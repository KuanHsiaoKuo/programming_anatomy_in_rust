<!DOCTYPE HTML>
<html lang="cn" class="sidebar-visible no-js rust">
<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>frame-executive - Programming Anatomy In Rust ğŸ¦€</title>


    <!-- Custom HTML head -->
    
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="ä»¥rustä¸ºä¾‹åˆ†äº«å­¦ä¹ ç¼–ç¨‹å¸¸è€ƒè™‘çš„æ–¹æ–¹é¢é¢">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff"/>

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../md-favicon.png">
    <link rel="stylesheet" href="../../../css/variables.css">
    <link rel="stylesheet" href="../../../css/general.css">
    <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../../highlight.css">
    <link rel="stylesheet" href="../../../tomorrow-night.css">
    <link rel="stylesheet" href="../../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../assets/pagetoc/pagetoc_style.css">
        <link rel="stylesheet" href="../../../assets/css/mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript"
                src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<!-- Provide site root to javascript -->
<script type="text/javascript">
    var path_to_root = "../../../";
    var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
</script>

<!-- Work around some values being stored in localStorage wrapped in quotes -->
<script type="text/javascript">
    try {
        var theme = localStorage.getItem('mdbook-theme');
        var sidebar = localStorage.getItem('mdbook-sidebar');

        if (theme.startsWith('"') && theme.endsWith('"')) {
            localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
        }

        if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
            localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
        }
    } catch (e) {
    }
</script>

<!-- Set the theme before any content is loaded, prevents flash -->
<script type="text/javascript">
    var theme;
    try {
        theme = localStorage.getItem('mdbook-theme');
    } catch (e) {
    }
    if (theme === null || theme === undefined) {
        theme = default_theme;
    }
    var html = document.querySelector('html');
    html.classList.remove('no-js')
    html.classList.remove('rust')
    html.classList.add(theme);
    html.classList.add('js');
</script>

<!-- Hide / unhide sidebar before it is displayed -->
<script type="text/javascript">
    var html = document.querySelector('html');
    var sidebar = 'hidden';
    if (document.body.clientWidth >= 1080) {
        try {
            sidebar = localStorage.getItem('mdbook-sidebar');
        } catch (e) {
        }
        sidebar = sidebar || 'visible';
    }
    html.classList.remove('sidebar-visible');
    html.classList.add("sidebar-" + sidebar);
</script>

<nav id="sidebar" class="sidebar" aria-label="Table of contents">
    <div class="sidebar-scrollbox">
        <ol class="chapter"><li class="chapter-item expanded "><a href="../../../../index.html"><strong aria-hidden="true">1.</strong> æ€»è§ˆ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../checklist.html"><strong aria-hidden="true">1.1.</strong> å¾…å®Œæˆ</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_intro.html"><strong aria-hidden="true">1.2.</strong> Substrateä»‹ç»ä¸è§£æ</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/1_learning_resource/talks.html"><strong aria-hidden="true">1.3.</strong> Rustè¯é¢˜</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer1_underlying_abstract/layer1_underlying_abstract.html"><strong aria-hidden="true">2.</strong> Layer1: åº•å±‚æŠ½è±¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer1_underlying_abstract/1_virtual_memory/virtual_memory.html"><strong aria-hidden="true">2.1.</strong> è™šæ‹Ÿå†…å­˜ç®¡ç†</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html"><strong aria-hidden="true">2.1.1.</strong> å†…å­˜ç®¡ç†ä¸å†…å­˜å®‰å…¨</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html"><strong aria-hidden="true">2.1.2.</strong> æ‰€æœ‰æƒä¸‰ä»¶å¥—</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer1_underlying_abstract/2_type_system/type_system.html"><strong aria-hidden="true">2.2.</strong> ç±»å‹ç³»ç»Ÿ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer1_underlying_abstract/2_type_system/built_in_types.html"><strong aria-hidden="true">2.2.1.</strong> åŸºç¡€å†…ç½®ç±»å‹</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/2_type_system/collections.html"><strong aria-hidden="true">2.2.2.</strong> é›†åˆç±»å‹</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/2_type_system/user_defined_types.html"><strong aria-hidden="true">2.2.3.</strong> è‡ªå®šä¹‰ç±»å‹</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/2_type_system/generics_traits_objects.html"><strong aria-hidden="true">2.2.4.</strong> æ³›å‹ã€ç‰¹å¾åŠç‰¹å¾å¯¹è±¡</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer1_underlying_abstract/3_language_grammar/language_grammar.html"><strong aria-hidden="true">2.3.</strong> è¯­è¨€è¯­æ³•</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html"><strong aria-hidden="true">2.3.1.</strong> æ³¨é‡Šä¸æ–‡æ¡£(rustdoc)</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/keywords_glossary.html"><strong aria-hidden="true">2.3.2.</strong> è¯æ³•ç»“æ„æ‰«ç›²</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html"><strong aria-hidden="true">2.3.3.</strong> ç»‘å®šã€èµ‹å€¼ä¸åŒ¹é…</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/logical_decision_loops.html"><strong aria-hidden="true">2.3.4.</strong> é€»è¾‘åˆ¤æ–­ä¸å¾ªç¯â™»ï¸</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/statements_expressions.html"><strong aria-hidden="true">2.3.5.</strong> è¯­å¥ä¸è¡¨è¾¾å¼</a></li><li class="chapter-item "><a href="../../../layer1_underlying_abstract/3_language_grammar/code_quality.html"><strong aria-hidden="true">2.3.6.</strong> ä»£ç è´¨é‡</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../layer2_design_abstract/layer2_design_abstract.html"><strong aria-hidden="true">3.</strong> Layer2: è®¾è®¡æŠ½è±¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html"><strong aria-hidden="true">3.1.</strong> ç¼–ç¨‹èŒƒå¼</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer2_design_abstract/4_programming_paradigm/fp.html"><strong aria-hidden="true">3.1.1.</strong> å‡½æ•°å¼ç¼–ç¨‹</a></li><li class="chapter-item "><a href="../../../layer2_design_abstract/4_programming_paradigm/oop.html"><strong aria-hidden="true">3.1.2.</strong> é¢å‘å¯¹è±¡ç¼–ç¨‹</a></li><li class="chapter-item "><a href="../../../layer2_design_abstract/4_programming_paradigm/gp.html"><strong aria-hidden="true">3.1.3.</strong> æ³›å‹ç¼–ç¨‹</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer2_design_abstract/5_design_pattern/5_design_pattern.html"><strong aria-hidden="true">3.2.</strong> è®¾è®¡æ¨¡å¼</a></li><li class="chapter-item expanded "><a href="../../../layer2_design_abstract/6_module_manage/6_module_manage.html"><strong aria-hidden="true">3.3.</strong> æ¨¡å—ç®¡ç†</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer2_design_abstract/6_module_manage/module_system.html"><strong aria-hidden="true">3.3.1.</strong> æ¨¡å—ç³»ç»Ÿ</a></li><li class="chapter-item "><a href="../../../layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html"><strong aria-hidden="true">3.3.2.</strong> Cargoä¸é¡¹ç›®ç”Ÿå‘½å‘¨æœŸ</a></li><li class="chapter-item "><a href="../../../layer2_design_abstract/6_module_manage/cargo_rustc.html"><strong aria-hidden="true">3.3.3.</strong> Cargo run: rustc</a></li><li class="chapter-item "><a href="../../../layer2_design_abstract/6_module_manage/rust_plugins.html"><strong aria-hidden="true">3.3.4.</strong> Rustæ‰©å±•å·¥å…·</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../layer3_task_abstract/layer3_task_abstract.html"><strong aria-hidden="true">4.</strong> Layer3: ä»»åŠ¡æŠ½è±¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer3_task_abstract/7_concurrency/7_concurrency.html"><strong aria-hidden="true">4.1.</strong> å¹¶å‘ç¼–ç¨‹</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer3_task_abstract/7_concurrency/io_models.html"><strong aria-hidden="true">4.1.1.</strong> ç³»ç»ŸIOæ¨¡å‹</a></li><li class="chapter-item "><a href="../../../layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html"><strong aria-hidden="true">4.1.2.</strong> å¤šçº¿ç¨‹æ¨¡å‹</a></li><li class="chapter-item "><a href="../../../layer3_task_abstract/7_concurrency/2_async_models/async_models.html"><strong aria-hidden="true">4.1.3.</strong> å¼‚æ­¥æ¨¡å‹</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer3_task_abstract/8_meta_programming/8_meta_programming.html"><strong aria-hidden="true">4.2.</strong> å…ƒç¼–ç¨‹</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer4_protocol_abstract/layer4_protocol_abstract.html"><strong aria-hidden="true">5.</strong> Layer4: åè®®æŠ½è±¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html"><strong aria-hidden="true">5.1.</strong> è·¨è¯­è¨€ç¼–ç¨‹</a></li><li class="chapter-item expanded "><a href="../../../layer4_protocol_abstract/10_computer_network/10_computer_network.html"><strong aria-hidden="true">5.2.</strong> è®¡ç®—æœºç½‘ç»œ</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer5_source_code_anatomy/layer5_source_code_anatomy.html"><strong aria-hidden="true">6.</strong> Layer5: æºç å‰–æ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer5_source_code_anatomy/substrate_anatomy/substrate_overview.html"><strong aria-hidden="true">6.1.</strong> Substrate</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer5_source_code_anatomy/substrate_anatomy/substrate_modules.html"><strong aria-hidden="true">6.1.1.</strong> Substrateä¸»è¦æ¨¡å—</a></li><li class="chapter-item expanded "><a href="../../../layer5_source_code_anatomy/substrate_anatomy/frame-executive/frame-executive.html" class="active"><strong aria-hidden="true">6.1.2.</strong> frame-executive</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/layer6_ecosystem.html"><strong aria-hidden="true">7.</strong> Layer6: ç”Ÿæ€ç¯å¢ƒ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/1_learning_resource/learning_resource.html"><strong aria-hidden="true">7.1.</strong> å­¦ä¹ èµ„æº</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/1_learning_resource/1_books/books.html"><strong aria-hidden="true">7.1.1.</strong> ä¹¦ç±æ•´ç†</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/1_learning_resource/2_courses/courses.html"><strong aria-hidden="true">7.1.2.</strong> çº¿ä¸Šè¯¾ç¨‹</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/1_learning_resource/3_blogs/blogs.html"><strong aria-hidden="true">7.1.3.</strong> åšå®¢æ–‡ç« </a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/1_learning_resource/4_videos/videos.html"><strong aria-hidden="true">7.1.4.</strong> åœ¨çº¿è§†é¢‘</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/1_learning_resource/5_projects/projects.html"><strong aria-hidden="true">7.1.5.</strong> å¼€æºé¡¹ç›®</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/2_lang_update/lang_update.html"><strong aria-hidden="true">7.2.</strong> å®˜æ–¹åŠ¨æ€</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/3_community/community.html"><strong aria-hidden="true">7.3.</strong> ç¤¾åŒºçƒ­ç‚¹</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/4_academic/academic.html"><strong aria-hidden="true">7.4.</strong> å­¦æœ¯è®¨è®º</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/5_open_source/open_source.html"><strong aria-hidden="true">7.5.</strong> å¼€æºè§‚å¯Ÿ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/underlying.html"><strong aria-hidden="true">7.5.1.</strong> åº•å±‚å¼€å‘</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/command/command.html"><strong aria-hidden="true">7.5.1.1.</strong> å‘½ä»¤è¡Œå·¥å…·</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/data/data.html"><strong aria-hidden="true">7.5.1.2.</strong> æ•°æ®å¤„ç†</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/embedded/embedded.html"><strong aria-hidden="true">7.5.1.3.</strong> åµŒå…¥å¼</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/os/os.html"><strong aria-hidden="true">7.5.1.4.</strong> ç³»ç»Ÿå¼€å‘</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/1_underlying/performance/performance.html"><strong aria-hidden="true">7.5.1.5.</strong> æ€§èƒ½å·¥å…·</a></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network.html"><strong aria-hidden="true">7.5.2.</strong> ç½‘ç»œç›¸å…³</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/cloud/cloud.html"><strong aria-hidden="true">7.5.2.1.</strong> äº‘åŸç”Ÿ</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/frontend/frontend.html"><strong aria-hidden="true">7.5.2.2.</strong> å‰ç«¯åŸºå»º</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/network.html"><strong aria-hidden="true">7.5.2.3.</strong> ç½‘ç»œåŸºå»º</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html"><strong aria-hidden="true">7.5.2.3.1.</strong> IPFS: æ˜Ÿé™…æ–‡ä»¶ç³»ç»Ÿ(InterPlanetary File System)</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/ipfs/ipfs_website.html"><strong aria-hidden="true">7.5.2.3.1.1.</strong> åˆ©ç”¨IPFSæ„å»ºè‡ªå·±çš„å»ä¸­å¿ƒåŒ–åˆ†å¸ƒå¼ç½‘ç«™</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/ipfs/ipfs_pubsub.html"><strong aria-hidden="true">7.5.2.3.1.2.</strong> IPFS pubsubåŠŸèƒ½</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/ipfs/ipfs_companion.html"><strong aria-hidden="true">7.5.2.3.1.3.</strong> IPFSä¼´ä¾£æ’ä»¶</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/network/ipfs/ipfs_ngrok.html"><strong aria-hidden="true">7.5.2.3.1.4.</strong> IPFS+ngrok</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/web/web.html"><strong aria-hidden="true">7.5.2.4.</strong> webå¼€å‘</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/2_network/web/webassembly_try.html"><strong aria-hidden="true">7.5.2.4.1.</strong> åŸºäºRustå°è¯•WebAssembly</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/3_media/media.html"><strong aria-hidden="true">7.5.3.</strong> å¤šåª’ä½“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/3_media/av/av.html"><strong aria-hidden="true">7.5.3.1.</strong> éŸ³è§†é¢‘å¤„ç†</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/3_media/game/game.html"><strong aria-hidden="true">7.5.3.2.</strong> æ¸¸æˆå¼€å‘</a></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/4_other/other.html"><strong aria-hidden="true">7.5.4.</strong> å…¶ä»–</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/4_other/lang-with-rust/lang_with_rust.html"><strong aria-hidden="true">7.5.4.1.</strong> Rustä¸å…¶ä»–è¯­è¨€</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/4_other/scientific-research/scientific_research.html"><strong aria-hidden="true">7.5.4.2.</strong> ç§‘å­¦è‰ºæœ¯ç ”ç©¶</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/5_open_source/4_other/tools/tools.html"><strong aria-hidden="true">7.5.4.3.</strong> å…¶ä»–å·¥å…·</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/6_security/security.html"><strong aria-hidden="true">7.6.</strong> å®‰å…¨å‚è€ƒ</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/7_business/business.html"><strong aria-hidden="true">7.7.</strong> å•†ä¸šè§‚å¯Ÿ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/blockchain.html"><strong aria-hidden="true">7.7.1.</strong> åŒºå—é“¾</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/build-a-block-in-rust.html"><strong aria-hidden="true">7.7.1.1.</strong> ä½¿ç”¨rustå»ºç«‹ä¸€ä¸ªç®€å•çš„åŒºå—é“¾</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_intro.html"><strong aria-hidden="true">7.7.1.2.</strong> Substrateä»‹ç»ä¸è§£æ</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html"><strong aria-hidden="true">7.7.1.2.1.</strong> Substrateæ•™ç¨‹æ¢³ç†</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_pallet.html"><strong aria-hidden="true">7.7.1.2.2.</strong> æ·±å…¥Substrate Pallet</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_runtime.html"><strong aria-hidden="true">7.7.1.2.3.</strong> æ·±å…¥Substrate Runtime</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_FRAME.html"><strong aria-hidden="true">7.7.1.2.4.</strong> æ·±å…¥Substrate FRAME</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_ref.html"><strong aria-hidden="true">7.7.1.2.5.</strong> Substrateå¤‡å¿˜</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html"><strong aria-hidden="true">7.7.1.2.6.</strong> Substrateå¸‚åœºï¼šRutimesã€Palletså’ŒProjects</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/substrate/awesome_substrate.html"><strong aria-hidden="true">7.7.1.2.7.</strong> SubstrateæƒŠå¥‡èµ„æº</a></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html"><strong aria-hidden="true">7.7.1.3.</strong> Nervos CKBä»‹ç»ä¸è§£æ</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/blockchain/solana.html"><strong aria-hidden="true">7.7.1.4.</strong> Solana</a></li></ol></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/practices/practices.html"><strong aria-hidden="true">7.7.2.</strong> ç”Ÿäº§å®è·µ</a></li><li class="chapter-item "><a href="../../../layer6_ecosystem/7_business/products/products.html"><strong aria-hidden="true">7.7.3.</strong> ä¼˜ç§€äº§å“</a></li></ol></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/8_libs/libs.html"><strong aria-hidden="true">7.8.</strong> åŸºç¡€åº“</a></li><li class="chapter-item expanded "><a href="../../../layer6_ecosystem/9_frameworks/frameworks.html"><strong aria-hidden="true">7.9.</strong> æ¡†æ¶å¼•æ“</a></li></ol></li><li class="chapter-item expanded "><a href="../../../checklist.html">Checklist</a></li></ol>
    </div>
    <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
</nav>

<div id="page-wrapper" class="page-wrapper">

    <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
        <div id="menu-bar" class="menu-bar sticky bordered">
            <div class="left-buttons">
                <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </button>
                <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                    <i class="fa fa-paint-brush"></i>
                </button>
                <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                    <li role="none">
                        <button role="menuitem" class="theme" id="light">Light</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="rust">Rust (default)</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="coal">Coal</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="navy">Navy</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="ayu">Ayu</button>
                    </li>
                </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                            aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                            aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
            </div>

            <h1 class="menu-title">Programming Anatomy In Rust ğŸ¦€</h1>
            <h4 class="menu-bar"><a href="https://kuanhsiaokuo.github.io/think-tool-kit/">ä¿æŒæ‰¹åˆ¤ï¼Œæœ‰æ‰€å–èˆï¼ŒçŸ¥è¡Œåˆä¸€, æ–¹è§çœŸæˆ‘</a> -- ç»ƒæ­¦ä¸ç»ƒåŠŸ
                åˆ°å¤´ä¸€åœºç©º -- ã€Šèµ›åšè‹±é›„ä¼ ã€‹ </h4>
            <div class="right-buttons">
                    <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/KuanHsiaoKuo/programming_anatomy_in_rust.git" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-rust"></i>
                    </a>
            </div>
        </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                           placeholder="Search this book ..." aria-controls="searchresults-outer"
                           aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

        <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
        <script type="text/javascript">
            document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
            document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
            Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
            });
        </script>

        <div id="content" class="content">
            <main>

                <!-- Page table of contents -->
                <div class="sidetoc">
                    <nav class="pagetoc"></nav>
                </div>
                <h1 id="frameexecutiveè§£å‰–"><a class="header" href="#frameexecutiveè§£å‰–">frame/executiveè§£å‰–</a></h1>
<h1 id="rustæ ¸å¿ƒ"><a class="header" href="#rustæ ¸å¿ƒ">Rustæ ¸å¿ƒ</a></h1>
<blockquote>
<p>é™æ€-&gt;æ³›å‹-&gt;trait-&gt;trait bound-&gt;trait object: structã€enumå’Œimpl</p>
</blockquote>
<!-- toc start -->
<!-- toc end -->
<h2 id="æ ¸å¿ƒæ€è·¯"><a class="header" href="#æ ¸å¿ƒæ€è·¯">æ ¸å¿ƒæ€è·¯</a></h2>
<ul>
<li>æ‰€æœ‰æƒã€å€Ÿç”¨ã€åˆ‡ç‰‡</li>
<li>æ³›å‹ã€traitã€ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<h3 id="ä»é™æ€è¯­è¨€å¼€å§‹"><a class="header" href="#ä»é™æ€è¯­è¨€å¼€å§‹">ä»é™æ€è¯­è¨€å¼€å§‹</a></h3>
<p>æ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦æŒ‡å®šç‰¹å®šç±»å‹</p>
<h3 id="ä¸ºäº†å¤ç”¨åŠ å…¥æ³›å‹"><a class="header" href="#ä¸ºäº†å¤ç”¨åŠ å…¥æ³›å‹">ä¸ºäº†å¤ç”¨ï¼ŒåŠ å…¥æ³›å‹</a></h3>
<p>å¯ä»¥ç”¨æ³›å‹æŒ‡å®šæ‰€æœ‰ç±»å‹ï¼Œå°±ä¸éœ€è¦é‡å¤å†™åŒæ ·çš„æ–¹æ³•</p>
<h3 id="ä¸ºäº†èŒƒå›´åŠ å…¥æ¥å£trait"><a class="header" href="#ä¸ºäº†èŒƒå›´åŠ å…¥æ¥å£trait">ä¸ºäº†èŒƒå›´ï¼ŒåŠ å…¥æ¥å£/trait</a></h3>
<p>å…¶å®å†™æ–¹æ³•å°±æ˜¯ä¸ºäº†å†™ç‰¹å®šæ“ä½œï¼Œé‚£ä¹ˆä¸å¦‚æŠŠæ“ä½œä½œä¸ºé‡ç‚¹ï¼Œäºæ˜¯å°±æœ‰äº†æ¥å£</p>
<h3 id="æ³›å‹traité™å®šä¼šå¯¼è‡´ç¼–è¯‘çš„åŒ…è†¨èƒ€äºæ˜¯è€ƒè™‘traitå¯¹è±¡"><a class="header" href="#æ³›å‹traité™å®šä¼šå¯¼è‡´ç¼–è¯‘çš„åŒ…è†¨èƒ€äºæ˜¯è€ƒè™‘traitå¯¹è±¡">æ³›å‹+traité™å®šä¼šå¯¼è‡´ç¼–è¯‘çš„åŒ…è†¨èƒ€ï¼Œäºæ˜¯è€ƒè™‘traitå¯¹è±¡</a></h3>
<ul>
<li><a href="marginnote3app://note/17559D64-980D-4EA7-B69E-49D766438399">ç²¾é€šrust-4.6 ä½¿ç”¨traitå¯¹è±¡å®ç°çœŸæ­£å¤šæ€æ€§</a></li>
</ul>
<blockquote>
<p>ç‰¹å¾å’Œæ³›å‹é€šè¿‡å•æ€åŒ–(æ—©æœŸç»‘å®š)æˆ–è¿è¡Œæ—¶å¤šæ€(åæœŸç»‘å®š)</p>
</blockquote>
<p>æä¾›äº†ä¸¤ç§ä»£ç å¤ç”¨çš„æ–¹å¼ã€‚ä½•æ—¶ä½¿ç”¨å®ƒä»¬å–å†³äºå…·ä½“æƒ…å†µå’Œç›¸å…³åº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚é€šå¸¸,é”™è¯¯ç±»å‹ä¼šè¢«åˆ†é…åˆ°åŠ¨æ€åˆ†å‘çš„åºåˆ—,å› ä¸ºå®ƒä»¬åº”è¯¥æ˜¯å¾ˆå°‘è¢«æ‰§è¡Œçš„ä»£ç è·¯å¾„ã€‚å•æ€åŒ–å¯¹å°å‹çš„åº”ç”¨åœºæ™¯æ¥è¯´éå¸¸æ–¹ä¾¿,ä½†æ˜¯ç¼ºç‚¹æ˜¯å¯¼è‡´äº†ä»£ç çš„è†¨èƒ€å’Œé‡å¤,è¿™ä¼šå½±å“ç¼“å­˜æ•ˆç‡,å¹¶å¢åŠ äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°ã€‚ä½†æ˜¯,åœ¨è¿™ä¸¤ä¸ªé€‰é¡¹ä¸­,é™æ€åˆ†å‘åº”è¯¥æ˜¯é¦–é€‰,é™¤éç³»ç»Ÿå¯¹äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°å­˜åœ¨ä¸¥æ ¼çš„é™åˆ¶ã€‚</p>
<h3 id="ä¸ºäº†éšç§åŠ å…¥pub"><a class="header" href="#ä¸ºäº†éšç§åŠ å…¥pub">ä¸ºäº†éšç§ï¼ŒåŠ å…¥pub</a></h3>
<h2 id="ä¸€æ³›å‹-generic-types"><a class="header" href="#ä¸€æ³›å‹-generic-types">ä¸€ã€æ³›å‹-Generic Types</a></h2>
<h3 id="æ³›å‹ç”±æ¥"><a class="header" href="#æ³›å‹ç”±æ¥">æ³›å‹ç”±æ¥</a></h3>
<blockquote>
<p>æ³›å‹æœ¬è´¨ä¸Šæ˜¯å¯¹å¤šç±»å‹çš„æŠ½è±¡ï¼Œå› ä¸ºå¯¹äºé™æ€è¯­è¨€æ¥è¯´éœ€è¦æŒ‡æ˜ç±»å‹ï¼Œå¯¹äºé‚£äº›å¾ˆå¤šç±»å‹é€šç”¨çš„å‡½æ•°ï¼Œä¸èƒ½ä¸€ä¸ªä¸ªåœ°å†™å‡ºæ¥ï¼Œé‚£æ ·ç¼–å†™ã€ç»´æŠ¤å¾ˆéº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨æ³›å‹äº†ã€‚</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn largest_i32(list: &amp;[i32]) -&gt; &amp;i32 {
    let mut largest = &amp;list[0];

    for item in list {
        if item &gt; largest {
            largest = item;
        }
    }

    largest
}

fn largest_char(list: &amp;[char]) -&gt; &amp;char {
    let mut largest = &amp;list[0];

    for item in list {
        if item &gt; largest {
            largest = item;
        }
    }

    largest
}


fn largest&lt;T&gt;(list: &amp;[T]) -&gt; &amp;T {
    let mut largest = &amp;list[0];

    for item in list {
        if item &gt; largest {
            largest = item;
        }
    }

    largest
}

<span class="boring">}
</span></code></pre></pre>
<h3 id="æ³›å‹ä½¿ç”¨"><a class="header" href="#æ³›å‹ä½¿ç”¨">æ³›å‹ä½¿ç”¨</a></h3>
<h4 id="èŒƒå‹ç»“æ„ä½“"><a class="header" href="#èŒƒå‹ç»“æ„ä½“">èŒƒå‹ç»“æ„ä½“</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Point&lt;T, U&gt; {
    x: T,
    y: U,
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="èŒƒå‹æšä¸¾ä½“"><a class="header" href="#èŒƒå‹æšä¸¾ä½“">èŒƒå‹æšä¸¾ä½“</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>enum Result&lt;T, E&gt; {
    Ok(T),
    Err(E),
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="èŒƒå‹æ–¹æ³•impl"><a class="header" href="#èŒƒå‹æ–¹æ³•impl">èŒƒå‹æ–¹æ³•(impl)</a></h4>
<blockquote>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¸æ˜¯æ³›å‹å‡½æ•°ã€‚æœ¬è´¨æ˜¯å› ä¸ºæ–¹æ³•æ˜¯éœ€è¦è°ƒç”¨è€…ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªå¯¹è±¡ï¼›è€Œå‡½æ•°æ˜¯è‡ªå·±è°ƒç”¨ã€‚</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust">struct Point&lt;T&gt; {
    x: T,
    y: T,
}

impl&lt;T&gt; Point&lt;T&gt; {
    fn x(&amp;self) -&gt; &amp;T {
        &amp;self.x
    }
}

fn main() {
    let p = Point { x: 5, y: 10 };

    println!(&quot;p.x = {}&quot;, p.x());
}
</code></pre></pre>
<h3 id="æ³›å‹çš„æ€§èƒ½è¡¨ç°"><a class="header" href="#æ³›å‹çš„æ€§èƒ½è¡¨ç°">æ³›å‹çš„æ€§èƒ½è¡¨ç°</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch10-01-syntax.html#performance-of-code-using-generics">Generic Data Types - The Rust Programming Language</a></li>
</ul>
<h2 id="åŒºåˆ†ä¸€ä¸‹ç±»çš„ç»„åˆä¸traitçš„ç»„åˆ"><a class="header" href="#åŒºåˆ†ä¸€ä¸‹ç±»çš„ç»„åˆä¸traitçš„ç»„åˆ">åŒºåˆ†ä¸€ä¸‹ç±»çš„ç»„åˆä¸traitçš„ç»„åˆ</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Point&lt;X1, Y1&gt; {
    x: X1,
    y: Y1,
}

<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn notify(item: &amp;(impl Summary + Display)) {}
<span class="boring">}
</span></code></pre></pre>
<h2 id="äºŒtrait"><a class="header" href="#äºŒtrait">äºŒã€Trait</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch10-02-traits.html">Traits: Defining Shared Behavior - The Rust Programming Language</a></li>
</ul>
<blockquote>
<p>A trait defines functionality a particular type has and can share with other types. We can use traits to define shared
behavior in an abstract way. We can use trait bounds to specify that a generic type can be any type that has certain
behavior.</p>
</blockquote>
<blockquote>
<p>Traits are similar to a feature often called interfaces in other languages, although with some differences.</p>
</blockquote>
<h3 id="å…³é”®å­—"><a class="header" href="#å…³é”®å­—">å…³é”®å­—</a></h3>
<h4 id="å®šä¹‰"><a class="header" href="#å®šä¹‰">å®šä¹‰</a></h4>
<p>trait</p>
<h4 id="å®ç°"><a class="header" href="#å®ç°">å®ç°</a></h4>
<p>impl <trait name> for <struct name>{ fn &lt;method_name in trait definition&gt; }</p>
<h4 id="ä¸å®ç°æ–¹æ³•çš„åŒºåˆ«"><a class="header" href="#ä¸å®ç°æ–¹æ³•çš„åŒºåˆ«">ä¸å®ç°æ–¹æ³•çš„åŒºåˆ«</a></h4>
<p>Implementing a trait on a type is similar to implementing regular methods. The difference is that after impl, we put the
trait name we want to implement, then use the for keyword, and then specify the name of the type we want to implement
the trait for. Within the impl block, we put the method signatures that the trait definition has defined. Instead of
adding a semicolon after each signature, we use curly brackets and fill in the method body with the specific behavior
that we want the methods of the trait to have for the particular type.</p>
<h3 id="ä¸¾ä¾‹"><a class="header" href="#ä¸¾ä¾‹">ä¸¾ä¾‹</a></h3>
<pre><pre class="playground"><code class="language-rust">pub trait Summary {
    fn summarize(&amp;self) -&gt; String;
}

pub struct NewsArticle {
    pub headline: String,
    pub location: String,
    pub author: String,
    pub content: String,
}

impl Summary for NewsArticle {
    fn summarize(&amp;self) -&gt; String {
        format!(&quot;{}, by {} ({})&quot;, self.headline, self.author, self.location)
    }
}

pub struct Tweet {
    pub username: String,
    pub content: String,
    pub reply: bool,
    pub retweet: bool,
}

impl Summary for Tweet {
    fn summarize(&amp;self) -&gt; String {
        format!(&quot;{}: {}&quot;, self.username, self.content)
    }
}


use aggregator::{Summary, Tweet};

fn main() {
    let tweet = Tweet {
        username: String::from(&quot;horse_ebooks&quot;),
        content: String::from(
            &quot;of course, as you probably already know, people&quot;,
        ),
        reply: false,
        retweet: false,
    };

    println!(&quot;1 new tweet: {}&quot;, tweet.summarize());
}


</code></pre></pre>
<h3 id="é™åˆ¶å­¤å„¿åŸåˆ™"><a class="header" href="#é™åˆ¶å­¤å„¿åŸåˆ™">é™åˆ¶ï¼šå­¤å„¿åŸåˆ™</a></h3>
<p>we canâ€™t implement external traits on external types. For example, we canâ€™t implement the Display trait on Vec<T> within
our aggregator crate, because Display and Vec<T> are both defined in the standard library and arenâ€™t local to our
aggregator crate. This restriction is part of a property called coherence (ç›¸å¹²) , and more specifically the orphan (å­¤å„¿)
rule, so named because the parent type is not present. This rule ensures that other peopleâ€™s code canâ€™t break your code
and vice (å‰¯) versa. Without the rule, two crates could implement the same trait for the same type, and Rust wouldnâ€™t
know which implementation to use.</p>
<h3 id="å¸¸ç”¨æ–¹å¼"><a class="header" href="#å¸¸ç”¨æ–¹å¼">å¸¸ç”¨æ–¹å¼</a></h3>
<h4 id="åœ¨traitå®šä¹‰ä¸­ç¼–å†™é»˜è®¤æ–¹æ³•é€»è¾‘"><a class="header" href="#åœ¨traitå®šä¹‰ä¸­ç¼–å†™é»˜è®¤æ–¹æ³•é€»è¾‘">åœ¨traitå®šä¹‰ä¸­ç¼–å†™é»˜è®¤æ–¹æ³•é€»è¾‘</a></h4>
<h4 id="ä½œä¸ºå‡½æ•°å…¥å‚"><a class="header" href="#ä½œä¸ºå‡½æ•°å…¥å‚">ä½œä¸ºå‡½æ•°å…¥å‚:</a></h4>
<h5 id="impl"><a class="header" href="#impl">&amp;impl</a></h5>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn notify(item: &amp;impl Summary) {
    println!(&quot;Breaking news! {}&quot;, item.summarize());
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="è¯­æ³•ç³–traité™å®štrait-bounds"><a class="header" href="#è¯­æ³•ç³–traité™å®štrait-bounds">è¯­æ³•ç³–ï¼štraité™å®š(trait bounds)</a></h4>
<h5 id="ä½¿ç”¨tä»£ç§°"><a class="header" href="#ä½¿ç”¨tä»£ç§°">ä½¿ç”¨Tä»£ç§°</a></h5>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn notify&lt;T: Summary&gt;(item1: &amp;T, item2: &amp;T) {}
<span class="boring">}
</span></code></pre></pre>
<h5 id="ä½¿ç”¨ç»„åˆç»§æ‰¿"><a class="header" href="#ä½¿ç”¨ç»„åˆç»§æ‰¿">ä½¿ç”¨â€œ+â€ç»„åˆç»§æ‰¿</a></h5>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn notify(item: &amp;(impl Summary + Display)) {}
<span class="boring">}
</span></code></pre></pre>
<h5 id="ä½¿ç”¨whereåç½®"><a class="header" href="#ä½¿ç”¨whereåç½®">ä½¿ç”¨whereåç½®</a></h5>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn some_function&lt;T, U&gt;(t: &amp;T, u: &amp;U) -&gt; i32
    where T: Display + Clone,
          U: Clone + Debug
{}

<span class="boring">}
</span></code></pre></pre>
<h4 id="ä½œä¸ºå‡½æ•°å‡ºå‚"><a class="header" href="#ä½œä¸ºå‡½æ•°å‡ºå‚">ä½œä¸ºå‡½æ•°å‡ºå‚</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn returns_summarizable() -&gt; impl Summary {
    Tweet {
        username: String::from(&quot;horse_ebooks&quot;),
        content: String::from(
            &quot;of course, as you probably already know, people&quot;,
        ),
        reply: false,
        retweet: false,
    }
}
<span class="boring">}
</span></code></pre></pre>
<h5 id="æ¡ä»¶å‡ºå‚"><a class="header" href="#æ¡ä»¶å‡ºå‚">æ¡ä»¶å‡ºå‚</a></h5>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn returns_summarizable(switch: bool) -&gt; impl Summary {
    if switch {
        NewsArticle {
            headline: String::from(
                &quot;Penguins win the Stanley Cup Championship!&quot;,
            ),
            location: String::from(&quot;Pittsburgh, PA, USA&quot;),
            author: String::from(&quot;Iceburgh&quot;),
            content: String::from(
                &quot;The Pittsburgh Penguins once again are the best \
                 hockey team in the NHL.&quot;,
            ),
        }
    } else {
        Tweet {
            username: String::from(&quot;horse_ebooks&quot;),
            content: String::from(
                &quot;of course, as you probably already know, people&quot;,
            ),
            reply: false,
            retweet: false,
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="æ³›å‹traitå¤šæ€"><a class="header" href="#æ³›å‹traitå¤šæ€">æ³›å‹traitå¤šæ€</a></h4>
<blockquote>
<p>æ ¹æ®æ³›å‹çš„traitè®¾å®šä¸åŒå‡½æ•°</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::fmt::Display;

struct Pair&lt;T&gt; {
    x: T,
    y: T,
}

impl&lt;T&gt; Pair&lt;T&gt; {
    fn new(x: T, y: T) -&gt; Self {
        Self { x, y }
    }
}

impl&lt;T: Display + PartialOrd&gt; Pair&lt;T&gt; {
    fn cmp_display(&amp;self) {
        if self.x &gt;= self.y {
            println!(&quot;The largest member is x = {}&quot;, self.x);
        } else {
            println!(&quot;The largest member is y = {}&quot;, self.y);
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<h2 id="ä¸‰trait-objects"><a class="header" href="#ä¸‰trait-objects">ä¸‰ã€Trait Objects</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/types/trait-object.html">Trait object types - The Rust Reference</a></li>
</ul>
<blockquote>
<p>A trait object is an opaque value of another type that implements a set of traits. The set of traits is made up of an
object safe base trait plus any number of auto traits.</p>
</blockquote>
<h3 id="å…³é”®å­—-1"><a class="header" href="#å…³é”®å­—-1">å…³é”®å­—</a></h3>
<p>dyn Trait</p>
<blockquote>
<p>Before the 2021 edition, the dyn keyword may be omitted .</p>
</blockquote>
<h3 id="å­˜åœ¨å½¢å¼"><a class="header" href="#å­˜åœ¨å½¢å¼">å­˜åœ¨å½¢å¼</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>dyn Trait
dyn Trait + Send
dyn Trait + Send + Sync
dyn Trait + 'static
dyn Trait + Send + 'static
dyn Trait +
dyn 'static + Trait.
dyn (Trait)
<span class="boring">}
</span></code></pre></pre>
<h3 id="ä¸¾ä¾‹-1"><a class="header" href="#ä¸¾ä¾‹-1">ä¸¾ä¾‹</a></h3>
<pre><pre class="playground"><code class="language-rust">trait Printable {
    fn stringify(&amp;self) -&gt; String;
}

impl Printable for i32 {
    fn stringify(&amp;self) -&gt; String { self.to_string() }
}

fn print(a: Box&lt;dyn Printable&gt;) {
    println!(&quot;{}&quot;, a.stringify());
}

fn main() {
    print(Box::new(10) as Box&lt;dyn Printable&gt;);
}
</code></pre></pre>
<h3 id="é¢å‘å¯¹è±¡ç¼–ç¨‹åº”ç”¨trait-objects--structenum"><a class="header" href="#é¢å‘å¯¹è±¡ç¼–ç¨‹åº”ç”¨trait-objects--structenum">é¢å‘å¯¹è±¡ç¼–ç¨‹åº”ç”¨(trait objects + struct/enum)</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch17-02-trait-objects.html">Using Trait Objects That Allow for Values of Different Types - The Rust Programming Language</a></li>
</ul>
<blockquote>
<p>We can use trait objects in place of a generic or concrete type.</p>
</blockquote>
<p>Wherever we use a trait object, Rustâ€™s type system will ensure at compile time that any value used in that context will
implement the trait objectâ€™s trait. Consequently, we donâ€™t need to know all the possible types at compile time.</p>
<blockquote>
<p>Weâ€™ve mentioned that, in Rust, we refrain from calling structs and enums â€œobjectsâ€ to distinguish them from other
languagesâ€™ objects.</p>
</blockquote>
<p>In a struct or enum, the data in the struct fields and the behavior in impl blocks are separated, whereas in other
languages, the data and behavior combined into one concept is often labeled an object.</p>
<p>However, trait objects are more like objects in other languages in the sense that they combine data and behavior.</p>
<p>But trait objects differ from traditional objects in that we canâ€™t add data to a trait object. Trait objects arenâ€™t as
generally useful as objects in other languages: their specific purpose is to allow abstraction across common behavior.</p>
<ul>
<li>trait objects</li>
</ul>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Screen {
    // This vector is of type Box&lt;dyn Draw&gt;
    // which is a trait object; itâ€™s a stand-in for any type inside a Box that implements the Draw trait.
    pub components: Vec&lt;Box&lt;dyn Draw&gt;&gt;,
}

impl Screen {
    pub fn run(&amp;self) {
        for component in self.components.iter() {
            component.draw();
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<ul>
<li>trait bounds</li>
</ul>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Screen&lt;T: Draw&gt; {
    pub components: Vec&lt;T&gt;,
}

// If youâ€™ll only ever have homogeneous collections, 
// using generics and trait bounds is preferable because 
// the definitions will be monomorphized at compile time to use the concrete types.
impl&lt;T&gt; Screen&lt;T&gt;
    where
        T: Draw,
{
    pub fn run(&amp;self) {
        for component in self.components.iter() {
            component.draw();
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<ul>
<li>static or dynamic dispatch</li>
</ul>
<ol>
<li>traité™å®šï¼šé™æ€åˆ†å‘ï¼Œç¼–è¯‘æœŸç¡®å®šï¼Œå¯¹åº”å®ç°äº†traité™å®šçš„ç±»å‹</li>
<li>traitå¯¹è±¡ï¼šåŠ¨æ€åˆ†å‘ï¼Œç¼–è¯‘å™¨æŒ‡é’ˆï¼Œè¿è¡ŒæœŸç¡®å®šå…·ä½“ç±»å‹</li>
</ol>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn trait_object() {
    #[derive(Debug)]
    struct Foo;
    trait Bar {
        fn baz(&amp;self);
    }
    impl Bar for Foo {
        fn baz(&amp;self) { println!(&quot;{:?}&quot;, self) }
    }
    fn static_dispatch&lt;T&gt;(t: &amp;T) where T: Bar {
        t.baz();
    }
    fn dynamic_dispatch(t: &amp;Bar) {
        t.baz();
    }
    let foo = Foo;
    static_dispatch(&amp;foo);
    dynamic_dispatch(&amp;foo);
}

<span class="boring">}
</span></code></pre></pre>
<h4 id="trait-objects-å…¶å®å°±æ˜¯é¸­å­ç±»å‹"><a class="header" href="#trait-objects-å…¶å®å°±æ˜¯é¸­å­ç±»å‹">trait objects å…¶å®å°±æ˜¯é¸­å­ç±»å‹</a></h4>
<blockquote>
<p>åœ¨ç¼–è¯‘æœŸç¼–è¯‘å™¨å°±çŸ¥é“ä½ çš„ç±»å‹æ˜¯å¦å…·æœ‰æŒ‡å®šçš„åŠ¨ä½œï¼Œæå‰æ£€æŸ¥</p>
</blockquote>
<p>This conceptâ€”of being concerned only with the messages a value responds to rather than the valueâ€™s concrete typeâ€”is
similar to the concept of duck typing in dynamically typed languages:</p>
<blockquote>
<p>if it walks like a duck and quacks like a duck, then it must be a duck!</p>
</blockquote>
<p>In the implementation of run on Screen in Listing 17-5, run doesnâ€™t need to know what the concrete type of each
component is.</p>
<p>It doesnâ€™t check whether a component is an instance of a Button or a SelectBox, it just calls the draw method on the
component.</p>
<blockquote>
<p>By specifying Box<dyn Draw> as the type of the values in the components vector, weâ€™ve defined Screen to need values
that we can call the draw method on.</p>
</blockquote>
<p>The advantage of using trait objects and Rustâ€™s type system to write code similar to code using duck typing is that:</p>
<ul>
<li>we never have to check whether a value implements a particular method at runtime or worry about getting errors if a
value doesnâ€™t implement a method but we call it anyway.</li>
<li>Rust wonâ€™t compile our code if the values donâ€™t implement the traits that the trait objects need.</li>
</ul>
<h2 id="å››trait-object-ä¸-trait-boundçš„å¯¹æ¯”"><a class="header" href="#å››trait-object-ä¸-trait-boundçš„å¯¹æ¯”">å››ã€trait object ä¸ trait boundçš„å¯¹æ¯”</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch10-01-syntax.html#performance-of-code-using-generics">Performance of Code Using Generics</a></li>
<li><a href="https://doc.rust-lang.org/book/ch17-02-trait-objects.html#trait-objects-perform-dynamic-dispatch">Trait Objects Perform Dynamic Dispatch</a></li>
</ul>
<p>Recall in the â€œPerformance of Code Using Genericsâ€ section in Chapter 10 our discussion on the monomorphization process
performed by the compiler when we use trait bounds on generics: the compiler generates nongeneric implementations of
functions and methods for each concrete type that we use in place of a generic type parameter. The code that results
from monomorphization is doing static dispatch, which is when the compiler knows what method youâ€™re calling at compile
time. This is opposed to dynamic dispatch, which is when the compiler canâ€™t tell at compile time which method youâ€™re
calling. In dynamic dispatch cases, the compiler emits code that at runtime will figure out which method to call.</p>
<p>When we use trait objects, Rust must use dynamic dispatch. The compiler doesnâ€™t know all the types that might be used
with the code thatâ€™s using trait objects, so it doesnâ€™t know which method implemented on which type to call. Instead, at
runtime, Rust uses the pointers inside the trait object to know which method to call. This lookup incurs a runtime cost
that doesnâ€™t occur with static dispatch. Dynamic dispatch also prevents the compiler from choosing to inline a methodâ€™s
code, which in turn prevents some optimizations. However, we did get extra flexibility in the code that we wrote in
Listing 17-5 and were able to support in Listing 17-9, so itâ€™s a trade-off to consider.</p>
<ul>
<li>taitå¯¹è±¡ç¼–è¯‘æœŸé—´æ— æ³•ç¡®å®šå¯¹è±¡å¤§å°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨æŒ‡é’ˆå½¢å¼(å¼•ç”¨)ã€‚</li>
</ul>
<blockquote>
<p>traitä½œä¸ºå‚æ•°ä¸€èˆ¬æœ‰ä¸¤ç§å†™æ³•ï¼š</p>
</blockquote>
<ul>
<li>ä¸€ç§æ˜¯traitå¯¹è±¡ï¼Œéœ€è¦è¿è¡Œæ—¶æ‰èƒ½è·å–å¯¹è±¡å¤§å°å±äºåŠ¨æ€åˆ†å‘ï¼Œ</li>
<li>ä¸€ç§æ˜¯traité™å®šï¼Œç±»ä¼¼æ¨¡æ¿æ˜¯ç¼–è¯‘å™¨ä»¶ç¡®å®šå±äºé™æ€åˆ†å‘ã€‚</li>
</ul>
<h2 id="äº”implä½¿ç”¨åœºæ™¯å®ç°æ–¹æ³•è€Œéå‡½æ•°"><a class="header" href="#äº”implä½¿ç”¨åœºæ™¯å®ç°æ–¹æ³•è€Œéå‡½æ•°">äº”ã€implä½¿ç”¨åœºæ™¯ï¼šå®ç°æ–¹æ³•ï¼Œè€Œéå‡½æ•°ã€‚</a></h2>
<blockquote>
<p>implä¸fnä¸ä¼šå…±å­˜</p>
</blockquote>
<h3 id="impl--xxxç»“æ„ä½“æšä¸¾ä½“å®šä¹‰å¹¶å®ç°æ–¹æ³•"><a class="header" href="#impl--xxxç»“æ„ä½“æšä¸¾ä½“å®šä¹‰å¹¶å®ç°æ–¹æ³•">impl &lt;&gt; xxx&lt;&gt;ç»“æ„ä½“/æšä¸¾ä½“ï¼šå®šä¹‰å¹¶å®ç°æ–¹æ³•</a></h3>
<blockquote>
<p>impl<target types> &lt;struct/enum&gt;<target types></p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&amp;self) -&gt; u32 {
        self.width * self.height
    }
}
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Point&lt;T&gt; {
    x: T,
    y: T,
}

impl&lt;T&gt; Point&lt;T&gt; {
    fn x(&amp;self) -&gt; &amp;T {
        &amp;self.x
    }
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="ç¤ºä¾‹ä¸€-å®šä¹‰å¹¶å®ç°è®¸å¤šæ–¹æ³•"><a class="header" href="#ç¤ºä¾‹ä¸€-å®šä¹‰å¹¶å®ç°è®¸å¤šæ–¹æ³•">ç¤ºä¾‹ä¸€: å®šä¹‰å¹¶å®ç°è®¸å¤šæ–¹æ³•</a></h4>
<ul>
<li><a href="https://paritytech.github.io/substrate/master/frame_executive/struct.Executive.html">Executive in frame_executive - Rust</a></li>
</ul>
<blockquote>
<p>substrate/frame/executive/src/lib.rs</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">impl&lt;
		System: frame_system::Config + EnsureInherentsAreFirst&lt;Block&gt;,
		Block: traits::Block&lt;Header = System::Header, Hash = System::Hash&gt;,
		Context: Default,
		UnsignedValidator,
		AllPalletsWithSystem: OnRuntimeUpgrade
			+ OnInitialize&lt;System::BlockNumber&gt;
			+ OnIdle&lt;System::BlockNumber&gt;
			+ OnFinalize&lt;System::BlockNumber&gt;
			+ OffchainWorker&lt;System::BlockNumber&gt;,
		COnRuntimeUpgrade: OnRuntimeUpgrade,
	&gt; Executive&lt;System, Block, Context, UnsignedValidator, AllPalletsWithSystem, COnRuntimeUpgrade&gt;
where
	Block::Extrinsic: Checkable&lt;Context&gt; + Codec,
	CheckedOf&lt;Block::Extrinsic, Context&gt;: Applyable + GetDispatchInfo,
	CallOf&lt;Block::Extrinsic, Context&gt;:
		Dispatchable&lt;Info = DispatchInfo, PostInfo = PostDispatchInfo&gt;,
	OriginOf&lt;Block::Extrinsic, Context&gt;: From&lt;Option&lt;System::AccountId&gt;&gt;,
	UnsignedValidator: ValidateUnsigned&lt;Call = CallOf&lt;Block::Extrinsic, Context&gt;&gt;,
{
	/// Execute all `OnRuntimeUpgrade` of this runtime, and return the aggregate weight.
	pub fn execute_on_runtime_upgrade() -&gt; frame_support::weights::Weight {
		&lt;(COnRuntimeUpgrade, AllPalletsWithSystem) as OnRuntimeUpgrade&gt;::on_runtime_upgrade()
	}

	/// Execute given block, but don't do any of the `final_checks`.
	///
	/// Should only be used for testing.
	#[cfg(feature = &quot;try-runtime&quot;)]
	pub fn execute_block_no_check(block: Block) -&gt; frame_support::weights::Weight {
		Self::initialize_block(block.header());
		Self::initial_checks(&amp;block);

		let (header, extrinsics) = block.deconstruct();

		Self::execute_extrinsics_with_book_keeping(extrinsics, *header.number());

		// do some of the checks that would normally happen in `final_checks`, but definitely skip
		// the state root check.
		{
			let new_header = &lt;frame_system::Pallet&lt;System&gt;&gt;::finalize();
			let items_zip = header.digest().logs().iter().zip(new_header.digest().logs().iter());
			for (header_item, computed_item) in items_zip {
				header_item.check_equal(computed_item);
				assert!(header_item == computed_item, &quot;Digest item must match that calculated.&quot;);
			}

			assert!(
				header.extrinsics_root() == new_header.extrinsics_root(),
				&quot;Transaction trie root must be valid.&quot;,
			);
		}

		frame_system::Pallet::&lt;System&gt;::block_weight().total()
	}

	/// Execute all `OnRuntimeUpgrade` of this runtime, including the pre and post migration checks.
	///
	/// This should only be used for testing.
	#[cfg(feature = &quot;try-runtime&quot;)]
	pub fn try_runtime_upgrade() -&gt; Result&lt;frame_support::weights::Weight, &amp;'static str&gt; {
		&lt;(COnRuntimeUpgrade, AllPalletsWithSystem) as OnRuntimeUpgrade&gt;::pre_upgrade().unwrap();
		let weight = Self::execute_on_runtime_upgrade();

		&lt;(COnRuntimeUpgrade, AllPalletsWithSystem) as OnRuntimeUpgrade&gt;::post_upgrade().unwrap();

		Ok(weight)
	}

	/// Start the execution of a particular block.
	pub fn initialize_block(header: &amp;System::Header) {
		sp_io::init_tracing();
		sp_tracing::enter_span!(sp_tracing::Level::TRACE, &quot;init_block&quot;);
		let digests = Self::extract_pre_digest(header);
		Self::initialize_block_impl(header.number(), header.parent_hash(), &amp;digests);
	}

	fn extract_pre_digest(header: &amp;System::Header) -&gt; Digest {
		let mut digest = &lt;Digest&gt;::default();
		header.digest().logs().iter().for_each(|d| {
			if d.as_pre_runtime().is_some() {
				digest.push(d.clone())
			}
		});
		digest
	}

	fn initialize_block_impl(
		block_number: &amp;System::BlockNumber,
		parent_hash: &amp;System::Hash,
		digest: &amp;Digest,
	) {
		// Reset events before apply runtime upgrade hook.
		// This is required to preserve events from runtime upgrade hook.
		// This means the format of all the event related storages must always be compatible.
		&lt;frame_system::Pallet&lt;System&gt;&gt;::reset_events();

		let mut weight = 0;
		if Self::runtime_upgraded() {
			weight = weight.saturating_add(Self::execute_on_runtime_upgrade());
		}
		&lt;frame_system::Pallet&lt;System&gt;&gt;::initialize(block_number, parent_hash, digest);
		weight = weight.saturating_add(&lt;AllPalletsWithSystem as OnInitialize&lt;
			System::BlockNumber,
		&gt;&gt;::on_initialize(*block_number));
		weight = weight.saturating_add(
			&lt;System::BlockWeights as frame_support::traits::Get&lt;_&gt;&gt;::get().base_block,
		);
		&lt;frame_system::Pallet&lt;System&gt;&gt;::register_extra_weight_unchecked(
			weight,
			DispatchClass::Mandatory,
		);

		frame_system::Pallet::&lt;System&gt;::note_finished_initialize();
	}

	/// Returns if the runtime was upgraded since the last time this function was called.
	fn runtime_upgraded() -&gt; bool {
		let last = frame_system::LastRuntimeUpgrade::&lt;System&gt;::get();
		let current = &lt;System::Version as frame_support::traits::Get&lt;_&gt;&gt;::get();

		if last.map(|v| v.was_upgraded(&amp;current)).unwrap_or(true) {
			frame_system::LastRuntimeUpgrade::&lt;System&gt;::put(
				frame_system::LastRuntimeUpgradeInfo::from(current),
			);
			true
		} else {
			false
		}
	}

	fn initial_checks(block: &amp;Block) {
		sp_tracing::enter_span!(sp_tracing::Level::TRACE, &quot;initial_checks&quot;);
		let header = block.header();

		// Check that `parent_hash` is correct.
		let n = *header.number();
		assert!(
			n &gt; System::BlockNumber::zero() &amp;&amp;
				&lt;frame_system::Pallet&lt;System&gt;&gt;::block_hash(n - System::BlockNumber::one()) ==
					*header.parent_hash(),
			&quot;Parent hash should be valid.&quot;,
		);

		if let Err(i) = System::ensure_inherents_are_first(block) {
			panic!(&quot;Invalid inherent position for extrinsic at index {}&quot;, i);
		}
	}

	/// Actually execute all transitions for `block`.
	pub fn execute_block(block: Block) {
		sp_io::init_tracing();
		sp_tracing::within_span! {
			sp_tracing::info_span!(&quot;execute_block&quot;, ?block);

			Self::initialize_block(block.header());

			// any initial checks
			Self::initial_checks(&amp;block);

			let signature_batching = sp_runtime::SignatureBatching::start();

			// execute extrinsics
			let (header, extrinsics) = block.deconstruct();
			Self::execute_extrinsics_with_book_keeping(extrinsics, *header.number());

			if !signature_batching.verify() {
				panic!(&quot;Signature verification failed.&quot;);
			}

			// any final checks
			Self::final_checks(&amp;header);
		}
	}

	/// Execute given extrinsics and take care of post-extrinsics book-keeping.
	fn execute_extrinsics_with_book_keeping(
		extrinsics: Vec&lt;Block::Extrinsic&gt;,
		block_number: NumberFor&lt;Block&gt;,
	) {
		extrinsics.into_iter().for_each(|e| {
			if let Err(e) = Self::apply_extrinsic(e) {
				let err: &amp;'static str = e.into();
				panic!(&quot;{}&quot;, err)
			}
		});

		// post-extrinsics book-keeping
		&lt;frame_system::Pallet&lt;System&gt;&gt;::note_finished_extrinsics();

		Self::idle_and_finalize_hook(block_number);
	}

	/// Finalize the block - it is up the caller to ensure that all header fields are valid
	/// except state-root.
	pub fn finalize_block() -&gt; System::Header {
		sp_io::init_tracing();
		sp_tracing::enter_span!(sp_tracing::Level::TRACE, &quot;finalize_block&quot;);
		&lt;frame_system::Pallet&lt;System&gt;&gt;::note_finished_extrinsics();
		let block_number = &lt;frame_system::Pallet&lt;System&gt;&gt;::block_number();

		Self::idle_and_finalize_hook(block_number);

		&lt;frame_system::Pallet&lt;System&gt;&gt;::finalize()
	}

	fn idle_and_finalize_hook(block_number: NumberFor&lt;Block&gt;) {
		let weight = &lt;frame_system::Pallet&lt;System&gt;&gt;::block_weight();
		let max_weight = &lt;System::BlockWeights as frame_support::traits::Get&lt;_&gt;&gt;::get().max_block;
		let remaining_weight = max_weight.saturating_sub(weight.total());

		if remaining_weight &gt; 0 {
			let used_weight = &lt;AllPalletsWithSystem as OnIdle&lt;System::BlockNumber&gt;&gt;::on_idle(
				block_number,
				remaining_weight,
			);
			&lt;frame_system::Pallet&lt;System&gt;&gt;::register_extra_weight_unchecked(
				used_weight,
				DispatchClass::Mandatory,
			);
		}

		&lt;AllPalletsWithSystem as OnFinalize&lt;System::BlockNumber&gt;&gt;::on_finalize(block_number);
	}

	/// Apply extrinsic outside of the block execution function.
	///
	/// This doesn't attempt to validate anything regarding the block, but it builds a list of uxt
	/// hashes.
	pub fn apply_extrinsic(uxt: Block::Extrinsic) -&gt; ApplyExtrinsicResult {
		sp_io::init_tracing();
		let encoded = uxt.encode();
		let encoded_len = encoded.len();
		sp_tracing::enter_span!(sp_tracing::info_span!(&quot;apply_extrinsic&quot;,
				ext=?sp_core::hexdisplay::HexDisplay::from(&amp;encoded)));
		// Verify that the signature is good.
		let xt = uxt.check(&amp;Default::default())?;

		// We don't need to make sure to `note_extrinsic` only after we know it's going to be
		// executed to prevent it from leaking in storage since at this point, it will either
		// execute or panic (and revert storage changes).
		&lt;frame_system::Pallet&lt;System&gt;&gt;::note_extrinsic(encoded);

		// AUDIT: Under no circumstances may this function panic from here onwards.

		// Decode parameters and dispatch
		let dispatch_info = xt.get_dispatch_info();
		let r = Applyable::apply::&lt;UnsignedValidator&gt;(xt, &amp;dispatch_info, encoded_len)?;

		&lt;frame_system::Pallet&lt;System&gt;&gt;::note_applied_extrinsic(&amp;r, dispatch_info);

		Ok(r.map(|_| ()).map_err(|e| e.error))
	}

	fn final_checks(header: &amp;System::Header) {
		sp_tracing::enter_span!(sp_tracing::Level::TRACE, &quot;final_checks&quot;);
		// remove temporaries
		let new_header = &lt;frame_system::Pallet&lt;System&gt;&gt;::finalize();

		// check digest
		assert_eq!(
			header.digest().logs().len(),
			new_header.digest().logs().len(),
			&quot;Number of digest items must match that calculated.&quot;
		);
		let items_zip = header.digest().logs().iter().zip(new_header.digest().logs().iter());
		for (header_item, computed_item) in items_zip {
			header_item.check_equal(computed_item);
			assert!(header_item == computed_item, &quot;Digest item must match that calculated.&quot;);
		}

		// check storage root.
		let storage_root = new_header.state_root();
		header.state_root().check_equal(storage_root);
		assert!(header.state_root() == storage_root, &quot;Storage root must match that calculated.&quot;);

		assert!(
			header.extrinsics_root() == new_header.extrinsics_root(),
			&quot;Transaction trie root must be valid.&quot;,
		);
	}

	/// Check a given signed transaction for validity. This doesn't execute any
	/// side-effects; it merely checks whether the transaction would panic if it were included or
	/// not.
	///
	/// Changes made to storage should be discarded.
	pub fn validate_transaction(
		source: TransactionSource,
		uxt: Block::Extrinsic,
		block_hash: Block::Hash,
	) -&gt; TransactionValidity {
		sp_io::init_tracing();
		use sp_tracing::{enter_span, within_span};

		&lt;frame_system::Pallet&lt;System&gt;&gt;::initialize(
			&amp;(frame_system::Pallet::&lt;System&gt;::block_number() + One::one()),
			&amp;block_hash,
			&amp;Default::default(),
		);

		enter_span! { sp_tracing::Level::TRACE, &quot;validate_transaction&quot; };

		let encoded_len = within_span! { sp_tracing::Level::TRACE, &quot;using_encoded&quot;;
			uxt.using_encoded(|d| d.len())
		};

		let xt = within_span! { sp_tracing::Level::TRACE, &quot;check&quot;;
			uxt.check(&amp;Default::default())
		}?;

		let dispatch_info = within_span! { sp_tracing::Level::TRACE, &quot;dispatch_info&quot;;
			xt.get_dispatch_info()
		};

		within_span! {
			sp_tracing::Level::TRACE, &quot;validate&quot;;
			xt.validate::&lt;UnsignedValidator&gt;(source, &amp;dispatch_info, encoded_len)
		}
	}

	/// Start an offchain worker and generate extrinsics.
	pub fn offchain_worker(header: &amp;System::Header) {
		sp_io::init_tracing();
		// We need to keep events available for offchain workers,
		// hence we initialize the block manually.
		// OffchainWorker RuntimeApi should skip initialization.
		let digests = header.digest().clone();

		&lt;frame_system::Pallet&lt;System&gt;&gt;::initialize(header.number(), header.parent_hash(), &amp;digests);

		// Frame system only inserts the parent hash into the block hashes as normally we don't know
		// the hash for the header before. However, here we are aware of the hash and we can add it
		// as well.
		frame_system::BlockHash::&lt;System&gt;::insert(header.number(), header.hash());

		&lt;AllPalletsWithSystem as OffchainWorker&lt;System::BlockNumber&gt;&gt;::offchain_worker(
			*header.number(),
		)
	}
}
</code></pre></pre>
<h3 id="impl-for-xxx-ç»“æ„ä½“æšä¸¾ä½“traitå®ç°æ¥å£å®šä¹‰çš„æ–¹æ³•"><a class="header" href="#impl-for-xxx-ç»“æ„ä½“æšä¸¾ä½“traitå®ç°æ¥å£å®šä¹‰çš„æ–¹æ³•">impl&lt;&gt; for xxx ç»“æ„ä½“/æšä¸¾ä½“+traitï¼šå®ç°æ¥å£å®šä¹‰çš„æ–¹æ³•</a></h3>
<blockquote>
<p>impl &lt;trait_name&gt; for &lt;struct/enum name&gt;</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait Summary {
    fn summarize(&amp;self) -&gt; String;
}

pub struct NewsArticle {
    pub headline: String,
    pub location: String,
    pub author: String,
    pub content: String,
}

impl Summary for NewsArticle {
    fn summarize(&amp;self) -&gt; String {
        format!(&quot;{}, by {} ({})&quot;, self.headline, self.author, self.location)
    }
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="ç¤ºä¾‹ä¸€å®ç°traitä¸­å®šä¹‰çš„æ–¹æ³•"><a class="header" href="#ç¤ºä¾‹ä¸€å®ç°traitä¸­å®šä¹‰çš„æ–¹æ³•">ç¤ºä¾‹ä¸€ï¼šå®ç°traitä¸­å®šä¹‰çš„æ–¹æ³•</a></h4>
<ul>
<li>
<p><a href="https://www.jianshu.com/p/0d60c148c0c0">Rustä¹‹PhantomData - ç®€ä¹¦</a></p>
</li>
<li>
<p><a href="https://users.rust-lang.org/t/type-alias-vs-use/7486"><code>type</code> alias vs <code>use</code> - help - The Rust Programming Language Forum</a></p>
</li>
<li>
<p>ç±»å‹è½¬æ¢ï¼š</p>
<ul>
<li><a href="marginnote3app://note/EA8CFC57-E675-493B-ACBA-BE60163B32EC">asç±»å‹è½¬æ¢</a></li>
<li><a href="marginnote3app://note/C1F89C89-164E-4A63-9214-0E2E335DFD00">Fromä¸Into</a></li>
<li><a href="marginnote3app://note/D27CC849-C8B6-477F-A76C-DFF423784062">æ•´ç†ç±»å‹è½¬æ¢</a></li>
</ul>
</li>
<li>
<p>whereä¸implè¯­æ³•çš„å¯¹æ¯”ï¼š</p>
<ul>
<li><a href="marginnote3app://note/8974BCC4-5036-4051-913A-287D6C6A56A5">whereå¯ä»¥ç”¨äºæ›´å¤æ‚çš„æƒ…å†µ, å¦‚å…³è”ç±»å‹</a></li>
<li><a href="marginnote3app://note/E1B86A91-9D49-4CC5-9344-CAEB316EAC41">æ³›å‹å…³è”ç±»å‹(Generic Associated Types)åªèƒ½ä½¿ç”¨whereå­å¥</a></li>
<li><a href="https://rust-lang.github.io/rfcs/0135-where.html">0135-where - The Rust RFC Book</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>substrate/frame/executive/src/lib.rs</p>
</blockquote>
<ol>
<li>ä¸‹åˆ—traité™å®šçš„æ„æ€ï¼š
<ol>
<li>ä¸ºExecutiveç»“æ„ä½“å®ç°ExecuteBlockè¿™ä¸ªtraitçš„æ–¹æ³•</li>
<li>for Executive&lt;â€¦&gt;ï¼šExecutiveæœ¬èº«æ˜¯ä¸ªç»“æ„ä½“ï¼Œç”¨åˆ°äº†è¿™äº›ç±»å‹</li>
<li>impl&lt;â€¦&gt;ï¼šè¿™äº›ç±»å‹åˆ†åˆ«æœ‰å“ªäº›traité™å®šï¼Œè¦ç”¨åˆ°å…³è”ç±»å‹é™å®šçš„ï¼Œå°±æ”¾åœ¨whereå­å¥ä¸­</li>
<li>whereå­å¥ï¼šä¸»è¦å…ˆçº¦æŸå¥½å…³è”ç±»å‹Block::Extrinsicï¼Œç»™åé¢çš„ä½¿ç”¨</li>
<li>æ€»ç»“implä¸whereå­å¥ï¼šè¿™é‡Œå°†ç®€å•æƒ…å†µæ”¾åœ¨implä¸­ï¼Œå°†å¤æ‚çš„å…³è”ç±»å‹é™å®šæ”¾åœ¨whereå­å¥ä¸­ã€‚</li>
</ol>
</li>
<li>å…³äºCheckedOfã€CallOfã€OriginOfè¿™ä¸‰ä¸ªï¼š
<ol>
<li>implä¸­çš„UnsignedValidatorç”¨åˆ°CallOfï¼Œ CallOfç”¨åˆ°CheckedOf</li>
<li>(é—®é¢˜)OriginOfçš„ç”¨é€”</li>
</ol>
</li>
</ol>
<pre><pre class="playground"><code class="language-rust  editable">impl&lt;
		System: frame_system::Config + EnsureInherentsAreFirst&lt;Block&gt;,
		Block: traits::Block&lt;Header = System::Header, Hash = System::Hash&gt;,
		Context: Default,
		UnsignedValidator,
		AllPalletsWithSystem: OnRuntimeUpgrade
			+ OnInitialize&lt;System::BlockNumber&gt;
			+ OnIdle&lt;System::BlockNumber&gt;
			+ OnFinalize&lt;System::BlockNumber&gt;
			+ OffchainWorker&lt;System::BlockNumber&gt;,
		COnRuntimeUpgrade: OnRuntimeUpgrade,
	&gt; ExecuteBlock&lt;Block&gt;
	for Executive&lt;System, Block, Context, UnsignedValidator, AllPalletsWithSystem, COnRuntimeUpgrade&gt;
where
	Block::Extrinsic: Checkable&lt;Context&gt; + Codec,
	CheckedOf&lt;Block::Extrinsic, Context&gt;: Applyable + GetDispatchInfo,
	CallOf&lt;Block::Extrinsic, Context&gt;:
		Dispatchable&lt;Info = DispatchInfo, PostInfo = PostDispatchInfo&gt;,
	OriginOf&lt;Block::Extrinsic, Context&gt;: From&lt;Option&lt;System::AccountId&gt;&gt;,
	UnsignedValidator: ValidateUnsigned&lt;Call = CallOf&lt;Block::Extrinsic, Context&gt;&gt;,
{
	fn execute_block(block: Block) {
		Executive::&lt;
			System,
			Block,
			Context,
			UnsignedValidator,
			AllPalletsWithSystem,
			COnRuntimeUpgrade,
		&gt;::execute_block(block);
	}
}
</code></pre></pre>
<h2 id="rusté¢å‘å¯¹è±¡"><a class="header" href="#rusté¢å‘å¯¹è±¡">Rusté¢å‘å¯¹è±¡</a></h2>
<blockquote>
<p>Struct/Enum+Traitã€Reusableã€Encapsulationã€Inheritance</p>
</blockquote>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch17-01-what-is-oo.html">Characteristics of Object-Oriented Languages - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch17-03-oo-design-patterns.html">Implementing an Object-Oriented Design Pattern - The Rust Programming Language</a></li>
</ul>
<blockquote>
<p>Object-oriented programs are made up of objects. An object packages both data and the procedures that operate on that
data. The procedures are typically called methods or operations.</p>
</blockquote>
<p>Using this definition, Rust is object-oriented: structs and enums have data, and impl blocks provide methods on structs
and enums. Even though structs and enums with methods arenâ€™t called objects, they provide the same functionality,
according to the Gang of Fourâ€™s definition of objects.</p>
<h3 id="æ³¨æ„å¯ä»¥ä½¿ç”¨å›¾è¡¨å¯¹æ¯”pythonå’Œrustçš„å¯¹åº”é¢å‘å¯¹è±¡ç‰¹æ€§å®ç°æ–¹å¼"><a class="header" href="#æ³¨æ„å¯ä»¥ä½¿ç”¨å›¾è¡¨å¯¹æ¯”pythonå’Œrustçš„å¯¹åº”é¢å‘å¯¹è±¡ç‰¹æ€§å®ç°æ–¹å¼">æ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨å›¾è¡¨ï¼Œå¯¹æ¯”pythonå’Œrustçš„å¯¹åº”é¢å‘å¯¹è±¡ç‰¹æ€§å®ç°æ–¹å¼</a></h3>
<h4 id="å±æ€§æ–¹æ³•"><a class="header" href="#å±æ€§æ–¹æ³•">å±æ€§æ–¹æ³•</a></h4>
<h4 id="é™æ€æ–¹æ³•"><a class="header" href="#é™æ€æ–¹æ³•">é™æ€æ–¹æ³•</a></h4>
<h4 id="å®ä¾‹æ–¹æ³•"><a class="header" href="#å®ä¾‹æ–¹æ³•">å®ä¾‹æ–¹æ³•</a></h4>
<h4 id="ç±»æ–¹æ³•"><a class="header" href="#ç±»æ–¹æ³•">ç±»æ–¹æ³•</a></h4>
<h3 id="encapsulation"><a class="header" href="#encapsulation">Encapsulation</a></h3>
<p>pub(crate/super) keywords</p>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch07-02-defining-modules-to-control-scope-and-privacy.html#modules-cheat-sheet">Modules Cheat Sheet</a></li>
</ul>
<h4 id="start-from-the-crate-root"><a class="header" href="#start-from-the-crate-root">Start from the crate root</a></h4>
<h4 id="declaring-modules"><a class="header" href="#declaring-modules">Declaring modules</a></h4>
<h4 id="declaring-submodules"><a class="header" href="#declaring-submodules">Declaring submodules</a></h4>
<p>mod keyword</p>
<h4 id="paths-to-code-in-modules"><a class="header" href="#paths-to-code-in-modules">Paths to code in modules</a></h4>
<h4 id="private-vs-public"><a class="header" href="#private-vs-public">Private vs public</a></h4>
<h4 id="the-use-keyword"><a class="header" href="#the-use-keyword">The use keyword</a></h4>
<h3 id="inheritance"><a class="header" href="#inheritance">Inheritance</a></h3>
<blockquote>
<p>If a language must have inheritance to be an object-oriented language, then Rust is not one. There is no way to define
a struct that inherits the parent structâ€™s fields and method implementations without using a macro.</p>
</blockquote>
<p>You would choose inheritance for two main reasons.</p>
<h4 id="reuse"><a class="header" href="#reuse">Reuse</a></h4>
<p>One is for reuse of code: you can implement particular behavior for one type, and inheritance enables you to reuse that
implementation for a different type. You can do this in a limited way in Rust code using default trait method
implementations</p>
<h4 id="polymorphism"><a class="header" href="#polymorphism">Polymorphism</a></h4>
<p>The other reason to use inheritance relates to the type system: to enable a child type to be used in the same places as
the parent type. This is also called polymorphism (å¤šæ€æ€§) , which means that you can substitute multiple objects for each
other at runtime if they share certain characteristics.</p>
<blockquote>
<p>Polymorphism: code that can work with data of multiple types</p>
</blockquote>
<p>Rust instead uses generics to abstract over different possible types and trait bounds to impose constraints on what
those types must provide. This is sometimes called <strong>bounded parametric polymorphism</strong> .</p>
<h2 id="å…­å›é¡¾traitè”ç³»ä¸Šç”Ÿå‘½å‘¨æœŸ"><a class="header" href="#å…­å›é¡¾traitè”ç³»ä¸Šç”Ÿå‘½å‘¨æœŸ">å…­ã€å›é¡¾traitï¼Œè”ç³»ä¸Šç”Ÿå‘½å‘¨æœŸ</a></h2>
<ul>
<li><a href="marginnote3app://note/133A41C4-ADA0-4101-B280-BCD4D3DB8014">rustæƒå¨æŒ‡å—-traitå®šä¹‰å…±äº«è¡Œä¸º</a></li>
</ul>
<p>å€ŸåŠ©äºtraitå’Œtraitçº¦æŸ,æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨æ³›å‹å‚æ•°æ¥æ¶ˆé™¤é‡å¤ä»£ç çš„åŒæ—¶,å‘ç¼–è¯‘å™¨æŒ‡æ˜è‡ªå·±å¸Œæœ›æ³›å‹æ‹¥æœ‰çš„åŠŸèƒ½ã€‚è€Œç¼–è¯‘å™¨åˆ™å¯ä»¥åˆ©ç”¨è¿™äº›traitçº¦æŸä¿¡æ¯æ¥ç¡®ä¿ä»£ç ä¸­ä½¿ç”¨çš„å…·ä½“ç±»å‹æä¾›äº†æ­£ç¡®çš„è¡Œä¸ºã€‚åœ¨åŠ¨æ€è¯­è¨€ä¸­,å°è¯•è°ƒç”¨ä¸€ä¸ªç±»å‹æ²¡æœ‰å®ç°çš„æ–¹æ³•ä¼šå¯¼è‡´åœ¨è¿è¡Œæ—¶å‡ºç°é”™è¯¯ã€‚ä½†æ˜¯,Rustå°†è¿™äº›é”™è¯¯å‡ºç°çš„æ—¶æœŸè½¬ç§»åˆ°äº†ç¼–è¯‘æœŸ,å¹¶è¿«ä½¿æˆ‘ä»¬åœ¨è¿è¡Œä»£ç ä¹‹å‰ä¿®å¤é—®é¢˜ã€‚æˆ‘ä»¬æ— é¡»ç¼–å†™é‚£äº›ç”¨äºåœ¨è¿è¡Œæ—¶æ£€æŸ¥è¡Œä¸ºçš„ä»£ç ,å› ä¸ºè¿™äº›å·¥ä½œå·²ç»åœ¨ç¼–è¯‘æœŸå®Œæˆäº†ã€‚è¿™ä¸€æœºåˆ¶åœ¨ä¿ç•™æ³›å‹çµæ´»æ€§çš„åŒæ—¶æå‡äº†ä»£ç çš„æ€§èƒ½ã€‚</p>
<p>ç”Ÿå‘½å‘¨æœŸæ˜¯å¦å¤–ä¸€ç§ä½ å·²ç»æ¥è§¦è¿‡çš„æ³›å‹ã€‚æ™®é€šæ³›å‹å¯ä»¥ç¡®ä¿ç±»å‹æ‹¥æœ‰æœŸæœ›çš„è¡Œä¸º,ä¸ä¹‹ä¸åŒçš„æ˜¯,ç”Ÿå‘½å‘¨æœŸèƒ½å¤Ÿç¡®ä¿å¼•ç”¨åœ¨æˆ‘ä»¬çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸€ç›´æœ‰æ•ˆ</p>

            </main>

            <!--            <script src="https://utteranc.es/client.js"-->
            <!--                    repo="RustMagazine/rust_magazine_2022"-->
            <!--                    issue-term="title"-->
            <!--                    theme="github-light"-->
            <!--                    crossorigin="anonymous"-->
            <!--                    async></script>-->

            <nav class="nav-wrapper" aria-label="Page navigation">
                <!-- Mobile navigation buttons -->
                    <a rel="prev" href="../../../layer5_source_code_anatomy/substrate_anatomy/substrate_modules.html" class="mobile-nav-chapters previous"
                       title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../../layer6_ecosystem/layer6_ecosystem.html" class="mobile-nav-chapters next"
                       title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>

                <div style="clear: both"></div>
            </nav>
        </div>
    </div>

    <nav class="nav-wide-wrapper" aria-label="Page navigation">
            <a rel="prev" href="../../../layer5_source_code_anatomy/substrate_anatomy/substrate_modules.html" class="nav-chapters previous" title="Previous chapter"
               aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>

            <a rel="next" href="../../../layer6_ecosystem/layer6_ecosystem.html" class="nav-chapters next" title="Next chapter"
               aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
    </nav>

</div>




    <script type="text/javascript">
        window.playground_copyable = true;
    </script>

    <script src="../../../ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../mode-rust.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>

<script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JS scripts -->
    <script type="text/javascript" src="../../../assets/mermaid/mermaid.min.js"></script>
    <script type="text/javascript" src="../../../assets/mermaid/mermaid-init.js"></script>
    <script type="text/javascript" src="../../../assets/smart-anchor.js"></script>
    <script type="text/javascript" src="../../../assets/pagetoc/sidebar.js"></script>

</body>
</html>
