# æ³›å‹ã€ç‰¹å¾åŠç‰¹å¾å¯¹è±¡

![rust-traits-deep-dive](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/rust-traits-deep-dive.png)
<!--ts-->
* [æ³›å‹ã€ç‰¹å¾åŠç‰¹å¾å¯¹è±¡](#æ³›å‹ç‰¹å¾åŠç‰¹å¾å¯¹è±¡)
   * [æ³›å‹](#æ³›å‹)
      * [ä»ä»£ç å¤ç”¨å‡ºå‘](#ä»ä»£ç å¤ç”¨å‡ºå‘)
         * [å‡½æ•°ä½œç”¨ä¸è¶³](#å‡½æ•°ä½œç”¨ä¸è¶³)
         * [é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç ](#é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç )
      * [æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–](#æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–)
      * [æ³›å‹ä½¿ç”¨æ–¹å¼](#æ³›å‹ä½¿ç”¨æ–¹å¼)
         * [æ³›å‹å‡½æ•°](#æ³›å‹å‡½æ•°)
         * [æ³›å‹ç»“æ„ä½“](#æ³›å‹ç»“æ„ä½“)
         * [æ³›å‹æšä¸¾ä½“](#æ³›å‹æšä¸¾ä½“)
         * [æ³›å‹ç‰¹å¾](#æ³›å‹ç‰¹å¾)
         * [æ³›å‹æ–¹æ³•](#æ³›å‹æ–¹æ³•)
      * [impl: æ³›å‹å®ç°å—](#impl-æ³›å‹å®ç°å—)
         * [æ³›å‹å®ç°](#æ³›å‹å®ç°)
         * [ä¸“é—¨åŒ–æ³›å‹](#ä¸“é—¨åŒ–æ³›å‹)
      * [æŒ‡å®šç±»å‹è¿›è¡Œå®ä¾‹åŒ–](#æŒ‡å®šç±»å‹è¿›è¡Œå®ä¾‹åŒ–)
         * [åŸºäºç±»å‹å®ä¾‹åŒ–æ¨æ–­](#åŸºäºç±»å‹å®ä¾‹åŒ–æ¨æ–­)
         * [æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•](#æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•)
         * [turbofish: ::&lt;&gt;](#turbofish-)
   * [ç‰¹å¾](#ç‰¹å¾)
      * [ä»å¤šæ€å’Œä»£ç å¤ç”¨çš„è§’åº¦æ¥çœ‹: æ¥å£ã€é¸­å­ç±»å‹è¿˜æ˜¯ç‰¹å¾ï¼Ÿ](#ä»å¤šæ€å’Œä»£ç å¤ç”¨çš„è§’åº¦æ¥çœ‹-æ¥å£é¸­å­ç±»å‹è¿˜æ˜¯ç‰¹å¾)
         * [æ¥å£](#æ¥å£)
         * [é¸­å­ç±»å‹](#é¸­å­ç±»å‹)
         * [ç‰¹å¾](#ç‰¹å¾-1)
      * [ç‰¹å¾åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ](#ç‰¹å¾åˆ°åº•æ˜¯ä»€ä¹ˆ)
      * [ç‰¹å¾çš„å¤šç§è¡¨ç°å½¢å¼](#ç‰¹å¾çš„å¤šç§è¡¨ç°å½¢å¼)
         * [æ ‡è®°(ç‰¹å¾)](#æ ‡è®°ç‰¹å¾)
         * [ç®€å•(ç‰¹å¾)](#ç®€å•ç‰¹å¾)
         * [æ³›å‹(ç‰¹å¾)](#æ³›å‹ç‰¹å¾-1)
         * [å…³è”ç±»å‹(ç‰¹å¾)](#å…³è”ç±»å‹ç‰¹å¾)
         * [ç»§æ‰¿(ç‰¹å¾)](#ç»§æ‰¿ç‰¹å¾)
      * [ä¸€äº›å¸¸ç”¨å†…ç½®ç‰¹å¾](#ä¸€äº›å¸¸ç”¨å†…ç½®ç‰¹å¾)
         * [è‡ªåŠ¨ç‰¹å¾(Auto Traits)](#è‡ªåŠ¨ç‰¹å¾auto-traits)
            * [Send &amp; Sync](#send--sync)
            * [Unpinã€ UnwindSafe &amp; RefUnwindSafe](#unpin-unwindsafe--refunwindsafe)
         * [Debug](#debug)
         * [PartialEq å’Œ Eq](#partialeq-å’Œ-eq)
         * [Copyå’ŒClone](#copyå’Œclone)
         * [Display](#display)
         * [Add](#add)
         * [Into å’Œ From](#into-å’Œ-from)
         * [Drop](#drop)
         * [Deref &amp; DerefMut](#deref--derefmut)
         * [Sized<a href="https://doc.rust-lang.org/stable/reference/special-types-and-traits.html" rel="nofollow">Special types and traits - The Rust Reference</a>](#sizedspecial-types-and-traits---the-rust-reference)
      * [ä¸€ä¸ªå®Œæ•´ä¾‹å­](#ä¸€ä¸ªå®Œæ•´ä¾‹å­)
   * [ç‰¹å¾åŒºé—´ï¼šæ³›å‹+ç‰¹å¾](#ç‰¹å¾åŒºé—´æ³›å‹ç‰¹å¾)
      * [å¼•å‡ºç‰¹å¾åŒºé—´](#å¼•å‡ºç‰¹å¾åŒºé—´)
      * [ä»£ç å•ä½“åŒ–](#ä»£ç å•ä½“åŒ–)
      * [æŒ‡å®šç‰¹å¾åŒºé—´çš„å››ä¸ªæ–¹æ³•](#æŒ‡å®šç‰¹å¾åŒºé—´çš„å››ä¸ªæ–¹æ³•)
         * [åŒºé—´å†…æ³›å‹: fn fn_name&lt;T: target_trait&gt;(val: T)](#åŒºé—´å†…æ³›å‹-fn-fn_namet-target_traitval-t)
         * [whereè¯­å¥: å½“ç¬¬ä¸€ç§æ–¹æ³•ç­¾åè¿‡é•¿æ—¶ä½¿ç”¨](#whereè¯­å¥-å½“ç¬¬ä¸€ç§æ–¹æ³•ç­¾åè¿‡é•¿æ—¶ä½¿ç”¨)
         * [ä½¿ç”¨"+"ç»„åˆå¤šä¸ªç‰¹å¾](#ä½¿ç”¨ç»„åˆå¤šä¸ªç‰¹å¾)
         * [ä½¿ç”¨implç‰¹å¾è¯­æ³•: é—­åŒ…å¸¸ç”¨](#ä½¿ç”¨implç‰¹å¾è¯­æ³•-é—­åŒ…å¸¸ç”¨)
      * [ç‰¹å¾åŒºé—´çš„ä½¿ç”¨åœºæ™¯](#ç‰¹å¾åŒºé—´çš„ä½¿ç”¨åœºæ™¯)
         * [åœ¨ç±»å‹ä¸Šä½¿ç”¨ï¼šä¸å»ºè®®](#åœ¨ç±»å‹ä¸Šä½¿ç”¨ä¸å»ºè®®)
         * [æ³›å‹å‡½æ•°+implä»£ç å—](#æ³›å‹å‡½æ•°implä»£ç å—)
   * [ç‰¹å¾å¯¹è±¡: å¤šæ€ç‰¹å¾ç±»å‹](#ç‰¹å¾å¯¹è±¡-å¤šæ€ç‰¹å¾ç±»å‹)
      * [åˆ†å‘(dispatch)](#åˆ†å‘dispatch)
         * [åˆ†å‘æ–¹å¼ï¼šé™æ€ or åŠ¨æ€](#åˆ†å‘æ–¹å¼é™æ€-or-åŠ¨æ€)
      * [åŒºåˆ«ç‰¹å¾åŒºé—´ä¸ç‰¹å¾å¯¹è±¡](#åŒºåˆ«ç‰¹å¾åŒºé—´ä¸ç‰¹å¾å¯¹è±¡)
      * [ç‰¹å¾å¯¹è±¡å…·ä½“è¯´è¯´](#ç‰¹å¾å¯¹è±¡å…·ä½“è¯´è¯´)
         * [æŒ‡å®šä¸ºå®ç°æŸä¸ªç‰¹å¾](#æŒ‡å®šä¸ºå®ç°æŸä¸ªç‰¹å¾)
         * [ç”¨èƒ–æŒ‡é’ˆå®ç°](#ç”¨èƒ–æŒ‡é’ˆå®ç°)
         * [æ˜¯Rustæ‰§è¡ŒåŠ¨æ€åˆ†å‘çš„æ–¹å¼](#æ˜¯rustæ‰§è¡ŒåŠ¨æ€åˆ†å‘çš„æ–¹å¼)
         * [ä¸å®šé•¿ç±»å‹åªèƒ½ä½œä¸ºå¼•ç”¨åˆ›å»º](#ä¸å®šé•¿ç±»å‹åªèƒ½ä½œä¸ºå¼•ç”¨åˆ›å»º)
   * [æ€»ç»“ç‰¹å¾ã€ç‰¹å¾åŒºé—´å’Œç‰¹å¾å¯¹è±¡](#æ€»ç»“ç‰¹å¾ç‰¹å¾åŒºé—´å’Œç‰¹å¾å¯¹è±¡)
   * [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)
      * [online-book](#online-book)
      * [fragment](#fragment)
      * [local](#local)

<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Sat Jul 23 13:01:12 UTC 2022 -->

<!--te-->

## æ³›å‹

### ä»ä»£ç å¤ç”¨å‡ºå‘

#### å‡½æ•°ä½œç”¨ä¸è¶³

ä¸€ç›´ä»¥æ¥ï¼Œå‡½æ•°çš„å®ç°æ–¹å¼å°±æ˜¯åŸºäºcè¯­è¨€çš„gotoæŒ‡ä»¤ï¼š

![image-20220613150721312](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150721312.png)

é€šè¿‡è¿›ä¸€æ­¥å¼ºåŒ–ï¼Œå°±å¾—åˆ°å‡½æ•°çš„å®ç°æ–¹å¼ï¼š

![image-20220613150804039](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150804039.png)

> ä½†æ˜¯ä¹Ÿå°±è¿™æ ·äº†ï¼Œå‡½æ•°åªèƒ½å®ç°æµç¨‹ä¸Šçš„å¤ç”¨ï¼Œä¸èƒ½å®ç°ç±»å‹ä¸Šçš„å¤ç”¨ã€‚è¿™ä¸€ç‚¹å…¶å®åœ¨pythonã€jsè¿™äº›åŠ¨æ€ç±»å‹è¯­è¨€ä¸Šé¢å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºRustè¿™ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå¯¹å‡½æ•°å…¥å‚ç±»å‹è¦æ±‚ååˆ†ä¸¥æ ¼ï¼Œäºæ˜¯æ³›å‹å°±åº”è¿è€Œç”Ÿã€‚

#### é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç 

> æ³›å‹ç¼–ç¨‹æ˜¯ä¸€ç§ä»…é€‚ç”¨äºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€çš„æŠ€æœ¯ã€‚å®ƒé¦–æ¬¡å‡ºç°åœ¨ ML è¯­è¨€ä¸­,æ˜¯ä¸€ç§é™æ€ç±»å‹çš„å‡½æ•°å¼è¯­è¨€ã€‚

åƒ Python è¿™æ ·çš„åŠ¨æ€è¯­è¨€é‡‡ç”¨çš„æ˜¯ç®€å•ç±»å‹ (duck typing) , å…¶ä¸­çš„ API æ˜¯æ ¹æ®å®ƒä»¬å¯ä»¥åšä»€ä¹ˆ,è€Œä¸æ˜¯å®ƒä»¬æ˜¯ä»€ä¹ˆæ¥å¤„ç†å‚æ•°çš„,å› æ­¤ä¸ä¾èµ–äºæ³›å‹ã€‚

æ³›å‹æ˜¯è¯­è¨€è®¾è®¡ç‰¹æ€§çš„ä¸€éƒ¨åˆ†, å¯ä»¥å®ç°ä»£ç å¤ç”¨, å¹¶éµå¾ªä¸é‡å¤è‡ªå·±çš„åŸåˆ™ (Don't Repeat Yourself,DRY) ã€‚é‡‡ç”¨è¿™ç§æŠ€æœ¯,ä½ å¯ä»¥ä½¿ç”¨ç±»å‹å ä½ç¬¦æ¥ç¼–å†™ç®—æ³•ã€å‡½æ•°ã€æ–¹æ³•åŠç±»å‹, å¹¶åœ¨è¿™äº›ç±»å‹ä¸ŠæŒ‡å®šä¸€ä¸ªç±»å‹å˜é‡(
ä½¿ç”¨å•ä¸ªå­—æ¯,é€šå¸¸æ˜¯ Tã€K æˆ– V) ,å‘ŠçŸ¥ç¼–è¯‘å™¨åœ¨ä»»ä½•ä»£ç ä¸­å®ä¾‹åŒ–å®ƒä»¬æ—¶è¦å¡«å……çš„å®é™…ç±»å‹ã€‚è¿™äº›ç±»å‹è¢«ç§°ä¸ºæ³›å‹æˆ–å…ƒç´ ã€‚å•ä¸ªå­—æ¯(ä¾‹å¦‚ç±»å‹ T)è¢«ç§°ä¸ºæ³›å‹å‚æ•°ã€‚å½“ä½ ä½¿ç”¨æˆ–å®ä¾‹åŒ–ä»»ä½•æ³›å‹å…ƒç´ æ—¶,å®ƒä»¬ä¼šè¢«æ›¿æ¢æˆè¯¸å¦‚ u32 è¿™æ ·çš„å…·ä½“ç±»å‹ã€‚

### æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–

æ¯æ¬¡å°†æ³›å‹å…ƒç´ ä¸å…·ä½“ç±»å‹ä¸€èµ·ä½¿ç”¨æ—¶,éƒ½ä¼šåœ¨ç¼–è¯‘æ—¶ç”¨ç±»å‹å˜é‡ T ç”Ÿæˆè¯¥ä»£ç çš„ç‰¹å®šå‰¯æœ¬,å¹¶å°†å…¶æ›¿æ¢ä¸ºå…·ä½“ç±»å‹ã€‚**è¿™ç§åœ¨ç¼–è¯‘æ—¶ç”ŸæˆåŒ…å«å…·ä½“ç±»å‹çš„ä¸“ç”¨å‡½æ•°çš„è¿‡ç¨‹è¢«ç§°ä¸ºå•æ€åŒ–,è¿™æ˜¯æ‰§è¡Œä¸å¤šæ€å‡½æ•°ç›¸åçš„è¿‡ç¨‹ã€‚**

### æ³›å‹ä½¿ç”¨æ–¹å¼

> åœ¨ä½¿ç”¨æ³›å‹æ—¶ï¼Œåº”è¯¥å¤šå»è€ƒè™‘å®ƒä¸ä¸åŒå…ƒç´ ç»“åˆä½¿ç”¨çš„åœºæ™¯èƒŒåçš„æ€ç»´æ–¹å¼ã€‚æ³›å‹å¯ä»¥ä¸ç»“æ„ä½“ã€æšä¸¾ã€å‡½æ•°ã€ç‰¹å¾ã€æ–¹æ³•åŠä»£ç å®ç°å—ã€‚å®ƒä»¬çš„ä¸€ä¸ªå…±åŒç‰¹å¾æ˜¯æ³›å‹çš„å‚æ•°æ˜¯ç”±ä¸€å¯¹å°–å¤´æ‹¬å·åˆ†éš”,å¹¶åŒ…å«äºå…¶ä¸­ã€‚

#### æ³›å‹å‡½æ•°

ä¸ºäº†åˆ›å»ºæ³›å‹å‡½æ•°,æˆ‘ä»¬éœ€è¦å°†æ³›å‹å‚æ•°æ”¾åœ¨å‡½æ•°åä¹‹åå’Œåœ†æ‹¬å·ä¹‹å‰,å¦‚ä¸‹æ‰€ç¤º:

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_function.rs:1:12}}
```

#### æ³›å‹ç»“æ„ä½“

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_struct.rs:1:21}}
```

#### æ³›å‹æšä¸¾ä½“

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_enum.rs:1:10}}
```

#### æ³›å‹ç‰¹å¾

#### æ³›å‹æ–¹æ³•

### impl: æ³›å‹å®ç°å—

#### æ³›å‹å®ç°

> å½“ä¸ºä»»ä½•æ³›å‹ç¼–å†™ impl ä»£ç å—æ—¶,éƒ½éœ€è¦åœ¨ä½¿ç”¨å®ƒä¹‹å‰å£°æ˜æ³›å‹å‚æ•°ã€‚T å°±åƒä¸€ä¸ªå˜é‡â€”â€” ä¸€ä¸ªç±»å‹å˜é‡,æˆ‘ä»¬éœ€è¦å…ˆå£°æ˜å®ƒ implä»£ç å—å®é™…ä¸Šæ„å‘³ç€æˆ‘ä»¬æ­£åœ¨ä¸ºæ‰€æœ‰ç±»å‹ T å®ç°è¿™äº›æ–¹æ³•,å®ƒä»¬ä¼šå‡ºç°åœ¨ Container<T>ä¸­ã€‚è¿™ä¸ª impl ä»£ç å—æ˜¯ä¸€ä¸ªæ³›å‹å®ç°ã€‚ å› æ­¤,ç”Ÿæˆçš„æ¯ä¸ªå…·ä½“ Container éƒ½å°†æœ‰è¿™äº›æ–¹æ³•ã€‚

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_struct_impl.rs:1:15}}
```

#### ä¸“é—¨åŒ–æ³›å‹

> åœ¨è¿™é‡Œ, ç”±äº u32 æ˜¯ä½œä¸ºå…·ä½“ç±»å‹å­˜åœ¨çš„, å› æ­¤æˆ‘ä»¬ä¸éœ€è¦ impl ä¹‹åçš„<T>, è¿™æ˜¯ impl ä»£ç å—çš„å¦å¤–ä¸€ä¸ªç‰¹æ€§,å®ƒå…è®¸ä½ é€šè¿‡ç‹¬ç«‹å®ç°æ–¹æ³•æ¥ä¸“é—¨åŒ–æ³›å‹ã€‚ ç°åœ¨,æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å°† T æ›¿æ¢ä¸ºä»»ä½•å…·ä½“ç±»å‹æ¥ä¸º Container<T>ç¼–å†™æ›´å…·ä½“çš„ impl ä»£ç å—ã€‚ä»¥ä¸‹å°±æ˜¯å®ƒçš„å®ä¾‹:

```rust, editable
impl Container<u32> { 
    fn sum(item: u32) -> Self {
        Container { item }
    } 
}
```

### æŒ‡å®šç±»å‹è¿›è¡Œå®ä¾‹åŒ–

> æ¯å½“æˆ‘ä»¬è¿›è¡Œå®ä¾‹åŒ–æ—¶, ç¼–è¯‘å™¨éœ€è¦åœ¨å…¶ç±»å‹ç­¾åä¸­çŸ¥é“ T çš„å…·ä½“ç±»å‹ä»¥ä¾¿æ›¿æ¢,è¿™ä¸ºå…¶æä¾›äº†å°†æ³›å‹ä»£ç å•æ€åŒ–çš„ç±»å‹ä¿¡æ¯ã€‚ è€Œå…·ä½“ç±»å‹çš„ç¡®å®šä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. å¤§å¤šæ•°æƒ…å†µä¸‹,å…·ä½“ç±»å‹æ˜¯åŸºäºç±»å‹çš„å®ä¾‹åŒ–æ¨æ–­.
2. å¯¹æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•æ¥æ¥æ”¶å…·ä½“ç±»å‹ã€‚
3. åœ¨æä¸ªåˆ«æƒ…å†µä¸‹, æˆ‘ä»¬éœ€è¦é€šè¿‡ä½¿ç”¨ `turbofish (::<>)`è¿ç®—ç¬¦è¾“å…¥å…·ä½“ç±»å‹æ¥æ›¿ä»£æ³›å‹ä»¥ä¾¿è¾…åŠ©ç¼–è¯‘å™¨è¯†åˆ«ã€‚

#### åŸºäºç±»å‹å®ä¾‹åŒ–æ¨æ–­

è¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œä¸»è¦åŸºäºç±»å‹ç‰¹å¾(trait)ã€‚

#### æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/using_generic_func.rs:1:}}
```

#### turbofish: ::<>

1. å¦‚æœæ²¡æœ‰ä»»ä½•ç±»å‹ç‰¹å¾ï¼Œä»£ç å°†æ— æ³•ç¼–è¯‘ï¼šğŸ‘‡

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/creating_generic_vec.rs:1:}}
```

2. è¿™æ—¶å¯ä»¥ç”¨ä¸‹åˆ—ä¸‰ç§æ–¹å¼æŒ‡å®š

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/using_generic_vec.rs:1:}}
```

## ç‰¹å¾

### ä»å¤šæ€å’Œä»£ç å¤ç”¨çš„è§’åº¦æ¥çœ‹: æ¥å£ã€é¸­å­ç±»å‹è¿˜æ˜¯ç‰¹å¾ï¼Ÿ

ä»å¤šæ€å’Œä»£ç å¤ç”¨çš„è§’åº¦æ¥çœ‹, åœ¨ä»£ç ä¸­å°†ç±»å‹çš„å…±äº«è¡Œä¸ºå’Œå…¬å…±å±æ€§ä¸å…¶è‡ªèº«éš”ç¦»é€šå¸¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„,å¹¶ä¸”èƒ½æ‹¥æœ‰ä¸“å±äºè‡ªå·±çš„æ–¹æ³•ã€‚åœ¨è¿™æ ·åšæ—¶,æˆ‘ä»¬å…è®¸ä¸åŒç±»å‹é€šè¿‡é€šç”¨å±æ€§äº’ç›¸å…³è”,ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸º API ç¼–ç¨‹,ä½¿å…¶å‚æ•°æ›´é€šç”¨æˆ–æ›´å…·åŒ…å®¹æ€§ã€‚
> è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ¥æ”¶å…·æœ‰è¿™äº›é€šç”¨å±æ€§çš„ç±»å‹,è€Œä¸ä»…é™äºæŸç§ç‰¹å®šç±»å‹ã€‚

#### æ¥å£

ç±»ä¼¼ Java å’Œ C#çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­,æ¥å£è¡¨è¾¾äº†ç›¸åŒçš„ç†å¿µ,æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­å®šä¹‰å¤šç§ç±»å‹èƒ½å¤Ÿå®ç°çš„å…±äº«è¡Œä¸ºã€‚ä¾‹å¦‚,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å•ä¸ª sort å‡½æ•°æ¥æ”¶å®ç° Comparable æˆ–è€… Comparator
æ¥å£çš„å…ƒç´ åˆ—è¡¨,è€Œä¸æ˜¯ä½¿ç”¨å¤šä¸ª sort å‡½æ•°æ¥æ”¶æ•´æ•°å€¼åˆ—è¡¨,ä»¥åŠç”¨å…¶ä»–å‡½æ•°æ¥æ”¶å­—ç¬¦ä¸²å€¼åˆ—è¡¨ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å¯æ¯”è¾ƒ(Comparable)çš„å†…å®¹ä¼ é€’ç»™ sort å‡½æ•°ã€‚

#### é¸­å­ç±»å‹

è€ŒPythonåŒæ ·æœ‰æ˜ç¡®çš„ç‰¹æ€§ï¼Œè¢«ç§°ä¸º"é¸­å­ç±»å‹".
> â€œå½“çœ‹åˆ°ä¸€åªé¸Ÿèµ°èµ·æ¥åƒé¸­å­ã€æ¸¸æ³³èµ·æ¥åƒé¸­å­ã€å«èµ·æ¥ä¹Ÿåƒé¸­å­ï¼Œé‚£ä¹ˆè¿™åªé¸Ÿå°±å¯ä»¥è¢«ç§°ä¸ºé¸­å­ã€‚â€

åœ¨é¸­å­ç±»å‹ä¸­ï¼Œå…³æ³¨ç‚¹åœ¨äºå¯¹è±¡çš„è¡Œä¸ºï¼Œèƒ½åšä»€ä¹ˆï¼›è€Œä¸æ˜¯å…³æ³¨å¯¹è±¡æ‰€å±çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸ä½¿ç”¨é¸­å­ç±»å‹çš„è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªç±»å‹ä¸ºâ€œé¸­å­â€çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„â€œèµ°â€å’Œâ€œå«â€æ–¹æ³•ã€‚åœ¨ä½¿ç”¨é¸­å­ç±»å‹çš„è¯­è¨€ä¸­ï¼Œè¿™æ ·çš„ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªä»»æ„ç±»å‹çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„â€œèµ°â€å’Œâ€œå«â€æ–¹æ³•ã€‚å¦‚æœè¿™äº›éœ€è¦è¢«è°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†å¼•å‘ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚ä»»ä½•æ‹¥æœ‰è¿™æ ·çš„æ­£ç¡®çš„â€œèµ°â€å’Œâ€œå«â€æ–¹æ³•çš„å¯¹è±¡éƒ½å¯è¢«å‡½æ•°æ¥å—çš„è¿™ç§è¡Œä¸ºå¼•å‡ºäº†ä»¥ä¸Šè¡¨è¿°ï¼Œè¿™ç§å†³å®šç±»å‹çš„æ–¹å¼å› æ­¤å¾—åã€‚

é¸­å­ç±»å‹é€šå¸¸å¾—ç›Šäºâ€œä¸â€æµ‹è¯•æ–¹æ³•å’Œå‡½æ•°ä¸­å‚æ•°çš„ç±»å‹ï¼Œè€Œæ˜¯ä¾èµ–æ–‡æ¡£ã€æ¸…æ™°çš„ä»£ç å’Œæµ‹è¯•æ¥ç¡®ä¿æ­£ç¡®ä½¿ç”¨ã€‚

åœ¨å¸¸è§„ç±»å‹ä¸­ï¼Œæˆ‘ä»¬èƒ½å¦åœ¨ä¸€ä¸ªç‰¹å®šåœºæ™¯ä¸­ä½¿ç”¨æŸä¸ªå¯¹è±¡å–å†³äºè¿™ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œè€Œåœ¨é¸­å­ç±»å‹ä¸­ï¼Œåˆ™å–å†³äºè¿™ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰æŸç§å±æ€§æˆ–è€…æ–¹æ³•â€”â€”å³åªè¦å…·å¤‡ç‰¹å®šçš„å±æ€§æˆ–æ–¹æ³•ï¼Œèƒ½é€šè¿‡é¸­å­æµ‹è¯•ï¼Œå°±å¯ä»¥ä½¿ç”¨ã€‚

#### ç‰¹å¾

Rustä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼ä¸”åŠŸèƒ½å¼ºå¤§çš„ç»“æ„,è¢«ç§°ä¸ºç‰¹å¾ã€‚Rustä¸­çš„ç‰¹å¾ä»¥å¤šç§å½¢å¼å­˜åœ¨, æˆ‘ä»¬å°†ä»‹ç»ä¸€äº›æœ€å¸¸è§çš„å½¢å¼å¹¶äº†è§£ä¸€äº›ä¸å®ƒä»¬ç®€å•äº¤äº’çš„æ–¹å¼ã€‚æ­¤å¤–,å½“ç‰¹å¾ä¸æ³›å‹æ­é…ä½¿ç”¨æ—¶,å¯ä»¥é™åˆ¶ä¼ é€’åˆ° API
çš„å‚æ•°èŒƒå›´ã€‚æˆ‘ä»¬å°†ä¼šå¯¹ç‰¹å¾è¿›è¡Œæ¯”è¾ƒæ·±å…¥çš„äº†è§£ã€‚

### ç‰¹å¾åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

### ç‰¹å¾çš„å¤šç§è¡¨ç°å½¢å¼

#### æ ‡è®°(ç‰¹å¾)

#### ç®€å•(ç‰¹å¾)

#### æ³›å‹(ç‰¹å¾)

#### å…³è”ç±»å‹(ç‰¹å¾)

#### ç»§æ‰¿(ç‰¹å¾)

### ä¸€äº›å¸¸ç”¨å†…ç½®ç‰¹å¾

#### è‡ªåŠ¨ç‰¹å¾(Auto Traits)

##### Send & Sync

##### Unpinã€ UnwindSafe & RefUnwindSafe

#### Debug

è¿™ä¸ªç‰¹å¾æœ‰åŠ©äºåœ¨æ§åˆ¶å°ä¸Šè¾“å‡ºç±»å‹ä»¥ä¾¿è¿›è¡Œè°ƒè¯•ã€‚åœ¨ç»„åˆç±»å‹çš„æƒ…å†µä¸‹,ç±»å‹å°†ä»¥ç±»ä¼¼ JSON çš„æ ¼å¼è¾“å‡º,å…¶ä¸­å¸¦æœ‰èŠ±æ‹¬å·å’Œå…¶ä»–æ‹¬å·,å¦‚æœç±»å‹æ˜¯å­—ç¬¦ä¸²,å°†ä¼šç”¨å¼•å·æ ‡è¯†ã€‚è¿™é€‚ç”¨äº Rust ä¸­çš„å¤§å¤šæ•°å†…ç½®ç±»å‹ã€‚

#### PartialEq å’Œ Eq

è¿™äº›ç‰¹å¾å…è®¸ä¸¤ä¸ªå…ƒç´ ç›¸äº’æ¯”è¾ƒä»¥éªŒè¯æ˜¯å¦ç›¸ç­‰

#### Copyå’ŒClone

è¿™äº›ç‰¹å¾å®šä¹‰äº†ç±»å‹çš„å¤åˆ¶æ–¹å¼ã€‚ ç®€è€Œè¨€ä¹‹,å½“åœ¨ä»»ä½•è‡ªå®šä¹‰ç±»å‹ä¸Šè‡ªåŠ¨æ´¾ç”Ÿæ—¶,è¿™äº›ç‰¹å¾å…è®¸ç”¨æˆ·ä»å®ä¾‹åˆ›å»ºæ–°çš„å‰¯æœ¬:

1. å¯ä»¥åœ¨å®ç° Copy æ—¶éšå¼åˆ›å»º
2. ä¹Ÿå¯ä»¥åœ¨å®ç° Clone æ—¶é€šè¿‡è°ƒç”¨ clone() æ˜¾å¼åˆ›å»ºã€‚

> è¯·æ³¨æ„,Copy ä¾èµ–äºåœ¨ç±»å‹ä¸Šå®ç°çš„ Clone ç‰¹å¾

#### Display

#### Add

#### Into å’Œ From

#### Drop

#### Deref & DerefMut

#### Sized[Special types and traits - The Rust Reference](https://doc.rust-lang.org/stable/reference/special-types-and-traits.html)

### ä¸€ä¸ªå®Œæ•´ä¾‹å­

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/complex/src/lib.rs:1:}}
```

## ç‰¹å¾åŒºé—´ï¼šæ³›å‹+ç‰¹å¾

### å¼•å‡ºç‰¹å¾åŒºé—´

é¦–å…ˆçœ‹ä¸€ä¸‹å¦‚ä¸‹ä»£ç ï¼š

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bound_intro.rs:1:}}
```

1. å› æ­¤, ä»»ä½•ç±»å‹ä¸º T çš„æ³›å‹å‡½æ•°éƒ½ä¸èƒ½çŸ¥é“æˆ–é»˜è®¤å‡å®š init()æ–¹æ³•å­˜åœ¨äº T ä¹‹ä¸Šã€‚
2. å¦‚æœç¡®å®å¦‚æ­¤,é‚£ä¹ˆå®ƒæ ¹æœ¬ä¸æ˜¯æ³›å‹,å¹¶ä¸”å®ƒä»¬åªèƒ½æ¥æ”¶å…·æœ‰ init()æ–¹æ³•çš„ç±»å‹ã€‚
3. **å› æ­¤,æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®©ç¼–è¯‘å™¨çŸ¥é“è¿™ä¸€ç‚¹,å¹¶çº¦æŸ load é€šè¿‡ç‰¹å¾èƒ½å¤Ÿæ¥æ”¶çš„ç±»å‹é›†,è¿™å°±éœ€è¦ç”¨åˆ°ç‰¹å¾åŒºé—´**ã€‚

> æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªåä¸º Loadable çš„ç‰¹å¾,å¹¶åœ¨æˆ‘ä»¬çš„ Enemy å’Œ Hero ç±»å‹ä¸Šå®ç°å®ƒã€‚

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bound_intro_fixed.rs:1:}}
```

1. æ³¨æ„, â€œ:Loadableâ€éƒ¨åˆ†è¡¨æ˜äº†æˆ‘ä»¬æŒ‡å®šç‰¹å¾èŒƒå›´çš„æ–¹å¼ã€‚ç‰¹å¾åŒºé—´å…è®¸æˆ‘ä»¬é™åˆ¶æ³›å‹ API å¯ä»¥æ¥æ”¶çš„å‚æ•°èŒƒå›´ã€‚

### ä»£ç å•ä½“åŒ–

1. æŒ‡å®šæ³›å‹å…ƒç´ ä¸Šçš„ç»‘å®šçš„ç‰¹å¾ç±»ä¼¼äºæˆ‘ä»¬ä¸ºå˜é‡æŒ‡å®šç±»å‹çš„æ–¹å¼
2. ä½†æ˜¯æ­¤å¤„çš„å˜é‡æ˜¯æ³›å‹ T,ç±»å‹æ˜¯æŸäº›ç‰¹å¾ã€‚ä¾‹å¦‚ **T:SomeTrait**ã€‚
3. å®šä¹‰æ³›å‹å‡½æ•°æ—¶å‡ ä¹æ€»æ˜¯ä¼šç”¨åˆ°ç‰¹å¾åŒºé—´ã€‚
4. å¦‚æœå®šä¹‰çš„æ³›å‹å‡½æ•°ä¸­çš„ T ä¸åŒ…å«ä»»ä½•ç‰¹å¾åŒºé—´,æˆ‘ä»¬å°±ä¸èƒ½é€šè¿‡ä»»ä½•æ–¹æ³•è°ƒç”¨,å›  Rust ä¸çŸ¥é“ç»™å®šæ–¹æ³•å®ç°çš„æ–¹å¼ã€‚
5. å®ƒéœ€è¦çŸ¥é“ T æ˜¯å¦å…·æœ‰æŸä¸ª foo æ–¹æ³•,ä»¥ä¾¿**å°†ä»£ç å•ä½“åŒ–**

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bound_basics.rs:1:}}
```

> ä¿®æ­£å

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bound_basics_fixed.rs:1:}}
```

### æŒ‡å®šç‰¹å¾åŒºé—´çš„å››ä¸ªæ–¹æ³•

#### åŒºé—´å†…æ³›å‹: fn fn_name<T: target_trait>(val: T)

```rust
// æŒ‡å®šç‰¹å¾åŒºé—´çš„ä¸€ç§æ–¹æ³•, å®ƒä¼šæ¥æ”¶ä»»ä½•å®ç°äº† Display ç‰¹å¾çš„ç±»å‹
fn show_me<T: Display>(val: T) {
    //å¯ä»¥ä½¿ç”¨{}æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå› ä¸ºæœ‰Displayç‰¹å¾åŒºé—´
    printin!("{}", val);
}
```

1. è¿™æ˜¯åœ¨æ³›å‹å‡½æ•°çš„ç±»å‹ç­¾åçš„é•¿åº¦è¾ƒçŸ­æ—¶å£°æ˜ç‰¹å¾åŒºé—´çš„å¸¸è§è¯­æ³•ã€‚
2. åœ¨æŒ‡å®šç±»å‹çš„ç‰¹å¾åŒºé—´æ—¶,æ­¤è¯­æ³•ä¹Ÿæœ‰æ•ˆ

#### whereè¯­å¥: å½“ç¬¬ä¸€ç§æ–¹æ³•ç­¾åè¿‡é•¿æ—¶ä½¿ç”¨

```rust
pub fn parse<F>(&self) -> Result<F, <F as FromStr>::Err>
    where F: FromStr { ... }
```

> æ³¨æ„â€œwhere F: FromStrâ€éƒ¨åˆ†å‘Šè¯‰æˆ‘ä»¬ F ç±»å‹å¿…é¡»å®ç° FromStr ç‰¹å¾ã€‚where è¯­å¥å°†ç‰¹å¾åŒºé—´å’Œå‡½æ•°ç­¾åè§£è€¦,å¹¶ä½¿å…¶å¯è¯»

#### ä½¿ç”¨"+"ç»„åˆå¤šä¸ªç‰¹å¾

- å…ˆçœ‹ä¸€ä¸‹æ ‡å‡†åº“ä¸­ HashMap ç±»å‹çš„ impl ä»£ç å—:

```rust
// HashMap é”®ç±»å‹çš„ K å¿…é¡»å®ç° Hash ç‰¹å¾å’Œ Eq ç‰¹å¾
impl<K: Hash + Eq, V> HashMap<K, V, RandomState>
{}
```

- ä¸€ä¸ªæ›´åŠ å…·ä½“çš„ä¾‹å­

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_composition.rs:1:}}
```

#### ä½¿ç”¨implç‰¹å¾è¯­æ³•: é—­åŒ…å¸¸ç”¨

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/impl_trait_syntax.rs:1:}}
```

> å¦‚æœæ²¡æœ‰è¿™ç§è¯­æ³•,åˆ™å¿…é¡»ä½¿ç”¨ Box æ™ºèƒ½æŒ‡é’ˆç±»å‹å°†å…¶æ”¾åœ¨æŒ‡é’ˆåé¢è¿”å›,è¿™æ¶‰åŠå †åˆ†é…ã€‚
> é—­åŒ…çš„åº•å±‚ç»“æ„ç”±å®ç°äº†ä¸€ç³»åˆ—ç‰¹å¾çš„ç»“æ„ä½“ç»„æˆã€‚**Fn(T) -> U** ç‰¹å¾å°±æ˜¯å…¶ä¸­ä¹‹ä¸€

é—­åŒ…ä½¿ç”¨ç¤ºä¾‹ï¼š

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/impl_trait_closure.rs:1:}}
```

è¿˜å¯ä»¥åœ¨å…¥å‚å’Œè¿”å›ä½¿ç”¨ï¼š

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/impl_trait_both.rs:1:}}
```

1. é€šå¸¸å»ºè®®å°†ç‰¹å¾åŒºé—´çš„ impl ç‰¹å¾è¯­æ³•ç”¨åšå‡½æ•°çš„è¿”å›ç±»å‹ã€‚
2. åœ¨å‚æ•°ä½ç½®ä½¿ç”¨å®ƒæ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ turbofish è¿ç®—ç¬¦ã€‚
3. å¦‚æœæŸäº›ç›¸å…³ä»£ç ä½¿ç”¨ turbofish è¿ç®—ç¬¦æ¥è°ƒç”¨è½¯ä»¶åŒ…ä¸­çš„æŸä¸ªæ–¹æ³•,é‚£ä¹ˆå¯èƒ½å¯¼è‡´ API ä¸å…¼å®¹ã€‚
4. åªæœ‰å½“æˆ‘ä»¬æ²¡æœ‰å¯ç”¨çš„å…·ä½“ç±»å‹æ—¶æ‰åº”è¯¥ä½¿ç”¨å®ƒ, å°±åƒé—­åŒ…é‚£æ ·ã€‚

### ç‰¹å¾åŒºé—´çš„ä½¿ç”¨åœºæ™¯

#### åœ¨ç±»å‹ä¸Šä½¿ç”¨ï¼šä¸å»ºè®®

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bounds_types.rs:1:}}
```

> ä¸è¿‡,æˆ‘ä»¬å¹¶ä¸é¼“åŠ±åœ¨ç±»å‹ä¸Šä½¿ç”¨ç‰¹å¾åŒºé—´,å› ä¸ºå®ƒå¯¹ç±»å‹è‡ªèº«æ–½åŠ äº†é™åˆ¶ã€‚
> é€šå¸¸, æˆ‘ä»¬å¸Œæœ›ç±»å‹å°½å¯èƒ½æ˜¯æ³›å‹,ä»è€Œå…è®¸æˆ‘ä»¬ä½¿ç”¨ä»»ä½•ç±»å‹åˆ›å»ºå®ä¾‹,å¹¶ä½¿ç”¨å‡½æ•°æˆ–æ–¹æ³•ä¸­çš„ç‰¹å¾åŒºé—´å¯¹å…¶è¡Œä¸ºè¿›è¡Œé™åˆ¶ã€‚

#### æ³›å‹å‡½æ•°+implä»£ç å—

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_bound_functions.rs:1:}}
```

## ç‰¹å¾å¯¹è±¡: å¤šæ€ç‰¹å¾ç±»å‹

### åˆ†å‘(dispatch)

> åˆ†å‘æ˜¯ä¸€ä¸ªä»é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼ä¸­å€Ÿé‰´çš„æ¦‚å¿µ,ä¸»è¦ç”¨äºæè¿°è¢«ç§°ä¸ºå¤šæ€çš„ä¸Šä¸‹æ–‡ä¸­çš„ä¸€ç§ç‰¹æ€§ã€‚ åœ¨é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡(Object-Oriented Programming,OOP)ä¸­,å½“ API æ˜¯æ³›å‹æˆ–è€…æ¥æ”¶å®ç°ä¸ºæ¥å£çš„å‚æ•°æ—¶,å¿…é¡»å¼„æ¸…æ¥šå‚æ•°åœ¨ä¼ é€’ç»™ API çš„ç±»å‹å®ä¾‹ä¸Šè°ƒç”¨ä»€ä¹ˆæ–¹æ³•å®ç°ã€‚å¤šæ€çš„ä¸Šä¸‹æ–‡ä¸­çš„æ–¹æ³•è§£æè¿‡ç¨‹è¢«ç§°ä¸ºåˆ†å‘,è°ƒç”¨è¯¥æ–¹æ³•è¢«ç§°ä¸ºåˆ†å‘åŒ–(dispatching) ã€‚

#### åˆ†å‘æ–¹å¼ï¼šé™æ€ or åŠ¨æ€

> åœ¨æ”¯æŒå¤šæ€çš„ä¸»æµè¯­è¨€ä¸­,åˆ†å‘å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»»æ„ä¸€ç§æ–¹å¼è¿›è¡Œã€‚

1. é™æ€åˆ†å‘ï¼šç¼–è¯‘æœŸå†³å®š

å½“åœ¨ç¼–è¯‘æœŸå†³å®šè¦è°ƒç”¨çš„æ–¹æ³•æ—¶,å®ƒè¢«ç§°ä¸ºé™æ€åˆ†å‘æˆ–æ—©æœŸç»‘å®šã€‚æ–¹æ³•çš„ç­¾åç”¨äºå†³å®šè°ƒç”¨çš„æ–¹æ³•,æ‰€æœ‰è¿™äº›éƒ½åœ¨ç¼–è¯‘æœŸå†³å®šã€‚åœ¨ Rust ä¸­,æ³›å‹å±•ç¤ºäº†è¿™ç§å½¢å¼çš„åˆ†å‘, å› ä¸ºå³ä½¿æ³›å‹å‡½æ•°å¯ä»¥æ¥æ”¶è®¸å¤šå‚æ•°, ä¹Ÿä¼šåœ¨ç¼–è¯‘æœŸä½¿ç”¨å…·ä½“ç±»å‹ç”Ÿæˆå‡½æ•°çš„ä¸“ç”¨å‰¯æœ¬ã€‚

2.åŠ¨æ€åˆ†å‘: è¿è¡ŒæœŸå†³å®šï¼Œèµ„æºå¼€é”€æ›´å¤§

åœ¨é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸­,æœ‰æ—¶ç›´åˆ°è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šè°ƒç”¨çš„æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºå…·ä½“ç±»å‹è¢«éšè—,å¹¶ä¸”åªæœ‰æ¥å£æ–¹æ³•å¯ç”¨äºè°ƒç”¨è¯¥ç±»å‹ã€‚ åœ¨ Java ä¸­,å½“å‡½æ•°åªæœ‰å‚æ•°æ—¶å°±æ˜¯è¿™ç§æƒ…å†µ,å³æ¥å£ã€‚ è¿™ç§æƒ…å†µåªèƒ½é€šè¿‡åŠ¨æ€åˆ†å‘æ¥å¤„ç†ã€‚åœ¨åŠ¨æ€åˆ†å‘è¿‡ç¨‹ä¸­,å¯é€šè¿‡å¯¹
vtable æ¥å£çš„å®ç°åˆ—è¡¨è¿›è¡ŒæŸ¥æ‰¾,å¹¶è°ƒç”¨è¯¥æ–¹æ³•æ¥åŠ¨æ€ç¡®å®šç›¸å…³æ–¹æ³•ã€‚vtable æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆåˆ—è¡¨,æŒ‡å‘æ¯ä¸ªç±»å‹çš„å®ç°æ–¹æ³•ã€‚ç”±äºæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­å­˜åœ¨é¢å¤–çš„é—´æ¥æŒ‡é’ˆå¼•ç”¨,æ‰€ä»¥è¿™éœ€è¦æ›´å¤šçš„èµ„æºå¼€é”€

### åŒºåˆ«ç‰¹å¾åŒºé—´ä¸ç‰¹å¾å¯¹è±¡

| ç‰¹å¾ä½¿ç”¨æ–¹å¼ | åˆ†å‘æ–¹å¼ | å®ç°æ–¹å¼ |       ç»‘å®šæ—¶æœŸ       |      |
| :----------: | :------: | :------: | :------------------: | ---- |
|   ç‰¹å¾åŒºé—´   | é™æ€åˆ†å‘ | é™å®šæ³›å‹ |   ç¼–è¯‘æœŸ(æ—©æœŸç»‘å®š)   |      |
|   ç‰¹å¾å¯¹è±¡   | åŠ¨æ€åˆ†å‘ |  èƒ–æŒ‡é’ˆ  | è¿è¡ŒæœŸå¤šæ€(åæœŸç»‘å®š) |      |

### ç‰¹å¾å¯¹è±¡å…·ä½“è¯´è¯´

#### æŒ‡å®šä¸ºå®ç°æŸä¸ªç‰¹å¾

ç‰¹å¾å¯¹è±¡æ˜¯ä¸€ç§åˆ›å»ºå¤šæ€ API çš„æ–¹æ³•,å¯ä»¥å°†å‚æ•°æŒ‡å®šä¸ºå®ç°æŸä¸ªç‰¹å¾çš„ä¸œè¥¿,è€Œä¸æ˜¯æ³›å‹æˆ–å…·ä½“ç±»å‹ã€‚è¿™ç§æ–¹æ³•è¢«å£°æ˜ä¸ºå®ç°æŸä¸ªç‰¹å¾ API,å³ç‰¹å¾å¯¹è±¡ã€‚

#### ç”¨èƒ–æŒ‡é’ˆå®ç°

ç‰¹å¾å¯¹è±¡ç±»ä¼¼ C++ä¸­çš„è™šæ–¹æ³•ã€‚ç‰¹å¾å¯¹è±¡å®ç°ä¸ºèƒ–æŒ‡é’ˆ,å¹¶ä¸”æ˜¯ä¸å®šé•¿ç±»å‹,è¿™æ„å‘³ç€å®ƒä»¬åªèƒ½åœ¨å¼•ç”¨ç¬¦å·(&)åé¢ä½¿ç”¨ã€‚ç‰¹å¾å¯¹è±¡èƒ–æŒ‡é’ˆå…·æœ‰æŒ‡å‘ä¸å¯¹è±¡å…³è”çš„å®é™…æ•°æ®çš„ç¬¬ä¸€æŒ‡é’ˆ,è€Œç¬¬äºŒæŒ‡é’ˆæŒ‡å‘è™šæ‹Ÿè¡¨(vtable)
,å®ƒæ˜¯åœ¨å›ºå®šåç§»å¤„ä¸ºæ¯ä¸ªå¯¹è±¡çš„æ–¹æ³•ä¿ç•™ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆçš„ç»“æ„ä½“ã€‚

#### æ˜¯Rustæ‰§è¡ŒåŠ¨æ€åˆ†å‘çš„æ–¹å¼

ç‰¹å¾å¯¹è±¡æ˜¯ Rust æ‰§è¡ŒåŠ¨æ€åˆ†å‘çš„æ–¹å¼,æˆ‘ä»¬æ²¡æœ‰å®é™…çš„å…·ä½“ç±»å‹ä¿¡æ¯ã€‚é€šè¿‡è·³è½¬åˆ°vtable å¹¶è°ƒç”¨é€‚å½“çš„æ–¹æ³•å®Œæˆæ–¹æ³•è§£æã€‚

ç‰¹å¾å¯¹è±¡çš„å¦ä¸€ä¸ªç”¨ä¾‹æ˜¯,å®ƒä»¬å…è®¸ç”¨æˆ·å¯¹å¯ä»¥å…·æœ‰å¤šç§ç±»å‹çš„é›†åˆè¿›è¡Œæ“ä½œ,ä½†æ˜¯åœ¨è¿è¡Œæ—¶éœ€è¦é¢å¤–çš„é—´æ¥æŒ‡é’ˆå¼•ç”¨å¼€é”€

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/trait_objects.rs:1:}}
```

#### ä¸å®šé•¿ç±»å‹åªèƒ½ä½œä¸ºå¼•ç”¨åˆ›å»º

> è¯·æ³¨æ„,æˆ‘ä»¬åªèƒ½åˆ›å»ºåœ¨ç¼–è¯‘æ—¶çŸ¥é“ç±»å‹å°ºå¯¸çš„ç‰¹å¾å¯¹è±¡ã€‚

dyn Trait æ˜¯ä¸€ä¸ªä¸å®šé•¿ç±»å‹,åªèƒ½ä½œä¸ºå¼•ç”¨åˆ›å»ºã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å°†ç‰¹å¾å¯¹è±¡ç½®äºå…¶ä»–æŒ‡é’ˆç±»å‹ä¹‹åæ¥åˆ›å»ºç‰¹å¾å¯¹è±¡,ä¾‹å¦‚ Boxã€Rcã€Arc ç­‰

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/dyn_trait.rs:1:}}
```

## æ€»ç»“ç‰¹å¾ã€ç‰¹å¾åŒºé—´å’Œç‰¹å¾å¯¹è±¡

ç‰¹å¾å’Œæ³›å‹é€šè¿‡å•æ€åŒ–(æ—©æœŸç»‘å®š)æˆ–è¿è¡Œæ—¶å¤šæ€(åæœŸç»‘å®š)æä¾›äº†ä¸¤ç§ä»£ç å¤ç”¨çš„æ–¹å¼ã€‚ ä½•æ—¶ä½¿ç”¨å®ƒä»¬å–å†³äºå…·ä½“æƒ…å†µå’Œç›¸å…³åº”ç”¨ç¨‹åºçš„éœ€æ±‚ï¼š

1. é€šå¸¸,é”™è¯¯ç±»å‹ä¼šè¢«åˆ†é…åˆ°åŠ¨æ€åˆ†å‘çš„åºåˆ—,å› ä¸ºå®ƒä»¬åº”è¯¥æ˜¯å¾ˆå°‘è¢«æ‰§è¡Œçš„ä»£ç è·¯å¾„ã€‚
2. å•æ€åŒ–å¯¹å°å‹çš„åº”ç”¨åœºæ™¯æ¥è¯´éå¸¸æ–¹ä¾¿,ä½†æ˜¯ç¼ºç‚¹æ˜¯å¯¼è‡´äº†ä»£ç çš„è†¨èƒ€å’Œé‡å¤,è¿™ä¼šå½±å“ç¼“å­˜æ•ˆç‡,å¹¶å¢åŠ äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°ã€‚

> ä½†æ˜¯,åœ¨è¿™ä¸¤ä¸ªé€‰é¡¹ä¸­,é™æ€åˆ†å‘åº”è¯¥æ˜¯é¦–é€‰,é™¤éç³»ç»Ÿå¯¹äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°å­˜åœ¨ä¸¥æ ¼çš„é™åˆ¶ã€‚

## å‚è€ƒèµ„æº

### online-book

- [Advanced Traits - The Rust Programming Language](https://doc.rust-lang.org/book/ch19-03-advanced-traits.html)
- [Trait and lifetime bounds - The Rust Reference](https://doc.rust-lang.org/stable/reference/trait-bounds.html)
- [Special types and traits - The Rust Reference](https://doc.rust-lang.org/stable/reference/special-types-and-traits.html)
- [Generic Types, Traits, and Lifetimes - The Rust Programming Language](https://doc.rust-lang.org/book/ch10-00-generics.html)
- [Advanced Traits - The Rust Programming Language](https://doc.rust-lang.org/book/ch19-03-advanced-traits.html)

### fragment

- [Rust traits: A deep dive - LogRocket Blog](https://blog.logrocket.com/rust-traits-a-deep-dive/)
- [é¸­å­ç±»å‹ - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦](https://zh.m.wikipedia.org/zh-hans/%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B)

### local

- [<ç²¾é€šrust(ç¬¬äºŒç‰ˆ)>-ç¬¬å››ç« ï¼šç±»å‹ã€æ³›å‹å’Œç‰¹å¾](marginnote3app://note/91DC4A44-A289-4D0F-B1D1-89D75181E736)
- [ã€Šä»£ç ä¹‹é«“ã€‹- ç¬¬äº”ç« ï¼šå‡½æ•°](marginnote3app://note/6D348DE0-2C5C-42E6-A404-4CF0CA1C5678)
