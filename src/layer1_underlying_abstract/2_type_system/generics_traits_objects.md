# æ³›å‹ã€ç‰¹å¾åŠç‰¹å¾å¯¹è±¡

![rust-traits-deep-dive](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/rust-traits-deep-dive.png)
<!--ts-->

* [æ³›å‹ã€ç‰¹å¾åŠç‰¹å¾å¯¹è±¡](#æ³›å‹ç‰¹å¾åŠç‰¹å¾å¯¹è±¡)
    * [æ³›å‹](#æ³›å‹)
        * [ä»ä»£ç å¤ç”¨å‡ºå‘](#ä»ä»£ç å¤ç”¨å‡ºå‘)
            * [å‡½æ•°ä½œç”¨ä¸è¶³](#å‡½æ•°ä½œç”¨ä¸è¶³)
            * [é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç ](#é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç )
        * [æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–](#æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–)
        * [æ³›å‹ä½¿ç”¨æ–¹å¼](#æ³›å‹ä½¿ç”¨æ–¹å¼)
            * [æ³›å‹å‡½æ•°](#æ³›å‹å‡½æ•°)
            * [æ³›å‹ç»“æ„ä½“](#æ³›å‹ç»“æ„ä½“)
            * [æ³›å‹æšä¸¾ä½“](#æ³›å‹æšä¸¾ä½“)
            * [æ³›å‹ç‰¹å¾](#æ³›å‹ç‰¹å¾)
            * [æ³›å‹æ–¹æ³•](#æ³›å‹æ–¹æ³•)
            * [æ³›å‹å®ç°å—](#æ³›å‹å®ç°å—)
    * [ç‰¹å¾](#ç‰¹å¾)
    * [ç‰¹å¾åŒºé—´ï¼šæ³›å‹+ç‰¹å¾](#ç‰¹å¾åŒºé—´æ³›å‹ç‰¹å¾)
    * [å‚è€ƒèµ„æº](#å‚è€ƒèµ„æº)

<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Mon Jun 13 07:40:28 UTC 2022 -->

<!--te-->

## æ³›å‹

### ä»ä»£ç å¤ç”¨å‡ºå‘

#### å‡½æ•°ä½œç”¨ä¸è¶³

ä¸€ç›´ä»¥æ¥ï¼Œå‡½æ•°çš„å®ç°æ–¹å¼å°±æ˜¯åŸºäºcè¯­è¨€çš„gotoæŒ‡ä»¤ï¼š

![image-20220613150721312](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150721312.png)

é€šè¿‡è¿›ä¸€æ­¥å¼ºåŒ–ï¼Œå°±å¾—åˆ°å‡½æ•°çš„å®ç°æ–¹å¼ï¼š

![image-20220613150804039](https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150804039.png)

> ä½†æ˜¯ä¹Ÿå°±è¿™æ ·äº†ï¼Œå‡½æ•°åªèƒ½å®ç°æµç¨‹ä¸Šçš„å¤ç”¨ï¼Œä¸èƒ½å®ç°ç±»å‹ä¸Šçš„å¤ç”¨ã€‚è¿™ä¸€ç‚¹å…¶å®åœ¨pythonã€jsè¿™äº›åŠ¨æ€ç±»å‹è¯­è¨€ä¸Šé¢å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºRustè¿™ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå¯¹å‡½æ•°å…¥å‚ç±»å‹è¦æ±‚ååˆ†ä¸¥æ ¼ï¼Œäºæ˜¯æ³›å‹å°±åº”è¿è€Œç”Ÿã€‚

#### é™æ€ç±»å‹è¯­è¨€è¿˜éœ€è¦æ³›å‹æ¥å¤ç”¨ä»£ç 

> æ³›å‹ç¼–ç¨‹æ˜¯ä¸€ç§ä»…é€‚ç”¨äºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€çš„æŠ€æœ¯ã€‚å®ƒé¦–æ¬¡å‡ºç°åœ¨ ML è¯­è¨€ä¸­,æ˜¯ä¸€ç§é™æ€ç±»å‹çš„å‡½æ•°å¼è¯­è¨€ã€‚

åƒ Python è¿™æ ·çš„åŠ¨æ€è¯­è¨€é‡‡ç”¨çš„æ˜¯ç®€å•ç±»å‹ (duck typing) , å…¶ä¸­çš„ API æ˜¯æ ¹æ®å®ƒä»¬å¯ä»¥åšä»€ä¹ˆ,è€Œä¸æ˜¯å®ƒä»¬æ˜¯ä»€ä¹ˆæ¥å¤„ç†å‚æ•°çš„,å› æ­¤ä¸ä¾èµ–äºæ³›å‹ã€‚

æ³›å‹æ˜¯è¯­è¨€è®¾è®¡ç‰¹æ€§çš„ä¸€éƒ¨åˆ†, å¯ä»¥å®ç°ä»£ç å¤ç”¨, å¹¶éµå¾ªä¸é‡å¤è‡ªå·±çš„åŸåˆ™ (Don't Repeat Yourself,DRY) ã€‚é‡‡ç”¨è¿™ç§æŠ€æœ¯,ä½ å¯ä»¥ä½¿ç”¨ç±»å‹å ä½ç¬¦æ¥ç¼–å†™ç®—æ³•ã€å‡½æ•°ã€æ–¹æ³•åŠç±»å‹, å¹¶åœ¨è¿™äº›ç±»å‹ä¸ŠæŒ‡å®šä¸€ä¸ªç±»å‹å˜é‡(
ä½¿ç”¨å•ä¸ªå­—æ¯,é€šå¸¸æ˜¯ Tã€K æˆ– V) ,å‘ŠçŸ¥ç¼–è¯‘å™¨åœ¨ä»»ä½•ä»£ç ä¸­å®ä¾‹åŒ–å®ƒä»¬æ—¶è¦å¡«å……çš„å®é™…ç±»å‹ã€‚è¿™äº›ç±»å‹è¢«ç§°ä¸ºæ³›å‹æˆ–å…ƒç´ ã€‚å•ä¸ªå­—æ¯(ä¾‹å¦‚ç±»å‹ T)è¢«ç§°ä¸ºæ³›å‹å‚æ•°ã€‚å½“ä½ ä½¿ç”¨æˆ–å®ä¾‹åŒ–ä»»ä½•æ³›å‹å…ƒç´ æ—¶,å®ƒä»¬ä¼šè¢«æ›¿æ¢æˆè¯¸å¦‚ u32 è¿™æ ·çš„å…·ä½“ç±»å‹ã€‚

### æ³›å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å•æ€åŒ–

æ¯æ¬¡å°†æ³›å‹å…ƒç´ ä¸å…·ä½“ç±»å‹ä¸€èµ·ä½¿ç”¨æ—¶,éƒ½ä¼šåœ¨ç¼–è¯‘æ—¶ç”¨ç±»å‹å˜é‡ T ç”Ÿæˆè¯¥ä»£ç çš„ç‰¹å®šå‰¯æœ¬,å¹¶å°†å…¶æ›¿æ¢ä¸ºå…·ä½“ç±»å‹ã€‚**è¿™ç§åœ¨ç¼–è¯‘æ—¶ç”ŸæˆåŒ…å«å…·ä½“ç±»å‹çš„ä¸“ç”¨å‡½æ•°çš„è¿‡ç¨‹è¢«ç§°ä¸ºå•æ€åŒ–,è¿™æ˜¯æ‰§è¡Œä¸å¤šæ€å‡½æ•°ç›¸åçš„è¿‡ç¨‹ã€‚**

### æ³›å‹ä½¿ç”¨æ–¹å¼

> åœ¨ä½¿ç”¨æ³›å‹æ—¶ï¼Œåº”è¯¥å¤šå»è€ƒè™‘å®ƒä¸ä¸åŒå…ƒç´ ç»“åˆä½¿ç”¨çš„åœºæ™¯èƒŒåçš„æ€ç»´æ–¹å¼ã€‚æ³›å‹å¯ä»¥ä¸ç»“æ„ä½“ã€æšä¸¾ã€å‡½æ•°ã€ç‰¹å¾ã€æ–¹æ³•åŠä»£ç å®ç°å—ã€‚å®ƒä»¬çš„ä¸€ä¸ªå…±åŒç‰¹å¾æ˜¯æ³›å‹çš„å‚æ•°æ˜¯ç”±ä¸€å¯¹å°–å¤´æ‹¬å·åˆ†éš”,å¹¶åŒ…å«äºå…¶ä¸­ã€‚

#### æ³›å‹å‡½æ•°

ä¸ºäº†åˆ›å»ºæ³›å‹å‡½æ•°,æˆ‘ä»¬éœ€è¦å°†æ³›å‹å‚æ•°æ”¾åœ¨å‡½æ•°åä¹‹åå’Œåœ†æ‹¬å·ä¹‹å‰,å¦‚ä¸‹æ‰€ç¤º:

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_function.rs:1:12}}
```

#### æ³›å‹ç»“æ„ä½“

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_struct.rs:1:21}}
```

#### æ³›å‹æšä¸¾ä½“

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_enum.rs:1:10}}
```

#### æ³›å‹ç‰¹å¾

#### æ³›å‹æ–¹æ³•

### impl: æ³›å‹å®ç°å—

#### æ³›å‹å®ç°

> å½“ä¸ºä»»ä½•æ³›å‹ç¼–å†™ impl ä»£ç å—æ—¶,éƒ½éœ€è¦åœ¨ä½¿ç”¨å®ƒä¹‹å‰å£°æ˜æ³›å‹å‚æ•°ã€‚T å°±åƒä¸€ä¸ªå˜é‡â€”â€” ä¸€ä¸ªç±»å‹å˜é‡,æˆ‘ä»¬éœ€è¦å…ˆå£°æ˜å®ƒ implä»£ç å—å®é™…ä¸Šæ„å‘³ç€æˆ‘ä»¬æ­£åœ¨ä¸ºæ‰€æœ‰ç±»å‹ T å®ç°è¿™äº›æ–¹æ³•,å®ƒä»¬ä¼šå‡ºç°åœ¨ Container<T>ä¸­ã€‚è¿™ä¸ª impl ä»£ç å—æ˜¯ä¸€ä¸ªæ³›å‹å®ç°ã€‚ å› æ­¤,ç”Ÿæˆçš„æ¯ä¸ªå…·ä½“ Container éƒ½å°†æœ‰è¿™äº›æ–¹æ³•ã€‚

```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/generic_struct_impl.rs:1:15}}
```

#### ä¸“é—¨åŒ–æ³›å‹

> åœ¨è¿™é‡Œ, ç”±äº u32 æ˜¯ä½œä¸ºå…·ä½“ç±»å‹å­˜åœ¨çš„, å› æ­¤æˆ‘ä»¬ä¸éœ€è¦ impl ä¹‹åçš„<T>, è¿™æ˜¯ impl ä»£ç å—çš„å¦å¤–ä¸€ä¸ªç‰¹æ€§,å®ƒå…è®¸ä½ é€šè¿‡ç‹¬ç«‹å®ç°æ–¹æ³•æ¥ä¸“é—¨åŒ–æ³›å‹ã€‚ ç°åœ¨,æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å°† T æ›¿æ¢ä¸ºä»»ä½•å…·ä½“ç±»å‹æ¥ä¸º Container<T>ç¼–å†™æ›´å…·ä½“çš„ impl ä»£ç å—ã€‚ä»¥ä¸‹å°±æ˜¯å®ƒçš„å®ä¾‹:

```rust, editable
impl Container<u32> { 
    fn sum(item: u32) -> Self {
        Container { item }
    } 
}
```

### æŒ‡å®šç±»å‹è¿›è¡Œå®ä¾‹åŒ–
> æ¯å½“æˆ‘ä»¬è¿›è¡Œå®ä¾‹åŒ–æ—¶, ç¼–è¯‘å™¨éœ€è¦åœ¨å…¶ç±»å‹ç­¾åä¸­çŸ¥é“ T çš„å…·ä½“ç±»å‹ä»¥ä¾¿æ›¿æ¢,è¿™ä¸ºå…¶æä¾›äº†å°†æ³›å‹ä»£ç å•æ€åŒ–çš„ç±»å‹ä¿¡æ¯ã€‚
è€Œå…·ä½“ç±»å‹çš„ç¡®å®šä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼š
1. å¤§å¤šæ•°æƒ…å†µä¸‹,å…·ä½“ç±»å‹æ˜¯åŸºäºç±»å‹çš„å®ä¾‹åŒ–æ¨æ–­.
2. å¯¹æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•æ¥æ¥æ”¶å…·ä½“ç±»å‹ã€‚ 
3. åœ¨æä¸ªåˆ«æƒ…å†µä¸‹, æˆ‘ä»¬éœ€è¦é€šè¿‡ä½¿ç”¨ `turbofish (::<>)`è¿ç®—ç¬¦è¾“å…¥å…·ä½“ç±»å‹æ¥æ›¿ä»£æ³›å‹ä»¥ä¾¿è¾…åŠ©ç¼–è¯‘å™¨è¯†åˆ«ã€‚
#### åŸºäºç±»å‹å®ä¾‹åŒ–æ¨æ–­
è¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œä¸»è¦åŸºäºç±»å‹ç‰¹å¾(trait)ã€‚

#### æ³›å‹å‡½æ•°è°ƒç”¨æŸäº›æ–¹æ³•
```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/using_generic_func.rs:1:}}
```

#### turbofish: ::<>
1. å¦‚æœæ²¡æœ‰ä»»ä½•ç±»å‹ç‰¹å¾ï¼Œä»£ç å°†æ— æ³•ç¼–è¯‘ï¼šğŸ‘‡
```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/creating_generic_vec.rs:1:}}
```
2. è¿™æ—¶å¯ä»¥ç”¨ä¸‹åˆ—ä¸‰ç§æ–¹å¼æŒ‡å®š
```rust, editable
{{#include ../../../codes/The-Complete-Rust-Programming-Reference-Guide/Chapter04_types_generics_and_traits/using_generic_vec.rs:1:}}
```


## ç‰¹å¾

## ç‰¹å¾åŒºé—´ï¼šæ³›å‹+ç‰¹å¾

## å‚è€ƒèµ„æº

1. <ç²¾é€šrust(ç¬¬äºŒç‰ˆ)>-ç¬¬å››ç« ï¼šç±»å‹ã€æ³›å‹å’Œç‰¹å¾
2. [Advanced Traits - The Rust Programming Language](https://doc.rust-lang.org/book/ch19-03-advanced-traits.html)
3. [Rust traits: A deep dive - LogRocket Blog](https://blog.logrocket.com/rust-traits-a-deep-dive/)

4. ã€Šä»£ç ä¹‹é«“ã€‹- ç¬¬äº”ç« ï¼šå‡½æ•°