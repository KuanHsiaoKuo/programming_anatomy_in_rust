<!DOCTYPE HTML>
<html lang="cn" class="sidebar-visible no-js rust">
<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Programming Anatomy In Rust 🦀</title>
        <meta name="robots" content="noindex"/>


    <!-- Custom HTML head -->
    
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="以rust为例分享学习编程常考虑的方方面面">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff"/>

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="highlight.css">
    <link rel="stylesheet" href="tomorrow-night.css">
    <link rel="stylesheet" href="ayu-highlight.css">

    <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="assets/pagetoc/pagetoc_style.css">
        <link rel="stylesheet" href="assets/css/mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript"
                src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<!-- Provide site root to javascript -->
<script type="text/javascript">
    var path_to_root = "";
    var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
</script>

<!-- Work around some values being stored in localStorage wrapped in quotes -->
<script type="text/javascript">
    try {
        var theme = localStorage.getItem('mdbook-theme');
        var sidebar = localStorage.getItem('mdbook-sidebar');

        if (theme.startsWith('"') && theme.endsWith('"')) {
            localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
        }

        if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
            localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
        }
    } catch (e) {
    }
</script>

<!-- Set the theme before any content is loaded, prevents flash -->
<script type="text/javascript">
    var theme;
    try {
        theme = localStorage.getItem('mdbook-theme');
    } catch (e) {
    }
    if (theme === null || theme === undefined) {
        theme = default_theme;
    }
    var html = document.querySelector('html');
    html.classList.remove('no-js')
    html.classList.remove('rust')
    html.classList.add(theme);
    html.classList.add('js');
</script>

<!-- Hide / unhide sidebar before it is displayed -->
<script type="text/javascript">
    var html = document.querySelector('html');
    var sidebar = 'hidden';
    if (document.body.clientWidth >= 1080) {
        try {
            sidebar = localStorage.getItem('mdbook-sidebar');
        } catch (e) {
        }
        sidebar = sidebar || 'visible';
    }
    html.classList.remove('sidebar-visible');
    html.classList.add("sidebar-" + sidebar);
</script>

<nav id="sidebar" class="sidebar" aria-label="Table of contents">
    <div class="sidebar-scrollbox">
        <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> 总览</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="checklist.html"><strong aria-hidden="true">1.1.</strong> 待完成</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html"><strong aria-hidden="true">1.2.</strong> Substrate介绍与解析</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/talks.html"><strong aria-hidden="true">1.3.</strong> Rust话题</a></li></ol></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/layer1_underlying_abstract.html"><strong aria-hidden="true">2.</strong> Layer1: 底层抽象</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html"><strong aria-hidden="true">2.1.</strong> 虚拟内存管理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html"><strong aria-hidden="true">2.1.1.</strong> 内存管理与内存安全</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html"><strong aria-hidden="true">2.1.2.</strong> 所有权三件套</a></li></ol></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/2_type_system/type_system.html"><strong aria-hidden="true">2.2.</strong> 类型系统</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer1_underlying_abstract/2_type_system/built_in_types.html"><strong aria-hidden="true">2.2.1.</strong> 基础内置类型</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/2_type_system/collections.html"><strong aria-hidden="true">2.2.2.</strong> 集合类型</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html"><strong aria-hidden="true">2.2.3.</strong> 自定义类型</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html"><strong aria-hidden="true">2.2.4.</strong> 泛型、特征及特征对象</a></li></ol></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html"><strong aria-hidden="true">2.3.</strong> 语言语法</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html"><strong aria-hidden="true">2.3.1.</strong> 注释与文档(rustdoc)</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/keywords_glossary.html"><strong aria-hidden="true">2.3.2.</strong> 词法结构扫盲</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html"><strong aria-hidden="true">2.3.3.</strong> 绑定、赋值与匹配</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/logical_decision_loops.html"><strong aria-hidden="true">2.3.4.</strong> 逻辑判断与循环♻️</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html"><strong aria-hidden="true">2.3.5.</strong> 语句与表达式</a></li><li class="chapter-item expanded "><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html"><strong aria-hidden="true">2.3.6.</strong> 代码质量</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="layer2_design_abstract/layer2_design_abstract.html"><strong aria-hidden="true">3.</strong> Layer2: 设计抽象</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html"><strong aria-hidden="true">3.1.</strong> 编程范式</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer2_design_abstract/4_programming_paradigm/fp.html"><strong aria-hidden="true">3.1.1.</strong> 函数式编程</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/4_programming_paradigm/oop.html"><strong aria-hidden="true">3.1.2.</strong> 面向对象编程</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/4_programming_paradigm/gp.html"><strong aria-hidden="true">3.1.3.</strong> 泛型编程</a></li></ol></li><li class="chapter-item expanded "><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html"><strong aria-hidden="true">3.2.</strong> 设计模式</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/6_module_manage/6_module_manage.html"><strong aria-hidden="true">3.3.</strong> 模块管理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer2_design_abstract/6_module_manage/module_system.html"><strong aria-hidden="true">3.3.1.</strong> 模块系统</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html"><strong aria-hidden="true">3.3.2.</strong> Cargo与项目生命周期</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html"><strong aria-hidden="true">3.3.3.</strong> Cargo run: rustc</a></li><li class="chapter-item expanded "><a href="layer2_design_abstract/6_module_manage/rust_plugins.html"><strong aria-hidden="true">3.3.4.</strong> Rust扩展工具</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="layer3_task_abstract/layer3_task_abstract.html"><strong aria-hidden="true">4.</strong> Layer3: 任务抽象</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer3_task_abstract/7_concurrency/7_concurrency.html"><strong aria-hidden="true">4.1.</strong> 并发编程</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer3_task_abstract/7_concurrency/io_models.html"><strong aria-hidden="true">4.1.1.</strong> 系统IO模型</a></li><li class="chapter-item expanded "><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html"><strong aria-hidden="true">4.1.2.</strong> 多线程模型</a></li><li class="chapter-item expanded "><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html"><strong aria-hidden="true">4.1.3.</strong> 异步模型</a></li></ol></li><li class="chapter-item expanded "><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html"><strong aria-hidden="true">4.2.</strong> 元编程</a></li></ol></li><li class="chapter-item expanded "><a href="layer4_protocol_abstract/layer4_protocol_abstract.html"><strong aria-hidden="true">5.</strong> Layer4: 协议抽象</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html"><strong aria-hidden="true">5.1.</strong> 跨语言编程</a></li><li class="chapter-item expanded "><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html"><strong aria-hidden="true">5.2.</strong> 计算机网络</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/layer5_ecosystem.html"><strong aria-hidden="true">6.</strong> Layer5: 生态环境</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/learning_resource.html"><strong aria-hidden="true">6.1.</strong> 学习资源</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/1_books/books.html"><strong aria-hidden="true">6.1.1.</strong> 书籍整理</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/2_courses/courses.html"><strong aria-hidden="true">6.1.2.</strong> 线上课程</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/3_blogs/blogs.html"><strong aria-hidden="true">6.1.3.</strong> 博客文章</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/4_videos/videos.html"><strong aria-hidden="true">6.1.4.</strong> 在线视频</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/1_learning_resource/5_projects/projects.html"><strong aria-hidden="true">6.1.5.</strong> 开源项目</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/2_lang_update/lang_update.html"><strong aria-hidden="true">6.2.</strong> 官方动态</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/3_community/community.html"><strong aria-hidden="true">6.3.</strong> 社区热点</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/4_academic/academic.html"><strong aria-hidden="true">6.4.</strong> 学术讨论</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/open_source.html"><strong aria-hidden="true">6.5.</strong> 开源观察</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/underlying.html"><strong aria-hidden="true">6.5.1.</strong> 底层开发</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/command/command.html"><strong aria-hidden="true">6.5.1.1.</strong> 命令行工具</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/data/data.html"><strong aria-hidden="true">6.5.1.2.</strong> 数据处理</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/embedded/embedded.html"><strong aria-hidden="true">6.5.1.3.</strong> 嵌入式</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/os/os.html"><strong aria-hidden="true">6.5.1.4.</strong> 系统开发</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/1_underlying/performance/performance.html"><strong aria-hidden="true">6.5.1.5.</strong> 性能工具</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network.html"><strong aria-hidden="true">6.5.2.</strong> 网络相关</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/cloud/cloud.html"><strong aria-hidden="true">6.5.2.1.</strong> 云原生</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/frontend/frontend.html"><strong aria-hidden="true">6.5.2.2.</strong> 前端基建</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/network.html"><strong aria-hidden="true">6.5.2.3.</strong> 网络基建</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html"><strong aria-hidden="true">6.5.2.3.1.</strong> IPFS: 星际文件系统(InterPlanetary File System)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_website.html"><strong aria-hidden="true">6.5.2.3.1.1.</strong> 利用IPFS构建自己的去中心化分布式网站</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_pubsub.html"><strong aria-hidden="true">6.5.2.3.1.2.</strong> IPFS pubsub功能</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_companion.html"><strong aria-hidden="true">6.5.2.3.1.3.</strong> IPFS伴侣插件</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_ngrok.html"><strong aria-hidden="true">6.5.2.3.1.4.</strong> IPFS+ngrok</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/web/web.html"><strong aria-hidden="true">6.5.2.4.</strong> web开发</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/2_network/web/webassembly_try.html"><strong aria-hidden="true">6.5.2.4.1.</strong> 基于Rust尝试WebAssembly</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/3_media/media.html"><strong aria-hidden="true">6.5.3.</strong> 多媒体</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/3_media/av/av.html"><strong aria-hidden="true">6.5.3.1.</strong> 音视频处理</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/3_media/game/game.html"><strong aria-hidden="true">6.5.3.2.</strong> 游戏开发</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/4_other/other.html"><strong aria-hidden="true">6.5.4.</strong> 其他</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/4_other/lang-with-rust/lang_with_rust.html"><strong aria-hidden="true">6.5.4.1.</strong> Rust与其他语言</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/4_other/scientific-research/scientific_research.html"><strong aria-hidden="true">6.5.4.2.</strong> 科学艺术研究</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/5_open_source/4_other/tools/tools.html"><strong aria-hidden="true">6.5.4.3.</strong> 其他工具</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/6_security/security.html"><strong aria-hidden="true">6.6.</strong> 安全参考</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/business.html"><strong aria-hidden="true">6.7.</strong> 商业观察</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/blockchain.html"><strong aria-hidden="true">6.7.1.</strong> 区块链</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/build-a-block-in-rust.html"><strong aria-hidden="true">6.7.1.1.</strong> 使用rust建立一个简单的区块链</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html"><strong aria-hidden="true">6.7.1.2.</strong> Substrate介绍与解析</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html"><strong aria-hidden="true">6.7.1.2.1.</strong> Substrate教程梳理</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_ref.html"><strong aria-hidden="true">6.7.1.2.2.</strong> Substrate备忘</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html"><strong aria-hidden="true">6.7.1.2.3.</strong> Substrate市场：Rutimes、Pallets和Projects</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html"><strong aria-hidden="true">6.7.1.2.4.</strong> Substrate惊奇资源</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html"><strong aria-hidden="true">6.7.1.3.</strong> Nervos CKB介绍与解析</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/blockchain/solana.html"><strong aria-hidden="true">6.7.1.4.</strong> Solana</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/practices/practices.html"><strong aria-hidden="true">6.7.2.</strong> 生产实践</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/7_business/products/products.html"><strong aria-hidden="true">6.7.3.</strong> 优秀产品</a></li></ol></li><li class="chapter-item expanded "><a href="layer5_ecosystem/8_libs/libs.html"><strong aria-hidden="true">6.8.</strong> 基础库</a></li><li class="chapter-item expanded "><a href="layer5_ecosystem/9_frameworks/frameworks.html"><strong aria-hidden="true">6.9.</strong> 框架引擎</a></li></ol></li><li class="chapter-item expanded "><a href="checklist.html">Checklist</a></li></ol>
    </div>
    <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
</nav>

<div id="page-wrapper" class="page-wrapper">

    <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
        <div id="menu-bar" class="menu-bar sticky bordered">
            <div class="left-buttons">
                <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                    <i class="fa fa-bars"></i>
                </button>
                <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                    <i class="fa fa-paint-brush"></i>
                </button>
                <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                    <li role="none">
                        <button role="menuitem" class="theme" id="light">Light</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="rust">Rust (default)</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="coal">Coal</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="navy">Navy</button>
                    </li>
                    <li role="none">
                        <button role="menuitem" class="theme" id="ayu">Ayu</button>
                    </li>
                </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                            aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                            aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
            </div>

            <h1 class="menu-title">Programming Anatomy In Rust 🦀</h1>
            <h4 class="menu-bar"><a href="https://kuanhsiaokuo.github.io/think-tool-kit/">保持批判，有所取舍，知行合一, 方见真我</a> -- 练武不练功
                到头一场空 -- 《赛博英雄传》 </h4>
            <div class="right-buttons">
                    <a href="print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/KuanHsiaoKuo/programming_anatomy_in_rust.git" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-rust"></i>
                    </a>
            </div>
        </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                           placeholder="Search this book ..." aria-controls="searchresults-outer"
                           aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

        <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
        <script type="text/javascript">
            document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
            document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
            Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
            });
        </script>

        <div id="content" class="content">
            <main>

                <!-- Page table of contents -->
                <div class="sidetoc">
                    <nav class="pagetoc"></nav>
                </div>
                <h1 id="编程解剖-in-rust"><a class="header" href="#编程解剖-in-rust">编程解剖 in rust</a></h1>
<blockquote>
<p>以rust为例分享学习编程常考虑的方方面面</p>
</blockquote>
<!--ts-->
<ul>
<li><a href="../index.html#%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%89%96-in-rust">编程解剖 in rust</a>
<ul>
<li><a href="../index.html#%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C">本地运行</a></li>
<li><a href="../index.html#git-lfs%E9%85%8D%E7%BD%AE">git lfs配置</a></li>
<li><a href="../index.html#%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E7%BB%93%E6%9E%84">项目基础结构</a></li>
<li><a href="../index.html#%E7%94%A8%E5%88%B0%E7%9A%84%E5%B7%A5%E5%85%B7">用到的工具</a>
<ul>
<li><a href="../index.html#mdbook-checklist-%E6%95%B4%E7%90%86%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9">mdbook-checklist: 整理待办事项</a></li>
<li><a href="../index.html#mdbook-pagetoc-%E6%B7%BB%E5%8A%A0%E4%B8%9A%E5%86%85%E7%9B%AE%E5%BD%95">mdbook-pagetoc: 添加业内目录</a></li>
<li><a href="../index.html#mdbook-admonish-%E4%BD%BF%E7%94%A8%E6%96%B0%E7%9A%84css%E6%96%87%E4%BB%B6">mdbook-admonish: 使用新的css文件</a>
<ul>
<li><a href="../index.html#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90">相关资源</a></li>
<li><a href="../index.html#%E7%89%B9%E5%88%AB%E8%AF%AD%E6%B3%95">特别语法</a>
<ul>
<li><a href="../index.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E9%A2%98">自定义标题</a></li>
<li><a href="../index.html#%E5%86%85%E5%B5%8C%E4%BB%A3%E7%A0%81">内嵌代码</a></li>
<li><a href="../index.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%B7%E5%BC%8F">自定义样式</a></li>
<li><a href="../index.html#%E5%8F%AF%E6%8A%98%E5%8F%A0">可折叠</a></li>
</ul>
</li>
<li><a href="../index.html#%E5%B8%B8%E7%94%A8%E6%A0%BC%E5%BC%8F">常用格式</a>
<ul>
<li><a href="../index.html#note">note</a></li>
<li><a href="../index.html#abstract-summary-tldr">abstract, summary, tldr</a></li>
<li><a href="../index.html#info-todo">info, todo</a></li>
<li><a href="../index.html#tip-hint-important">tip, hint, important</a></li>
<li><a href="../index.html#success-check-done">success, check, done</a></li>
<li><a href="../index.html#question-help-faq">question, help, faq</a></li>
<li><a href="../index.html#warning-caution-attention">warning, caution, attention</a></li>
<li><a href="../index.html#failure-fail-missing">failure, fail, missing</a></li>
<li><a href="../index.html#danger-error">danger, error</a></li>
<li><a href="../index.html#bug">bug</a></li>
<li><a href="../index.html#example">example</a></li>
<li><a href="../index.html#quote-cite">quote, cite</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="../index.html#github-action">github action</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:26 UTC 2022 -->
<!--te-->
<h2 id="本地运行"><a class="header" href="#本地运行">本地运行</a></h2>
<pre><code class="language-shell">cargo install mdbook
mdbook serve
</code></pre>
<h2 id="git-lfs配置"><a class="header" href="#git-lfs配置">git lfs配置</a></h2>
<ul>
<li><a href="https://git-lfs.github.com/">Git Large File Storage | Git Large File Storage (LFS) replaces large files such as audio samples, videos, datasets, and graphics with text pointers inside Git, while storing the file contents on a remote server like GitHub.com or GitHub Enterprise.</a></li>
</ul>
<pre><code>git lfs install 
git lfs track '*.img'
</code></pre>
<h2 id="项目基础结构"><a class="header" href="#项目基础结构">项目基础结构</a></h2>
<p>{{#check <name> | <description>}}</p>
<ol>
<li>每个文件夹下的同名md文件介绍当前文件夹的内容</li>
<li>关于待完成内容：主要基于mdbook-checklist插件</li>
</ol>
<pre><code class="language-shell">    - [待完成](checklist.md) 
</code></pre>
<ol start="3">
<li>添加待完成锚点的格式</li>
</ol>
<blockquote>
<p>check空格之后的内容不能有空格, 且只能为英文
“ | “之后的内容可以有空格，可以为中文</p>
</blockquote>
<pre><code class="language-shell">&lt;a id=&quot;Note-1&quot;&gt;&lt;/a&gt;Note-1
</code></pre>
<ul>
<li>checklist页面渲染效果：</li>
</ul>
<pre><code class="language-none">- &lt;SUMMARY对应标题名&gt;
    - [This is an important note](Note-1)
</code></pre>
<blockquote>
<p>这种写法会自动在本地生成md文件：src/checklist.md, 但是不用管它，最后渲染还是以mdbook-checklist的内容为准</p>
</blockquote>
<h2 id="用到的工具"><a class="header" href="#用到的工具">用到的工具</a></h2>
<blockquote>
<p>来自：<a href="https://kuanhsiaokuo.github.io/apple_power_user/app_deepin/mdbook_deepin.html">Mdbook - Apple Power User</a></p>
</blockquote>
<h3 id="mdbook-checklist-整理待办事项"><a class="header" href="#mdbook-checklist-整理待办事项">mdbook-checklist: 整理待办事项</a></h3>
<p><a href="https://github.com/ANSSI-FR/mdbook-checklist">ANSSI-FR/mdbook-checklist: mdbook preprocessor for generating checklists and indexes</a></p>
<pre><code class="language-shell">cargo install mdbook-checklist
</code></pre>
<p><a href="https://crates.io/crates/mdbook-checklist">mdbook-checklist - crates.io: Rust Package Registry</a></p>
<h3 id="mdbook-pagetoc-添加业内目录"><a class="header" href="#mdbook-pagetoc-添加业内目录">mdbook-pagetoc: 添加业内目录</a></h3>
<p><a href="https://github.com/JorelAli/mdBook-pagetoc">JorelAli/mdBook-pagetoc: A page table of contents for mdBook</a></p>
<h3 id="mdbook-admonish-使用新的css文件"><a class="header" href="#mdbook-admonish-使用新的css文件">mdbook-admonish: 使用新的css文件</a></h3>
<h4 id="相关资源"><a class="header" href="#相关资源">相关资源</a></h4>
<ul>
<li><a href="https://github.com/tommilligan/mdbook-admonish">tommilligan/mdbook-admonish: A preprocessor for mdbook to add Material Design admonishments.</a></li>
<li><a href="https://crates.io/crates/mdbook-admonish">mdbook-admonish - crates.io: Rust Package Registry</a></li>
<li><a href="https://tommilligan.github.io/mdbook-admonish/">Overview - The mdbook-admonish book</a></li>
<li><a href="https://squidfunk.github.io/mkdocs-material/reference/admonitions/#usage">Admonitions - Material for MkDocs</a></li>
</ul>
<blockquote>
<p>All supported directives are listed below.</p>
</blockquote>
<h4 id="特别语法"><a class="header" href="#特别语法">特别语法</a></h4>
<h5 id="自定义标题"><a class="header" href="#自定义标题">自定义标题</a></h5>
<div id="admonition-数据损失" class="admonition warning">
<div class="admonition-title">
<p>数据损失</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-数据损失"></a></p>
</div>
<div>
<p>The following steps can lead to irrecoverable data corruption.</p>
</div>
</div>
<h5 id="内嵌代码"><a class="header" href="#内嵌代码">内嵌代码</a></h5>
<div id="admonition-内嵌代码" class="admonition bug">
<div class="admonition-title">
<p>内嵌代码</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-内嵌代码"></a></p>
</div>
<div>
<p>This syntax won’t work in Python 3:</p>
<pre><code class="language-python">print &quot;Hello, world!&quot;
</code></pre>
</div>
</div>
<h5 id="自定义样式"><a class="header" href="#自定义样式">自定义样式</a></h5>
<div id="admonition-note" class="admonition note custom-0 custom-1">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-note"></a></p>
</div>
<div>
<p>Styled with my custom CSS class.</p>
</div>
</div>
<h5 id="可折叠"><a class="header" href="#可折叠">可折叠</a></h5>
<details id="admonition-note-1" class="admonition note">
<summary class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-note-1"></a></p>
</summary>
<div>
<p>Content will be hidden initially.</p>
</div>
</details>
<h4 id="常用格式"><a class="header" href="#常用格式">常用格式</a></h4>
<h5 id="note"><a class="header" href="#note">note</a></h5>
<div id="admonition-note-2" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-note-2"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="abstract-summary-tldr"><a class="header" href="#abstract-summary-tldr"><code>abstract</code>, <code>summary</code>, <code>tldr</code></a></h5>
<div id="admonition-abstract" class="admonition abstract">
<div class="admonition-title">
<p>Abstract</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-abstract"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="info-todo"><a class="header" href="#info-todo"><code>info</code>, <code>todo</code></a></h5>
<div id="admonition-info" class="admonition info">
<div class="admonition-title">
<p>Info</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-info"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="tip-hint-important"><a class="header" href="#tip-hint-important"><code>tip</code>, <code>hint</code>, <code>important</code></a></h5>
<div id="admonition-tip" class="admonition tip">
<div class="admonition-title">
<p>Tip</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-tip"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="success-check-done"><a class="header" href="#success-check-done"><code>success</code>, <code>check</code>, <code>done</code></a></h5>
<div id="admonition-success" class="admonition success">
<div class="admonition-title">
<p>Success</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-success"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="question-help-faq"><a class="header" href="#question-help-faq"><code>question</code>, <code>help</code>, <code>faq</code></a></h5>
<div id="admonition-question" class="admonition question">
<div class="admonition-title">
<p>Question</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-question"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="warning-caution-attention"><a class="header" href="#warning-caution-attention"><code>warning</code>, <code>caution</code>, <code>attention</code></a></h5>
<div id="admonition-warning" class="admonition warning">
<div class="admonition-title">
<p>Warning</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-warning"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="failure-fail-missing"><a class="header" href="#failure-fail-missing"><code>failure</code>, <code>fail</code>, <code>missing</code></a></h5>
<div id="admonition-failure" class="admonition failure">
<div class="admonition-title">
<p>Failure</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-failure"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="danger-error"><a class="header" href="#danger-error"><code>danger</code>, <code>error</code></a></h5>
<div id="admonition-danger" class="admonition danger">
<div class="admonition-title">
<p>Danger</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-danger"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="bug"><a class="header" href="#bug"><code>bug</code></a></h5>
<div id="admonition-bug" class="admonition bug">
<div class="admonition-title">
<p>Bug</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-bug"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="example"><a class="header" href="#example"><code>example</code></a></h5>
<div id="admonition-example" class="admonition example">
<div class="admonition-title">
<p>Example</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-example"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h5 id="quote-cite"><a class="header" href="#quote-cite"><code>quote</code>, <code>cite</code></a></h5>
<div id="admonition-quote" class="admonition quote">
<div class="admonition-title">
<p>Quote</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-quote"></a></p>
</div>
<div>
<p>Rust is a multi-paradigm, general-purpose programming language designed for performance and safety, especially safe concurrency.</p>
</div>
</div>
<h2 id="github-action"><a class="header" href="#github-action">github action</a></h2>
<ul>
<li><a href="https://github.com/marketplace/actions/rust-cargo-install">rust-cargo-install · Actions · GitHub Marketplace</a></li>
<li><a href="https://github.com/ekalinin/github-markdown-toc">ekalinin/github-markdown-toc: Easy TOC creation for GitHub README.md</a></li>
</ul>
<div id="admonition-基于github-repository设置secrects-token" class="admonition info">
<div class="admonition-title">
<p>基于github repository设置secrects token</p>
<p><a class="admonition-anchor-link" href="../index.html#admonition-基于github-repository设置secrects-token"></a></p>
</div>
<div>
<blockquote>
<p><a href="https://michaelcurrin.github.io/code-cookbook/recipes/ci-cd/github-actions/tokens/access-token.html">Access Token | Code Cookbook</a></p>
</blockquote>
<ol>
<li>设置token：<a href="https://github.com/settings/tokens">Personal access tokens</a></li>
<li>给指定repository设置secret：repository -&gt; settings -&gt; secrets -&gt; Actions</li>
<li>新建一个名为<strong>GH_MD_TOC</strong>的repository secret，将第一步的token设置进去</li>
<li>将这个secret设置为action环境变量</li>
</ol>
</div>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="待完成"><a class="header" href="#待完成">待完成</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate介绍与源码解读"><a class="header" href="#substrate介绍与源码解读">Substrate介绍与源码解读</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/what_is_substrate.png" alt="what_is_substrate" /></p>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB">Substrate介绍与源码解读</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#gavin-wookpolkadot-and-substrate">Gavin Wook、Polkadot and Substrate</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#gavin-wook%E4%B8%8E%E6%B3%A2%E5%8D%A1%E8%B7%A8%E9%93%BE">Gavin Wook与波卡跨链</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%BB%8E%E6%B3%A2%E5%8D%A1%E5%88%B0substrate">从波卡到Substrate</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E8%B7%A8%E9%93%BE%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7">跨链的重要性</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%80%BB%E4%BD%93%E8%AE%BE%E8%AE%A1">总体设计</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%B8%B8%E8%A7%81%E5%8C%BA%E5%9D%97%E9%93%BE%E8%AE%BE%E8%AE%A1">常见区块链设计</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8C%BA%E5%9D%97%E9%93%BE%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86">区块链系统基础部分</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%93%BE%E7%9A%84%E5%8A%9F%E8%83%BD">链的功能</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%90%86%E5%BF%B5">Substrate理念</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%88%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8B%E4%BB%80%E4%B9%88%E6%98%AF%E5%8C%BA%E5%9D%97%E9%93%BE%E6%A1%86%E6%9E%B6">先认识一下：什么是区块链框架</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%8E%A5%E7%9D%80%E8%AF%B4%E8%AF%B4substrate%E4%B8%8Eweb3">接着说说Substrate与web3</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%94%A8web%E6%A1%86%E6%9E%B6%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E7%B1%BB%E6%AF%94">用web框架、游戏引擎类比</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-architecture">Substrate Architecture</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%BC%80%E5%8F%91%E8%80%85%E5%8F%AA%E9%9C%80%E8%A6%81%E5%85%B3%E6%B3%A8runtime%E9%93%BE%E5%8A%9F%E8%83%BD">开发者只需要关注Runtime(链功能)</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%98%8E%E6%99%B0runtime">明晰Runtime</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%88%A4%E6%96%AD%E6%A0%87%E5%87%86">判断标准</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%9A%84runtime">Substrate的Runtime</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%B8%AD%E5%BF%83%E5%8C%96%E5%8D%87%E7%BA%A7%E6%B5%81%E7%A8%8B">中心化升级流程</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%97%A0%E5%A4%AE%E5%8C%96%E5%8D%87%E7%BA%A7%E6%B5%81%E7%A8%8B%E5%8E%9F%E5%85%88">无央化升级流程(原先)</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%9A%84%E4%B8%8D%E5%90%8C">Substrate的不同</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%90%88%E7%BA%A6%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5">以太坊合约更新策略</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E5%AF%B9%E5%BA%94%E5%90%88%E7%BA%A6%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5">Substrate对应‘合约更新策略’</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">项目结构</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9E%B6%E6%9E%84">客户端架构</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%9E%B6%E6%9E%84%E5%9B%BE">架构图</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E">模块说明</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%AD%98%E5%82%A8">存储</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#runtime">Runtime</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#p2p%E7%BD%91%E7%BB%9C">p2p网络</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%B1%E8%AF%86">共识</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#rpc">RPC</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#telemetry-%E9%81%A5%E6%B5%8B">telemetry （遥测）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#tree-level1">Tree Level1</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%94%A8cargo%E7%BB%84%E7%BB%87%E4%BB%A3%E7%A0%81">用Cargo组织代码</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%B8%BB%E8%A6%81%E9%83%A8%E5%88%86%E4%BB%8B%E7%BB%8Dnodeframecore">主要部分介绍：Node、Frame、Core</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-node">Substrate Node:</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%87%8D%E7%82%B9%E8%AF%B4%E8%AF%B4nodepallets%E5%92%8Cruntime">重点说说node、pallets和runtime</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-frame">Substrate FRAME</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-coreclient">Substrate Core(client)</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%B6%E4%BB%96">其他</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#primitives">primitives</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#scriptsci">scripts/ci</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#utils">utils</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8A%9F%E8%83%BD%E9%80%BB%E8%BE%91">功能逻辑</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%89%B9%E8%89%B2%E4%BB%A3%E7%A0%81">特色代码</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#runtime-1">Runtime</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:47 UTC 2022 -->
<!--te-->
<h2 id="gavin-wookpolkadot-and-substrate"><a class="header" href="#gavin-wookpolkadot-and-substrate">Gavin Wook、Polkadot and Substrate</a></h2>
<h3 id="gavin-wook与波卡跨链"><a class="header" href="#gavin-wook与波卡跨链">Gavin Wook与波卡跨链</a></h3>
<p>所以对于开发人员来说，比起大家耳熟能详的v神(Vitalik Buterin)，更重要的人是实际上撑起整个以太坊世界的灵魂人物<strong>Gavin Wood</strong>。更何况很多山寨币实际上就是在以太坊的模型上修修改改，所以在我看来Gavin
Wood是撑起了当前半个区块链世界的人。</p>
<p>而Gavin Wood 离开了以太坊之后，开启的一个新项目叫做Polkadot(波卡)，这个项目的<strong>目的就是跨链，为了把各个割裂的区块链孤岛能够联系一起</strong>
。虽然目前有很多的项目都号称自己在做跨链，但是目前在我看来唯一在推进，逻辑上是可推理，之后可能成功的跨链项目就只有波卡能够成功。（后半段可能存在一定误导性，Polkadot的跨链可能在大部分人理解下应该是分片的变种，也就是基于Substrate开发的区块链可以部署到Polkadot上，经过Polkadot平台互相沟通）。</p>
<h3 id="从波卡到substrate"><a class="header" href="#从波卡到substrate">从波卡到Substrate</a></h3>
<p>而Gavin Wood 在开发的波卡的过程中，经过不断地思考，认为其实区块链发展这几年，大家做的很多事情都是相同的。</p>
<div id="admonition-抽离共同点开始造轮子" class="admonition abstract">
<div class="admonition-title">
<p>抽离共同点，开始造“轮子“</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-抽离共同点开始造轮子"></a></p>
</div>
<div>
<p>那么在以往的软件开发中，当大家发现大家都在做相同的事情的时候，就会将这件事情进行抽象，然后造“轮子”，将这些高层次的东西做封装，成为“开发框架”，将背后复杂的基础设施都封装起来，而使用这个“框架”的开发人员，就可以更加专注于自己的业务逻辑，而不必花费大量的精力去造“轮子”去完成那些每个链都要做的事情。</p>
</div>
</div>
<p>Gavin Wood 在开发波卡的中途先暂停了波卡的开发，将波卡及以太坊已有的成果进行抽象，命名为substrate作为区块链开发的基础框架，并把全部精力都转移到了substrate开发中。</p>
<div id="admonition-第一个轮子" class="admonition tip">
<div class="admonition-title">
<p>第一个轮子</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-第一个轮子"></a></p>
</div>
<div>
<p>所以“substrate”就是区块链世界的第一个“轮子”。</p>
</div>
</div>
<h3 id="跨链的重要性"><a class="header" href="#跨链的重要性">跨链的重要性</a></h3>
<p>另一方面，在软件开发领域或者互联网领域，大家其实都发现了占据了框架的地位实际上一定程度上占据了这个领域开发的生态，更何况对于跨链来说，当大家的链都比较同质化后，跨链会更加的方便。现在大家都把跨链当作区块链下一个引爆点，而跨链的属性界定了做“跨链”的人基本上只能一家独大，成为垄断地位。而接入跨链的链越多，这个跨链就越垄断(
因为大家使用跨链就是为了在不同的链之间兑换代币，能换的代币越多，使用这个跨链的人就越多，生态就越集中)，</p>
<p>而Gavin Wood 提供的substrate框架又<strong>能解决大部分链都在重复解决的问题</strong>，所以大家就更倾向于使用substrate开发自己的链。</p>
<div id="admonition-三角关系" class="admonition quote">
<div class="admonition-title">
<p>三角关系</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-三角关系"></a></p>
</div>
<div>
<p>这样就会在“用户-链-跨链”这个三角关系中将三方的利益绑定在一起，互惠互利，共同进步。</p>
</div>
</div>
<h2 id="总体设计"><a class="header" href="#总体设计">总体设计</a></h2>
<h3 id="常见区块链设计"><a class="header" href="#常见区块链设计">常见区块链设计</a></h3>
<p>目前所有的区块链系统几乎都是从比特币/以太坊模型演变而来。一般来说，一个区块链系统应该具有：</p>
<h4 id="区块链系统基础部分"><a class="header" href="#区块链系统基础部分">区块链系统基础部分</a></h4>
<ul>
<li>共识系统 （区块链分布式基石）</li>
<li>p2p连接与广播系统</li>
<li>存储系统</li>
<li>交易池系统</li>
<li>rpc系统（区块链与外界交互主要通道）</li>
</ul>
<div id="admonition-基础通用" class="admonition info">
<div class="admonition-title">
<p>基础通用</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-基础通用"></a></p>
</div>
<div>
<p>基础部分是当前区块链模型下都会具备的组件，其中共识与P2P体现区块链的分布式本质</p>
</div>
</div>
<h4 id="链的功能"><a class="header" href="#链的功能">链的功能</a></h4>
<div id="admonition-竞争关键" class="admonition info">
<div class="admonition-title">
<p>竞争关键</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-竞争关键"></a></p>
</div>
<div>
<p>链功能是区块链间相互竞争的关键部分. 与系统基础部分相比，这部分差异很大，提供的是除去区块链模型外，这条链能够提供的功能。另一方面在区块链升级中，一般来说系统基础部分改动较小，而链的功能部分改动较大，特别是许多链为了追求开发速度，一开始只能提供转账功能，在后续的版本中才慢慢升级其他功能</p>
</div>
</div>
<p>例如：</p>
<ul>
<li>比特币的UTXO结构加上交易脚本</li>
<li>以太坊的虚拟机与智能合约</li>
<li>eos的账户系统及虚拟机</li>
<li>有的山寨币特化部分智能合约或部分native层成为系统级功能：
<ul>
<li>提供随机数</li>
<li>提供质押对赌</li>
<li>oracle数据输入</li>
<li>引入复杂密码学方案</li>
<li>等等。。。</li>
</ul>
</li>
</ul>
<h4 id="substrate理念"><a class="header" href="#substrate理念">Substrate理念</a></h4>
<div id="admonition-分离变与不变" class="admonition tip">
<div class="admonition-title">
<p>分离变与不变</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-分离变与不变"></a></p>
</div>
<div>
<p>Substrate作为一个区块链框架，认为所有的链都应该具备区块链系统基础部分，而由开发者自由定制链的功能部分</p>
</div>
</div>
<h3 id="先认识一下什么是区块链框架"><a class="header" href="#先认识一下什么是区块链框架">先认识一下：什么是区块链框架</a></h3>
<p>简单来说，或者从本质上讲，区块链框架是一个（巨大的）工具和库的集合，用于构建一个完整的、可运行的、安全的、功能完整的（尽管是基本的）区块链。</p>
<p>区块链框架负责处理以下方面的大部分繁重工作：</p>
<ul>
<li>共识P2P网络</li>
<li>帐户管理</li>
<li>基本的区块链逻辑（区块、交易等）</li>
<li>区块链交互的客户端</li>
</ul>
<h3 id="接着说说substrate与web3"><a class="header" href="#接着说说substrate与web3">接着说说Substrate与web3</a></h3>
<p>Substrate 可以被描述为一个区块链框架——具体来说，一个用于构建定制区块链的框架。这些区块链可以完全自主运行，这意味着它们不依赖任何外部技术来运行。</p>
<p>然而，Substrate 背后的公司 Parity（由以太坊联合创始人 Gavin Wood 共同创立）也建立了 Polkadot 网络。 Polkadot 本质上是一个分散的、基于协议的区块链平台，用于实现安全的跨区块链通信。</p>
<div id="admonition-波卡本身就是跨链桥梁" class="admonition tip">
<div class="admonition-title">
<p>波卡本身就是跨链桥梁</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-波卡本身就是跨链桥梁"></a></p>
</div>
<div>
<p>这意味着 Polkadot可以用作区块链之间的一种桥梁，负责链之间的通信层，并使不同区块链（甚至是以太坊和比特币等系统）之间的交互成为可能。</p>
</div>
</div>
<div id="admonition-web3愿景" class="admonition quote">
<div class="admonition-title">
<p>web3愿景</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-web3愿景"></a></p>
</div>
<div>
<p>这代表着在实现 Web3 的愿景（一个分散的、基于区块链的互联网版本）方面取得了重大进展。</p>
</div>
</div>
<p>由于它们是由同一个人开发的，因此 Substrate 对与Polkadot的集成具有一流的支持，因此您使用Substrate创建的任何区块链都可以无缝连接到 Polkadot。</p>
<p>Substrate 还提供无分叉运行时升级——在不触发硬分叉的情况下升级区块链状态转换功能的能力。</p>
<div id="admonition-文档教程" class="admonition info">
<div class="admonition-title">
<p>文档教程</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-文档教程"></a></p>
</div>
<div>
<p>当然，由于提供了大量的代码，Substrate 附带了大量的文档和教程来帮助您入门。</p>
</div>
</div>
<h3 id="用web框架游戏引擎类比"><a class="header" href="#用web框架游戏引擎类比">用web框架、游戏引擎类比</a></h3>
<div id="admonition-sustrate与web框架大有不同" class="admonition warning">
<div class="admonition-title">
<p>Sustrate与web框架大有不同</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-sustrate与web框架大有不同"></a></p>
</div>
<div>
<p>如果你以前使用过一个广泛的 Web 框架，那么区块链框架就是——根本不是这样的。范围、活动部件的数量、相关概念和扩展点只是处于不同的规模。</p>
</div>
</div>
<blockquote>
<p>一个更好的比较可能是一个成熟的游戏引擎（想想 Unity），它为你需要的一切功能提供基本实现，以及可能需要的许多扩展点，供自定义。</p>
</blockquote>
<p>当然，这意味着已经在架构方面做出了一些决定：你将无法轻易更改。</p>
<p>根据你的用例，可能需要更多的可定制性，而框架可能会以某种方式对其进行限制。</p>
<p>这是标准的权衡：区块链框架可以节省你的时间，但代价是你不得不忍受的一些事情。</p>
<p>然而，正如我们将在下面更详细地探讨的那样，Substrate在这方面提供了一些灵活性。</p>
<p>使您能够在多个阶段在更多的技术自由和易于开发之间进行选择。</p>
<p>Substrate的后端是用 Rust 构建的。它（以及 Parity 通常所做的大部分工作）也是完全开源的。</p>
<blockquote>
<p>因此，您不仅可以使用 Substrate，还可以通过回馈和分叉其中的一部分来改进它，以根据您自己的需求进行定制。</p>
</blockquote>
<h3 id="substrate-architecture"><a class="header" href="#substrate-architecture">Substrate Architecture</a></h3>
<p>Gavin Wood 作为以太坊实际核心的开发者，自然早已对这套系统的框架了然于心，所以从Substrate框架提出的开始（2018年9月），就对区块链系统作出了2个关键的区分：</p>
<div id="admonition-coreruntime" class="admonition info">
<div class="admonition-title">
<p>Core&amp;Runtime</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-coreruntime"></a></p>
</div>
<div>
<p>Substrate Core: 系统基础部分
Runtime：链功能</p>
</div>
</div>
<div id="admonition-substrte-architecture" class="admonition tip">
<div class="admonition-title">
<p>Substrte Architecture</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrte-architecture"></a></p>
</div>
<div>
<pre><code class="language-text">┌───────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                       │
│                                                                                                       │
│      ┌─────────────────┐     ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│      │ fund management │     │     Account     │    │    Contract     │    │   Democratic    │        │
│      │    transfer     │     │     system      │    │       VM        │    │   referendum    │        │
│      └─────────────────┘     └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                                                       │
│                                                  ######  #     # #     # ####### ### #     # #######  │
│      ┌─────────────────┐     ┌─────────────────┐ #     # #     # ##    #    #     #  ##   ## #        │
│      │     Equity      │     │      etc.       │ #     # #     # # #   #    #     #  # # # # #        │
│      │   calculation   │     │                 │ ######  #     # #  #  #    #     #  #  #  # #####    │
│      └─────────────────┘     └─────────────────┘ #   #   #     # #   # #    #     #  #     # #        │
│                                                  #    #  #     # #    ##    #     #  #     # #        │
│                                                  #     #  #####  #     #    #    ### #     # #######  │
├───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                       │
│      ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐    ┌─────────────────┐       │
│      │    Consensus    │     │ Network system  │     │     Trading     │    │                 │       │
│      │    mechanism    │     │      (p2p)      │     │      Pool       │    │       RPC       │       │
│      └─────────────────┘     └─────────────────┘     └─────────────────┘    │                 │       │
│                                                                             └─────────────────┘       │
│                                                             #####  ####### ######  #######            │
│      ┌─────────────────┐                                   #     # #     # #     # #                  │
│      │      etc.       │                                   #       #     # #     # #                  │
│      │                 │                                   #       #     # ######  #####              │
│      └─────────────────┘                                   #       #     # #   #   #                  │
│                                                            #     # #     # #    #  #                  │
│                                                             #####  ####### #     # #######            │
│                                                                                                       │
└───────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<h3 id="开发者只需要关注runtime链功能"><a class="header" href="#开发者只需要关注runtime链功能">开发者只需要关注Runtime(链功能)</a></h3>
<p>根据这样的划分，当开发者使用Substrate框架的时候，无需关心区块链基础功能也就是Core部分的工作，而只需关心自己链能够提供的功能，也就是Runtime部分的工作。</p>
<div id="admonition-vm类似以太坊的智能合约" class="admonition tip">
<div class="admonition-title">
<p>VM类似以太坊的智能合约</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-vm类似以太坊的智能合约"></a></p>
</div>
<div>
<p>注意图中虚拟机EVM也是Runtime的一个组件。与以太坊的结构相比，相当于把以太坊的智能合约功能也能随意作为一个链的功能组件添加进入使用Substrate开发的链中</p>
</div>
</div>
<h3 id="明晰runtime"><a class="header" href="#明晰runtime">明晰Runtime</a></h3>
<p>这里一直强调Runtime是“链的功能”有一些通俗与不严谨，这里使用一个更抽象的描述：</p>
<div id="admonition-runtime明确" class="admonition danger">
<div class="admonition-title">
<p>Runtime明确</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-runtime明确"></a></p>
</div>
<div>
<p>需要对运行结果进行共识的功能部分应该归属于Runtime</p>
</div>
</div>
<p>这个定义比较抽象，且由于需要对“世界状态”或类似概念有比较深入的了解才好解释，故不展开讲解。更严格来说，“需要对运行结果进行共识的功能组件”是“链的功能”的一个子集。</p>
<h4 id="判断标准"><a class="header" href="#判断标准">判断标准</a></h4>
<div id="admonition-判断标准" class="admonition tip">
<div class="admonition-title">
<p>判断标准</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-判断标准"></a></p>
</div>
<div>
<p>这里有一个简单的判定标准判断某个功能是否应该放在Runtime内：</p>
<p>对于某个功能，若只改动一个节点的代码对于所有的逻辑运行的结果与其他不改动的节点运行的结果相同，则认为这个部分应该放在Runtime之外，如果运行结果不同，则认为应该放在Runtime之内。</p>
</div>
</div>
<div id="admonition-举例" class="admonition example">
<div class="admonition-title">
<p>举例</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-举例"></a></p>
</div>
<div>
<p>举个例子：比如我改变了交易池的排序代码，使得对某个账户有利的交易能优先打包。这个改动会令自己这个节点产出的区块不公平的打包交易，但是只要打包出来的区块大家都可以认可，则所有节点共识的“状态的变化”仍然是一致的。很明显，这个功能组件不应该是Runtime的功能，因为它不会改变对于验证一个区块时的“状态变化”的验证。比如我改变了转账功能的代码，能给某个账户凭空增加钱，那么显然，这种改动对于这个改动过的节点执行的结果将会与其他节点不同，则共识不会通过。所以转账这个功能就应该放在Runtime当中，让所有节点执行的都是一致的。</p>
</div>
</div>
<p>这部分结合native与wasm后会容易理解</p>
<p>所以到底什么是Runtime，我认为使用“链上功能”来描述最为恰当，因为其隐含了对于执行结果的共识问题。</p>
<h3 id="substrate的runtime"><a class="header" href="#substrate的runtime">Substrate的Runtime</a></h3>
<p>Substrate的Runtime当然没有止步于仅将区块链系统做了模块化划分，提供框架功能这一步，事实上，由于抽象出了Runtime，Substrate实现了以往所有区块链都无法实现的一个功能：区块链系统升级。</p>
<h4 id="中心化升级流程"><a class="header" href="#中心化升级流程">中心化升级流程</a></h4>
<div id="admonition-centralized-system-upgrading" class="admonition tip">
<div class="admonition-title">
<p>Centralized System Upgrading</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-centralized-system-upgrading"></a></p>
</div>
<div>
<pre><code class="language-text">┌────────────────────────────────Centralized System Upgrading(Internet App)────────────────────────────────┐
│                                                                                                          │
│                                                                                                          │
│                         ┌───────────────────┐      ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │
│                     ┌──▶│    Update Code    │      │   Deploy    │    │   Upgrade   │    │ Centralized │ │
│     .─────────.     │   │(Backend/Frontend)─┼──────▶   Server    │───▶│  Sucessful  │────▶Upgrade Easy │ │
│    ╱           ╲    │   └───────────────────┘      └─────────────┘    └─────────────┘    └─────────────┘ │
│   ( Bug/Upgrade )───┤                                                 ┌─────────────┐                    │
│    `.         ,'    │                                                 │  Somebody   │                    │
│      `───────'      │                                              ┌─▶│   Upgrade   ├─┐                  │
│                     │   ┌───────────────────┐      ┌─────────────┐ │  └─────────────┘ │  ┌─────────────┐ │
│                     └──▶│    Update Code    │      │   Publish   │ │                  │  │ Fragmented  │ │
│                         │       (App)      ─┼──────▶  App Store  │─┤  ┌─────────────┐ ├─▶│   version   │ │
│                         └───────────────────┘      └─────────────┘ │  │  Somebody   │ │  └─────────────┘ │
│                                                                    └─▶│   Reject    │─┘                  │
│                                                                       └─────────────┘                    │
│                                                                                                          │
│                                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<p>对于中心化的互联网系统而言，由于代码与数据的控制权在自己手上，所以可以随时进行版本的升级与修改。但是即便如此，也只有网页H5，后台代码可以做到随时升级，在移动互联网中，app还是需要用户自行更新。其中android生态尤为突出，apk版本的碎片化一度是困扰开发者的难题。为了应对app应用的碎片化，推出了许多功能各异的框架能够用户在不更新app的情况下进行“热更新”，一度成为技术的热门追捧。这些热更新的框架本质上都是允许从后台下载一段更新代码，通过各种方式加载运行新的代码来完成。一般情况下通过这种热更新提供的功能都会带来一定的性能损耗以运行最新的热更新代码。但是即便是热更新，更新代码的控制权也同样处于中心化组织的手中。</p>
<h4 id="无央化升级流程原先"><a class="header" href="#无央化升级流程原先">无央化升级流程(原先)</a></h4>
<div id="admonition-decentralized-system-upgradingpre" class="admonition tip">
<div class="admonition-title">
<p>Decentralized System Upgrading(pre)</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-decentralized-system-upgradingpre"></a></p>
</div>
<div>
<pre><code class="language-text">┌───────────────────────────────────Decentralized System Upgrading(Blockchain Dapp)────────────────────────────────────┐
│                                                                                                 ┌─────────────┐      │
│                                                                                                 │   Upgrade   │      │
│                                                                                  ┌───Yes───────▶│  Sucessful  │      │
│                                                                                  │              └─────────────┘      │
│                                                                                  Λ                                   │
│                                                                                 ╱ ╲                                  │
│                                                                                ╱   ╲                                 │
│                                                                               ╱     ╲                                │
│                                                          ┌────────┐          ╱       ╲                               │
│                                                          │ Deploy │      Most deployments                            │
│                                              ┌──Support─▶│  Node  │─────▶(Under Byzantine                            │
│                                              │           └────────┘      Fault Tolerance)                            │
│                                              │                               ╲       ╱                               │
│                                              Λ                                ╲     ╱                                │
│                                             ╱ ╲                                ╲   ╱                                 │
│                                            ╱   ╲                                ╲ ╱                                  │
│                                           ╱     ╲                                V              ┌──────────────────┐ │
│     .─────────.      ┌─────────────┐     ╱       ╲                               │              │   Upgrade Fail   │ │
│    ╱           ╲     │ Update Node │    ╱ Running ╲                              └───No────────▶│(Cause Fragmented)│ │
│   ( Bug/Upgrade ─────▶    Code     ├────▶  Node    ▏                                            └──────────────────┘ │
│    `.         ,'     └─────────────┘    ╲ (Minner ╱                                                       ▲          │
│      `───────'                           ╲       ╱                                                        │          │
│                                           ╲     ╱                                                         │          │
│                                            ╲   ╱                                                          │          │
│     .─────────.                             ╲ ╱                                                           │          │
│  ,─'           '─.                           V                                                            │          │
│ ;    Community    :                          │           ┌────────┐                                       │          │
│ :    proposal     ;                          │           │ Reject │                                       │          │
│  ╲   (BIP/EIP)   ╱                           └───Reject─▶│ Deploy │───────────────────────────────────────┘          │
│   '─.         ,─'                                        └────────┘                                                  │
│      `───────'                                                                                                       │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<p>区块链领域就大大不同了。 即便代码更新的权力在某个组织的手上，但是运行这些代码的人可不一定会听这个组织的指挥，无法容易的命令分散节点统一的进行新代码的部署更新。</p>
<div id="admonition-分布式自治的优缺点" class="admonition tip">
<div class="admonition-title">
<p>分布式自治的优缺点</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-分布式自治的优缺点"></a></p>
</div>
<div>
<p>这是区块链带来的分布式自治的优点，同时也是一个巨大的缺点。</p>
</div>
</div>
<p>比特币社区就是这个领域下的一个典型，由于比特币社区的分裂，部分人并不认同不更改区块大小而是采用隔离见证的方案，分裂出了BCH，对BTC的生态产生的极大的损害。ETH的升级同样也困难重重，每次升级都需要进行长时间的等待以防有节点未升级而产生的分叉。</p>
<p>EOS由于其中心化的特点使得升级稍微简单一些，但仍然出现了由于升级带来的分叉的恶性事件。我们可以形象把区块链下的系统升级称为“全球升级”，因为其要求分布式环境下的大部分节点都更新了代码才使得升级能够成功。相较于中心化控制的系统，区块链系统的升级困难重重且充满风险。</p>
<div id="admonition-高度判断" class="admonition tip">
<div class="admonition-title">
<p>高度判断</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-高度判断"></a></p>
</div>
<div>
<p>同时区块链的升级还有另一个问题：高度判断</p>
<p>一个区块链系统升级后，不得不在代码中加入许多的“高度判断”，以区分不同高度下运行的代码，保证同步能够正常执行，兼容老数据。这种做法很原始但是又无法绕开，给开发者带来极大的思维负担，且需要大量的测试来保证不出现Bug。</p>
</div>
</div>
<p>比如目前比特币的源码中就有许多的区块高度判定使得在同步老区块的时候执行老代码，新区块的时候执行新代码。而中心化系统的数据控制权在自己手上，并且也不存在需要从某个数据源同步的情况，所以完全不需要担心这个问题。</p>
<h4 id="substrate的不同"><a class="header" href="#substrate的不同">Substrate的不同</a></h4>
<p>Substrate横空而出，推出了目前区块链领域最完美的升级方案。其采用“链上代码”的思想，将整个Runtime都做成了可直接更新的组件，让所有节点能够强制运行最新的Runtime代码。</p>
<div id="admonition-substrate-runtime" class="admonition info">
<div class="admonition-title">
<p>Substrate Runtime</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrate-runtime"></a></p>
</div>
<div>
<p>简单来说，Runtime在Substrate框架下，将会用同一份代码编译出两份可执行文件：</p>
<ol>
<li>一份Rust的本地代码，我们一般称为native代码，native与其他代码无异，是这个执行文件中的二进制数据，直接运行。在Substrate的相关代码以native命名</li>
<li>一份wasm的链上代码，我们一般成为wasm代码，wasm被部署到链上，所有人可获取，wasm通过构建一个wasm的运行时环境执行 。在Substrate的相关代码以wasm命名 在节点启动的时候可以选择执行策略，使用native, possible，wasm或者both。不同的执行策略会执行不同的执行文件</li>
</ol>
</div>
</div>
<p>由于这两份代码是由相同的代码编译出来的，所以其执行逻辑完全相同 (有一些很小的暗坑要注意)。其中wasm将会部署到链上，所有人都可以获取到，也就是说即使本地运行的不是最新版本的节点，只要同步了区块，一定可以获取到最新的wasm代码。</p>
<p>换句话说，一个写在Runtime内部的代码，也就是代表这条链功能性的代码，存在两份，分别是native与wasm。wasm代码被部署到链上，是“链上数据”，可以通过同步区块所有人统一获取并执行。这样就可以保证在区块链中所有矿工执行的都是最新的代码。</p>
<div id="admonition-哪种更合理" class="admonition tip">
<div class="admonition-title">
<p>哪种更合理</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-哪种更合理"></a></p>
</div>
<div>
<p>这里需要强调，代码的部署可以通过“民主提议”，“sudo控制权限”，“开发者自定一种部署条件”等方式进行，到底哪种方式“更区块链”，“更合理”，不在本文讨论范围内，这与这条链的设计目的相关。Substrate只是提供了这种“热更新”的强大机制，如何使用这种机制是这条链的问题。</p>
</div>
</div>
<h4 id="以太坊合约更新策略"><a class="header" href="#以太坊合约更新策略">以太坊合约更新策略</a></h4>
<div id="admonition-合约更新策略" class="admonition info">
<div class="admonition-title">
<p>合约更新策略</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-合约更新策略"></a></p>
</div>
<div>
<p>我们使用以太坊中“合约更新策略”来解释Substrate的Runtime机制：</p>
</div>
</div>
<p>由于以太坊部署一个合约后，其地址已经被固定，且数据完全存储在这个合约地址下，若这个合约需要升级功能或出现Bug，将会带来许多的问题（比如许多垃圾山寨币的ERC20合约有溢出漏洞，被攻击后损失惨重，只能通过重新部署合约，**
并将老合约的数据重新导入的方式**进行合约升级，且此时的合约地址只能使用新的了）。</p>
<p>许多开发人员不断探索后发展出了如下的以太坊合约升级方式：</p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Substrate_runtime_intro.jpeg" alt="Substrate_runtime_intro" /></p>
<p>熟悉以太坊的开发人员应该很容易理解上图表达的意思。</p>
<p>其核心思想是将一个合约拆分成为“逻辑合约”与“数据合约”，并使用一个“核心合约”将它们串在一起，这个核心合约就是用户的入口。</p>
<p>由于以太坊部署后的地址是固定的，所以将逻辑合约做成一个独立的合约，并将其地址设置在核心合约当中。那么只要更改核心合约中设置的地址，就可以更改核心合约执行的逻辑了。</p>
<p>并且由于以太坊的合约部署后都存在于“世界状态”当中，那么在同步区块时，老数据就会自动使用老的逻辑合约执行，而新的数据使用新的逻辑合约执行。</p>
<div id="admonition-链上代码" class="admonition tip">
<div class="admonition-title">
<p>链上代码</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-链上代码"></a></p>
</div>
<div>
<p>这里的“逻辑合约”就是“链上代码”的概念，它存在于被共识的数据当中，具备历史的意义</p>
</div>
</div>
<h4 id="substrate对应合约更新策略"><a class="header" href="#substrate对应合约更新策略">Substrate对应‘合约更新策略’</a></h4>
<p>那么将Substrate的框架对应过来，其中：</p>
<ul>
<li>“核心合约”的部分就是节点采用wasm执行去从“状态”存储中加载出最新的合约代码</li>
<li>“逻辑合约”的部分就是这条链的Runtime</li>
<li>“数据合约”的部分就是这条链自己的状态数据</li>
</ul>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/v2-b9bb441d00298a06de67ab8fdd368c08_720w.jpg" alt="img" /></p>
<div id="admonition-wasm" class="admonition tip">
<div class="admonition-title">
<p>wasm</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-wasm"></a></p>
</div>
<div>
<p>由此可见，由于wasm代码的存在，可以保证即使节点没有更新到最新版本，仍然能够<strong>以最新的代码运行</strong>，保证不会因为代码的不同而分叉。同时在节点同步老数据的过程中也<strong>不会因为本地代码是最新的而导致同步出错</strong></p>
</div>
</div>
<h2 id="项目结构"><a class="header" href="#项目结构">项目结构</a></h2>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/substrate_github.gif" alt="substrate_github" /></p>
<h3 id="客户端架构"><a class="header" href="#客户端架构">客户端架构</a></h3>
<h4 id="架构图"><a class="header" href="#架构图">架构图</a></h4>
<div id="admonition-substrate-client" class="admonition tip">
<div class="admonition-title">
<p>Substrate Client</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrate-client"></a></p>
</div>
<div>
<pre><code class="language-text">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ___ _   _ ___ ___ _____ ___    _ _____ ___    ___ _    ___ ___ _  _ _____        ┃
┃        / __| | | | _ ) __|_   _| _ \  /_\_   _| __|  / __| |  |_ _| __| \| |_   _|       ┃
┃        \__ \ |_| | _ \__ \ | | |   / / _ \| | | _|  | (__| |__ | || _|| .` | | |         ┃
┃        |___/\___/|___/___/ |_| |_|_\/_/ \_\_| |___|  \___|____|___|___|_|\_| |_|         ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃     ┌───────────────┐     ┌──────────────────────────────────────────────────────────┐   ┃
┃     │               │     │                                                          │   ┃
┃     │               │     │                                                          │   ┃
┃     │               │     │                           RPC                            │   ┃
┃     │               │     │                                                          │   ┃
┃     │      P2P      │     │                                                          │   ┃
┃     │    NETWORK    │     └──────────────────────────────────────────────────────────┘   ┃
┃     │               │     ┌────────────────────────────────────────┐ ┌───────────────┐   ┃
┃     │               │     │                                        │ │               │   ┃
┃     │               │     │            ┌───────────────┐           │ │               │   ┃
┃     │               │     │            │               │           │ │   CONSENSUS   │   ┃
┃     └───────────────┘     │            │     Wasm      │           │ │               │   ┃
┃          .───────.        │            │    Runtime    │           │ │               │   ┃
┃       ,─'         '─.     │            │               │           │ └───────────────┘   ┃
┃      ╱               ╲░   │            └───────────────┘           │                     ┃
┃     ;     NATIVE      :░  │                                        │ ┌───────────────┐   ┃
┃     :     RUNTIME     ;░░ │                                        │ │               │   ┃
┃      ╲               ╱░░░ │                STORAGE                 │ │               │   ┃
┃       ╲             ╱░░░  │                                        │ │   TELEMETRY   │   ┃
┃        '─.       ,─'░░░   │                                        │ │               │   ┃
┃          ░`─────'░░░░░    │                                        │ │               │   ┃
┃             ░░░░░░░       └────────────────────────────────────────┘ └───────────────┘   ┃
┃                                                                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
</div>
</div>
<p>现在我们知道了 Substrate 是什么，让我们对框架、它的移动部分以及我们可以用来创建自定义区块链的扩展点进行高级概述。 
由于我们在这里处理的是去中心化的点对点系统，所以我们谈论的基本单元是节点,这是我们的区块链运行的地方。
该节点在客户端内部运行，并提供系统运行所需的所有基本组件，例如p2p网络、区块链的存储、块处理和共识的逻辑，以及从外部与区块链交互的能力。</p>
<h4 id="模块说明"><a class="header" href="#模块说明">模块说明</a></h4>
<blockquote>
<p>substrate客户端是基于substrate实现的区块链的节点客户端（可以理解为全节点），
它主要由以下几个组件组成（以下也就是告诉我们实现一条链由哪几部分组成）：</p>
</blockquote>
<h5 id="存储"><a class="header" href="#存储">存储</a></h5>
<p>用来维持区块链系统所呈现的状态演变。substrate提供了的存储方式是一种简单有效的key-value对存储机制的方式。</p>
<h5 id="runtime"><a class="header" href="#runtime">Runtime</a></h5>
<p>这里就可以回答上面的问题，什么是runtime？runtime定义了区块的处理方式，主要是状态转换的逻辑。在substrate中，runtime code被编译成wasm作为区块链存储状态的一部分。</p>
<h5 id="p2p网络"><a class="header" href="#p2p网络">p2p网络</a></h5>
<p>允许客户端和其它网络参与者进行通信。</p>
<h5 id="共识"><a class="header" href="#共识">共识</a></h5>
<p>提供了一种逻辑，能使网络参与者就区块链的状态达成一致。 substrate 支持提供自定义的共识引擎。</p>
<h5 id="rpc"><a class="header" href="#rpc">RPC</a></h5>
<p>远程过程调用。</p>
<h5 id="telemetry-遥测"><a class="header" href="#telemetry-遥测">telemetry （遥测）</a></h5>
<p>通过嵌入式Prometheus服务器的方式对外展示（我理解应该是类似于区块链浏览器一样的东西，或者是提供信息给区块链浏览器展示）。</p>
<h3 id="tree-level1"><a class="header" href="#tree-level1">Tree Level1</a></h3>
<p>首先来看看项目的整理结构：</p>
<pre><code class="language-shell"> tree -L 1 | pbcopy                                                                                                                                                                                                                        ─╯
.
├── Cargo.lock
├── Cargo.toml
├── HEADER-APACHE2
├── HEADER-GPL3
├── LICENSE-APACHE2
├── LICENSE-GPL3
├── README.md
├── bin
├── client
├── docker
├── docs
├── frame
├── primitives
├── rustfmt.toml
├── scripts
├── shell.nix
├── test-utils
└── utils

9 directories, 9 files
</code></pre>
<h4 id="用cargo组织代码"><a class="header" href="#用cargo组织代码">用Cargo组织代码</a></h4>
<p>Substrate非常明显使用Cargo来组织代码：</p>
<ol>
<li>项目根目录的Cargo.toml会用workspace+members导入各子模块</li>
</ol>
<pre><code class="language-yaml">[ workspace ]
  resolver = &quot;2&quot;

  members = [...]
</code></pre>
<div id="admonition-workspacememgers" class="admonition info">
<div class="admonition-title">
<p>workspace+memgers</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-workspacememgers"></a></p>
</div>
<div>
<p>在[workspace]项下, members 属性表示工作区目录中的程序库列表</p>
</div>
</div>
<ol start="2">
<li>各子模块之间也用Cargo.toml来相互导入使用</li>
</ol>
<pre><code class="language-yaml">[ dependencies ]
  sc-consensus = { version = &quot;0.10.0-dev&quot;, path = &quot;../../client/consensus/common&quot; }
</code></pre>
<div id="admonition-高内聚低耦合" class="admonition tip">
<div class="admonition-title">
<p>高内聚，低耦合</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-高内聚低耦合"></a></p>
</div>
<div>
<p>这里正是通过Cargo.toml的语法，将模块功能内聚之后供调用</p>
</div>
</div>
<h3 id="主要部分介绍nodeframecore"><a class="header" href="#主要部分介绍nodeframecore">主要部分介绍：Node、Frame、Core</a></h3>
<h4 id="substrate-node"><a class="header" href="#substrate-node">Substrate Node:</a></h4>
<p>我们将从 Substrate Node 开始。这是我们可以开始的最高级别；</p>
<p>它提供了最多的预建功能和最少的技术自由度。它是完全可运行的，包括所有基本组件的默认实现，例如:</p>
<ul>
<li>账户管理</li>
<li>特权访问</li>
<li>共识</li>
<li>…</li>
</ul>
<p>我们可以自定义链的创世块（即初始状态）以开始。 在这里，我们可以运行节点并熟悉 Substrate 提供的开箱即用的功能，玩转状态并与正在运行的区块链交互以熟悉。</p>
<p>另一种实现相同目的的方法是使用 <a href="https://substrate.io/developers/playground/">Substrate Playground</a>，您可以在其中查看后端和前端模板以熟悉它们。
然而，一旦我们准备好真正构建自己的区块链，我们最好降低一层并使用 FRAME。</p>
<pre><code class="language-shell">tree bin -L 2 | pbcopy                                                                                                                                                                                                                       ─╯
bin
├── node
│   ├── bench
│   ├── cli
│   ├── executor
│   ├── inspect
│   ├── primitives
│   ├── rpc
│   ├── runtime
│   └── testing
├── node-template: 使用Substrate写项目的基础模版
│   ├── LICENSE
│   ├── README.md
│   ├── docker-compose.yml
│   ├── docs
│   ├── node
│   ├── pallets
│   ├── runtime
│   ├── scripts
│   └── shell.nix
└── utils
    ├── chain-spec-builder
    └── subkey

18 directories, 4 files
</code></pre>
<h5 id="重点说说nodepallets和runtime"><a class="header" href="#重点说说nodepallets和runtime">重点说说node、pallets和runtime</a></h5>
<div id="admonition-nodepalletsruntimes" class="admonition tip">
<div class="admonition-title">
<p>node、pallets、runtimes</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-nodepalletsruntimes"></a></p>
</div>
<div>
<p>│   ├── node: 链的一些基础功能的实现（或者说比较底层的实现，如网络、rpc，搭建链的最基础的code)
│   ├── pallets: 放置的就是各个pallet，也就是业务相关的模块
│   ├── runtime: 可以简单理解为把所有pallet组合到一起，也就是业务相关的逻辑</p>
</div>
</div>
<p>三者的关系大致如下：</p>
<div id="admonition-nodepalletsruntime的关系" class="admonition tip">
<div class="admonition-title">
<p>node、pallets、runtime的关系</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-nodepalletsruntime的关系"></a></p>
</div>
<div>
<pre><code class="language-text">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             ___ _   _ ___ ___ _____ ___    _ _____ ___   _  _  ___  ___  ___             ┃
┃            / __| | | | _ ) __|_   _| _ \  /_\_   _| __| | \| |/ _ \|   \| __|            ┃
┃            \__ \ |_| | _ \__ \ | | |   / / _ \| | | _|  | .` | (_) | |) | _|             ┃
┃            |___/\___/|___/___/ |_| |_|_\/_/ \_\_| |___| |_|\_|\___/|___/|___|            ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ ┃
┃  ┃                         ___ _   _ _  _ _____ ___ __  __ ___                         ┃ ┃
┃  ┃                        | _ \ | | | \| |_   _|_ _|  \/  | __|                        ┃ ┃
┃  ┃                        |   / |_| | .` | | |  | || |\/| | _|                         ┃ ┃
┃  ┃                        |_|_\\___/|_|\_| |_| |___|_|  |_|___|                        ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃    ┌───────────────┐    ┌───────────────┐    ┌───────────────┐   ┌───────────────┐  ┃ ┃
┃  ┃    │               │    │               │    │               │   │               │  ┃ ┃
┃  ┃    │   pallet 1    │    │   pallet 2    │    │      ...      │   │   pallet n    │  ┃ ┃
┃  ┃    │               │    │               │    │               │   │               │  ┃ ┃
┃  ┃    └───────────────┘    └───────────────┘    └───────────────┘   └───────────────┘  ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛ ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
</div>
</div>
<blockquote>
<p>当然，对于pallets来说，在runtime中使用的pallet，有些是我们自己开发的pallet，有些是substrate中已经开发好的pallet，甚至还有些是pallet是第三方开发的pallet。</p>
</blockquote>
<h4 id="substrate-frame"><a class="header" href="#substrate-frame">Substrate FRAME</a></h4>
<p>FRAME (Framework for Runtime Aggregation of Modularized Entities) 是一个框架，用于从现有库构建 Substrate 运行时(Runtime)
，并具有高度的自由度来确定我们的区块链逻辑。</p>
<p>我们基本上是从 Substrate 的预构建节点模板开始，可以添加所谓的托盘（pallet, Substrate 库模块的名称）来定制和扩展我们的链。</p>
<p>在这个抽象级别，我们还能够完全自定义我们区块链的逻辑、状态和数据类型。这当然是大多数旨在接近 Substrate 的基本定制项目在易于开发和技术自由之间利用两全其美的地方。</p>
<div id="admonition-专注定制" class="admonition tip">
<div class="admonition-title">
<p>专注定制</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-专注定制"></a></p>
</div>
<div>
<p>从这个起点开始，我们必须投入最少的时间来建立我们的区块链，并且可以完全专注于我们自己的定制。</p>
</div>
</div>
<p>我们仍然需要在它们到来时采用一些默认值——或者更确切地说，因为它们可以被配置——但是如果我们从根本上想要做不同的事情，我们可以从 Core 开始再降低一步。</p>
<div id="admonition-frame" class="admonition info">
<div class="admonition-title">
<p>FRAME</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-frame"></a></p>
</div>
<div>
<p>The Framework for Runtime Aggregation of Modularized Entities (FRAME) is a set of modules and support libraries that simplify runtime development. 
In Substrate , these modules are called Pallets, each hosting domain-specific logic to include in a chain’s runtime.</p>
<p>FRAME also provides some helper modules to interact with important Substrate Primitives that provide the interface to the core client.</p>
<p>The following diagram shows the architectural overview of FRAME and its support libraries:</p>
</div>
</div>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/frame-arch.png" alt="frame-arch" /></p>
<p><a href="https://docs.substrate.io/v3/runtime/frame/">FRAME | Substrate_</a></p>
<pre><code class="language-shell">tree frame -L 1 | pbcopy
frame
├── alliance: The Alliance Pallet provides a collective that curates a list of accounts and URLs, deemed by the voting members to be unscrupulous actors.
├── assets: A simple, secure module for dealing with fungible assets. The Assets module provides functionality for asset management of fungible asset classes with a fixed supply
├── atomic-swap: A module for atomically sending funds.
├── aura: The Aura module extends Aura consensus by managing offline reporting.
├── authority-discovery: This module is used by the client/authority-discovery to retrieve the current set of authorities.
├── authorship
├── babe
├── bags-list
├── balances: The Balances module provides functionality for handling accounts and balances.
├── beefy
├── beefy-mmr
├── benchmarking
├── bounties
├── child-bounties
├── collective
├── contracts
├── conviction-voting
├── democracy
├── election-provider-multi-phase
├── election-provider-support
├── elections-phragmen
├── examples
├── executive
├── gilt
├── grandpa
├── identity
├── im-online
├── indices
├── lottery
├── membership
├── merkle-mountain-range
├── multisig
├── nicks
├── node-authorization
├── nomination-pools
├── offences
├── preimage
├── proxy
├── randomness-collective-flip
├── ranked-collective
├── recovery
├── referenda
├── remark
├── scheduler
├── scored-pool
├── session
├── society
├── staking
├── state-trie-migration
├── sudo
├── support
├── system
├── timestamp
├── tips
├── transaction-payment
├── transaction-storage
├── treasury
├── try-runtime
├── uniques
├── utility
├── vesting
└── whitelist

62 directories, 0 files

</code></pre>
<h4 id="substrate-coreclient"><a class="header" href="#substrate-coreclient">Substrate Core(client)</a></h4>
<p>Substrate Core 本质上意味着我们可以以任何我们想要的方式实现我们的运行时，只要它以 WebAssembly 为目标并遵守 Substrate 块创建的基本法则。</p>
<p>然后，我们可以使用这个运行时并在 Substrate 节点中运行它。</p>
<div id="admonition-最高自由度" class="admonition info">
<div class="admonition-title">
<p>最高自由度</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-最高自由度"></a></p>
</div>
<div>
<p>这种方法当然需要最多的工作和最高的难度，但它也具有最高的技术自由度，同时仍然能够在 Substrate 生态系统中无缝工作。</p>
</div>
</div>
<p>说到 Substrate 的生态系统，有一个充满活力（充满活力）的开发者社区，他们在自己的项目中使用 Substrate，其中许多人通过共享自己的托盘(pallet)来回馈生态系统。</p>
<p>您可以通过使用诸如 <a href="https://substratemarketplace.com/">Substrate Market</a>
之类的站点或仅在托管 <a href="https://crates.io/">crates.io: Rust Package Registry</a> 的任何地方找到托盘(pallet)，因为 Substrate 托盘本质上是自包含的 Rust
库，您可以将其集成到您的 Substrate 项目中, 并根据需要进行配置。</p>
<p>与任何其他库一样，建议首先审核代码，并了解依赖外部代码与编写自己的代码之间的权衡。</p>
<p>在玩了一点预建节点之后，我们应该专注于 FRAME，学习如何通过在 Substrate 模板节点之上构建自定义区块链。这也是许多精彩教程的起点。</p>
<pre><code class="language-shell"> tree client -L 1 | pbcopy                                                                                                                                                                                                                    ─╯
client
├── allocator
├── api
├── authority-discovery
├── basic-authorship
├── beefy
├── block-builder
├── chain-spec
├── cli
├── consensus
├── db
├── executor
├── finality-grandpa
├── informant
├── keystore
├── network
├── network-gossip
├── offchain
├── peerset
├── proposer-metrics
├── rpc
├── rpc-api
├── rpc-servers
├── service
├── state-db
├── sync-state-rpc
├── sysinfo
├── telemetry
├── tracing
├── transaction-pool
└── utils

30 directories, 0 files
</code></pre>
<h3 id="其他"><a class="header" href="#其他">其他</a></h3>
<h4 id="primitives"><a class="header" href="#primitives">primitives</a></h4>
<pre><code class="language-shell">tree primitives -L 1 | pbcopy
primitives
├── api
├── application-crypto
├── arithmetic
├── authority-discovery
├── authorship
├── beefy
├── block-builder
├── blockchain
├── consensus
├── core
├── database
├── debug-derive
├── externalities
├── finality-grandpa
├── inherents
├── io
├── keyring
├── keystore
├── maybe-compressed-blob
├── merkle-mountain-range
├── npos-elections
├── offchain
├── panic-handler
├── rpc
├── runtime
├── runtime-interface
├── sandbox
├── serializer
├── session
├── staking
├── state-machine
├── std
├── storage
├── tasks
├── test-primitives
├── timestamp
├── tracing
├── transaction-pool
├── transaction-storage-proof
├── trie
├── version
└── wasm-interface

42 directories, 0 files

</code></pre>
<h4 id="scriptsci"><a class="header" href="#scriptsci">scripts/ci</a></h4>
<pre><code class="language-shell">tree scripts/ci | pbcopy
scripts/ci
├── common
│   └── lib.sh
├── deny.toml
├── docker
│   ├── subkey.Dockerfile
│   └── substrate.Dockerfile
├── github
│   ├── check_labels.sh
│   └── generate_changelog.sh
├── gitlab
│   ├── check_runtime.sh
│   ├── check_signed.sh
│   ├── ensure-deps.sh
│   ├── pipeline
│   │   ├── build.yml
│   │   ├── check.yml
│   │   ├── publish.yml
│   │   └── test.yml
│   ├── publish_draft_release.sh
│   └── skip_if_draft.sh
├── monitoring
│   ├── alerting-rules
│   │   ├── alerting-rule-tests.yaml
│   │   └── alerting-rules.yaml
│   └── grafana-dashboards
│       ├── README_dashboard.md
│       ├── substrate-networking.json
│       └── substrate-service-tasks.json
├── node-template-release
│   ├── Cargo.toml
│   └── src
│       └── main.rs
└── node-template-release.sh

10 directories, 23 files

</code></pre>
<h4 id="utils"><a class="header" href="#utils">utils</a></h4>
<pre><code class="language-shell">tree utils -L 1 | pbcopy
utils
├── build-script-utils
├── fork-tree
├── frame
├── prometheus
└── wasm-builder

5 directories, 0 files

</code></pre>
<h2 id="功能逻辑"><a class="header" href="#功能逻辑">功能逻辑</a></h2>
<div id="admonition-注意" class="admonition tip">
<div class="admonition-title">
<p>注意</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-注意"></a></p>
</div>
<div>
<p>这里将结合前面提到的runtim/core分块方式来进行功能模块说明</p>
</div>
</div>
<h2 id="特色代码"><a class="header" href="#特色代码">特色代码</a></h2>
<h2 id="参考资源"><a class="header" href="#参考资源">参考资源</a></h2>
<h3 id="online-book"><a class="header" href="#online-book">online-book</a></h3>
<ul>
<li><a href="https://github.com/paritytech/substrate">paritytech/substrate: Substrate: The platform for blockchain innovators</a></li>
<li><a href="https://docs.substrate.io/v3/getting-started/architecture/">Architecture | Substrate_</a></li>
<li><a href="https://www.bilibili.com/video/BV1KT4y1Y7Uf">substrate轻松学</a></li>
</ul>
<h3 id="fragment"><a class="header" href="#fragment">fragment</a></h3>
<ul>
<li><a href="https://www.zhihu.com/column/c_74315572">链块与分散的数据 - 知乎</a></li>
<li><a href="https://web.archive.org/web/20220627112702/https://mp.weixin.qq.com/s/MP0LXWVqUn5R4C6fAbe1nQ">区块链与substrate</a></li>
<li><a href="https://web.archive.org/web/20220618042220/https://zhuanlan.zhihu.com/p/47805322">substrate 源码解析与运用 - 介绍 - 知乎</a></li>
<li><a href="https://www.zhihu.com/column/substrate">Substrate区块链开发 - 知乎</a></li>
<li><a href="https://substrate.io/ecosystem/">Substrate Ecosystem | Substrate_</a></li>
<li><a href="https://blog.logrocket.com/substrate-blockchain-framework-core-concepts/"><strong>Substrate blockchain development: Core concepts - LogRocket
Blog</strong></a>：对Substrate的简要介绍</li>
<li><a href="https://substrate.io/developers/playground/">Playground | Substrate_</a></li>
<li><a href="https://substratemarketplace.com/">Substrate Market</a></li>
<li><a href="https://crates.io/">crates.io: Rust Package Registry</a></li>
<li><a href="https://docs.substrate.io/quick-start/">Quick start | Substrate Docs</a></li>
<li><a href="https://docs.substrate.io/tutorials/">Tutorials | Substrate Docs</a></li>
<li><a href="https://substrate.io/ecosystem/projects/">Projects | Substrate_</a>: 一些基于Substrate建立的项目，值得参考</li>
<li><a href="https://docs.substrate.io/tutorials/v3/kitties/pt1/">Build the Substrate Kitties Chain | Substrate_</a>: 教你建立一个nft平台</li>
<li><a href="https://docs.substrate.io/v3/runtime/frame/">FRAME | Substrate_</a></li>
<li><a href="https://medium.com/frctls/the-substrate-guide-i-wish-i-had-6bc76b10ddd2">The Substrate Guide I Wish I Had. Fractal’s blockchain lead Shelby… | by Fractal | Fractal | Medium</a></li>
<li><a href="https://docs.substrate.io/reference/how-to-guides/">How-to quick reference guides | Substrate Docs</a></li>
</ul>
<h3 id="runtime-1"><a class="header" href="#runtime-1">Runtime</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220627114404/https://zhuanlan.zhihu.com/p/79539782">剖析Substrate Runtime - 知乎</a>
<blockquote>
<p>基于Substrate开发自己的运行时模块，会遇到一个比较大的挑战，就是理解Substrate运行时（Runtime）。
本文首先介绍了Runtime的架构，类型，常用宏，并结合一个实际的演示项目，做了具体代码分析，以帮助大家更好地理解在Substrate中它们是如何一起工作的。</p>
</blockquote>
</li>
</ul>
<h3 id="local"><a class="header" href="#local">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="漫话rust"><a class="header" href="#漫话rust">漫话Rust</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/1_learning_resource/talks.html#%E6%BC%AB%E8%AF%9Drust">漫话Rust</a>
<ul>
<li><a href="layer5_ecosystem/1_learning_resource/talks.html#%E8%AF%9D%E9%A2%98">话题</a>
<ul>
<li><a href="layer5_ecosystem/1_learning_resource/talks.html#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A7%89%E5%BE%97-rust-%E9%9A%BE%E4%B8%8A%E6%89%8B%E5%B0%A4%E5%85%B6%E6%98%AF%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F---%E7%9F%A5%E4%B9%8E">为什么觉得 Rust 难上手，尤其是生命周期？ - 知乎</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:41 UTC 2022 -->
<!--te-->
<h2 id="话题"><a class="header" href="#话题">话题</a></h2>
<h3 id="为什么觉得-rust-难上手尤其是生命周期---知乎"><a class="header" href="#为什么觉得-rust-难上手尤其是生命周期---知乎">为什么觉得 Rust 难上手，尤其是生命周期？ - 知乎</a></h3>
<ul>
<li><a href="https://www.zhihu.com/question/537491826">为什么觉得 Rust 难上手，尤其是生命周期？ - 知乎</a></li>
</ul>
<div id="admonition-把技巧掺杂在上手过程里" class="admonition quote">
<div class="admonition-title">
<p>把技巧掺杂在上手过程里</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/1_learning_resource/talks.html#admonition-把技巧掺杂在上手过程里"></a></p>
</div>
<div>
<p>因为其他语言上手真的就只是上手而已，你还得买《Effective Xxxx》甚至《More Effective Xxxx》，以及《Xxx并发编程》《深入理解Xxx虚拟机》等等各种书籍来学习各种避坑、省力、debug技巧。而Rust的上手是把这些技巧直接掺在上手过程里了，编译器以及配套工具（比如错误提示里的help，fmt、clippy）逼着你把代码写对，上手Rust等于同时被迫学会了这一堆技巧。</p>
</div>
</div>
<div id="admonition-区分编译期抽象和运行期抽象" class="admonition quote">
<div class="admonition-title">
<p>区分编译期抽象和运行期抽象</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/1_learning_resource/talks.html#admonition-区分编译期抽象和运行期抽象"></a></p>
</div>
<div>
<ol>
<li>学习 rust 上手难一般是因为缺乏丰富的 Cpp 经验。因此，大家会对【胖指针】【瘦指针】【虚表 vtable 】等基础概念缺少深刻的理解。而这些概念正是区分 rust 中【编译期间-抽象 — 单态化】与【运行期间-抽象 — <code>trait Object</code> 】的认知“门槛”。</li>
<li>另一方面，学习lifetime 上手难是因为大家已经习惯了“颐指气使”地向计算机“发号施令”和下达指示了。</li>
<li>但是， lifetime  完全是另一码事。就【生命周期】而言， rustc 的角色是【仲裁者】，而不是【执行者】。</li>
</ol>
<blockquote>
<p>【生命周期·标注】被设计用来：由 @程序员 向【仲裁者 rustc 】表述自己的代码设计意图（这些意图通过直接扫描代码不容易被揣测出来）。然后，再由【仲裁者】判断你的代码意图是否可行，因为代码首先得足够安全。</p>
</blockquote>
<p>所以，你不能命令 rustc ：我要求某某变量一定得活多长时间（一切皆可操控，那是 Cpp）；而是，询问 rustc ：我如此设计代码，想让某某变量活这么长时间，你看行得通吗？若 rustc 判定行不通，那么一个编译错误就等着你了。</p>
<p>比如说，函数的【生命周期_泛型参数】是被用来将</p>
<ol>
<li>引用类型的函数入参的生命周期与</li>
<li>引用类型的函数返回值的生命周期关联起来。</li>
</ol>
<p>以便，在对代码做【静态分析】时，编译器能够根据（已知）入参推断出函数返回值的生命周期。</p>
<blockquote>
<p>这是帮助编译器理解咱们代码的“脚注”，而不是给编译器下达的“指示”。得和 <code>rustc</code> “商量”着来。</p>
</blockquote>
</div>
</div>
<div id="admonition-对c不熟悉" class="admonition quote">
<div class="admonition-title">
<p>对C++不熟悉</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/1_learning_resource/talks.html#admonition-对c不熟悉"></a></p>
</div>
<div>
<p>最直接的原因就是对C++不熟悉，如果你明白移动语义，完美转发，智能指针这些东西。Rust也不过是强制我们在正确使用C++里面的某些工具而已。</p>
</div>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="底层抽象"><a class="header" href="#底层抽象">底层抽象</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/layer1_underlying_abstract.html#%E5%BA%95%E5%B1%82%E6%8A%BD%E8%B1%A1">底层抽象</a></li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:35 UTC 2022 -->
<!--te--><div style="break-before: page; page-break-before: always;"></div><!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html#%E4%BB%8B%E7%BB%8D">介绍</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/virtual_memory.html#local">local</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:32 UTC 2022 -->
<!--te-->
<h2 id="介绍"><a class="header" href="#介绍">介绍</a></h2>
<p>从计算机组成原理了解到操作系统，当一个程序开始运行的时候，不论是可执行程序还是命令行，都会从创建进程，申请进程资源开始，再到堆栈(stack/heap)
的使用，申请与释放资源。这一系列操作对于编程来说重要性不言而喻，只不过根据编程语言的高级程度不同，开发者需要掌握的知识也有不同。</p>
<p>而在rust语言编程中，内存的管理方式及其重要。所以这一层主要先介绍虚拟内存管理以及相关出现的内容安全问题，接着介绍rust是如何通过所有权、作用域和生命周期，引申出借用、移动语义、复制语义等一系列内容来解决内存安全问题。</p>
<h2 id="参考资源-1"><a class="header" href="#参考资源-1">参考资源</a></h2>
<h3 id="online-book-1"><a class="header" href="#online-book-1">online-book</a></h3>
<h3 id="fragment-1"><a class="header" href="#fragment-1">fragment</a></h3>
<h3 id="local-1"><a class="header" href="#local-1">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="内存管理与内存安全"><a class="header" href="#内存管理与内存安全">内存管理与内存安全</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B8%8E%E5%86%85%E5%AD%98%E5%AE%89%E5%85%A8">内存管理与内存安全</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html#%E5%8F%82%E8%80%83">参考</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/memory_manage_safety.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:31 UTC 2022 -->
<!--te-->
<h2 id="参考"><a class="header" href="#参考">参考</a></h2>
<h3 id="online-book-2"><a class="header" href="#online-book-2">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/memory-model.html">Memory model - The Rust Reference</a></li>
</ul>
<h3 id="fragment-2"><a class="header" href="#fragment-2">fragment</a></h3>
<ul>
<li><a href="https://segmentfault.com/a/1190000020338427">Go内存分配那些事，就这么简单！ - SegmentFault 思否</a></li>
</ul>
<h3 id="local-2"><a class="header" href="#local-2">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="所有权三件套所有权借用与生命周期"><a class="header" href="#所有权三件套所有权借用与生命周期">所有权三件套：所有权、借用与生命周期</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Ownership.jpeg" alt="Ownership" /></p>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E6%89%80%E6%9C%89%E6%9D%83%E4%B8%89%E4%BB%B6%E5%A5%97%E6%89%80%E6%9C%89%E6%9D%83%E5%80%9F%E7%94%A8%E4%B8%8E%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">所有权三件套：所有权、借用与生命周期</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%BB%BC%E8%BF%B0">综述</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E6%89%80%E6%9C%89%E6%9D%83">所有权</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E8%B5%84%E6%BA%90%E6%89%80%E6%9C%89%E8%80%85">资源所有者</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E8%B5%84%E6%BA%90%E6%89%80%E6%9C%89%E8%80%85%E8%B4%9F%E8%B4%A3%E9%87%8A%E6%94%BE">资源所有者负责释放</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%8A%A8%E6%80%81%E8%AF%AD%E8%A8%80%E9%9D%A0gc%E5%9C%A8%E8%BF%90%E8%A1%8C%E6%9C%9F%E5%A4%84%E7%90%86">动态语言靠GC在运行期处理</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E9%9D%99%E6%80%81%E8%AF%AD%E8%A8%80%E5%9C%A8%E7%BC%96%E8%AF%91%E6%9C%9F%E8%A7%84%E5%AE%9A">静态语言在编译期规定</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#rust%E7%9A%84%E6%89%80%E6%9C%89%E6%9D%83%E8%A7%84%E5%88%99">Rust的所有权规则</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E6%8F%A3%E6%91%A9%E6%89%80%E6%9C%89%E6%9D%83%E5%90%AB%E4%B9%89">揣摩所有权含义</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%89%80%E6%9C%89%E6%9D%83%E8%80%83%E8%99%91%E5%9B%A0%E7%B4%A0">作用域：所有权考虑因素</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%A4%9A%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84%E6%83%85%E5%86%B5%E5%88%86%E6%9E%90">多作用域的情况分析</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%98%AF%E6%8E%A8%E6%96%AD%E6%89%80%E6%9C%89%E6%9D%83%E6%97%B6%E7%9A%84%E4%B8%80%E4%B8%AA%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7">作用域是推断所有权时的一个重要属性</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%BC%95%E5%85%A5%E7%A7%BB%E5%8A%A8%E5%92%8C%E5%A4%8D%E5%88%B6%E8%AF%AD%E4%B9%89">引入移动和复制语义</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E8%AF%AD%E4%B9%89%E6%98%AF%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D">语义是什么意思</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89%E5%8F%98%E9%87%8F%E8%AE%BF%E9%97%AE%E6%88%96%E9%87%8D%E6%96%B0%E5%88%86%E9%85%8D%E6%97%B6%E9%BB%98%E8%AE%A4">移动语义：变量访问或重新分配时默认</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%A4%8D%E5%88%B6%E8%AF%AD%E4%B9%89">复制语义</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BD%BF%E7%94%A8copy%E7%89%B9%E5%BE%81%E6%9B%B4%E6%94%B9%E8%AF%AD%E4%B9%89">使用Copy特征更改语义</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#copy-%E7%89%B9%E5%BE%81%E4%BE%9D%E8%B5%96%E4%BA%8Eclone-%E7%89%B9%E5%BE%81">Copy 特征依赖于Clone 特征</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%8C%BA%E5%88%AB%E4%B8%80%E4%B8%8Bcopy%E4%B8%8Eclone-trait">区别一下Copy与Clone trait</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#copy">Copy</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#clone">Clone</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#copy%E4%B8%8Eclone%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%88%99">Copy与Clone的使用原则</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BD%95%E6%97%B6%E5%9C%A8%E7%B1%BB%E5%9E%8B%E4%B8%8A%E5%AE%9E%E7%8E%B0-copy">何时在类型上实现 Copy</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BD%95%E6%97%B6%E5%9C%A8%E7%B1%BB%E5%9E%8B%E4%B8%8A%E5%AE%9E%E7%8E%B0-clone">何时在类型上实现 Clone。</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E6%89%80%E6%9C%89%E6%9D%83%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">所有权使用场景</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#let%E7%BB%91%E5%AE%9A%E7%A4%BA%E4%BE%8B">let绑定示例</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%B0%86%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E7%BB%99%E5%87%BD%E6%95%B0">将参数传递给函数</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#match%E8%A1%A8%E8%BE%BE%E5%BC%8F">match表达式</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#impl%E4%BB%A3%E7%A0%81%E5%9D%97">impl代码块</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E9%97%AD%E5%8C%85">闭包</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%80%9F%E7%94%A8-%E9%80%9A%E8%BF%87%E5%BC%95%E7%94%A8%E8%A7%84%E9%81%BF%E6%89%80%E6%9C%89%E6%9D%83%E8%A7%84%E5%88%99%E9%99%90%E5%88%B6">借用: 通过引用规避所有权规则限制</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%B8%BA%E4%BD%95%E9%9C%80%E8%A6%81%E5%80%9F%E7%94%A8%E5%BC%95%E7%94%A8">为何需要借用/引用</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%80%9F%E7%94%A8-or-%E5%BC%95%E7%94%A8">借用 or 引用？</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%B8%A4%E7%A7%8D%E5%80%9F%E7%94%A8%E6%96%B9%E5%BC%8F">两种借用方式</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%B8%8D%E5%8F%AF%E5%8F%98%E5%80%9F%E7%94%A8">不可变借用：&amp;</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%8F%AF%E5%8F%98%E5%80%9F%E7%94%A8mut">可变借用：&amp;mut</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%80%9F%E7%94%A8%E8%A7%84%E5%88%99">借用规则</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%A6%82%E6%9E%9C%E8%BF%9D%E5%8F%8D%E5%80%9F%E7%94%A8%E8%A7%84%E5%88%99">如果违反借用规则</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84%E5%80%9F%E7%94%A8">函数中的借用</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%8C%B9%E9%85%8D%E4%B8%AD%E7%9A%84%E5%80%9F%E7%94%A8">匹配中的借用</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BB%8E%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%BC%95%E7%94%A8">从函数返回引用：</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%9F%BA%E4%BA%8E%E5%80%9F%E7%94%A8%E8%A7%84%E5%88%99%E7%9A%84%E6%96%B9%E6%B3%95%E7%B1%BB%E5%9E%8B">基于借用规则的方法类型</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%88%E5%AF%B9%E5%BC%95%E7%94%A8%E9%99%84%E5%8A%A0%E7%9A%84%E4%BF%A1%E6%81%AF">生命周期：针对引用附加的信息</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E4%BB%8E%E5%8F%98%E9%87%8F%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%BC%80%E5%A7%8B">从变量生命周期开始</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%99%90%E5%AE%9A">生命周期限定</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B3%A8%E8%A7%A3">生命周期注解</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9C%81%E7%95%A5lifetime-elision">生命周期省略(Lifetime Elision)</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E9%94%80%E6%AF%81destructors">销毁(Destructors)</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:32 UTC 2022 -->
<!--te-->
<h2 id="综述"><a class="header" href="#综述">综述</a></h2>
<pre><code class="language-text">┌───────────────────────────────────┐
│                                   │
│                                   │
│         .───────.       ┌──────┐  │
│       ,'         `.     │Borrow│  │
│     ,'             `.   └──────┘  │
│    ;   ┌─────────┐   :            │
│    │   │OwnerShip│   │            │
│    │   └─────────┘   │            │
│    :     ┌─────┐     ; ┌────────┐ │
│     ╲    │Scope│    ╱  │Lifetime│ │
│      `.  └─────┘  ,'   └────────┘ │
│        `.       ,'                │
│          `─────'                  │
│                                   │
│                                   │
└───────────────────────────────────┘
</code></pre>
<p>所有权、作用域、借用与生命周期是 Rust 的内存安全及其零成本抽象原则的核心。 它们让 Rust 能够在编译期检测程序中内存安全违规,在离开作用域时自动释放相关资源等情况。
所有权有点类似核心原则,而借用和生命周期是对语言类型系统的扩展。在代码的不同上下文中加强或有时放松所有权原则,可确保编译期内存管理正常运作。</p>
<h2 id="所有权"><a class="header" href="#所有权">所有权</a></h2>
<h3 id="资源所有者"><a class="header" href="#资源所有者">资源所有者</a></h3>
<p>程序中资源的真正所有者的概念因语言而异。这里的含义是通过资源, 主要包含下列内容：</p>
<ol>
<li>共同引用在堆或堆栈上保存值的任何变量</li>
<li>或者是包含打开文件描述符、数据库连接套接字、网络套接字及类似内容的变量。</li>
</ol>
<p>从它们存在到完成程序调用及其之后的时间,都会占用一些内存。</p>
<h3 id="资源所有者负责释放"><a class="header" href="#资源所有者负责释放">资源所有者负责释放</a></h3>
<blockquote>
<p>资源所有者的一个重要职责就是明智地释放它们使用的内存,因为如果无法在适当的位置和时间执行取消内存分配,就可能导致内存泄漏。</p>
</blockquote>
<h4 id="动态语言靠gc在运行期处理"><a class="header" href="#动态语言靠gc在运行期处理">动态语言靠GC在运行期处理</a></h4>
<p>在使用 Python 等动态语言编程时,可以将多个所有者或别名添加到 list 对象中,从而使用执行该对象的众多变量之一添加或删除 list 中的项目。变量不需要关心如何释放对象使用过的内存,因为 GC
会处理这些事情,并且一旦指向对象的所有引用都消失,GC 就会释放相关的内存。</p>
<h4 id="静态语言在编译期规定"><a class="header" href="#静态语言在编译期规定">静态语言在编译期规定</a></h4>
<p>对于 C/C++/Golang之类的编译语言,在智能指针出现之前,程序库对代码使用完毕的相关资源 API 的调用方或者被调用方是否负责释放内存有明确的规定。存在这些规则是因为编译器不会在这些语言中强制限定所有权。在
C++中不使用智能指针仍然有可能出现问题。在C++中,存在多个变量指向堆上的某个值是完全没问题的(尽管我们不建议这么做) ,这就是所谓的别名。由于具有指向资源的多个指针或别名的灵活性,程序员会遇到各种各样的问题,其中之一就是
C++中的迭代器失效问题。</p>
<blockquote>
<p>具体而言,当给定作用域中资源的其他不可变别名相对存在至少一个可变别名时,就会出现问题</p>
</blockquote>
<h3 id="rust的所有权规则"><a class="header" href="#rust的所有权规则">Rust的所有权规则</a></h3>
<p>Rust 试图为程序中值的所有权设定适当的语义。Rust 的所有权规则遵循以下原则。</p>
<ul>
<li>使用 let 语句创建值或资源,并将其分配给变量时,该变量将成为资源的所有者。</li>
<li>当值从一个变量重新分配给另一个变量时, 值的所有权将转移至另一个变量, 原来的变量将失效以便另作他用。</li>
<li>值和变量在其作用域的末尾会被清理、释放。</li>
</ul>
<h3 id="揣摩所有权含义"><a class="header" href="#揣摩所有权含义">揣摩所有权含义</a></h3>
<p>需要注意的是,Rust 中的值只有一个所有者,即创建它们的变量。其理念很简单,但是它的含义值得揣摩：</p>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_basics.rs

#[derive(Debug)]
struct Foo(u32);

fn main() {
    // 根据所有权规则, foo 是 Foo 实例的所有者
    let foo = Foo(2048);
    /*
        bar 成为Foo 实例的新所有者, 而旧的 foo 是一个废弃变量.
        经过此变动之后不能在其他任何地方使用
    */
    let bar = foo; // value moved here
    /*
        每当我们将变量分配给某个其他变量或从变量读取数据时,Rust 会默认移动变量指向的值。
        所有权规则可以防止你通过多个访问点来修改值,这可能导致访问已被释放的变量.
        即使在单线程上下文中,使用允许多个值的可变别名的语言也是如此
    */
    println!(&quot;Foo is {:?}&quot;, foo);  // value borrowed here after move
    println!(&quot;Bar is {:?}&quot;, bar);
}
</code></pre></pre>
<p>每当我们将变量分配给某个其他变量或从变量读取数据时,Rust 会默认移动变量指向的值。所有权规则可以防止你通过多个访问点来修改值,这可能导致访问已被释放的变量,即使在单线程上下文中,使用允许多个值的可变别名的语言也是如此</p>
<h3 id="作用域所有权考虑因素"><a class="header" href="#作用域所有权考虑因素">作用域：所有权考虑因素</a></h3>
<blockquote>
<p>为了分析某个值何时超出作用域,所有权规则还会考虑变量的作用域</p>
</blockquote>
<ol>
<li>在 Rust 的背景下, 所有权与作用域协同工作。</li>
<li>因此,作用域只不过是变量和值存在的环境。你声明的每个变量都与作用域有关。</li>
<li>代码中的作用域是由一对花括号表示的。无论何时使用块表达式都会创建一个作用域,即任何以花括号开头和结尾的表达式。</li>
<li>此外,作用域支持互相嵌套,并且可以在子作用域中访问父作用域的元素,但反过来不行</li>
</ol>
<h4 id="多作用域的情况分析"><a class="header" href="#多作用域的情况分析">多作用域的情况分析</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// scopes.rs

/*
由于函数可以创建新的作用域, 因此 main 函数引入了根级别作用域 0,
在代码中定义为 level_0_str
*/
fn main() {
    let level_0_str = String::from(&quot;foo&quot;);
    /*
        在 0 级作用域中, 创建了一个新的作用域,即作用域 1,
        并且带有一个花括号,其中包含变量level_1_number。
    */
    {
        let level_1_number = 9;
        /*
            在 1 级作用域中, 创建了一个块表达式, 它成为 2 级作用域。
            在其中, 声明了另一个变量 level_2_vector,
            以便可以将 level_1_number 添加到其中,
            而level_1_number 来自其父级作用域 1
        */
        {
            let mut level_2_vector = vec![1, 2, 3];
            level_2_vector.push(level_1_number);    // can access
        } // level_2_vector goes out of scope here 

        level_2_vector.push(4);    // no longer exists
    } // level_1_number goes out of scope here
} // level_0_str goes out of scope here
</code></pre></pre>
<h4 id="作用域是推断所有权时的一个重要属性"><a class="header" href="#作用域是推断所有权时的一个重要属性">作用域是推断所有权时的一个重要属性</a></h4>
<blockquote>
<p>作用域还会被用来推断后续介绍的借用和生命周期。</p>
</blockquote>
<ol>
<li>当作用域结束时,拥有值的任何变量都会运行相关代码以取消分配该值,并且其自身在作用域之外是无效的。</li>
<li>特别是对在堆上分配的值,drop 方法会被放在作用域结束标记}之前调用。</li>
<li>这类似于在 C 语言中调用 free 函数,但这里是隐式的, 并且可以避免程序员忘记释放值。</li>
<li>drop 方法来自 Drop 特征,它是为 Rust 中大部分堆分配类型实现的,可以轻松地自动释放资源。</li>
</ol>
<h3 id="引入移动和复制语义"><a class="header" href="#引入移动和复制语义">引入移动和复制语义</a></h3>
<blockquote>
<p>结合作用域判断一下下列代码是否正确</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_primitives.rs

fn main() {
    let foo = 4623;
    /*
        4623 的所有权不会从 foo 转移到 bar,但 bar 会获得4623 的单独副本。
        看起来基元类型在 Rust 中会被特殊对待,它们会被移动而不是复制。
        这意味着根据我们在 Rust 中使用的类型,存在不同的所有权语义,这将引入移动和复制语义的概念
    */
    let bar = foo;
    println!(&quot;{:?} {:?}&quot;, foo, bar); 
}
</code></pre></pre>
<h4 id="语义是什么意思"><a class="header" href="#语义是什么意思">语义是什么意思</a></h4>
<p>以移动语义为例，在 Rust
中,变量绑定默认具有移动语义。但这究竟意味着什么?要理解这一点,我们需要考虑如何在程序中使用变量。我们创建值或资源并将它们分配给变量,以便在程序中可以方便地引用它们。这些变量是指向值所在内存地址的名称。现在,诸如读取、赋值、添加及将它们传递给函数等对变量的操作,在访问变量指向值的方式上可能具有不同的语义或含义。在静态类型语言中,这些语义大致分为移动语义和复制语义。</p>
<h4 id="移动语义变量访问或重新分配时默认"><a class="header" href="#移动语义变量访问或重新分配时默认">移动语义：变量访问或重新分配时默认</a></h4>
<blockquote>
<p>通过变量访问或重新分配给变量时移动到接收项的值表示移动语义。</p>
</blockquote>
<p>由于Rust 的仿射类型系统,它默认会采用移动语义。仿射类型系统的一个突出特点是值或资源只能使用一次,而 Rust 通过所有权规则展示此属性。</p>
<h4 id="复制语义"><a class="header" href="#复制语义">复制语义</a></h4>
<p>默认情况下,通过变量分配或访问,以及从函数返回时复制的值(例如按位复制)具有复制语义。这意味着该值可以使用任意次数,每个值都是全新的。</p>
<h4 id="使用copy特征更改语义"><a class="header" href="#使用copy特征更改语义">使用Copy特征更改语义</a></h4>
<p>Rust 中的移动语义有时会受到限制。幸运的是,通过实现 Copy 特征可以更改类型的行为以遵循复制语义。基元和其他仅适用于堆栈的数据类型在默认情况下实现了上述特征,这也是前面的基元代码能够正常工作的原因</p>
<pre><pre class="playground"><code class="language-rust  editable">// making_copy_types.rs

#[derive(Copy, Debug)]  // the trait `Clone` is not implemented for `Dummy`
struct Dummy;

fn main() {
    let a = Dummy;
    let b = a;
    println!(&quot;{:?}&quot;, a);
    println!(&quot;{:?}&quot;, b);
}
</code></pre></pre>
<h4 id="copy-特征依赖于clone-特征"><a class="header" href="#copy-特征依赖于clone-特征">Copy 特征依赖于Clone 特征</a></h4>
<blockquote>
<p>Clone 是 Copy 的父级特征, 任何实现 Copy 特征的类型必须实现 Clone。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// making_copy_types.rs

// 可以在派生注释中的 Copy 旁边添加 Clone 特征来让该示例通过编译
#[derive(Copy, Clone, Debug)]
struct Dummy;

fn main() {
    let a = Dummy;
    let b = a;
    println!(&quot;{:?}&quot;, a);
    println!(&quot;{:?}&quot;, b);
}
</code></pre></pre>
<h3 id="区别一下copy与clone-trait"><a class="header" href="#区别一下copy与clone-trait">区别一下Copy与Clone trait</a></h3>
<blockquote>
<p>Copy 和 Clone 特征传达了在代码中使用类型时如何进行复制的原理。</p>
</blockquote>
<p>|特征|复制方式|复制内容|使用场景|
|::----|:--:--------|:--:--------|:--:--------|
|Copy|隐式，自动化特征|堆栈|可以在堆栈上单独表示的小型值|
|Clone|显式调用clone|堆+栈|在堆上还包含一个值作为其表示的一部分|</p>
<h4 id="copy"><a class="header" href="#copy">Copy</a></h4>
<ol>
<li>Copy 特征通常用于可以在堆栈上完全表示的类型, 也就是说它们自身没有任何部分位于堆上。</li>
<li>如果出现了这种情况,那么 Copy 将是开销很大的操作,因为它必须从堆中复制值。这直接影响到赋值运算符的工作方式。</li>
<li>如果类型实现了 Copy,则从一个变量到另一个变量的赋值操作将隐式复制数据。</li>
</ol>
<h4 id="clone"><a class="header" href="#clone">Clone</a></h4>
<p>Clone 特征用于显式复制, 并附带 clone 方法, 类型可以实现该方法以获取自身的副本</p>
<p>Clone 有一个名为 clone 的方法,用于获取接收者的不可变引用,即&amp;self,并返回相同类型的新值。用户自定义类型或任何需要提供能够复制自身的包装器类型,应通过实现clone 方法来实现 Clone 特征</p>
<blockquote>
<p>一个通过 Clone 特征复制类型的示例</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// explicit_copy.rs

// 在 derive 属性中添加了一个 Clone 特征。
#[derive(Clone, Debug)]
struct Dummy {
    items: u32,
}

fn main() {
    let a = Dummy { items: 54 };
    // 有了Clone, 我们就可以在 a 上调用 clone 方法来获得它的新副本
    let b = a.clone();
    println!(&quot;a: {:?}, b: {:?}&quot;, a, b);
}
</code></pre></pre>
<h3 id="copy与clone的使用原则"><a class="header" href="#copy与clone的使用原则">Copy与Clone的使用原则</a></h3>
<h4 id="何时在类型上实现-copy"><a class="header" href="#何时在类型上实现-copy">何时在类型上实现 Copy</a></h4>
<blockquote>
<p>可以在堆栈上单独表示的小型值如下所示。</p>
</blockquote>
<ul>
<li>如果类型仅依赖于在其上实现了 Copy 特征的其他类型, 则 Copy 特征是为其隐式实现的。</li>
<li>Copy 特征隐式影响赋值运算符的工作方式。 使用 Copy 特征构建自定义外部可见类型需要考虑它是否会对赋值运算符产生影响。 如果在开发的早期阶段,
你的类型是Copy,后续将它移除之后则会影响使用该类型进行赋值的所有环节。你可以通过这种方式轻松地破坏 API。</li>
</ul>
<h4 id="何时在类型上实现-clone"><a class="header" href="#何时在类型上实现-clone">何时在类型上实现 Clone。</a></h4>
<ul>
<li>Clone 特征只是声明一个 clone 方法,需要被显式调用。</li>
<li>如果你的类型在堆上还包含一个值作为其表示的一部分, 那么可选择实现 Clone 特征,这也需要向复制堆数据的用户明确表示。</li>
<li>如果要实现智能指针类型(例如引用计数类型) ,那么应该在类型上实现 Clone 特征,以便仅复制堆栈上的指针。</li>
</ul>
<h3 id="所有权使用场景"><a class="header" href="#所有权使用场景">所有权使用场景</a></h3>
<blockquote>
<p>重要的是我们能够识别它和编译器给出的错误提示信息</p>
</blockquote>
<h4 id="let绑定示例"><a class="header" href="#let绑定示例">let绑定示例</a></h4>
<h4 id="将参数传递给函数"><a class="header" href="#将参数传递给函数">将参数传递给函数</a></h4>
<blockquote>
<p>如果将参数传递给函数,那么相同的所有权规则也同样有效</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_functions.rs

fn take_the_n(n: u8) {}

fn take_the_s(s: String) {}

fn main() {
    let n = 5;
    let s = String::from(&quot;string&quot;);
    // take_the_n 函数能够正常工作,是因为 u8(基元类型)实现了 Copy 特征
    take_the_n(n);
    /*
        String 并没有实现 Copy 特征,因此值的所有权在 take_the_s 函数中会发生移动。
        当函数返回时,相关值的作用域也随之结束,并且会在 s 上调用 drop 方法,
        这会释放 s 所使用的堆内存。
        因此,在函数调用结束后 s 将失效
        使用clone即可通过编译：take_the_s(s.clone())
    */
    take_the_s(s);

    println!(&quot;n is {}&quot;, n);
    println!(&quot;s is {}&quot;, s);
}
</code></pre></pre>
<blockquote>
<p>如果我们只需要变量 s 的读取访问权限,那么可以让该代码正常工作的另一种方法是将字符串 s 传递回 main 函数</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_functions_back.rs

fn take_the_n(n: u8) {}

// 添加了一个返回类型
fn take_the_s(s: String) -&gt; String {
    println!(&quot;inside function: {}&quot;, s);
    // 并将传递的字符串返回给调用者
    s
}

fn main() {
    let n = 5;
    let s = String::from(&quot;string&quot;);

    take_the_n(n);
    let s = take_the_s(s);

    println!(&quot;n is {}&quot;, n);
    println!(&quot;s is {}&quot;, s);
}
</code></pre></pre>
<h4 id="match表达式"><a class="header" href="#match表达式">match表达式</a></h4>
<blockquote>
<p>在 match 表达式中,移动类型默认也会被移动</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_match.rs

#[derive(Debug)]
enum Food {
    Cake,
    Pizza,
    Salad,
}

#[derive(Debug)]
struct Bag {
    food: Food,
}

fn main() {
    let bag = Bag { food: Food::Cake };
    match bag.food {
        Food::Cake =&gt; println!(&quot;I got cake&quot;),
        a =&gt; println!(&quot;I got {:?}&quot;, a) // value partially moved here
    }

    println!(&quot;{:?}&quot;, bag); // value borrowed here after partial move
}
</code></pre></pre>
<h4 id="impl代码块"><a class="header" href="#impl代码块">impl代码块</a></h4>
<blockquote>
<p>impl 代码块中,任何以 self 作为第一个参数的方法都将获取调用该方法的值的所有权。这意味着对值调用方法后,你无法再次使用该值</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_methods.rs

struct Item(u32);

impl Item {
    fn new() -&gt; Self {
        Item(1024)
    }
    /*
        以 self 作为第 1 个参数的实例方法。
        在调用之后, 它将在方法内移动, 并在函数作用域结束时被释放。
        后续我们将不能再使用它
    */
    fn take_item(self) {
        // does nothing
    }
}

fn main() {
    let it = Item::new(); // move occurs because `it` has type `Item`, which does not implement the `Copy` trait
    it.take_item(); // `it` moved due to this method call
    println!(&quot;{}&quot;, it.0); // value borrowed here after move
}
</code></pre></pre>
<h4 id="闭包"><a class="header" href="#闭包">闭包</a></h4>
<blockquote>
<p>闭包接收不同的值取决于在其内部使用变量的方式</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_closures.rs

#[derive(Debug)]
struct Foo;

fn main() {
    let a = Foo;

    /*
        Foo 的所有权在闭包中已经默认移动到了 b,
        用户将无法再次访问 a。
    */
    // let closure = move || {
    let closure = || {
        let b = a;
    };

    println!(&quot;{:?}&quot;, a);
}
</code></pre></pre>
<h2 id="借用-通过引用规避所有权规则限制"><a class="header" href="#借用-通过引用规避所有权规则限制">借用: 通过引用规避所有权规则限制</a></h2>
<h3 id="为何需要借用引用"><a class="header" href="#为何需要借用引用">为何需要借用/引用</a></h3>
<p>Rust的所有权规则非常严格, 因为它只允许我们使用类型一次。 如果函数只需要对值的读取访问权限,那么我们需要再次从函数返回值,或者在它传递给函数之前复制它。如果类型没有实现 Clone 特征,那么后者可能无法实现其目的。
复制类型看起来似乎很容易绕过所有权规则,但是由于 Clone 总是复制类型,可能会调用内存分配器 API,这是一种涉及系统调用,并且开销高昂的操作,因此它无法满足零成本抽象承诺的所有要点。 随着移动语义和所有权规则的实施,在 Rust
中编写程序很快就会变得困难重重。幸运的是,我们引入了借用和引用类型的概念,它们放宽了规则所施加的限制,但仍然能够在编译期确保兼容所有权规则。</p>
<p>借用的概念是规避所有权规则的限制。进行借用时,你不会获取值的所有权,而是根据需要提供数据。这是通过借用值,即获取值的引用来实现的。为了借用值,我们需要将运算符&amp;放在变量之前,&amp;表示指向变量的地址。</p>
<h3 id="借用-or-引用"><a class="header" href="#借用-or-引用">借用 or 引用？</a></h3>
<h3 id="两种借用方式"><a class="header" href="#两种借用方式">两种借用方式</a></h3>
<h4 id="不可变借用"><a class="header" href="#不可变借用">不可变借用：&amp;</a></h4>
<blockquote>
<p>当我们在类型之前使用运算符&amp;时,就会创建一个不可变借用。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_basics.rs

#[derive(Debug)]
struct Foo;

fn main() {
    let foo = Foo;
    /*
        注意变量 foo 之前的&amp;。我们借用 foo 并将借用结果分配给 bar。
        bar 的类型为&amp;Foo, 这是一种引用类型。
        作为一个不可变借用,我们不能通过 bar 改变 Foo 中的值
     */
    let bar = &amp;foo;
    println!(&quot;Foo is {:?}&quot;, foo);
    println!(&quot;Bar is {:?}&quot;, bar);
}
</code></pre></pre>
<h4 id="可变借用mut"><a class="header" href="#可变借用mut">可变借用：&amp;mut</a></h4>
<blockquote>
<p>可以使用&amp;mut 运算符对某个值进行可变借用。 通过可变借用, 你可以改变该值。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// mutable_borrow.rs

fn main() {
    // 可变借用需要可变变量，所以这里会报错，可以加上mut
    let a = String::from(&quot;Owned string&quot;);
    /*
        用&amp;mut a 创建了一个该值的可变借用。
        这并没有将 a 移动到 b
        只是可变地对它借用。
    */
    let a_ref = &amp;mut a;
    a_ref.push('!');
}
</code></pre></pre>
<blockquote>
<p>可变借用可以改变值,但是不能销毁该值,因为它不是所有者。
如果a 在借用它的代码行之前被销毁,则借用失效</p>
</blockquote>
<p>{{#check 检查是否更新 | 借用失效情况并不存在}}</p>
<pre><pre class="playground"><code class="language-rust  editable">// exclusive_borrow.rs

fn main() {
    let mut a = String::from(&quot;Owned string&quot;);
    let a_ref = &amp;mut a;
    a_ref.push('!');
    println!(&quot;{}&quot;, a);
}
</code></pre></pre>
<div id="admonition-bug" class="admonition bug">
<div class="admonition-title">
<p>Bug</p>
<p><a class="admonition-anchor-link" href="layer1_underlying_abstract/1_virtual_memory/ownership_borrow_lifetime.html#admonition-bug"></a></p>
</div>
<div>
<p>(存疑🤨，待修正🤔️)</p>
</div>
</div>
<h3 id="借用规则"><a class="header" href="#借用规则">借用规则</a></h3>
<blockquote>
<p>通过引用来维护单一的所有权语义。这些规则如下所示</p>
</blockquote>
<ol>
<li>一个引用的生命周期可能不会超过其被引用的时间。 这是显而易见的, 因为如果它的生命周期超过其被借用的时间,那么它将指向一个垃圾值(被销毁的值) 。</li>
<li>如果存在一个值的可变借用,那么不允许其他引用(可变借用或不可变借用)在该作用域下指向相同的值。可变借用是一种独占性借用。</li>
<li>如果不存在指向某些东西的可变借用, 那么在该作用域下允许出现对同一值的任意数量的不可变借用</li>
</ol>
<h3 id="如果违反借用规则"><a class="header" href="#如果违反借用规则">如果违反借用规则</a></h3>
<h4 id="函数中的借用"><a class="header" href="#函数中的借用">函数中的借用</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// borrowing_functions.rs

// 接收可变借用作为参数
fn take_the_n(n: &amp;mut u8) {
    *n += 2;
}

fn take_the_s(s: &amp;mut String) {
    s.push_str(&quot;ing&quot;);
}

fn main() {
    // 变量绑定必须是可变
    let mut n = 5;
    let mut s = String::from(&quot;Borrow&quot;);
    // 因为函数内做了修改，所以调用时也需要使用可变借用
    take_the_n(&amp;mut n);
    take_the_s(&amp;mut s);

    println!(&quot;n changed to {}&quot;, n);
    println!(&quot;s changed to {}&quot;, s);
}
</code></pre></pre>
<h4 id="匹配中的借用"><a class="header" href="#匹配中的借用">匹配中的借用</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// ownership_match.rs

#[derive(Debug)]
enum Food {
    Cake,
    Pizza,
    Salad
}

#[derive(Debug)]
struct Bag {
    food: Food
}

fn main() {
    let bag = Bag { food: Food::Cake };
    match bag.food {
        Food::Cake =&gt; println!(&quot;I got cake&quot;),
        // 以 ref 作为前缀。
        // 关键字 ref 可以通过引用来匹配元素,而不是根据值来捕获它们。
        ref a =&gt; println!(&quot;I got {:?}&quot;, a)
    }
    
    println!(&quot;{:?}&quot;, bag);
}
</code></pre></pre>
<h4 id="从函数返回引用"><a class="header" href="#从函数返回引用">从函数返回引用：</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// return_func_ref.rs

fn get_a_borrowed_value() -&gt; &amp;u8 { // expected named lifetime parameter
    let x = 1;
    &amp;x
}

fn main() {
    let value = get_a_borrowed_value();
}
</code></pre></pre>
<h3 id="基于借用规则的方法类型"><a class="header" href="#基于借用规则的方法类型">基于借用规则的方法类型</a></h3>
<blockquote>
<p>借用规则还规定了如何定义类型的固有方法和特征的实例方法。以下是它们接收实例的方式,并且是根据限制由少到多排列的。</p>
</blockquote>
<ul>
<li>&amp;self 方法:这些方法只对其成员具有不可变的访问权限。</li>
<li>&amp;mut self 方法:这些方法能够可变地借用 self 实例。</li>
<li>self 方法:这些方法拥有调用它的实例的所有权,并且类型在后续调用时将失效。</li>
</ul>
<p>对于自定义类型,相同的借用规则也适用于其作用域成员。</p>
<h2 id="生命周期针对引用附加的信息"><a class="header" href="#生命周期针对引用附加的信息">生命周期：针对引用附加的信息</a></h2>
<h3 id="从变量生命周期开始"><a class="header" href="#从变量生命周期开始">从变量生命周期开始</a></h3>
<h3 id="生命周期限定"><a class="header" href="#生命周期限定">生命周期限定</a></h3>
<h3 id="生命周期注解"><a class="header" href="#生命周期注解">生命周期注解</a></h3>
<h3 id="生命周期省略lifetime-elision"><a class="header" href="#生命周期省略lifetime-elision">生命周期省略(Lifetime Elision)</a></h3>
<h2 id="销毁destructors"><a class="header" href="#销毁destructors">销毁(Destructors)</a></h2>
<h2 id="参考资源-2"><a class="header" href="#参考资源-2">参考资源</a></h2>
<h3 id="online-book-3"><a class="header" href="#online-book-3">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html">What is Ownership? - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/lifetime-elision.html#lifetime-elision-in-functions">生命周期省略规则(Lifetime elision) - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/destructors.html">Destructors - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/lifetime-elision.html">Lifetime elision - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/book/ch04-00-understanding-ownership.html">Understanding Ownership - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-3"><a class="header" href="#fragment-3">fragment</a></h3>
<ul>
<li><a href="https://www.ditsing.com/object-lifetime-and-ownership/">Object lifetime and ownership</a></li>
<li><a href="https://www.zhihu.com/question/58863427">go没有虚拟机怎么运行gc的？ - 知乎</a></li>
<li><a href="https://hashrust.com/blog/lifetimes-in-rust/">Lifetimes in Rust</a></li>
</ul>
<h3 id="local-3"><a class="header" href="#local-3">local</a></h3>
<ul>
<li><a href="marginnote3app://note/72B2EE33-36EE-4FE6-A088-FEBE54D61E8D">&lt;精通rust(第二版)&gt;-5.7 内存安全三原则</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E8%B5%B7%E6%BA%90">类型系统起源</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E6%88%91%E4%BB%AC%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%9C%A8%E8%AF%AD%E8%A8%80%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B">我们为什么需要在语言中使用类型?</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#1-%E4%BB%8E%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%88%B0%E6%B1%87%E7%BC%96">1. 从二进制数据格式到汇编</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#2-%E4%BB%8E%E6%B1%87%E7%BC%96%E5%88%B0%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E5%BA%94%E8%BF%90%E8%80%8C%E7%94%9F">2. 从汇编到编程语言，类型系统应运而生</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#3-%E5%86%8D%E6%9D%A5%E8%AE%A4%E7%9C%9F%E7%9C%8B%E7%9C%8B%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F">3. 再来认真看看类型系统</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#4-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E5%85%B6%E5%AE%9E%E6%98%AF%E4%B8%80%E7%BB%84%E8%A7%84%E5%88%99">4. 类型系统其实是一组规则</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#5-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E6%98%AF%E5%AF%B9%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%AE%89%E5%85%A8%E7%9A%84%E6%8A%BD%E8%B1%A1">5. 类型系统是对内存管理/安全的抽象</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E5%8A%A8%E6%80%81%E7%B1%BB%E5%9E%8B%E5%A4%A7%E5%B0%8F">动态类型大小</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E7%B1%BB%E5%9E%8B%E5%B8%83%E5%B1%80">类型布局</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E5%86%85%E9%83%A8%E5%8F%AF%E5%8F%98%E6%80%A7">内部可变性</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E5%AD%90%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%8D%8F%E5%8F%98">子类型与协变</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E5%BC%BA%E5%88%B6%E8%BD%AC%E6%8D%A2type-coercions">强制转换(type coercions)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/type_system.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:33 UTC 2022 -->
<!--te-->
<h1 id="类型系统起源"><a class="header" href="#类型系统起源">类型系统起源</a></h1>
<h2 id="我们为什么需要在语言中使用类型"><a class="header" href="#我们为什么需要在语言中使用类型">我们为什么需要在语言中使用类型?</a></h2>
<blockquote>
<p>这是一个很好的问题,可以作为理解编程语言类型系统的契机。</p>
</blockquote>
<h3 id="1-从二进制数据格式到汇编"><a class="header" href="#1-从二进制数据格式到汇编">1. 从二进制数据格式到汇编</a></h3>
<p>作为程序员,我们知道为计算机编写的程序在最底层是以 0 和 1
组成的二进制数据格式表示的。实际上,最早的计算机必须使用机器代码手动编程。最终,程序员意识到这样做非常容易出错,并且乏味、耗时。对大部分人来说,在二进制层面操作和推断这些实体是不切实际的。 到了 20 世纪 50 年代,
编程社区提出了机器代码助记符的概念, 这些助记符变成了今天我们熟知的汇编语言。</p>
<h3 id="2-从汇编到编程语言类型系统应运而生"><a class="header" href="#2-从汇编到编程语言类型系统应运而生">2. 从汇编到编程语言，类型系统应运而生</a></h3>
<p>然后,编程语言应运而生,它们被编译成汇编代码,并允许编程人员编写人类可理解的代码,以方便计算机将其编译成机器代码。然而,大家平时所说的语言表达某些语义比较模糊,因此需要制定一套规则和条件,来表述用类似人类语言编写的计算机程序中可能或不可能存在的内容,即程序语义。这使得我们提出了类型和类型系统的理念。</p>
<h3 id="3-再来认真看看类型系统"><a class="header" href="#3-再来认真看看类型系统">3. 再来认真看看类型系统</a></h3>
<p>类型是一组具名的可能值。例如,u8 是一种可能包含 0~255 的正数值类型。类型提供了一种方法来弥合我们创建的这些实体的底层表示与心理模型之间的差距。除此之外, 类型还为我们提供了<strong>表示实体的意图、行为和约束的方法</strong>：</p>
<blockquote>
<p>它们定义了用户通过类型能够(不能够) 做什么。 例如, 它没有定义将字符串类型的值和数值类型的值相加的结果是什么。</p>
</blockquote>
<h3 id="4-类型系统其实是一组规则"><a class="header" href="#4-类型系统其实是一组规则">4. 类型系统其实是一组规则</a></h3>
<p>从类型来看,语言设计者构建了类型系统,这些系统是一组规则,用于管理不同类型在编程语言中的交互。它们可以用作推断程序的工具,并有助于确保程序能够正常运行并符合规范。类型系统根据其表达力进行限定,这仅表示你可以使用类型表达逻辑的程度,以及程序中的不变量。</p>
<blockquote>
<p>例如 Haskell 是一种高级语言,它具有非常丰富的表现力的类型系统,而C 语言是一种低级语言,它只为我们提供了很少的基于类型的抽象。Rust 试图在这两个极端之间找到一种平衡。</p>
</blockquote>
<h3 id="5-类型系统是对内存管理安全的抽象"><a class="header" href="#5-类型系统是对内存管理安全的抽象">5. 类型系统是对内存管理/安全的抽象</a></h3>
<h4 id="动态类型大小"><a class="header" href="#动态类型大小">动态类型大小</a></h4>
<h4 id="类型布局"><a class="header" href="#类型布局">类型布局</a></h4>
<h4 id="内部可变性"><a class="header" href="#内部可变性">内部可变性</a></h4>
<h4 id="子类型与协变"><a class="header" href="#子类型与协变">子类型与协变</a></h4>
<h4 id="强制转换type-coercions"><a class="header" href="#强制转换type-coercions">强制转换(type coercions)</a></h4>
<h2 id="参考资料"><a class="header" href="#参考资料">参考资料</a></h2>
<h3 id="online-book-4"><a class="header" href="#online-book-4">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/dynamically-sized-types.html">Dynamically Sized Types - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/type-layout.html">Type layout - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/interior-mutability.html">Interior mutability - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/subtyping.html">Subtyping and Variance - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/type-coercions.html">Type coercions - The Rust Reference</a></li>
</ul>
<h3 id="fragment-4"><a class="header" href="#fragment-4">fragment</a></h3>
<h3 id="local-4"><a class="header" href="#local-4">local</a></h3>
<ul>
<li><a href="marginnote3app://note/7D37028B-C1FB-47BC-AA50-4EBA22EB9CC7">&lt;精通Rust(第二版)&gt;-4.1 类型系统及其重要性</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="基础内置类型"><a class="header" href="#基础内置类型">基础内置类型</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E5%9F%BA%E7%A1%80%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B">基础内置类型</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E5%9F%BA%E5%85%83%E7%B1%BB%E5%9E%8B">基元类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B">序列类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B">自定义类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E5%87%BD%E6%95%B0%E7%B1%BB%E5%9E%8B">函数类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B">指针类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E7%89%B9%E5%BE%81%E7%B1%BB%E5%9E%8B">特征类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/built_in_types.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:32 UTC 2022 -->
<!--te-->
<h2 id="基元类型"><a class="header" href="#基元类型">基元类型</a></h2>
<h2 id="序列类型"><a class="header" href="#序列类型">序列类型</a></h2>
<h2 id="自定义类型"><a class="header" href="#自定义类型">自定义类型</a></h2>
<h2 id="函数类型"><a class="header" href="#函数类型">函数类型</a></h2>
<h2 id="指针类型"><a class="header" href="#指针类型">指针类型</a></h2>
<h2 id="特征类型"><a class="header" href="#特征类型">特征类型</a></h2>
<h2 id="参考资源-3"><a class="header" href="#参考资源-3">参考资源</a></h2>
<h3 id="online-book-5"><a class="header" href="#online-book-5">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/types.html">Types - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/book/ch15-00-smart-pointers.html">Smart Pointers - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-5"><a class="header" href="#fragment-5">fragment</a></h3>
<h3 id="local-5"><a class="header" href="#local-5">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="集合类型"><a class="header" href="#集合类型">集合类型</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/collections.html#%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B">集合类型</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/collections.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/collections.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/collections.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/collections.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:33 UTC 2022 -->
<!--te-->
<h2 id="参考资源-4"><a class="header" href="#参考资源-4">参考资源</a></h2>
<h3 id="online-book-6"><a class="header" href="#online-book-6">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch08-00-common-collections.html">Common Collections - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-6"><a class="header" href="#fragment-6">fragment</a></h3>
<h3 id="local-6"><a class="header" href="#local-6">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="自定义类型-1"><a class="header" href="#自定义类型-1">自定义类型</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B">自定义类型</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/user_defined_types.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:34 UTC 2022 -->
<!--te-->
<h2 id="参考资源-5"><a class="header" href="#参考资源-5">参考资源</a></h2>
<h3 id="online-book-7"><a class="header" href="#online-book-7">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch05-00-structs.html">Using Structs to Structure Related Data - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-7"><a class="header" href="#fragment-7">fragment</a></h3>
<h3 id="local-7"><a class="header" href="#local-7">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="泛型特征及特征对象"><a class="header" href="#泛型特征及特征对象">泛型、特征及特征对象</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/rust-traits-deep-dive.png" alt="rust-traits-deep-dive" /></p>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E7%89%B9%E5%BE%81%E5%8F%8A%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1">泛型、特征及特征对象</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B">泛型</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%BB%8E%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8%E5%87%BA%E5%8F%91">从代码复用出发</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E4%B8%8D%E8%B6%B3">函数作用不足</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E9%9D%99%E6%80%81%E7%B1%BB%E5%9E%8B%E8%AF%AD%E8%A8%80%E8%BF%98%E9%9C%80%E8%A6%81%E6%B3%9B%E5%9E%8B%E6%9D%A5%E5%A4%8D%E7%94%A8%E4%BB%A3%E7%A0%81">静态类型语言还需要泛型来复用代码</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E6%9C%AC%E8%B4%A8%E4%B8%8A%E6%98%AF%E4%B8%80%E7%A7%8D%E5%8D%95%E6%80%81%E5%8C%96">泛型本质上是一种单态化</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F">泛型使用方式</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0">泛型函数</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E7%BB%93%E6%9E%84%E4%BD%93">泛型结构体</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E6%9E%9A%E4%B8%BE%E4%BD%93">泛型枚举体</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E7%89%B9%E5%BE%81">泛型特征</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95">泛型方法</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#impl-%E6%B3%9B%E5%9E%8B%E5%AE%9E%E7%8E%B0%E5%9D%97">impl: 泛型实现块</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E5%AE%9E%E7%8E%B0">泛型实现</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%B8%93%E9%97%A8%E5%8C%96%E6%B3%9B%E5%9E%8B">专门化泛型</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%8C%87%E5%AE%9A%E7%B1%BB%E5%9E%8B%E8%BF%9B%E8%A1%8C%E5%AE%9E%E4%BE%8B%E5%8C%96">指定类型进行实例化</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%9F%BA%E4%BA%8E%E7%B1%BB%E5%9E%8B%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%8E%A8%E6%96%AD">基于类型实例化推断</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E6%9F%90%E4%BA%9B%E6%96%B9%E6%B3%95">泛型函数调用某些方法</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#turbofish-">turbofish: ::&lt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81">特征</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%BB%8E%E5%A4%9A%E6%80%81%E5%92%8C%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8%E7%9A%84%E8%A7%92%E5%BA%A6%E6%9D%A5%E7%9C%8B-%E6%8E%A5%E5%8F%A3%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B%E8%BF%98%E6%98%AF%E7%89%B9%E5%BE%81">从多态和代码复用的角度来看: 接口、鸭子类型还是特征？</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%8E%A5%E5%8F%A3">接口</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B">鸭子类型</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81-1">特征</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88">特征到底是什么？</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A1%A8%E7%8E%B0%E5%BD%A2%E5%BC%8F">特征的多种表现形式</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%A0%87%E8%AE%B0%E7%89%B9%E5%BE%81">标记(特征)</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%AE%80%E5%8D%95%E7%89%B9%E5%BE%81">简单(特征)</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E7%89%B9%E5%BE%81-1">泛型(特征)</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%85%B3%E8%81%94%E7%B1%BB%E5%9E%8B%E7%89%B9%E5%BE%81">关联类型(特征)</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%BB%A7%E6%89%BF%E7%89%B9%E5%BE%81">继承(特征)</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E5%86%85%E7%BD%AE%E7%89%B9%E5%BE%81">一些常用内置特征</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E8%87%AA%E5%8A%A8%E7%89%B9%E5%BE%81auto-traits">自动特征(Auto Traits)</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#send--sync">Send &amp; Sync</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#unpin-unwindsafe--refunwindsafe">Unpin、 UnwindSafe &amp; RefUnwindSafe</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#debug">Debug</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#partialeq-%E5%92%8C-eq">PartialEq 和 Eq</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#copy%E5%92%8Cclone">Copy和Clone</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#display">Display</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#add">Add</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#into-%E5%92%8C-from">Into 和 From</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#drop">Drop</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#deref--derefmut">Deref &amp; DerefMut</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#sizedspecial-types-and-traits---the-rust-reference">Sized<a href="https://doc.rust-lang.org/stable/reference/special-types-and-traits.html" rel="nofollow">Special types and traits - The Rust Reference</a>
</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%95%B4%E4%BE%8B%E5%AD%90">一个完整例子</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4%E6%B3%9B%E5%9E%8B%E7%89%B9%E5%BE%81">特征区间：泛型+特征</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%BC%95%E5%87%BA%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4">引出特征区间</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%BB%A3%E7%A0%81%E5%8D%95%E4%BD%93%E5%8C%96">代码单体化</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%8C%87%E5%AE%9A%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4%E7%9A%84%E5%9B%9B%E4%B8%AA%E6%96%B9%E6%B3%95">指定特征区间的四个方法</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%8C%BA%E9%97%B4%E5%86%85%E6%B3%9B%E5%9E%8B-fn-fn_namet-target_traitval-t">区间内泛型: fn fn_name&lt;T: target_trait&gt;(val: T)</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#where%E8%AF%AD%E5%8F%A5-%E5%BD%93%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E6%B3%95%E7%AD%BE%E5%90%8D%E8%BF%87%E9%95%BF%E6%97%B6%E4%BD%BF%E7%94%A8">where语句: 当第一种方法签名过长时使用</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%BD%BF%E7%94%A8%E7%BB%84%E5%90%88%E5%A4%9A%E4%B8%AA%E7%89%B9%E5%BE%81">使用“+“组合多个特征</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%BD%BF%E7%94%A8impl%E7%89%B9%E5%BE%81%E8%AF%AD%E6%B3%95-%E9%97%AD%E5%8C%85%E5%B8%B8%E7%94%A8">使用impl特征语法: 闭包常用</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">特征区间的使用场景</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%9C%A8%E7%B1%BB%E5%9E%8B%E4%B8%8A%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%BB%BA%E8%AE%AE">在类型上使用：不建议</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0impl%E4%BB%A3%E7%A0%81%E5%9D%97">泛型函数+impl代码块</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1-%E5%A4%9A%E6%80%81%E7%89%B9%E5%BE%81%E7%B1%BB%E5%9E%8B">特征对象: 多态特征类型</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%88%86%E5%8F%91dispatch">分发(dispatch)</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%88%86%E5%8F%91%E6%96%B9%E5%BC%8F%E9%9D%99%E6%80%81-or-%E5%8A%A8%E6%80%81">分发方式：静态 or 动态</a></li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%8C%BA%E5%88%AB%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4%E4%B8%8E%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1">区别特征区间与特征对象</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1%E5%85%B7%E4%BD%93%E8%AF%B4%E8%AF%B4">特征对象具体说说</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%8C%87%E5%AE%9A%E4%B8%BA%E5%AE%9E%E7%8E%B0%E6%9F%90%E4%B8%AA%E7%89%B9%E5%BE%81">指定为实现某个特征</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E7%94%A8%E8%83%96%E6%8C%87%E9%92%88%E5%AE%9E%E7%8E%B0">用胖指针实现</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%98%AFrust%E6%89%A7%E8%A1%8C%E5%8A%A8%E6%80%81%E5%88%86%E5%8F%91%E7%9A%84%E6%96%B9%E5%BC%8F">是Rust执行动态分发的方式</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E4%B8%8D%E5%AE%9A%E9%95%BF%E7%B1%BB%E5%9E%8B%E5%8F%AA%E8%83%BD%E4%BD%9C%E4%B8%BA%E5%BC%95%E7%94%A8%E5%88%9B%E5%BB%BA">不定长类型只能作为引用创建</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E6%80%BB%E7%BB%93%E7%89%B9%E5%BE%81%E7%89%B9%E5%BE%81%E5%8C%BA%E9%97%B4%E5%92%8C%E7%89%B9%E5%BE%81%E5%AF%B9%E8%B1%A1">总结特征、特征区间和特征对象</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/2_type_system/generics_traits_objects.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:33 UTC 2022 -->
<!--te-->
<h2 id="泛型"><a class="header" href="#泛型">泛型</a></h2>
<h3 id="从代码复用出发"><a class="header" href="#从代码复用出发">从代码复用出发</a></h3>
<h4 id="函数作用不足"><a class="header" href="#函数作用不足">函数作用不足</a></h4>
<p>一直以来，函数的实现方式就是基于c语言的goto指令：</p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150721312.png" alt="image-20220613150721312" /></p>
<p>通过进一步强化，就得到函数的实现方式：</p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220613150804039.png" alt="image-20220613150804039" /></p>
<blockquote>
<p>但是也就这样了，函数只能实现流程上的复用，不能实现类型上的复用。这一点其实在python、js这些动态类型语言上面就不存在这个问题。对于Rust这种静态类型语言，对函数入参类型要求十分严格，于是泛型就应运而生。</p>
</blockquote>
<h4 id="静态类型语言还需要泛型来复用代码"><a class="header" href="#静态类型语言还需要泛型来复用代码">静态类型语言还需要泛型来复用代码</a></h4>
<blockquote>
<p>泛型编程是一种仅适用于静态类型编程语言的技术。它首次出现在 ML 语言中,是一种静态类型的函数式语言。</p>
</blockquote>
<p>像 Python 这样的动态语言采用的是简单类型 (duck typing) , 其中的 API 是根据它们可以做什么,而不是它们是什么来处理参数的,因此不依赖于泛型。</p>
<p>泛型是语言设计特性的一部分, 可以实现代码复用, 并遵循不重复自己的原则 (Don’t Repeat Yourself,DRY) 。采用这种技术,你可以使用类型占位符来编写算法、函数、方法及类型, 并在这些类型上指定一个类型变量(
使用单个字母,通常是 T、K 或 V) ,告知编译器在任何代码中实例化它们时要填充的实际类型。这些类型被称为泛型或元素。单个字母(例如类型 T)被称为泛型参数。当你使用或实例化任何泛型元素时,它们会被替换成诸如 u32 这样的具体类型。</p>
<h3 id="泛型本质上是一种单态化"><a class="header" href="#泛型本质上是一种单态化">泛型本质上是一种单态化</a></h3>
<p>每次将泛型元素与具体类型一起使用时,都会在编译时用类型变量 T 生成该代码的特定副本,并将其替换为具体类型。<strong>这种在编译时生成包含具体类型的专用函数的过程被称为单态化,这是执行与多态函数相反的过程。</strong></p>
<h3 id="泛型使用方式"><a class="header" href="#泛型使用方式">泛型使用方式</a></h3>
<blockquote>
<p>在使用泛型时，应该多去考虑它与不同元素结合使用的场景背后的思维方式。泛型可以与结构体、枚举、函数、特征、方法及代码实现块。它们的一个共同特征是泛型的参数是由一对尖头括号分隔,并包含于其中。</p>
</blockquote>
<h4 id="泛型函数"><a class="header" href="#泛型函数">泛型函数</a></h4>
<p>为了创建泛型函数,我们需要将泛型参数放在函数名之后和圆括号之前,如下所示:</p>
<pre><pre class="playground"><code class="language-rust  editable">// generic_function.rs

fn give_me&lt;T&gt;(value: T) {
    let _ = value;
}

fn main() {
    let a = &quot;generics&quot;;
    let b = 1024;
    give_me(a);
    give_me(b);
}
</code></pre></pre>
<h4 id="泛型结构体"><a class="header" href="#泛型结构体">泛型结构体</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// generic_struct.rs

struct Container&lt;T&gt; {
    item: T,
}

impl&lt;T&gt; Container&lt;T&gt; {
    fn new(item: T) -&gt; Self {
        Container { item }
    }
}

impl Container&lt;u32&gt; {
    fn sum(item: u32) -&gt; Self {
        Container { item }
    }
}

fn main() {
    // todo
}
</code></pre></pre>
<h4 id="泛型枚举体"><a class="header" href="#泛型枚举体">泛型枚举体</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// generic_enum.rs

enum Transmission&lt;T&gt; {
    Signal(T),
    NoSignal,
}

fn main() {
    // stuff
}
</code></pre></pre>
<h4 id="泛型特征"><a class="header" href="#泛型特征">泛型特征</a></h4>
<h4 id="泛型方法"><a class="header" href="#泛型方法">泛型方法</a></h4>
<h3 id="impl-泛型实现块"><a class="header" href="#impl-泛型实现块">impl: 泛型实现块</a></h3>
<h4 id="泛型实现"><a class="header" href="#泛型实现">泛型实现</a></h4>
<blockquote>
<p>当为任何泛型编写 impl 代码块时,都需要在使用它之前声明泛型参数。T 就像一个变量—— 一个类型变量,我们需要先声明它 impl代码块实际上意味着我们正在为所有类型 T 实现这些方法,它们会出现在 Container<T>中。这个 impl 代码块是一个泛型实现。 因此,生成的每个具体 Container 都将有这些方法。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// generic_struct_impl.rs

struct Container&lt;T&gt; {
    item: T,
}

impl&lt;T&gt; Container&lt;T&gt; {
    fn new(item: T) -&gt; Self {
        Container { item }
    }
}

fn main() {
    // stuff
}
</code></pre></pre>
<h4 id="专门化泛型"><a class="header" href="#专门化泛型">专门化泛型</a></h4>
<blockquote>
<p>在这里, 由于 u32 是作为具体类型存在的, 因此我们不需要 impl 之后的<T>, 这是 impl 代码块的另外一个特性,它允许你通过独立实现方法来专门化泛型。 现在,我们也可以通过将 T 替换为任何具体类型来为 Container<T>编写更具体的 impl 代码块。以下就是它的实例:</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">impl Container&lt;u32&gt; { 
    fn sum(item: u32) -&gt; Self {
        Container { item }
    } 
}
</code></pre></pre>
<h3 id="指定类型进行实例化"><a class="header" href="#指定类型进行实例化">指定类型进行实例化</a></h3>
<blockquote>
<p>每当我们进行实例化时, 编译器需要在其类型签名中知道 T 的具体类型以便替换,这为其提供了将泛型代码单态化的类型信息。 而具体类型的确定主要有三种方式：</p>
</blockquote>
<ol>
<li>大多数情况下,具体类型是基于类型的实例化推断.</li>
<li>对泛型函数调用某些方法来接收具体类型。</li>
<li>在极个别情况下, 我们需要通过使用 <code>turbofish (::&lt;&gt;)</code>运算符输入具体类型来替代泛型以便辅助编译器识别。</li>
</ol>
<h4 id="基于类型实例化推断"><a class="header" href="#基于类型实例化推断">基于类型实例化推断</a></h4>
<p>这是最常见的方式，主要基于类型特征(trait)。</p>
<h4 id="泛型函数调用某些方法"><a class="header" href="#泛型函数调用某些方法">泛型函数调用某些方法</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// using_generic_func.rs

use std::str;

fn main() {
    let num_from_str = str::parse::&lt;u8&gt;(&quot;34&quot;).unwrap();
    println!(&quot;Parsed number {}&quot;, num_from_str);
}
</code></pre></pre>
<h4 id="turbofish-"><a class="header" href="#turbofish-">turbofish: ::&lt;&gt;</a></h4>
<ol>
<li>如果没有任何类型特征，代码将无法编译：👇</li>
</ol>
<pre><pre class="playground"><code class="language-rust  editable">fn main() {
    let a = Vec::new();
}
</code></pre></pre>
<ol start="2">
<li>这时可以用下列三种方式指定</li>
</ol>
<pre><pre class="playground"><code class="language-rust  editable">// using_generic_vec.rs

fn main() {
    // providing a type
    let v1: Vec&lt;u8&gt; = Vec::new();

    // or calling method
    let mut v2 = Vec::new();
    v2.push(2); // v2 is now Vec&lt;i32&gt;

    // or using turbofish
    let v3 = Vec::&lt;u8&gt;::new(); // not so readable
}
</code></pre></pre>
<h2 id="特征"><a class="header" href="#特征">特征</a></h2>
<h3 id="从多态和代码复用的角度来看-接口鸭子类型还是特征"><a class="header" href="#从多态和代码复用的角度来看-接口鸭子类型还是特征">从多态和代码复用的角度来看: 接口、鸭子类型还是特征？</a></h3>
<p>从多态和代码复用的角度来看, 在代码中将类型的共享行为和公共属性与其自身隔离通常是一个好主意,并且能拥有专属于自己的方法。在这样做时,我们允许不同类型通过通用属性互相关联,使我们能够为 API 编程,使其参数更通用或更具包容性。</p>
<blockquote>
<p>这意味着我们可以接收具有这些通用属性的类型,而不仅限于某种特定类型。</p>
</blockquote>
<h4 id="接口"><a class="header" href="#接口">接口</a></h4>
<p>类似 Java 和 C#的面向对象编程语言中,接口表达了相同的理念,我们可以在其中定义多种类型能够实现的共享行为。例如,我们可以使用单个 sort 函数接收实现 Comparable 或者 Comparator
接口的元素列表,而不是使用多个 sort 函数接收整数值列表,以及用其他函数接收字符串值列表。这使得我们可以将任何可比较(Comparable)的内容传递给 sort 函数。</p>
<h4 id="鸭子类型"><a class="header" href="#鸭子类型">鸭子类型</a></h4>
<p>而Python同样有明确的特性，被称为“鸭子类型“.</p>
<blockquote>
<p>“当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子，那么这只鸟就可以被称为鸭子。”</p>
</blockquote>
<p>在鸭子类型中，关注点在于对象的行为，能做什么；而不是关注对象所属的类型。例如，在不使用鸭子类型的语言中，我们可以编写一个函数，它接受一个类型为“鸭子”的对象，并调用它的“走”和“叫”方法。在使用鸭子类型的语言中，这样的一个函数可以接受一个任意类型的对象，并调用它的“走”和“叫”方法。如果这些需要被调用的方法不存在，那么将引发一个运行时错误。任何拥有这样的正确的“走”和“叫”方法的对象都可被函数接受的这种行为引出了以上表述，这种决定类型的方式因此得名。</p>
<p>鸭子类型通常得益于“不”测试方法和函数中参数的类型，而是依赖文档、清晰的代码和测试来确保正确使用。</p>
<p>在常规类型中，我们能否在一个特定场景中使用某个对象取决于这个对象的类型，而在鸭子类型中，则取决于这个对象是否具有某种属性或者方法——即只要具备特定的属性或方法，能通过鸭子测试，就可以使用。</p>
<h4 id="特征-1"><a class="header" href="#特征-1">特征</a></h4>
<p>Rust也有一个类似且功能强大的结构,被称为特征。Rust中的特征以多种形式存在, 我们将介绍一些最常见的形式并了解一些与它们简单交互的方式。此外,当特征与泛型搭配使用时,可以限制传递到 API
的参数范围。我们将会对特征进行比较深入的了解。</p>
<h3 id="特征到底是什么"><a class="header" href="#特征到底是什么">特征到底是什么？</a></h3>
<h3 id="特征的多种表现形式"><a class="header" href="#特征的多种表现形式">特征的多种表现形式</a></h3>
<h4 id="标记特征"><a class="header" href="#标记特征">标记(特征)</a></h4>
<h4 id="简单特征"><a class="header" href="#简单特征">简单(特征)</a></h4>
<h4 id="泛型特征-1"><a class="header" href="#泛型特征-1">泛型(特征)</a></h4>
<h4 id="关联类型特征"><a class="header" href="#关联类型特征">关联类型(特征)</a></h4>
<h4 id="继承特征"><a class="header" href="#继承特征">继承(特征)</a></h4>
<h3 id="一些常用内置特征"><a class="header" href="#一些常用内置特征">一些常用内置特征</a></h3>
<h4 id="自动特征auto-traits"><a class="header" href="#自动特征auto-traits">自动特征(Auto Traits)</a></h4>
<h5 id="send--sync"><a class="header" href="#send--sync">Send &amp; Sync</a></h5>
<h5 id="unpin-unwindsafe--refunwindsafe"><a class="header" href="#unpin-unwindsafe--refunwindsafe">Unpin、 UnwindSafe &amp; RefUnwindSafe</a></h5>
<h4 id="debug"><a class="header" href="#debug">Debug</a></h4>
<p>这个特征有助于在控制台上输出类型以便进行调试。在组合类型的情况下,类型将以类似 JSON 的格式输出,其中带有花括号和其他括号,如果类型是字符串,将会用引号标识。这适用于 Rust 中的大多数内置类型。</p>
<h4 id="partialeq-和-eq"><a class="header" href="#partialeq-和-eq">PartialEq 和 Eq</a></h4>
<p>这些特征允许两个元素相互比较以验证是否相等</p>
<h4 id="copy和clone"><a class="header" href="#copy和clone">Copy和Clone</a></h4>
<p>这些特征定义了类型的复制方式。 简而言之,当在任何自定义类型上自动派生时,这些特征允许用户从实例创建新的副本:</p>
<ol>
<li>可以在实现 Copy 时隐式创建</li>
<li>也可以在实现 Clone 时通过调用 clone() 显式创建。</li>
</ol>
<blockquote>
<p>请注意,Copy 依赖于在类型上实现的 Clone 特征</p>
</blockquote>
<h4 id="display"><a class="header" href="#display">Display</a></h4>
<h4 id="add"><a class="header" href="#add">Add</a></h4>
<h4 id="into-和-from"><a class="header" href="#into-和-from">Into 和 From</a></h4>
<h4 id="drop"><a class="header" href="#drop">Drop</a></h4>
<h4 id="deref--derefmut"><a class="header" href="#deref--derefmut">Deref &amp; DerefMut</a></h4>
<h4 id="sizedspecial-types-and-traits---the-rust-reference"><a class="header" href="#sizedspecial-types-and-traits---the-rust-reference">Sized<a href="https://doc.rust-lang.org/stable/reference/special-types-and-traits.html">Special types and traits - The Rust Reference</a></a></h4>
<h3 id="一个完整例子"><a class="header" href="#一个完整例子">一个完整例子</a></h3>
<pre><pre class="playground"><code class="language-rust  editable">// complex/src/lib.rs

use std::ops::Add;

/*
将#[derive(Default)] 属性实现为一个过程宏,可以自动实现它修饰的类型的特征。
此自动派生要求任何自定义类型的字段(例如结构体或枚举)本身必须实现 Default 特征。
使用它们继承特征仅适用于结构体、枚举及联合。
*/
#[derive(Default, Debug, PartialEq, Copy, Clone)]
struct Complex&lt;T&gt; {
    // Real part
    re: T,
    // Complex part
    im: T,
}

impl&lt;T&gt; Complex&lt;T&gt; {
    // new 函数实际上并不是一个特殊的构造函数(如果你只了解带有构造函数的语言),
    // 而是社区采用的一个常用名称(作为创建新类型实例的方法名) 。
    fn new(re: T, im: T) -&gt; Self {
        Complex { re, im }
    }
}

// 来自 std::ops 模块的 Add 特征允许我们使用“+”运算符将两个复数相加
/*
1. impl&lt;T: Add&lt;T, Output=T&gt;表示我们正在为泛型 T 实现 Add,其中 T 实现 Add&lt;T, Output=T&gt;。
2. &lt;T, Output=T&gt;部分表示 Add 特征的实现必须具有相同的输入和输出类型
3. Add for Complex&lt;T&gt;部分表示为 Complex&lt;T&gt;类型实现 Add 特征
4. T:Add 表示必须实现 Add 特征。如果没有实现,那么我们不能使用“+”运算符
*/
impl&lt;T: Add&lt;T, Output=T&gt;&gt; Add for Complex&lt;T&gt; {
    type Output = Complex&lt;T&gt;;
    // Add 特征提供的核心功能,是我们在两种实现类型之间使用“+”运算符时调用的方法。
    // 它是一个实例方法,通过值获取 self 并接收 rhs 作为参数,即特征定义中的 RHS。
    fn add(self, rhs: Complex&lt;T&gt;) -&gt; Self::Output {
        Complex { re: self.re + rhs.re, im: self.im + rhs.im }
    }
}

// 来自 std::convert 模块的 Into 和 From 特征使用户能够根据其他类型创建复数类型
/*
1. 如果我们可以从内置基元类型 (例如双元素元组) 构造 Complex 类型
   其中第 1 个元素是实部,第 2 个元素是虚部,将会很方便。
   我们可以通过实现 From 特征来达到此目的。
2. 此特征定义了一个 from 方法, 为我们提供了在类型之间进行转换的一般方法
3. 第一个&lt;T&gt;是泛型 T 的声明, 第二个和第三个&lt;T&gt;是泛型类型 T 的用途。 我们会根据(T,T) 类型创建它
*/
impl&lt;T&gt; From&lt;(T, T)&gt; for Complex&lt;T&gt; {
    /*
        当我们实现它时, 只需要用我们希望实现它的类型替换 T 并实现 from 方法,
        然后我们就可以在相关类型上调用该方法。
        这是一个将 Complex 值转换为双元素元组类型的实现, Rust本身就能识别它
    */
    fn from(value: (T, T)) -&gt; Complex&lt;T&gt; {
        Complex { re: value.0, im: value.1 }
    }
}

use std::fmt::{Formatter, Display, Result};

// Display 特征能够输出人类可读版本的复数类型
impl&lt;T: Display&gt; Display for Complex&lt;T&gt; {
    fn fmt(&amp;self, f: &amp;mut Formatter) -&gt; Result {
        // 为了让用户能够以数学符号的形式查看复数类型
        write!(f, &quot;{} + {}i&quot;, self.re, self.im)
    }
}

// 一个简单的初始化测试用例。
#[cfg(test)]
mod tests {
    use crate::Complex;

    #[test]
    fn complex_basics() {
        let first = Complex::new(3, 5);
        let second: Complex&lt;i32&gt; = Complex::default();
        assert_eq!(first.re, 3);
        assert_eq!(first.im, 5);
        assert!(second.re == second.im);
    }

    #[test]
    fn complex_addition() {
        let a = Complex::new(1, -2);
        let b = Complex::default();
        let res = a + b;
        assert_eq!(res, a);
    }

    #[test]
    fn complex_from() {
        let a = (2345, 456);
        let complex = Complex::from(a);
        assert_eq!(complex.re, 2345);
        assert_eq!(complex.im, 456);
    }

    #[test]
    fn complex_display() {
        let my_imaginary = Complex::new(2345, 456);
        println!(&quot;{}&quot;, my_imaginary);
    }
}
// 最后使用cargo test -- --nocapture执行
</code></pre></pre>
<h2 id="特征区间泛型特征"><a class="header" href="#特征区间泛型特征">特征区间：泛型+特征</a></h2>
<h3 id="引出特征区间"><a class="header" href="#引出特征区间">引出特征区间</a></h3>
<p>首先看一下如下代码：</p>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bounds_intro.rs

struct Game;

struct Enemy;

struct Hero;
/*
在 Game 类型上我们有一个泛型函数 load,它可以接收任何游戏实体,
并通过任意 T 调用 init()将其加载到我们的游戏世界中。
但是,这个示例无法通过编译
*/
impl Game {
    fn load&lt;T&gt;(&amp;self, entity: T) {
        entity.init(); // method not found in `T`
    }
}

fn main() {
    let game = Game;
    game.load(Enemy);
    game.load(Hero);
}
</code></pre></pre>
<ol>
<li>因此, 任何类型为 T 的泛型函数都不能知道或默认假定 init()方法存在于 T 之上。</li>
<li>如果确实如此,那么它根本不是泛型,并且它们只能接收具有 init()方法的类型。</li>
<li><strong>因此,有一种方法可以让编译器知道这一点,并约束 load 通过特征能够接收的类型集,这就需要用到特征区间</strong>。</li>
</ol>
<blockquote>
<p>我们可以定义一个名为 Loadable 的特征,并在我们的 Enemy 和 Hero 类型上实现它。</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bounds_intro.rs

struct Game;

struct Enemy;

struct Hero;

trait Loadable {
    fn init(&amp;self);
}
/*
我们分别为 Enemy 和 Hero 实现了 Loadable,还修改了 load 方法
*/
impl Loadable for Enemy {
    fn init(&amp;self) {
        println!(&quot;Enemy loaded&quot;);
    }
}

impl Loadable for Hero {
    fn init(&amp;self) {
        println!(&quot;Hero loaded&quot;);
    }
}

impl Game {
    /*
        我们必须在泛型声明旁边放置几个符号来指定特征,我们称之为特征区间
    */
    fn load&lt;T: Loadable&gt;(&amp;self, entity: T) {
        entity.init();
    }
}

fn main() {
    let game = Game;
    game.load(Enemy);
    game.load(Hero);
}
</code></pre></pre>
<ol>
<li>注意, “:Loadable”部分表明了我们指定特征范围的方式。特征区间允许我们限制泛型 API 可以接收的参数范围。</li>
</ol>
<h3 id="代码单体化"><a class="header" href="#代码单体化">代码单体化</a></h3>
<ol>
<li>指定泛型元素上的绑定的特征类似于我们为变量指定类型的方式</li>
<li>但是此处的变量是泛型 T,类型是某些特征。例如 <strong>T:SomeTrait</strong>。</li>
<li>定义泛型函数时几乎总是会用到特征区间。</li>
<li>如果定义的泛型函数中的 T 不包含任何特征区间,我们就不能通过任何方法调用,因 Rust 不知道给定方法实现的方式。</li>
<li>它需要知道 T 是否具有某个 foo 方法,以便<strong>将代码单体化</strong></li>
</ol>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bounds_basics.rs

// 我们有一个方法 add_thing,它可以添加任何类型 T。
fn add_thing&lt;T&gt;(fst: T, snd: T) {
    // 编译器向用户建议在 T 上添加特征区间 Add
    // help: consider restricting type parameter `T`
    let _ = fst + snd;
}

fn main() {
    add_thing(2, 2);
}
</code></pre></pre>
<blockquote>
<p>修正后</p>
</blockquote>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bound_basics_fixed.rs

use std::ops::Add;

// 代码修改之后,我们将“:Add”添加到了 T 的后面,之后代码通过了编译
fn add_thing&lt;T: Add&gt;(fst: T, snd: T) {
    let _ = fst + snd;
}

fn main() {
    add_thing(2, 2);
}
</code></pre></pre>
<h3 id="指定特征区间的四个方法"><a class="header" href="#指定特征区间的四个方法">指定特征区间的四个方法</a></h3>
<h4 id="区间内泛型-fn-fn_namet-target_traitval-t"><a class="header" href="#区间内泛型-fn-fn_namet-target_traitval-t">区间内泛型: fn fn_name&lt;T: target_trait&gt;(val: T)</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 指定特征区间的一种方法, 它会接收任何实现了 Display 特征的类型
fn show_me&lt;T: Display&gt;(val: T) {
    //可以使用{}格式化字符串，因为有Display特征区间
    printin!(&quot;{}&quot;, val);
}
<span class="boring">}
</span></code></pre></pre>
<ol>
<li>这是在泛型函数的类型签名的长度较短时声明特征区间的常见语法。</li>
<li>在指定类型的特征区间时,此语法也有效</li>
</ol>
<h4 id="where语句-当第一种方法签名过长时使用"><a class="header" href="#where语句-当第一种方法签名过长时使用">where语句: 当第一种方法签名过长时使用</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn parse&lt;F&gt;(&amp;self) -&gt; Result&lt;F, &lt;F as FromStr&gt;::Err&gt;
    where F: FromStr { ... }
<span class="boring">}
</span></code></pre></pre>
<blockquote>
<p>注意“where F: FromStr”部分告诉我们 F 类型必须实现 FromStr 特征。where 语句将特征区间和函数签名解耦,并使其可读</p>
</blockquote>
<h4 id="使用组合多个特征"><a class="header" href="#使用组合多个特征">使用“+“组合多个特征</a></h4>
<ul>
<li>先看一下标准库中 HashMap 类型的 impl 代码块:</li>
</ul>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// HashMap 键类型的 K 必须实现 Hash 特征和 Eq 特征
impl&lt;K: Hash + Eq, V&gt; HashMap&lt;K, V, RandomState&gt;
{}
<span class="boring">}
</span></code></pre></pre>
<ul>
<li>一个更加具体的例子</li>
</ul>
<pre><pre class="playground"><code class="language-rust  editable">// traits_composition.rs

trait Eat {
    fn eat(&amp;self) {
        println!(&quot;eat&quot;);
    }
}

trait Code {
    fn code(&amp;self) {
        println!(&quot;code&quot;);
    }
}

trait Sleep {
    fn sleep(&amp;self) {
        println!(&quot;sleep&quot;);
    }
}

// 创建了一个新的特征 Programmer,它由 3 个特征组合而成:Eat、Code、 Sleep。
// 通过这种方式, 我们对类型设置了约束:
// 因此如果类型 T 实现了 Programmer, 那么它必须实现上述所有特征
trait Programmer: Eat + Code + Sleep {
    fn animate(&amp;self) {
        self.eat();
        self.code();
        self.sleep();
        println!(&quot;repeat!&quot;);
    }
}

struct Bob;

impl Programmer for Bob {}

impl Eat for Bob {}

impl Code for Bob {}

impl Sleep for Bob {}

fn main() {
    Bob.animate();
}
</code></pre></pre>
<h4 id="使用impl特征语法-闭包常用"><a class="header" href="#使用impl特征语法-闭包常用">使用impl特征语法: 闭包常用</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// impl_trait_syntax.rs

use std::fmt::Display;

/*
直接使用了 impl Display,而不是指定 T:Display。这是 impl 特征语法。
这为我们返回复杂或不方便表示的类型(例如函数的闭包)提供了便利
*/
fn show_me(val: impl Display) {
    println!(&quot;{}&quot;, val);
}

fn main() {
    show_me(&quot;Trait bounds are awesome&quot;);
}
</code></pre></pre>
<blockquote>
<p>如果没有这种语法,则必须使用 Box 智能指针类型将其放在指针后面返回,这涉及堆分配。
闭包的底层结构由实现了一系列特征的结构体组成。<strong>Fn(T) -&gt; U</strong> 特征就是其中之一</p>
</blockquote>
<p>闭包使用示例：</p>
<pre><pre class="playground"><code class="language-rust  editable">// impl_trait_closure.rs
// 它接收两个数字,并返回将这两个数字相加的闭包
fn lazy_adder(a: u32, b: u32) -&gt; impl Fn() -&gt; u32 {
    move || a + b
}

fn main() {
    // 调用 lazy_adder,传入两个数字。
    // 这会在 lazy_adder 中创建一个闭包,但不会对其进行求值
    let add_later = lazy_adder(1024, 2048);
    println!(&quot;{:?}&quot;, add_later());
}
</code></pre></pre>
<p>还可以在入参和返回使用：</p>
<pre><pre class="playground"><code class="language-rust  editable">// impl_trait_both.rs

use std::fmt::Display;

/*
1. 会接收任何 Display 特征的参数
2. 返回的类型是 impl Display
*/
fn surround_with_braces(val: impl Display) -&gt; impl Display {
    format!(&quot;{{{}}}&quot;, val)
}

fn main() {
    println!(&quot;{}&quot;, surround_with_braces(&quot;Hello&quot;));
}
</code></pre></pre>
<ol>
<li>通常建议将特征区间的 impl 特征语法用做函数的返回类型。</li>
<li>在参数位置使用它意味着我们不能使用 turbofish 运算符。</li>
<li>如果某些相关代码使用 turbofish 运算符来调用软件包中的某个方法,那么可能导致 API 不兼容。</li>
<li>只有当我们没有可用的具体类型时才应该使用它, 就像闭包那样。</li>
</ol>
<h3 id="特征区间的使用场景"><a class="header" href="#特征区间的使用场景">特征区间的使用场景</a></h3>
<h4 id="在类型上使用不建议"><a class="header" href="#在类型上使用不建议">在类型上使用：不建议</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bounds_types.rs

use std::fmt::Display;

// 写法一：区间内泛型
struct Foo&lt;T: Display&gt; {
    bar: T,
}

// 写法二：where语句解耦
struct Bar&lt;F&gt;
    where
        F: Display,
{
    inner: F,
}

fn main() {}
</code></pre></pre>
<blockquote>
<p>不过,我们并不鼓励在类型上使用特征区间,因为它对类型自身施加了限制。
通常, 我们希望类型尽可能是泛型,从而允许我们使用任何类型创建实例,并使用函数或方法中的特征区间对其行为进行限制。</p>
</blockquote>
<h4 id="泛型函数impl代码块"><a class="header" href="#泛型函数impl代码块">泛型函数+impl代码块</a></h4>
<pre><pre class="playground"><code class="language-rust  editable">// trait_bounds_functions.rs

use std::fmt::Debug;

trait Eatable {
    fn eat(&amp;self);
}

// 指定类型必须是 Debug,以便其可以在方法内部输出到控制台
#[derive(Debug)]
struct Food&lt;T&gt;(T);

#[derive(Debug)]
struct Apple;

// 为了让 apple 是“可食用”的,我们实现了 Food 的 Eatable 特征
impl&lt;T&gt; Eatable for Food&lt;T&gt;
    where
        T: Debug,
{
    fn eat(&amp;self) {
        println!(&quot;Eating {:?}&quot;, self);
    }
}

// 注意 eat 的特点,类型 T 必须实现 Eatable 特征。
fn eat&lt;T&gt;(val: T)
    where
        T: Eatable,
{
    val.eat();
}

fn main() {
    let apple = Food(Apple);
    eat(apple);
}
</code></pre></pre>
<h2 id="特征对象-多态特征类型"><a class="header" href="#特征对象-多态特征类型">特征对象: 多态特征类型</a></h2>
<h3 id="分发dispatch"><a class="header" href="#分发dispatch">分发(dispatch)</a></h3>
<blockquote>
<p>分发是一个从面向对象编程范式中借鉴的概念,主要用于描述被称为多态的上下文中的一种特性。 在面向对象程序设计(Object-Oriented Programming,OOP)中,当 API 是泛型或者接收实现为接口的参数时,必须弄清楚参数在传递给 API 的类型实例上调用什么方法实现。多态的上下文中的方法解析过程被称为分发,调用该方法被称为分发化(dispatching) 。</p>
</blockquote>
<h4 id="分发方式静态-or-动态"><a class="header" href="#分发方式静态-or-动态">分发方式：静态 or 动态</a></h4>
<blockquote>
<p>在支持多态的主流语言中,分发可以通过以下任意一种方式进行。</p>
</blockquote>
<ol>
<li>静态分发：编译期决定</li>
</ol>
<p>当在编译期决定要调用的方法时,它被称为静态分发或早期绑定。方法的签名用于决定调用的方法,所有这些都在编译期决定。在 Rust 中,泛型展示了这种形式的分发, 因为即使泛型函数可以接收许多参数, 也会在编译期使用具体类型生成函数的专用副本。</p>
<p>2.动态分发: 运行期决定，资源开销更大</p>
<p>在面向对象的语言中,有时直到运行时才能确定调用的方法。这是因为具体类型被隐藏,并且只有接口方法可用于调用该类型。 在 Java 中,当函数只有参数时就是这种情况,即接口。 这种情况只能通过动态分发来处理。在动态分发过程中,可通过对
vtable 接口的实现列表进行查找,并调用该方法来动态确定相关方法。vtable 是一个函数指针列表,指向每个类型的实现方法。由于方法调用过程中存在额外的间接指针引用,所以这需要更多的资源开销</p>
<h3 id="区别特征区间与特征对象"><a class="header" href="#区别特征区间与特征对象">区别特征区间与特征对象</a></h3>
<p>|特征使用方式|分发方式|实现方式|绑定时期||
|:----:------------|:--:--------|:--:--------|:--:--------|--|
|特征区间|静态分发|限定泛型|编译期(早期绑定)||
|特征对象|动态分发|胖指针|运行期多态(后期绑定)||</p>
<h3 id="特征对象具体说说"><a class="header" href="#特征对象具体说说">特征对象具体说说</a></h3>
<h4 id="指定为实现某个特征"><a class="header" href="#指定为实现某个特征">指定为实现某个特征</a></h4>
<p>特征对象是一种创建多态 API 的方法,可以将参数指定为实现某个特征的东西,而不是泛型或具体类型。这种方法被声明为实现某个特征 API,即特征对象。</p>
<h4 id="用胖指针实现"><a class="header" href="#用胖指针实现">用胖指针实现</a></h4>
<p>特征对象类似 C++中的虚方法。特征对象实现为胖指针,并且是不定长类型,这意味着它们只能在引用符号(&amp;)后面使用。特征对象胖指针具有指向与对象关联的实际数据的第一指针,而第二指针指向虚拟表(vtable)
,它是在固定偏移处为每个对象的方法保留一个函数指针的结构体。</p>
<h4 id="是rust执行动态分发的方式"><a class="header" href="#是rust执行动态分发的方式">是Rust执行动态分发的方式</a></h4>
<p>特征对象是 Rust 执行动态分发的方式,我们没有实际的具体类型信息。通过跳转到vtable 并调用适当的方法完成方法解析。</p>
<p>特征对象的另一个用例是,它们允许用户对可以具有多种类型的集合进行操作,但是在运行时需要额外的间接指针引用开销</p>
<pre><pre class="playground"><code class="language-rust  editable">// trait_objects.rs

use std::fmt::Debug;

#[derive(Debug)]
struct Square(f32);

#[derive(Debug)]
struct Rectangle(f32, f32);

trait Area: Debug {
    fn get_area(&amp;self) -&gt; f32;
}

impl Area for Square {
    fn get_area(&amp;self) -&gt; f32 {
        self.0 * self.0
    }
}

impl Area for Rectangle {
    fn get_area(&amp;self) -&gt; f32 {
        self.0 * self.1
    }
}

fn main() {
    /*
        shapes 的元素类型是&amp;dyn Area,这是一种表示为特征的类型。
        特征对象是由 dyn Area 表示的, 意味着它是指向 Area 特征某些实现的指针。
        特征对象形式的类型允许用户在集合类型(例如 Vec)中存储不同类型

        Square 和 Rectangle 会隐式转换成特征对象,因为我们给它们推送了一个引用。
        我们还可以通过手动转换某个特征对象来构造一个类型,但这是一种比较少见的情况.
        只有在编译器自身无法将类型作为特征对象转换时使用。
    */
    let shapes: Vec&lt;&amp;dyn Area&gt; = vec![&amp;Square(3f32), &amp;Rectangle(4f32, 2f32)];
    for s in shapes {
        println!(&quot;{:?}&quot;, s);
    }
}
</code></pre></pre>
<h4 id="不定长类型只能作为引用创建"><a class="header" href="#不定长类型只能作为引用创建">不定长类型只能作为引用创建</a></h4>
<blockquote>
<p>请注意,我们只能创建在编译时知道类型尺寸的特征对象。</p>
</blockquote>
<p>dyn Trait 是一个不定长类型,只能作为引用创建。我们还可以通过将特征对象置于其他指针类型之后来创建特征对象,例如 Box、Rc、Arc 等</p>
<pre><pre class="playground"><code class="language-rust  editable">// dyn_trait.rs

use std::fmt::Display;

fn show_me(item: &amp;dyn Display) {
    println!(&quot;{}&quot;, item);
}

fn main() {
    show_me(&amp;&quot;Hello trait object&quot;);
}
</code></pre></pre>
<h2 id="总结特征特征区间和特征对象"><a class="header" href="#总结特征特征区间和特征对象">总结特征、特征区间和特征对象</a></h2>
<p>特征和泛型通过单态化(早期绑定)或运行时多态(后期绑定)提供了两种代码复用的方式。 何时使用它们取决于具体情况和相关应用程序的需求：</p>
<ol>
<li>通常,错误类型会被分配到动态分发的序列,因为它们应该是很少被执行的代码路径。</li>
<li>单态化对小型的应用场景来说非常方便,但是缺点是导致了代码的膨胀和重复,这会影响缓存效率,并增加二进制文件的大小。</li>
</ol>
<blockquote>
<p>但是,在这两个选项中,静态分发应该是首选,除非系统对二进制文件大小存在严格的限制。</p>
</blockquote>
<h2 id="参考资源-6"><a class="header" href="#参考资源-6">参考资源</a></h2>
<h3 id="online-book-8"><a class="header" href="#online-book-8">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch19-03-advanced-traits.html">Advanced Traits - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/trait-bounds.html">Trait and lifetime bounds - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/special-types-and-traits.html">Special types and traits - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/book/ch10-00-generics.html">Generic Types, Traits, and Lifetimes - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch19-03-advanced-traits.html">Advanced Traits - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-8"><a class="header" href="#fragment-8">fragment</a></h3>
<ul>
<li><a href="https://blog.logrocket.com/rust-traits-a-deep-dive/">Rust traits: A deep dive - LogRocket Blog</a></li>
<li><a href="https://zh.m.wikipedia.org/zh-hans/%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B">鸭子类型 - 维基百科，自由的百科全书</a></li>
</ul>
<h3 id="local-8"><a class="header" href="#local-8">local</a></h3>
<ul>
<li><a href="marginnote3app://note/91DC4A44-A289-4D0F-B1D1-89D75181E736">&lt;精通rust(第二版)&gt;-第四章：类型、泛型和特征</a></li>
<li><a href="marginnote3app://note/6D348DE0-2C5C-42E6-A404-4CF0CA1C5678">《代码之髓》- 第五章：函数</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E8%AF%AD%E6%B3%95%E6%A6%82%E8%BF%B0">编程语言语法概述</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/language_grammar.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:35 UTC 2022 -->
<!--te-->
<h1 id="编程语言语法概述"><a class="header" href="#编程语言语法概述">编程语言语法概述</a></h1>
<h2 id="前言"><a class="header" href="#前言">前言</a></h2>
<p>其实编程语言的语法本质上就分成三部分：确定使用什么类型、类型可以用的操作、通用逻辑操作。不过语法又不是这么简单，它担负着两方面的作用：</p>
<ol>
<li>
<p>与编译器交互：因为这些语法在编译器内部都有对应的操作，涉及一系列繁杂的自动化操作。所以当编写语法可以通过编译，至少说明程序可以跑起来。
这一点在rust中尤其明显，毕竟rust是出了名的“面向编译器”开发语言，编译器对语法的要求可以算作“苛刻”。但是这样也有好处，就是潜移默化之中，编程思维也被调整一番。</p>
</li>
<li>
<p>与编程人员交互：这里主要指编程需要可读且易读。这和代码质量息息相关，这里的编程人员不仅包括第一个写出这段代码的人，还包括后续开发以及协作的开发人员。</p>
</li>
</ol>
<h2 id="参考资源-7"><a class="header" href="#参考资源-7">参考资源</a></h2>
<h3 id="online-book-9"><a class="header" href="#online-book-9">online-book</a></h3>
<h3 id="fragment-9"><a class="header" href="#fragment-9">fragment</a></h3>
<h3 id="local-9"><a class="header" href="#local-9">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="注释与文档rustdoc"><a class="header" href="#注释与文档rustdoc">注释与文档(rustdoc)</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#%E6%B3%A8%E9%87%8A%E4%B8%8E%E6%96%87%E6%A1%A3rustdoc">注释与文档(rustdoc)</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#%E6%B3%A8%E9%87%8A%E6%96%B9%E6%B3%95">注释方法</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#rustdoc%E4%BD%BF%E7%94%A8">rustdoc使用</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/annotation_rustdoc.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:34 UTC 2022 -->
<!--te-->
<h2 id="注释方法"><a class="header" href="#注释方法">注释方法</a></h2>
<h2 id="rustdoc使用"><a class="header" href="#rustdoc使用">rustdoc使用</a></h2>
<h2 id="参考资源-8"><a class="header" href="#参考资源-8">参考资源</a></h2>
<h3 id="online-book-10"><a class="header" href="#online-book-10">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/rustdoc/index.html">What is rustdoc? - The rustdoc book</a></li>
</ul>
<h3 id="fragment-10"><a class="header" href="#fragment-10">fragment</a></h3>
<h3 id="local-10"><a class="header" href="#local-10">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="词法关键字扫盲"><a class="header" href="#词法关键字扫盲">词法关键字扫盲</a></h1>
<h2 id="1-关键字"><a class="header" href="#1-关键字">1. 关键字</a></h2>
<h3 id="严格关键字"><a class="header" href="#严格关键字">严格关键字</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>as / break / const / continue / crate / if / else / struct / enum / true / false / fn / for / in / let / loop / impl / mod / match / move mut / pub / ref / return / self / Self / static / super /trait / type / unsafe /use / where / while / async /await/dyn/main
<span class="boring">}
</span></code></pre></pre>
<h3 id="弱关键字"><a class="header" href="#弱关键字">弱关键字</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>abstract / become / box / do / final / macro / override / priv / typeof / unsized / virtual / yield / try
<span class="boring">}
</span></code></pre></pre>
<h3 id="保留字"><a class="header" href="#保留字">保留字</a></h3>
<ul>
<li>2018 Edition:union,’static</li>
<li>2015 Edition:dyn</li>
</ul>
<blockquote>
<p>被保留的关键字不代表将来一定会使用</p>
</blockquote>
<h2 id="2-标识符"><a class="header" href="#2-标识符">2. 标识符</a></h2>
<h2 id="3-注释"><a class="header" href="#3-注释">3. 注释</a></h2>
<blockquote>
<p>//!, /<em>!, //!!, /</em>!!, /<strong>…<em>/, //, ////, /</em></strong>…*/</p>
</blockquote>
<h2 id="4-空白-nttab"><a class="header" href="#4-空白-nttab">4. 空白: \n、\t、tab</a></h2>
<blockquote>
<p>任何形式的空白字符在RuSt中只用于分隔标记，没有语义意义。</p>
</blockquote>
<h2 id="5-词条"><a class="header" href="#5-词条">5. 词条</a></h2>
<ol>
<li>语言项(item)</li>
<li>块(block)</li>
<li>语句（Stmt)</li>
<li>表达式（Expr)</li>
<li>模式（Pattern)</li>
<li>关键字（Keyword)</li>
<li>标识符（Ident)</li>
<li>字面量(Literal)</li>
<li>生命周期(Lifetime)</li>
<li>可见性(Vis)</li>
<li>标点符号（Punctuation)</li>
<li>分隔符（delimiter)</li>
<li>词条树(Token Tree)</li>
<li>属性（Attribute)</li>
</ol>
<h2 id="路径--"><a class="header" href="#路径--">路径: ::, ::&lt;&gt;</a></h2>
<h2 id="参考资源-9"><a class="header" href="#参考资源-9">参考资源</a></h2>
<h3 id="online-book-11"><a class="header" href="#online-book-11">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/lexical-structure.html">Lexical structure - The Rust Reference</a></li>
</ul>
<h3 id="fragment-11"><a class="header" href="#fragment-11">fragment</a></h3>
<ul>
<li><a href="https://time.geekbang.org/course/detail/100060601-286522">词法结构</a></li>
</ul>
<h3 id="local-11"><a class="header" href="#local-11">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="绑定赋值与匹配模式"><a class="header" href="#绑定赋值与匹配模式">绑定、赋值与匹配模式</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html#%E7%BB%91%E5%AE%9A%E8%B5%8B%E5%80%BC%E4%B8%8E%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F">绑定、赋值与匹配模式</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/binding_match_patterns.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:34 UTC 2022 -->
<!--te-->
<h2 id="参考资源-10"><a class="header" href="#参考资源-10">参考资源</a></h2>
<h3 id="online-book-12"><a class="header" href="#online-book-12">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/patterns.html">Patterns - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/book/ch06-00-enums.html">Enums and Pattern Matching - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch18-00-patterns.html">Patterns and Matching - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-12"><a class="header" href="#fragment-12">fragment</a></h3>
<h3 id="local-12"><a class="header" href="#local-12">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="逻辑判断与循环"><a class="header" href="#逻辑判断与循环">逻辑判断与循环</a></h1>
<h2 id="参考资源-11"><a class="header" href="#参考资源-11">参考资源</a></h2>
<h3 id="online-book-13"><a class="header" href="#online-book-13">online-book</a></h3>
<h3 id="fragment-13"><a class="header" href="#fragment-13">fragment</a></h3>
<h3 id="local-13"><a class="header" href="#local-13">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="语句与表达式"><a class="header" href="#语句与表达式">语句与表达式</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html#%E8%AF%AD%E5%8F%A5%E4%B8%8E%E8%A1%A8%E8%BE%BE%E5%BC%8F">语句与表达式</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/statements_expressions.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:35 UTC 2022 -->
<!--te-->
<h2 id="参考资源-12"><a class="header" href="#参考资源-12">参考资源</a></h2>
<h3 id="online-book-14"><a class="header" href="#online-book-14">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/statements.html">Statements - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/expressions.html">Expressions - The Rust Reference</a></li>
</ul>
<h3 id="fragment-14"><a class="header" href="#fragment-14">fragment</a></h3>
<h3 id="local-14"><a class="header" href="#local-14">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="代码质量异常测试与日志"><a class="header" href="#代码质量异常测试与日志">代码质量：异常、测试与日志</a></h1>
<!--ts-->
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E5%BC%82%E5%B8%B8%E6%B5%8B%E8%AF%95%E4%B8%8E%E6%97%A5%E5%BF%97">代码质量：异常、测试与日志</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">错误处理</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#rust_backtrace%E7%9A%84%E7%94%A8%E6%B3%95">RUST_BACKTRACE的用法</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">设置环境变量</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#%E4%B8%B4%E6%97%B6%E8%AE%BE%E7%BD%AE%E4%BD%BF%E7%94%A8">临时设置使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#online-book">online-book</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#fragment">fragment</a></li>
<li><a href="layer1_underlying_abstract/3_language_grammar/code_quality.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:34 UTC 2022 -->
<!--te-->
<h2 id="错误处理"><a class="header" href="#错误处理">错误处理</a></h2>
<h3 id="rust_backtrace的用法"><a class="header" href="#rust_backtrace的用法">RUST_BACKTRACE的用法</a></h3>
<ul>
<li>1 : 打印简略错误信息</li>
<li>full: 打印详细错误信息</li>
</ul>
<h4 id="设置环境变量"><a class="header" href="#设置环境变量">设置环境变量</a></h4>
<pre><code class="language-shell">export RUST_BACKTRACE=1
echo $RUST_BACKTRACE
</code></pre>
<h4 id="临时设置使用"><a class="header" href="#临时设置使用">临时设置使用</a></h4>
<pre><code class="language-shell">RUST_BACKTRACE=1 cargo run
RUST_BACKTRACE=full mdbook serve
</code></pre>
<h2 id="参考资源-13"><a class="header" href="#参考资源-13">参考资源</a></h2>
<h3 id="online-book-15"><a class="header" href="#online-book-15">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch11-00-testing.html">Writing Automated Tests - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-15"><a class="header" href="#fragment-15">fragment</a></h3>
<ul>
<li><a href="https://www.runoob.com/rust/rust-error-handle.html">Rust 错误处理 | 菜鸟教程</a></li>
</ul>
<h3 id="local-15"><a class="header" href="#local-15">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="设计抽象"><a class="header" href="#设计抽象">设计抽象</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/layer2_design_abstract.html#%E8%AE%BE%E8%AE%A1%E6%8A%BD%E8%B1%A1">设计抽象</a>
<ul>
<li><a href="layer2_design_abstract/layer2_design_abstract.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/layer2_design_abstract.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/layer2_design_abstract.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/layer2_design_abstract.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:38 UTC 2022 -->
<!--te-->
<h2 id="参考资源-14"><a class="header" href="#参考资源-14">参考资源</a></h2>
<h3 id="online-book-16"><a class="header" href="#online-book-16">online-book</a></h3>
<h3 id="fragment-16"><a class="header" href="#fragment-16">fragment</a></h3>
<h3 id="local-16"><a class="header" href="#local-16">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="编程范式"><a class="header" href="#编程范式">编程范式</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html#%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F">编程范式</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/4_programming_paradigm.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:35 UTC 2022 -->
<!--te-->
<h2 id="参考资源-15"><a class="header" href="#参考资源-15">参考资源</a></h2>
<h3 id="online-book-17"><a class="header" href="#online-book-17">online-book</a></h3>
<h3 id="fragment-17"><a class="header" href="#fragment-17">fragment</a></h3>
<h3 id="local-17"><a class="header" href="#local-17">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="函数式编程"><a class="header" href="#函数式编程">函数式编程</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/fp.html#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B">函数式编程</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/fp.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/fp.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/fp.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/fp.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:36 UTC 2022 -->
<!--te-->
<h2 id="参考资源-16"><a class="header" href="#参考资源-16">参考资源</a></h2>
<h3 id="online-book-18"><a class="header" href="#online-book-18">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch13-00-functional-features.html">Functional Language Features: Iterators and Closures - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch19-05-advanced-functions-and-closures.html">Advanced Functions and Closures - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-18"><a class="header" href="#fragment-18">fragment</a></h3>
<h3 id="local-18"><a class="header" href="#local-18">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="面向对象编程"><a class="header" href="#面向对象编程">面向对象编程</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/oop.html#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B">面向对象编程</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/oop.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/oop.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/oop.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/oop.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:36 UTC 2022 -->
<!--te-->
<h2 id="参考资源-17"><a class="header" href="#参考资源-17">参考资源</a></h2>
<h3 id="online-book-19"><a class="header" href="#online-book-19">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch17-00-oop.html">Object Oriented Programming Features of Rust - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-19"><a class="header" href="#fragment-19">fragment</a></h3>
<h3 id="local-19"><a class="header" href="#local-19">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="泛型编程"><a class="header" href="#泛型编程">泛型编程</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/gp.html#%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B">泛型编程</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/gp.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/4_programming_paradigm/gp.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/gp.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/4_programming_paradigm/gp.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:36 UTC 2022 -->
<!--te-->
<h2 id="参考资源-18"><a class="header" href="#参考资源-18">参考资源</a></h2>
<h3 id="online-book-20"><a class="header" href="#online-book-20">online-book</a></h3>
<h3 id="fragment-20"><a class="header" href="#fragment-20">fragment</a></h3>
<h3 id="local-20"><a class="header" href="#local-20">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="设计模式"><a class="header" href="#设计模式">设计模式</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">设计模式</a>
<ul>
<li><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/5_design_pattern/5_design_pattern.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:36 UTC 2022 -->
<!--te-->
<h2 id="参考资源-19"><a class="header" href="#参考资源-19">参考资源</a></h2>
<h3 id="online-book-21"><a class="header" href="#online-book-21">online-book</a></h3>
<h3 id="fragment-21"><a class="header" href="#fragment-21">fragment</a></h3>
<h3 id="local-21"><a class="header" href="#local-21">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="项目模块管理及扩展"><a class="header" href="#项目模块管理及扩展">项目模块管理及扩展</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/6_module_manage/6_module_manage.html#%E9%A1%B9%E7%9B%AE%E6%A8%A1%E5%9D%97%E7%AE%A1%E7%90%86%E5%8F%8A%E6%89%A9%E5%B1%95">项目模块管理及扩展</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/6_module_manage.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/6_module_manage.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/6_module_manage/6_module_manage.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/6_module_manage/6_module_manage.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:36 UTC 2022 -->
<!--te-->
<p>对于一门编程语言，是否能够成为工程化开发工具的主要标准在于两点：</p>
<ol>
<li>包管理、模块管理</li>
<li>扩展工具是否方便加入</li>
</ol>
<p>这里面包含一些通用的设计抽象，因此专门作为单独的一层。</p>
<h2 id="参考资源-20"><a class="header" href="#参考资源-20">参考资源</a></h2>
<h3 id="online-book-22"><a class="header" href="#online-book-22">online-book</a></h3>
<h3 id="fragment-22"><a class="header" href="#fragment-22">fragment</a></h3>
<h3 id="local-22"><a class="header" href="#local-22">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="模块系统相关workspacepackagecratemodule"><a class="header" href="#模块系统相关workspacepackagecratemodule">模块系统相关：Workspace、Package、Crate、Module</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3workspacepackagecratemodule">模块系统相关：Workspace、Package、Crate、Module</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E5%8E%98%E6%B8%85workspacepackagecrate%E5%92%8Cmodule%E7%9A%84%E5%85%B3%E7%B3%BB">厘清Workspace、Package、crate和module的关系</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#package-%E5%8C%85%E5%90%ABcargotoml">Package: 包含Cargo.toml</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#workspace%E4%B8%8Epackage">workspace与package</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E5%85%B7%E4%BD%93%E5%AF%B9%E6%AF%94package%E5%92%8Ccrate">具体对比package和crate</a>
<ul>
<li>[在Cargo.toml的[bin]/[lib]中指明](#在cargotoml的binlib中指明)</li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E5%86%8D%E6%9D%A5%E5%AF%B9%E6%AF%94workspacepackage%E5%92%8Ccrate">再来对比workspace、package和crate</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#module">module</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E6%95%B4%E7%90%86%E8%AF%B4%E4%B8%80%E4%B8%8Brust%E7%9A%84%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F">整理说一下rust的模块系统</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E8%81%94%E6%83%B3%E5%AF%B9%E6%AF%94">联想对比</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#module-tree">module tree</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F">模块使用方式</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E7%9B%AE%E5%BD%95%E6%A8%A1%E5%9D%97">目录模块</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E5%B5%8C%E5%A5%97%E5%AF%BC%E5%85%A5">嵌套导入</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#pubcrate%E5%AF%BC%E5%87%BA">pub/crate导出</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/6_module_manage/module_system.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:37 UTC 2022 -->
<!--te-->
<h2 id="厘清workspacepackagecrate和module的关系"><a class="header" href="#厘清workspacepackagecrate和module的关系">厘清Workspace、Package、crate和module的关系</a></h2>
<h3 id="package-包含cargotoml"><a class="header" href="#package-包含cargotoml">Package: 包含Cargo.toml</a></h3>
<p>package就是cargo new的产物，里面包含一个cargo.toml，包名就写在里面的package里。比如substrate的一个包代码：</p>
<blockquote>
<p><a href="https://github.com/paritytech/substrate/blob/master/client/allocator/Cargo.toml">substrate/Cargo.toml at master · paritytech/substrate</a></p>
</blockquote>
<pre><code class="language-toml">[package]
name = &quot;sc-allocator&quot;
version = &quot;4.1.0-dev&quot;
authors = [&quot;Parity Technologies &lt;admin@parity.io&gt;&quot;]
edition = &quot;2021&quot;
license = &quot;Apache-2.0&quot;
homepage = &quot;https://substrate.io&quot;
repository = &quot;https://github.com/paritytech/substrate/&quot;
description = &quot;Collection of allocator implementations.&quot;
documentation = &quot;https://docs.rs/sc-allocator&quot;
readme = &quot;README.md&quot;

[package.metadata.docs.rs]
targets = [&quot;x86_64-unknown-linux-gnu&quot;]

[dependencies]
log = &quot;0.4.17&quot;
thiserror = &quot;1.0.30&quot;
sp-core = { version = &quot;6.0.0&quot;, path = &quot;../../primitives/core&quot; }
sp-wasm-interface = { version = &quot;6.0.0&quot;, path = &quot;../../primitives/wasm-interface&quot; }
</code></pre>
<ol>
<li>package表明该package的基本信息</li>
<li>dependencies表示该package依赖的其他package</li>
</ol>
<h3 id="workspace与package"><a class="header" href="#workspace与package">workspace与package</a></h3>
<ul>
<li>workspace+members: 并发代表当前package包含的所有subpackage，只是指明一个工作区的所有package</li>
</ul>
<blockquote>
<p>A Cargo.toml file can simultaneously define a package and a workspace to which it belongs, but that package is still a
member of that workspace, not the other way around.</p>
</blockquote>
<h3 id="具体对比package和crate"><a class="header" href="#具体对比package和crate">具体对比package和crate</a></h3>
<div id="admonition-package和crate" class="admonition tip">
<div class="admonition-title">
<p>package和crate</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-package和crate"></a></p>
</div>
<div>
<p>在rust中，最小编译单元叫crate，package是一个或多个crate的集合。</p>
<blockquote>
<p>也就是说，如果package没有指明crate，本身就是一个crate</p>
</blockquote>
</div>
</div>
<h4 id="在cargotoml的binlib中指明"><a class="header" href="#在cargotoml的binlib中指明">在Cargo.toml的[bin]/[lib]中指明</a></h4>
<h3 id="再来对比workspacepackage和crate"><a class="header" href="#再来对比workspacepackage和crate">再来对比workspace、package和crate</a></h3>
<div id="admonition-hierarchy" class="admonition info">
<div class="admonition-title">
<p>hierarchy</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-hierarchy"></a></p>
</div>
<div>
<p>Workspace → Package → Crate</p>
</div>
</div>
<p>Generally, a package exposes only one crate. Most library crates don’t even have an associated binary crate(s) in their
package. It’s due to this that package/crate terminology is often used interchangeably; for lib crates it is in the 90%
case. Package is also a generic term that people not familiar with Rust’s ecosystem can understand, where crate is a
Rust-specific piece of jargon.</p>
<p>The two concepts are still meaningfully different – while conventionally package and lib crate have the same name (
modulo hyphens vs underscores), this is not required in any way – but for the most part there isn’t an appreciable
difference unless you’re paying attention to the weeds and edge cases.</p>
<h3 id="module"><a class="header" href="#module">module</a></h3>
<p>在rust中，module(模块)更多还是一种逻辑上的概念，主要使用mod关键字，下面会具体说说</p>
<div id="admonition-模块主要还是为了控制作用域scope和隐私privacy" class="admonition tip">
<div class="admonition-title">
<p>模块主要还是为了控制作用域(scope)和隐私(privacy)</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-模块主要还是为了控制作用域scope和隐私privacy"></a></p>
</div>
<div>
</div>
</div>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>mod say {
    pub fn hello() {
        println!(&quot;Hello, world!&quot;);
    }
}
<span class="boring">}
</span></code></pre></pre>
<h3 id="整理说一下rust的模块系统"><a class="header" href="#整理说一下rust的模块系统">整理说一下rust的模块系统</a></h3>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1172.4426px" preserveAspectRatio="none" style="width:900px;height:1172px;background:#000000;" version="1.1" viewBox="0 0 900 1172" width="900.9395px" zoomAndPan="magnify"><defs/><g><rect fill="#333333" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="101.4614" x="9.3946" y="568.5551"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="82.6722" x="18.7891" y="590.158">Rust模块系统</text><rect fill="#2E2E2E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="71.3987" x="157.8288" y="136.3974"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="52.6096" x="167.2234" y="158.0004">两种视角</text><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="58.2463" x="276.2004" y="18.7891"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="39.4572" x="285.595" y="40.3921">程序猿</text><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="71.3987" x="381.4196" y="18.7891"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="52.6096" x="390.8142" y="40.3921">文件结构</text><path d="M334.4468,35.8388 L343.8413,35.8388 C357.9332,35.8388 357.9332,35.8388 372.0251,35.8388 L381.4196,35.8388 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M229.2276,153.4471 L238.6221,153.4471 C252.714,153.4471 252.714,35.8388 266.8058,35.8388 L276.2004,35.8388 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="143.737" x="276.2004" y="162.8417"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="124.9478" x="285.595" y="184.4446">rustc：module tree</text><rect fill="#0E0E0E" height="64.7198" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="407.7244" x="466.9102" y="71.6776"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="65.762" x="476.3048" y="93.2806">可执行root</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="82.6722" x="476.3048" y="108.5908">src/main.rs</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="388.9353" x="476.3048" y="123.901">-&gt; binary crate(默认与cargo.toml-&gt;[package].name同名)</text><path d="M419.9374,179.8914 L429.3319,179.8914 C443.4238,179.8914 443.4238,104.0375 457.5157,104.0375 L466.9102,104.0375 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="64.7198" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="385.1775" x="466.9102" y="155.1866"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="39.4572" x="476.3048" y="176.7895">库root</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="75.1566" x="476.3048" y="192.0997">src/lib.rs</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="366.3883" x="476.3048" y="207.4099">-&gt; lib crate(默认与cargo.toml-&gt;[package].name同名)</text><path d="M419.9374,179.8914 L429.3319,179.8914 C443.4238,179.8914 443.4238,187.5465 457.5157,187.5465 L466.9102,187.5465 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="49.4096" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="252.714" x="466.9102" y="238.6955"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="32.881" x="476.3048" y="260.2985">crate</text><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="233.9248" x="476.3048" y="275.6087">&lt;code&gt;编译的最小基本单位&lt;/code&gt;</text><path d="M419.9374,179.8914 L429.3319,179.8914 C443.4238,179.8914 443.4238,263.4003 457.5157,263.4003 L466.9102,263.4003 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M229.2276,153.4471 L238.6221,153.4471 C252.714,153.4471 252.714,179.8914 266.8058,179.8914 L276.2004,179.8914 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M110.8559,585.6048 L120.2505,585.6048 C134.3424,585.6048 134.3424,153.4471 148.4342,153.4471 L157.8288,153.4471 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#2E2E2E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="129.6451" x="157.8288" y="412.6713"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="110.8559" x="167.2234" y="434.2742">project的五个层级</text><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="89.2484" x="334.4468" y="306.8942"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="70.4593" x="343.8413" y="328.4972">workspace</text><path d="M287.4739,429.7209 L296.8685,429.7209 C310.9603,429.7209 310.9603,323.9439 325.0522,323.9439 L334.4468,323.9439 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="74.2171" x="334.4468" y="359.7828"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="55.428" x="343.8413" y="381.3857">package</text><path d="M287.4739,429.7209 L296.8685,429.7209 C310.9603,429.7209 310.9603,376.8324 325.0522,376.8324 L334.4468,376.8324 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="59.1858" x="334.4468" y="412.6713"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="40.3967" x="343.8413" y="434.2742">crates</text><path d="M287.4739,429.7209 L296.8685,429.7209 C310.9603,429.7209 310.9603,429.7209 325.0522,429.7209 L334.4468,429.7209 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="75.1566" x="334.4468" y="465.5598"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="56.3674" x="343.8413" y="487.1627">modules</text><path d="M287.4739,429.7209 L296.8685,429.7209 C310.9603,429.7209 310.9603,482.6094 325.0522,482.6094 L334.4468,482.6094 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="55.428" x="334.4468" y="518.4483"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="36.6388" x="343.8413" y="540.0512">paths</text><path d="M287.4739,429.7209 L296.8685,429.7209 C310.9603,429.7209 310.9603,535.4979 325.0522,535.4979 L334.4468,535.4979 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M110.8559,585.6048 L120.2505,585.6048 C134.3424,585.6048 134.3424,429.7209 148.4342,429.7209 L157.8288,429.7209 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#2E2E2E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="224.5303" x="157.8288" y="571.3368"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="205.7411" x="167.2234" y="592.9397">bin文件夹：可以直接使用src/lib.rs</text><path d="M110.8559,585.6048 L120.2505,585.6048 C134.3424,585.6048 134.3424,588.3864 148.4342,588.3864 L157.8288,588.3864 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#383838" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="153.1315" x="157.8288" y="871.2732"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="134.3424" x="167.2234" y="892.8761">crates.io保存的什么？</text><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="71.3987" x="357.9332" y="829.5187"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="52.6096" x="367.3278" y="851.1216">发布流程</text><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="90.1879" x="476.3048" y="624.2253"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="71.3987" x="485.6994" y="645.8282">cargo login</text><path d="M429.3319,846.5684 L438.7265,846.5684 C452.8184,846.5684 452.8184,641.275 466.9102,641.275 L476.3048,641.275 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#383838" height="233.1322" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="413.3612" x="476.3048" y="677.1138"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="95.8246" x="485.6994" y="698.7167">cargo package</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="150.3132" x="485.6994" y="714.0269">$ cargo help package</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="251.7745" x="485.6994" y="729.3371">从帮助信息结合substrate源码实验&#129514;可知：</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="394.572" x="485.6994" y="744.6474">1. 从当前目录开始执行路径开始，首先去父文件夹找Cargo.toml,</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="272.4426" x="485.6994" y="759.9576">然后找当前目录的Cargo.toml，找不到就报错</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="283.7161" x="485.6994" y="775.2678">2. 找到的Cargo.toml如果有workspace配置，</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="313.7787" x="485.6994" y="790.578">就按照workspace里面的subpackage顺序来依次打包</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="319.4154" x="485.6994" y="805.8882">3. 每次打包的标志为src/main.rs或者src/lib.rs,</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="353.2359" x="485.6994" y="821.1984">且src同级存在Cargo.toml,Cargo.toml里面有[package]</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="227.3486" x="485.6994" y="836.5087">4. 开始打包为上传到crate.io的格式</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="75.1566" x="485.6994" y="851.8189">5. 依次打包</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="345.7203" x="485.6994" y="867.1291">6. 所有依赖必须是在crate.io可以找到的，找不到就报错</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="281.8372" x="485.6994" y="882.4393">7. 以包含Cargo.toml父文件夹为项目根目录，</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="157.8288" x="485.6994" y="897.7495">放在target/package里面</text><path d="M429.3319,846.5684 L438.7265,846.5684 C452.8184,846.5684 452.8184,793.6799 466.9102,793.6799 L476.3048,793.6799 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="106.1587" x="476.3048" y="929.0351"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="87.3695" x="485.6994" y="950.638">cargo publish</text><path d="M429.3319,846.5684 L438.7265,846.5684 C452.8184,846.5684 452.8184,946.0848 466.9102,946.0848 L476.3048,946.0848 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="89.2484" x="476.3048" y="981.9236"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="70.4593" x="485.6994" y="1003.5265">cargo yank</text><path d="M429.3319,846.5684 L438.7265,846.5684 C452.8184,846.5684 452.8184,998.9733 466.9102,998.9733 L476.3048,998.9733 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#0E0E0E" height="34.0994" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="99.5825" x="476.3048" y="1034.8121"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="80.7933" x="485.6994" y="1056.415">cargo owner</text><path d="M429.3319,846.5684 L438.7265,846.5684 C452.8184,846.5684 452.8184,1051.8618 466.9102,1051.8618 L476.3048,1051.8618 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M310.9603,888.3228 L320.3549,888.3228 C334.4468,888.3228 334.4468,846.5684 348.5386,846.5684 L357.9332,846.5684 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><rect fill="#383838" height="64.7198" rx="11.7432" ry="11.7432" style="stroke:#E7E7E7;stroke-width:1.4091858037578289;" width="505.428" x="357.9332" y="1087.7006"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13.1524" lengthAdjust="spacing" textLength="126.8267" x="367.3278" y="1109.3035">crate.io包含代码总结</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="486.6388" x="367.3278" y="1124.6138">1. 只包含最小crate内容，也就是src/main.rs或者src/lib.rs + Cargo.toml</text><text fill="#FFFFFF" font-family="monospace" font-size="13.1524" lengthAdjust="spacing" textLength="366.3883" x="367.3278" y="1139.924">2. rust只能允许一级嵌套，使用workspace分出subpackage</text><path d="M310.9603,888.3228 L320.3549,888.3228 C334.4468,888.3228 334.4468,1120.0605 348.5386,1120.0605 L357.9332,1120.0605 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/><path d="M110.8559,585.6048 L120.2505,585.6048 C134.3424,585.6048 134.3424,888.3228 148.4342,888.3228 L157.8288,888.3228 " fill="none" style="stroke:#E7E7E7;stroke-width:0.9394572025052192;"/></g></svg></figure>
<h3 id="联想对比"><a class="header" href="#联想对比">联想对比</a></h3>
<ol>
<li>golang的模块系统</li>
<li>python/js的模块系统</li>
<li>mdbook的所有文章只能挂到SUMMARY才能生成链接。</li>
</ol>
<h3 id="module-tree"><a class="header" href="#module-tree">module tree</a></h3>
<ul>
<li>module Tree只有一个入口（根），src/main.rs或src/lib.rs</li>
<li>默认情况下，lib.rs和main.rs的crate都和cargo.toml里面的[package].name同名</li>
<li>但是cargo.toml里面可以给crate重命名：[lib]重命名lib.rs, [binary]重命名main.rs</li>
</ul>
<h2 id="模块使用方式"><a class="header" href="#模块使用方式">模块使用方式</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="669px" preserveAspectRatio="none" style="width:719px;height:669px;background:#FFFFFF;" version="1.1" viewBox="0 0 719 669" width="719px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="104" x="10" y="315.5586"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="20" y="338.5537">模块使用方式</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="76" x="164" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="174" y="155.5889">存在形式</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="312" x="290" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="292" x="300" y="42.9951">嵌套模块: mod可以在一个文件中定义多个模块</text><path d="M240,150.7422 L250,150.7422 C265,150.7422 265,38.1484 280,38.1484 L290,38.1484 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="317" x="290" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="297" x="300" y="99.292">文件模块：不带mod的文件，以文件名为模块名</text><path d="M240,150.7422 L250,150.7422 C265,150.7422 265,94.4453 280,94.4453 L290,94.4453 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="76" x="290" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="300" y="211.8857">目录模块</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="146" x="416" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="426" y="155.5889">目录同级有同名文件</text><path d="M366,207.0391 L376,207.0391 C391,207.0391 391,150.7422 406,150.7422 L416,150.7422 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="291" x="416" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="271" x="426" y="211.8857">同名文件中导入目录中的文件模块/嵌套模块</text><path d="M366,207.0391 L376,207.0391 C391,207.0391 391,207.0391 406,207.0391 L416,207.0391 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="160" x="416" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="426" y="268.1826">在同名文件中开始使用</text><path d="M366,207.0391 L376,207.0391 C391,207.0391 391,263.3359 406,263.3359 L416,263.3359 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M240,150.7422 L250,150.7422 C265,150.7422 265,207.0391 280,207.0391 L290,207.0391 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M114,333.707 L124,333.707 C139,333.707 139,150.7422 154,150.7422 L164,150.7422 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="146" x="164" y="385.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="174" y="408.9248">隐私管理与导出导入</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="145" x="360" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="370" y="324.4795">pub: 导出-变为公有</text><path d="M310,404.0781 L320,404.0781 C335,404.0781 335,319.6328 350,319.6328 L360,319.6328 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="81" x="360" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="370" y="437.0732">导入方式:</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="186" x="491" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="501" y="380.7764">use: 导入-进入当前作用域</text><path d="M441,432.2266 L451,432.2266 C466,432.2266 466,375.9297 481,375.9297 L491,375.9297 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="142" x="491" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="501" y="437.0732">再次导入: pub use</text><path d="M441,432.2266 L451,432.2266 C466,432.2266 466,432.2266 481,432.2266 L491,432.2266 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="192" x="491" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="501" y="493.3701">嵌套导入：使用{}作为嵌套</text><path d="M441,432.2266 L451,432.2266 C466,432.2266 466,488.5234 481,488.5234 L491,488.5234 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M310,404.0781 L320,404.0781 C335,404.0781 335,432.2266 350,432.2266 L360,432.2266 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M114,333.707 L124,333.707 C139,333.707 139,404.0781 154,404.0781 L164,404.0781 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="104" x="164" y="568.8945"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="174" y="591.8896">两类导入路径</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="120" x="318" y="526.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="328" y="549.667">crate: 绝对导入</text><path d="M268,587.043 L278,587.043 C293,587.043 293,544.8203 308,544.8203 L318,544.8203 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="141" x="318" y="582.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="328" y="605.9639">相对导入: 提高内聚</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="151" x="509" y="554.8203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="519" y="577.8154">self: 与当前模块相关</text><path d="M459,601.1172 L469,601.1172 C484,601.1172 484,572.9688 499,572.9688 L509,572.9688 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="153" x="509" y="611.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="519" y="634.1123">super: 从父模块导入</text><path d="M459,601.1172 L469,601.1172 C484,601.1172 484,629.2656 499,629.2656 L509,629.2656 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M268,587.043 L278,587.043 C293,587.043 293,601.1172 308,601.1172 L318,601.1172 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M114,333.707 L124,333.707 C139,333.707 139,587.043 154,587.043 L164,587.043 " fill="none" style="stroke:#181818;stroke-width:1.0;"/></g></svg></figure>
<div id="admonition-关于细节说明" class="admonition info">
<div class="admonition-title">
<p>关于细节说明</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-关于细节说明"></a></p>
</div>
<div>
<p>下方对应小标题会对思维导图中的重点内容进行详叙和代码展示</p>
</div>
</div>
<h3 id="目录模块"><a class="header" href="#目录模块">目录模块</a></h3>
<pre><code class="language-shell">tree -L 2                                                                                                      ─╯
.
├── foo
│   └── bar.rs
├── foo.rs
└── main.rs

1 directory, 3 files
</code></pre>
<ul>
<li>foo/bar.rs</li>
</ul>
<pre><pre class="playground"><code class="language-rust editable">
pub struct Bar; // 导出给foo.rs使用

impl Bar {
    pub fn hello() {
        println!(&quot;Hello from Bar !&quot;);
    }
}
</code></pre></pre>
<ul>
<li>foo.rs</li>
</ul>
<pre><pre class="playground"><code class="language-rust editable">
mod bar; // 使用同名目录foo下的文件模块foo/bar.rs

pub use self::bar::Bar; // 再次指定导入bar::Bar

pub fn do_foo() {
    println!(&quot;Hi from foo!&quot;);
}
</code></pre></pre>
<h3 id="嵌套导入"><a class="header" href="#嵌套导入">嵌套导入</a></h3>
<pre><pre class="playground"><code class="language-rust editable">// nested_imports.rs
// 使用{}嵌套导入
use std::sync::{Arc, Mutex, mpsc::{channel, Sender, Receiver}};

fn consume(_tx: Sender&lt;()&gt;, _rx: Receiver&lt;()&gt;) { } 

fn main() {
    let _ = Arc::new(Mutex::new(40));
    let (tx, rx) = channel();
    consume(tx, rx);
}
</code></pre></pre>
<h3 id="pubcrate导出"><a class="header" href="#pubcrate导出">pub/crate导出</a></h3>
<div id="admonition-pubcrate-fn-fn_name-" class="admonition info">
<div class="admonition-title">
<p>pub(crate) fn fn_name() {}</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-pubcrate-fn-fn_name-"></a></p>
</div>
<div>
<p>Rust 中元素的隐私性是从模块层面开始的。作为程序库的作者,要从模块向用户公开一些内容可以使用关键字 pub。</p>
<blockquote>
<p>但是对于有一些元素,我们只想暴露给软件包中的其他模块,而不是用户。</p>
</blockquote>
<p>在这种情况下,我们可以对元素使用 pub(crate)修饰符,这允许元素仅在软件包内部暴露</p>
</div>
</div>
<h2 id="参考资源-21"><a class="header" href="#参考资源-21">参考资源</a></h2>
<div id="admonition-不要把其他人的话直接照抄" class="admonition note">
<div class="admonition-title">
<p>不要把其他人的话直接照抄！</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-不要把其他人的话直接照抄"></a></p>
</div>
<div>
<p>保持批判，有所取舍，知行合一, 方见真我</p>
</div>
</div>
<h3 id="online-book-23"><a class="header" href="#online-book-23">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/stable/reference/visibility-and-privacy.html">Visibility and privacy - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/stable/reference/visibility-and-privacy.html#pubin-path-pubcrate-pubsuper-and-pubself">pub(in path), pub(crate), pub(super), and pub(self) - The Rust Reference</a></li>
<li><a href="https://doc.rust-lang.org/book/ch07-00-managing-growing-projects-with-packages-crates-and-modules.html">Managing Growing Projects with Packages, Crates, and Modules - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/stable/rust-by-example/mod.html">Modules - Rust By Example</a></li>
<li><a href="https://doc.rust-lang.org/stable/rust-by-example/crates.html">Crates - Rust By Example</a></li>
</ul>
<h3 id="fragment-23"><a class="header" href="#fragment-23">fragment</a></h3>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220620093333/https://mp.weixin.qq.com/s/mQ0zh_tcLEZZNpGIbz6BVA">了解下Rust 模块使用方式</a></p>
</li>
<li>
<p><a href="https://www.reddit.com/r/rust/comments/lvtzri/confused_about_package_vs_crate_terminology/">Confused about Package vs. Crate terminology. : rust</a></p>
</li>
<li>
<p><a href="https://course.rs/basic/crate-module/intro.html">包和模块 - Rust语言圣经(Rust Course)</a></p>
<ul>
<li>项目(Packages)：一个 Cargo 提供的 feature，可以用来构建、测试和分享包</li>
<li>包(Crate)：一个由多个模块组成的树形结构，可以作为三方库进行分发，也可以生成可执行文件进行运行</li>
<li>模块(Module)：可以一个文件多个模块，也可以一个文件一个模块，模块可以被认为是真实项目中的代码组织单元</li>
</ul>
</li>
<li>
<p><a href="https://doc.rust-lang.org/cargo/reference/workspaces.html">Workspaces - The Cargo Book</a>
默认情况下，一个Cargo.toml只能指明一个package，但是在workspace里面就可以指明多个(此时可以理解为这个package包含多个subpackage)，比如substrate的根cargo：</p>
</li>
<li>
<p><a href="https://github.com/paritytech/substrate/blob/master/Cargo.toml">substrate/Cargo.toml at master · paritytech/substrate</a></p>
</li>
</ul>
<pre><code class="language-toml">[workspace]
resolver = &quot;2&quot;

members = [
    &quot;bin/node-template/node&quot;,
]
[profile.dev.package]
blake2 = { opt-level = 3 }
</code></pre>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/reference/cargo-targets.html?highlight=bin#library">Cargo Targets - The Cargo Book</a></li>
</ul>
<div id="admonition-crate" class="admonition tip">
<div class="admonition-title">
<p>crate</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-crate"></a></p>
</div>
<div>
<p>A crate is the [lib] or [[bin]] tables in the Cargo.toml. 
At most one lib crate may be present, but an arbitrary number of bin crates may be present. </p>
<p>You won’t see these tables added explicitly too often, 
because they’re implicitly present if you have src/lib.rs (lib crate) and/or src/main.rs (bin crate).</p>
</div>
</div>
<pre><code class="language-toml"># Example of customizing the library in Cargo.toml.
[lib]
crate-type = [&quot;cdylib&quot;]
bench = false
</code></pre>
<pre><code class="language-toml"># Example of customizing binaries in Cargo.toml.
[[bin]]
name = &quot;cool-tool&quot;
test = false
bench = false

[[bin]]
name = &quot;frobnicator&quot;
required-features = [&quot;frobnicate&quot;]

</code></pre>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html">Packages and Crates - The Rust Programming Language</a></li>
</ul>
<div id="admonition-the-rust-programming-language相关整理" class="admonition quote">
<div class="admonition-title">
<p>《The Rust Programming Language》相关整理</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/module_system.html#admonition-the-rust-programming-language相关整理"></a></p>
</div>
<div>
<ol>
<li>一个包是一个或多个提供一组功能的 crates。一个package包含一个 Cargo.toml 文件，该文件描述了如何构建这些crate。</li>
<li>crate 可以是二进制 crate 或库 crate。</li>
</ol>
<ul>
<li>二进制 crate 是可以编译成可执行文件的程序，可以运行，例如命令行程序或服务器。</li>
</ul>
<blockquote>
<p>它们必须有一个名为 main 的函数，该函数定义了可执行文件运行时会发生什么。到目前为止，我们创建的所有 crate 都是二进制 crate。</p>
</blockquote>
<ol start="3">
<li>库 crates 没有 main 函数，它们不会编译为可执行文件。它们定义了旨在与多个项目共享的功能。</li>
</ol>
<blockquote>
<p>例如，我们在第 2 章中使用的 rand crate 提供了生成随机数的功能。</p>
</blockquote>
<ol start="4">
<li>下面是一些规则：</li>
</ol>
<ul>
<li>一个包最多可以包含一个库 crate。它可以包含任意数量的二进制 crate，但它必须至少包含一个 crate（库或二进制）。</li>
<li>当我们输入<strong>cargo new</strong>时，Cargo 创建了一个 Cargo.toml 文件，cargo将会给我们一个package。</li>
<li>查看 Cargo.toml 的内容，没有提到 src/main.rs，因为 Cargo 遵循一个约定，即 src/main.rs 是与包同名的二进制 crate 的 crate 根。</li>
<li>同样，Cargo 知道如果包目录包含 src/lib.rs，则该包包含一个与包同名的库 crate，并且 src/lib.rs 是它的 crate 根。 </li>
</ul>
<blockquote>
<p>Cargo 将 crate 根文件传递给 rustc 以构建库或二进制文件。</p>
</blockquote>
<ul>
<li>在这里，我们有一个只包含 src/main.rs 的包，这意味着它只包含一个名为 my-project 的二进制 crate。</li>
<li>如果一个包包含 src/main.rs 和 src/lib.rs，它有两个 crate：一个二进制文件和一个库，两者都与包同名。</li>
</ul>
<blockquote>
<p>通过将文件放在 src/bin 目录中，一个包可以有多个二进制 crate：每个文件都是一个单独的二进制crate</p>
</blockquote>
</div>
</div>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220704161217/https://zhuanlan.zhihu.com/p/106251259">Rust的模块化系统: 包Packages, 箱Crates, 和模块Modules - 知乎</a>
包 Packages: Cargo提供的让我们创建, 测试和分享Crates的工具. 箱 Crates: 提供类库或可执行文件的模块树 模块 Modules and use: 管理和组织路径, 及其作用域和访问权限 路径 Paths:
如结构体(structs), 函数(function), 或模块(module)等事物的命名方式</p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220704161255/https://zhuanlan.zhihu.com/p/365735504">三言两语理解Rust module System - 知乎</a></p>
</li>
</ul>
<p>Module System</p>
<p>一个问题几乎总会由许多小问题组成。module system是为了定义清楚各个小问题的边界。这样更容易和更方便的管理问题。而大问题的解法，就是把小问题的解法组合起来。</p>
<p>project，package， crate， module这些概念感觉相似。实际上，一个package/project可以包含多个 binary crates和一个或者零个library
binary。一个crate可以包含多个module。可以认为package就是一个project，一个crate就是一个暴露给外界的逻辑单元，一个module就是一个小问题的解法。</p>
<p>当project里面有lib.rs说明这个project是一个library crate，这个library的名字是project的名字。main.rs/main2.rs都可以直接使用这个library
crate。我们可以认为bin文件夹里面是单独的crate，它们默认导入了这个library crate。</p>
<p>一个crate就是一个暴露给外界的逻辑单元，一个module就是一个小问题的解法</p>
<p>关于找不到模块： 这就是module tree的体现，<strong>be explicit</strong>。所有模块都需要添加到crate root(src/main.rs或者src/lib.rs)里面。也就是要显示地指明module
tree的结构。这也就是我们经常在main.rs/lib.rs里面看到许多mod xxx的原因。比如<a href="https://github.com/Celthi/rsnova/blob/master/src/lib.rs#L20">这里的代码</a></p>
<p>它们的存在就是为了将project里面的modules 加到这个crate里面。比如在main.rs 里面看到mod channel，就是将module channel加进crate的module tree来。</p>
<p>相关引用：
<a href="https://web.archive.org/web/20220419042941/https://manishearth.github.io/blog/2017/05/14/mentally-modelling-modules/">Mentally Modelling Modules - In Pursuit of Laziness</a></p>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220614192155/https://www.sheshbabu.com/posts/rust-module-system/">Clear explanation of Rust’s module system</a>
作者通过举例，详细介绍了rust编译器与程序猿看到的不同项目结构。</p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220704161820/https://zhuanlan.zhihu.com/p/360342782">Rust那些难理解的点(大量更新于6月16日） - 知乎</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220704162217/https://news.ycombinator.com/item?id=23894172">The confusion around Rust’s modules reminds me of the different ways that people… | Hacker News</a>
The confusion around Rust’s modules reminds me of the different ways that people learn how to use car indicators. Some
people learn that you push the stalk up to indicate your intent to turn left, or down to turn right. And then they
might eventually learn that in a European car, you push the stalk down to turn left, and up to turn right. And then of
course some of these people get confused when switching between different cars. Yes, I’ve seen plenty of people on the
road who indicate one direction and then turn another. It’s… kind of frightening .</p>
</li>
</ul>
<p>The other way of learning to use car indicators is much simpler: push the stalk in the direction that you would turn the
wheel. Of course this still leaves the possibility that some people will push the wrong stalk, and briefly activate
their windshield wipers . But it’s a much easier mistake to <em>notice</em>, and the consequences are minor.</p>
<p>Back to Rust’s modules. I keep seeing articles trying to offer a simple or clear explanation of how they work, that end
up unnecessarily complicated in a way that feels a lot like the “up/down” model of car indicators. The explanation that
makes the basics of Rust modules clear to me is this:</p>
<ul>
<li>
<p>Child modules must always be <em>declared</em> in the parent module, or they don’t exist.</p>
</li>
<li>
<p>The content of child modules may be <em>defined</em> either inline in the parent as <code>mod child { ... }</code>, or in a file with a
relative path of ‘./child.rs’ or ‘./child/mod.rs’.</p>
</li>
</ul>
<p>Did I miss anything important?</p>
<p>Without this basic explanation up-front, I have no idea what to do with the stream of information I’m reading in a
lengthy article on the topic – I’ve been given no scaffolding onto which to bolt all the details and examples. So this
is the “bottom line” that I would like to see “up front” in descriptions of Rust’s modules.</p>
<p>Other misunderstandings, e.g., around item visibility, are explained really well by the compiler if you get them mixed
up, so I’m not sure how much value there is in mixing them in to articles about how modules are <em>structured</em> before
those two basic facts are presented.</p>
<ul>
<li><a href="https://web.archive.org/web/20220705022801/https://stackoverflow.com/questions/63515853/how-to-better-understand-crate-in-rust">How to better understand Crate in Rust? - Stack Overflow</a></li>
</ul>
<blockquote>
<p>The processing of that source file may result in other source files being loaded as modules.
It is not that one source file makes up a crate: it’s that starting from that one source file, you can find all the
files making up the crate, as opposed to other compilation models where the compiler might be given many file names to
start from.</p>
</blockquote>
<p>其实从代码完整性考虑，crate确实就是编译的最小基本单位。因为它不仅指一个源码文件(xx.rs)，而是包含这个源码文件里面引入的所有其他module。这个时候，rustc才会开始编译这个crate</p>
<ul>
<li><a href="https://web.archive.org/web/20220609151503/https://stackoverflow.com/questions/52024304/what-exactly-is-a-crate-in-the-cargo-ecosystem-and-what-is-the-mapping-to-what?rq=1">rust - What exactly is a ‘crate’ in the Cargo ecosystem and what is the mapping to what is on crates.io? - Stack Overflow</a></li>
</ul>
<blockquote>
<p>The exact things hosted on crates.io are crates inside packages. A crate is the output artifact of the compiler.
The compilation model centers on artifacts called crates. Each compilation processes a single crate in source form,
and if successful, produces a single crate in binary form: either an executable or some sort of library.
A package is an artifact managed by Cargo, the Rust package manager.</p>
</blockquote>
<h3 id="local-23"><a class="header" href="#local-23">local</a></h3>
<ul>
<li><a href="marginnote3app://note/CF61A2D3-C05C-49B2-943A-777D4A4A6434">&lt;精通Rust(第二版)&gt;-2.2模块</a></li>
<li><a href="marginnote3app://note/72AB7939-56B0-4797-8307-09E7F9905417">&lt;精通Rust(第二版)&gt;-7.9 模块、路径和导入</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cargo与crate生命周期"><a class="header" href="#cargo与crate生命周期">Cargo与crate生命周期</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/cargo_ship.jpeg" alt="cargo_ship" /></p>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo%E4%B8%8Ecrate%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F">Cargo与crate生命周期</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo--%E7%94%A8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%90%86%E8%A7%A3cargo%E6%8C%87%E4%BB%A4%E7%B3%BB%E5%88%97">cargo : 用生命周期理解Cargo指令系列</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E6%96%B0%E5%BB%BA">新建</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-new">cargo new</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-init">cargo init</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E5%BC%80%E5%8F%91">开发</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-clean">cargo clean</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-doc">cargo doc</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86">依赖管理</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-check">cargo check</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-fix">cargo fix</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-fetch">cargo fetch</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-searchinstalluninstall">cargo search/install/uninstall</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E4%BB%8Ecratesio%E6%8B%89%E5%8F%96%E5%AE%89%E8%A3%85">从crates.io拉取安装</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E4%BB%8E%E6%BA%90%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85">从源码进行安装</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-report">cargo report</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-generate-lockfile">cargo generate-lockfile</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-locate-project">cargo locate-project</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-metadata">cargo metadata</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-pkgid">cargo pkgid</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-tree">cargo tree</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-update">cargo update</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-vendor">cargo vendor</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-verify-project">cargo verify-project</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E6%B5%8B%E8%AF%95">测试</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-test">cargo test</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-bench">cargo bench</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E8%BF%90%E8%A1%8C">运行</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-run">cargo run</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E6%9E%84%E5%BB%BA">构建</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-rustc">cargo rustc</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-build">cargo build</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-rustdoc">cargo rustdoc</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E5%8F%91%E5%B8%83">发布</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-login">cargo login</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-owner">cargo owner</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-package">cargo package</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-publish">cargo publish</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargo-yank">cargo yank</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E7%BB%B4%E6%8A%A4">维护</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E5%88%86%E5%8C%BA">分区</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#cargotoml%E7%BB%86%E8%AF%B4">Cargo.toml细说</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#rust%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93">Rust程序运行方式总结</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E8%84%9A%E6%9C%AC">脚本</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E9%A1%B9%E7%9B%AE">项目</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#local">local</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:37 UTC 2022 -->
<!--te-->
<h2 id="cargo--用生命周期理解cargo指令系列"><a class="header" href="#cargo--用生命周期理解cargo指令系列">cargo <cmd>: 用生命周期理解Cargo指令系列</a></h2>
<h2 id="新建"><a class="header" href="#新建">新建</a></h2>
<h3 id="cargo-new"><a class="header" href="#cargo-new">cargo new</a></h3>
<h3 id="cargo-init"><a class="header" href="#cargo-init">cargo init</a></h3>
<h2 id="开发"><a class="header" href="#开发">开发</a></h2>
<h3 id="cargo-clean"><a class="header" href="#cargo-clean">cargo clean</a></h3>
<h3 id="cargo-doc"><a class="header" href="#cargo-doc">cargo doc</a></h3>
<h2 id="依赖管理"><a class="header" href="#依赖管理">依赖管理</a></h2>
<h3 id="cargo-check"><a class="header" href="#cargo-check">cargo check</a></h3>
<p>该命令用来快速检查当前代码是否可以通过编译，但是不去生成真正可执行的程序。这样可以加快我们的检查速度。</p>
<h3 id="cargo-fix"><a class="header" href="#cargo-fix">cargo fix</a></h3>
<h3 id="cargo-fetch"><a class="header" href="#cargo-fetch">cargo fetch</a></h3>
<h3 id="cargo-searchinstalluninstall"><a class="header" href="#cargo-searchinstalluninstall">cargo search/install/uninstall</a></h3>
<h4 id="从cratesio拉取安装"><a class="header" href="#从cratesio拉取安装">从crates.io拉取安装</a></h4>
<p>cargo install <crate></p>
<h4 id="从源码进行安装"><a class="header" href="#从源码进行安装">从源码进行安装</a></h4>
<p>cargo install &lt;Cargo.toml path&gt; –debug –locked</p>
<div id="admonition-具体应用" class="admonition tip">
<div class="admonition-title">
<p>具体应用</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_crate_lifetime.html#admonition-具体应用"></a></p>
</div>
<div>
<p>当crates.io上面的某个crate需要定制化的时候，就可以直接拉取源码之后本地修改安装</p>
</div>
</div>
<h3 id="cargo-report"><a class="header" href="#cargo-report">cargo report</a></h3>
<h3 id="cargo-generate-lockfile"><a class="header" href="#cargo-generate-lockfile">cargo generate-lockfile</a></h3>
<h3 id="cargo-locate-project"><a class="header" href="#cargo-locate-project">cargo locate-project</a></h3>
<h3 id="cargo-metadata"><a class="header" href="#cargo-metadata">cargo metadata</a></h3>
<h3 id="cargo-pkgid"><a class="header" href="#cargo-pkgid">cargo pkgid</a></h3>
<h3 id="cargo-tree"><a class="header" href="#cargo-tree">cargo tree</a></h3>
<h3 id="cargo-update"><a class="header" href="#cargo-update">cargo update</a></h3>
<h3 id="cargo-vendor"><a class="header" href="#cargo-vendor">cargo vendor</a></h3>
<h3 id="cargo-verify-project"><a class="header" href="#cargo-verify-project">cargo verify-project</a></h3>
<h2 id="测试"><a class="header" href="#测试">测试</a></h2>
<h3 id="cargo-test"><a class="header" href="#cargo-test">cargo test</a></h3>
<h3 id="cargo-bench"><a class="header" href="#cargo-bench">cargo bench</a></h3>
<h2 id="运行"><a class="header" href="#运行">运行</a></h2>
<h3 id="cargo-run"><a class="header" href="#cargo-run">cargo run</a></h3>
<h2 id="构建"><a class="header" href="#构建">构建</a></h2>
<h3 id="cargo-rustc"><a class="header" href="#cargo-rustc">cargo rustc</a></h3>
<h3 id="cargo-build"><a class="header" href="#cargo-build">cargo build</a></h3>
<pre><code class="language-shell">cargo build --release
</code></pre>
<blockquote>
<p>该命令将会在 target/release/目录下生成优化过的可执行程序。这样生成的可执行程序拥有更好的性能。</p>
</blockquote>
<h3 id="cargo-rustdoc"><a class="header" href="#cargo-rustdoc">cargo rustdoc</a></h3>
<h2 id="发布"><a class="header" href="#发布">发布</a></h2>
<h3 id="cargo-login"><a class="header" href="#cargo-login">cargo login</a></h3>
<h3 id="cargo-owner"><a class="header" href="#cargo-owner">cargo owner</a></h3>
<h3 id="cargo-package"><a class="header" href="#cargo-package">cargo package</a></h3>
<h3 id="cargo-publish"><a class="header" href="#cargo-publish">cargo publish</a></h3>
<h3 id="cargo-yank"><a class="header" href="#cargo-yank">cargo yank</a></h3>
<h2 id="维护"><a class="header" href="#维护">维护</a></h2>
<h2 id="分区"><a class="header" href="#分区">分区</a></h2>
<h1 id="cargotoml细说"><a class="header" href="#cargotoml细说">Cargo.toml细说</a></h1>
<h1 id="rust程序运行方式总结"><a class="header" href="#rust程序运行方式总结">Rust程序运行方式总结</a></h1>
<h2 id="脚本"><a class="header" href="#脚本">脚本</a></h2>
<h2 id="项目"><a class="header" href="#项目">项目</a></h2>
<h1 id="参考资源-22"><a class="header" href="#参考资源-22">参考资源</a></h1>
<h2 id="online-book-24"><a class="header" href="#online-book-24">online-book</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/commands/index.html">Cargo Commands - The Cargo Book</a></li>
<li><a href="https://doc.rust-lang.org/stable/rust-by-example/cargo.html">Cargo - Rust By Example</a></li>
</ul>
<h2 id="fragment-24"><a class="header" href="#fragment-24">fragment</a></h2>
<h2 id="local-24"><a class="header" href="#local-24">local</a></h2>
<ul>
<li><a href="marginnote3app://note/607C0511-4592-4F59-A8C0-AD8017A503FE">&lt;精通Rust(第二版)&gt;-2.3 Cargo和程序库</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cargo与rustc"><a class="header" href="#cargo与rustc">cargo与rustc</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo%E4%B8%8Erustc">cargo与rustc</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#rustc">rustc</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#rustc%E6%98%AF%E4%BB%80%E4%B9%88">rustc是什么</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8">基础使用</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#rustc%E4%B8%8Ecargo%E7%9A%84%E5%85%B3%E7%B3%BB">rustc与cargo的关系</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-style">cargo style</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-essential-structure">cargo essential structure</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-%E6%89%A9%E5%B1%95">.cargo 扩展</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#tree-overview">tree overview</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#bin">bin</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#env">env</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#git">git</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#registry">registry</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-%E4%B8%8E-git-%E7%9A%84%E5%85%B3%E8%81%94">Cargo 与 git 的关联！</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-tree">cargo tree</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#git-1">git</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%85%B3%E4%BA%8E%E4%BE%9D%E8%B5%96%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98">关于依赖冲突问题</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3">Cargo相关问题解决</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E7%89%88%E6%9C%AC%E5%86%B2%E7%AA%81failed-to-select-a-version-for-the-requirement">版本冲突：failed to select a version for the requirement</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">Cargo项目结构</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%9F%BA%E7%A1%80%E8%AF%B4%E6%98%8E">基础说明</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#cargotoml%E5%92%8Ccargolock">cargo.toml和cargo.lock</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E6%9E%84%E5%BB%BA%E6%B8%85%E7%90%86%E6%9B%B4%E6%96%B0%E4%BB%A5%E5%8F%8A%E5%AE%89%E8%A3%85">构建、清理、更新以及安装</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#mainrs-%E5%92%8C-librs">main.rs 和 lib.rs</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8substrate%E7%9A%84substrate-node-template">实际应用：Substrate的substrate-node-template</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%8C%BA%E5%88%ABcargo-run%E4%B8%8Ecargo-build">区别cargo run与cargo build</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%9C%A8node%E5%8C%85%E9%87%8C%E9%9D%A2%E5%AD%98%E5%9C%A8mainrs">在node包里面存在main.rs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/6_module_manage/cargo_rustc.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:37 UTC 2022 -->
<!--te-->
<h2 id="rustc"><a class="header" href="#rustc">rustc</a></h2>
<h3 id="rustc是什么"><a class="header" href="#rustc是什么">rustc是什么</a></h3>
<p>全称应该是“rust complier“, 是 Rust 编程语言的编译器，由项目本身提供。编译器获取源代码并生成二进制代码，作为库或可执行文件。</p>
<h3 id="基础使用"><a class="header" href="#基础使用">基础使用</a></h3>
<pre><code class="language-shell">rustc target_file.rs
</code></pre>
<h3 id="rustc与cargo的关系"><a class="header" href="#rustc与cargo的关系">rustc与cargo的关系</a></h3>
<p>这其实就类似前端webpack.config和package.json的关系, cargo在运行时会默认调用rustc指令。</p>
<div id="admonition-查看cargo如何调用rustc" class="admonition tip">
<div class="admonition-title">
<p>查看cargo如何调用rustc</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-查看cargo如何调用rustc"></a></p>
</div>
<div>
<pre><code class="language-shell">$ cargo build --verbose
</code></pre>
<blockquote>
<p>verbose：就是详细信息的意思，运行后将会打印出每次调用rustc的过程。</p>
</blockquote>
</div>
</div>
<h2 id="cargo-style"><a class="header" href="#cargo-style">cargo style</a></h2>
<p>cargo可以看作是基于rustc的“管理框架“，主要还是对于项目用到的包的管理。</p>
<div id="admonition-查看cargo" class="admonition tip">
<div class="admonition-title">
<p>查看cargo</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-查看cargo"></a></p>
</div>
<div>
<p><a href="layer2_design_abstract/6_module_manage//layer2_design_abstract/6_module_manage/cargo_crate_lifetime">这里</a>可以看到具体有哪些功能</p>
</div>
</div>
<h2 id="cargo-essential-structure"><a class="header" href="#cargo-essential-structure">cargo essential structure</a></h2>
<p>但是对于大多数场景下，一般采用如下的项目结构</p>
<div id="admonition-rust-package-structure" class="admonition tip">
<div class="admonition-title">
<p>rust package structure</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-rust-package-structure"></a></p>
</div>
<div>
<pre><code class="language-shell">$ tree use-benchmarking -L 2                                                                                                                                                                                                             ─╯
use-benchmarking
├── Cargo.toml
├── README.md
└── src
    ├── benchmarking.rs
    ├── lib.rs
    ├── mock.rs
    ├── tests.rs
    └── weights.rs

1 directory, 7 files
</code></pre>
</div>
</div>
<h2 id="cargo-扩展"><a class="header" href="#cargo-扩展">.cargo 扩展</a></h2>
<p>除了cargo, 它的全局相关配置文件都会放在$HOME/.cargo目录下，这里值得看看</p>
<h3 id="tree-overview"><a class="header" href="#tree-overview">tree overview</a></h3>
<pre><code class="language-shell">tree -L 1 $HOME/.cargo                                                                                                                                                                                                                 ─╯
├── bin # 安装的二进制相关可执行文件
├── env # rustup的环境变量设置脚本
├── git
└── registry
</code></pre>
<h3 id="bin"><a class="header" href="#bin">bin</a></h3>
<pre><code class="language-shell">tree -L 1 $HOME/.cargo/bin                                                                                                                                                                                                             ─╯
├── cargo -&gt; /usr/local/bin/rustup-init
├── cargo-clippy -&gt; /usr/local/bin/rustup-init
├── cargo-fmt -&gt; /usr/local/bin/rustup-init
├── cargo-miri -&gt; /usr/local/bin/rustup-init
├── clippy-driver -&gt; /usr/local/bin/rustup-init
├── mdbook
├── mdbook-admonish
├── mdbook-checklist
├── mdbook-mermaid
├── mdbook-pdf
├── mdbook-rss
├── mdbook-template
├── rls -&gt; /usr/local/bin/rustup-init
├── rust-gdb -&gt; /usr/local/bin/rustup-init
├── rust-lldb -&gt; /usr/local/bin/rustup-init
├── rustc -&gt; /usr/local/bin/rustup-init
├── rustdoc -&gt; /usr/local/bin/rustup-init
├── rustfmt -&gt; /usr/local/bin/rustup-init
└── rustup -&gt; /usr/local/bin/rustup-init

0 directories, 19 files
</code></pre>
<h3 id="env"><a class="header" href="#env">env</a></h3>
<pre><code class="language-shell">#!/bin/sh
# rustup shell setup
# affix colons on either side of $PATH to simplify matching
case &quot;:${PATH}:&quot; in
    *:&quot;$HOME/.cargo/bin&quot;:*)
        ;;
    *)
        # Prepending path in case a system-installed rustc needs to be overridden
        export PATH=&quot;$HOME/.cargo/bin:$PATH&quot;
        ;;
esac
</code></pre>
<h3 id="git"><a class="header" href="#git">git</a></h3>
<pre><code class="language-shell">tree -L 3 $HOME/.cargo/git                                                                                                                                                                                                             ─╯
/Users/kuanhsiaokuo/.cargo/git
├── checkouts
│   ├── substrate-7e08433d4c370a21
│   │   ├── 174735e
│   │   ├── 257cdb5
│   │   ├── 279593d
│   │   ├── 3348e14
│   │   ├── 346471d
│   │   ├── 4d28ebe
│   │   ├── 7ba4e4c
│   │   ├── 7eb671f
│   │   ├── 814752f
│   │   ├── 852bab0
│   │   ├── b6c1c1b
│   │   └── bf9683e
│   └── unveil-rs-403565214a7cc66c
│       └── 3d8e9ad
└── db
    ├── substrate-7e08433d4c370a21
    │   ├── FETCH_HEAD
    │   ├── HEAD
    │   ├── config
    │   ├── description
    │   ├── hooks
    │   ├── info
    │   ├── objects
    │   └── refs
    └── unveil-rs-403565214a7cc66c
        ├── FETCH_HEAD
        ├── HEAD
        ├── config
        ├── description
        ├── hooks
        ├── info
        ├── objects
        └── refs

27 directories, 8 files
</code></pre>
<h3 id="registry"><a class="header" href="#registry">registry</a></h3>
<pre><code class="language-shell">tree -L 2 $HOME/.cargo/registry                                                                                                                                                                                                        ─╯
/Users/kuanhsiaokuo/.cargo/registry
├── cache
│   └── github.com-1ecc6299db9ec823
├── index
│   └── github.com-1ecc6299db9ec823
└── src
    └── github.com-1ecc6299db9ec823

6 directories, 0 files
</code></pre>
<h2 id="cargo-与-git-的关联"><a class="header" href="#cargo-与-git-的关联">Cargo 与 git 的关联！</a></h2>
<h3 id="cargo-tree-1"><a class="header" href="#cargo-tree-1">cargo tree</a></h3>
<ol>
<li>Cargo.toml是分等级的，最外层的Cargo.toml里面可以只用一个members，然后里面列出内部包含的其他packages</li>
</ol>
<div id="admonition-substrate-node-template为例" class="admonition info">
<div class="admonition-title">
<p>substrate-node-template为例</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-substrate-node-template为例"></a></p>
</div>
<div>
<blockquote>
<p>最外层的Cargo.toml</p>
</blockquote>
<pre><code class="language-toml">[workspace]
members = [
    &quot;node&quot;,
    &quot;pallets/template&quot;,
    &quot;runtime&quot;,
]
[profile.release]
panic = &quot;unwind&quot;
</code></pre>
</div>
</div>
<ol start="2">
<li>然后内部的其他packages就需要列出用到的[dependencies]</li>
<li>dependencies的完整使用参数如下：</li>
</ol>
<div id="admonition-dependencies写法一" class="admonition info">
<div class="admonition-title">
<p>dependencies写法一</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-dependencies写法一"></a></p>
</div>
<div>
<pre><code class="language-toml">[dependencies]
pallet-aura = { version = &quot;4.0.0-dev&quot;, default-features = false, git = &quot;https://github.com/paritytech/substrate.git&quot;, branch = &quot;polkadot-v0.9.24&quot; }
</code></pre>
</div>
</div>
<div id="admonition-dependencies写法二" class="admonition info">
<div class="admonition-title">
<p>dependencies写法二</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-dependencies写法二"></a></p>
</div>
<div>
<pre><code class="language-toml">[dependencies.pallet-aura]
version = &quot;4.0.0-dev&quot;
default-features = false
git = &quot;https://github.com/paritytech/substrate.git&quot;
branch = &quot;polkadot-v0.9.24&quot;
</code></pre>
<blockquote>
<p>这里的branch也可以用tag(git tag)</p>
</blockquote>
</div>
</div>
<h3 id="git-1"><a class="header" href="#git-1">git</a></h3>
<blockquote>
<p>上面dependencie里面的git+branch/tag唯一确定了一份代码，cargo下载对应的git代码之后，会从最外层Cargo.toml顺着members一层层找到[package]如下所示的Cargo.toml来确定对应的依赖包</p>
</blockquote>
<div id="admonition-substrateframeauracargotoml" class="admonition tip">
<div class="admonition-title">
<p>substrate/frame/aura/Cargo.toml</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-substrateframeauracargotoml"></a></p>
</div>
<div>
<pre><code class="language-toml">[package]
name = &quot;pallet-aura&quot;
version = &quot;4.0.0-dev&quot;
authors = [&quot;Parity Technologies &lt;admin@parity.io&gt;&quot;]
edition = &quot;2021&quot;
license = &quot;Apache-2.0&quot;
homepage = &quot;https://substrate.io&quot;
repository = &quot;https://github.com/paritytech/substrate/&quot;
description = &quot;FRAME AURA consensus pallet&quot;
readme = &quot;README.md&quot;
</code></pre>
</div>
</div>
<h3 id="关于依赖冲突问题"><a class="header" href="#关于依赖冲突问题">关于依赖冲突问题</a></h3>
<p>目前Cargo无法解决依赖冲突问题，一般都会是因为dependencies里面的git+branch/tag对应的依赖更新导致。</p>
<div id="admonition-顺藤摸瓜一一排查" class="admonition tip">
<div class="admonition-title">
<p>顺藤摸瓜，一一排查</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-顺藤摸瓜一一排查"></a></p>
</div>
<div>
<p>这时需要根据冲突的包，切换分支/tag, 找到对应的branch/tag来更新</p>
</div>
</div>
<blockquote>
<p>应用场景: <a href="layer2_design_abstract/6_module_manage//layer5_ecosystem/7_business/blockchain/substrate/substrate_deep_try.html#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96-cargotomldependincies">substrate添加pallet</a></p>
</blockquote>
<h2 id="cargo相关问题解决"><a class="header" href="#cargo相关问题解决">Cargo相关问题解决</a></h2>
<h3 id="版本冲突failed-to-select-a-version-for-the-requirement"><a class="header" href="#版本冲突failed-to-select-a-version-for-the-requirement">版本冲突：failed to select a version for the requirement</a></h3>
<ul>
<li>删除registry
<a href="https://web.archive.org/web/20220702104818/https://blog.illixion.com/2021/10/fix-failed-to-select-a-version-cargo/">How to fix “failed to select a version for the requirement” in Rust’s Cargo - Manual</a></li>
</ul>
<pre><code class="language-admonist info title='解决方案'">Apparently, Cargo can sometimes get into a state where its local registry cache will corrupt itself, and Cargo won’t be able to discover new versions of the dependencies. To resolve this, delete the ~/.cargo/registry folder and run the build command again.
</code></pre>
<ul>
<li>修改dependencies
<a href="https://web.archive.org/web/20220702110637/https://qiita.com/bc_yuuuuuki/items/6f566ddef60a201af1bc">cargo install 出现需求版本选择失败怎么办–Qiita</a></li>
</ul>
<h2 id="cargo项目结构"><a class="header" href="#cargo项目结构">Cargo项目结构</a></h2>
<h3 id="基础说明"><a class="header" href="#基础说明">基础说明</a></h3>
<p><img src="https://web.archive.org/web/20220621034241im_/https://pp88.org/rust.zui.jia.shi.jian.rust.zui.jia.shi.jian/cargo.xiang.mu.pei.zhi.ji.jie.gou/project-structure.png" alt="hello_world_project_sturcture" /></p>
<ul>
<li>cargo.toml和cargo.lock文件总是位于项目根目录下。</li>
<li>源代码位于src目录下。</li>
<li>默认的库入口文件是src/lib.rs。</li>
<li>默认的可执行程序入口文件是src/main.rs。</li>
<li>其他可选的可执行文件位于src/bin/*.rs(这里每一个rs文件均对应一个可执行文件)。</li>
<li>外部测试源代码文件位于tests目录下。</li>
<li>示例程序源代码文件位于examples。</li>
<li>基准测试源代码文件位于benches目录下。</li>
</ul>
<h3 id="cargotoml和cargolock"><a class="header" href="#cargotoml和cargolock">cargo.toml和cargo.lock</a></h3>
<p>cargo.toml和cargo.lock是cargo项目代码管理的核心两个文件，cargo工具的所有活动均基于这两个文件。</p>
<p>cargo.toml是cargo特有的项目数据描述文件，对于猿们而言，cargo.toml文件存储了项目的所有信息，它直接面向rust猿，猿们如果想让自己的rust项目能够按照期望的方式进行构建、测试和运行，那么，必须按照合理的方式构建’cargo.toml’。</p>
<p>而cargo.lock文件则不直接面向猿，猿们也不需要直接去修改这个文件。lock文件是cargo工具根据同一项目的toml文件生成的项目依赖详细清单文件，所以我们一般不用不管他，只需要对着cargo.toml文件撸就行了。</p>
<h3 id="构建清理更新以及安装"><a class="header" href="#构建清理更新以及安装">构建、清理、更新以及安装</a></h3>
<blockquote>
<p>领会了toml描述文件的写法，是一个重要的方面。另一个重要的方面，就是cargo工具本身为我们程序猿提供的各种好用的工具。如果大家感兴趣，自己在终端中输入’cargo –help’查看即可。</p>
</blockquote>
<ol>
<li>其中开发时最常用的命令就是’cargo build’，用于构建项目。</li>
<li>此外，’cargo clean’命令可以清理target文件夹中的所有内容；</li>
<li>’cargo update’根据toml描述文件重新检索并更新各种依赖项的信息，并写入lock文件，例如依赖项版本的更新变化等等；</li>
<li>’cargo install’可用于实际的生产部署。这些命令在实际的开发部署中均是非常有用的。</li>
</ol>
<h3 id="mainrs-和-librs"><a class="header" href="#mainrs-和-librs">main.rs 和 lib.rs</a></h3>
<div id="admonition-mainrs-vs-librs" class="admonition info">
<div class="admonition-title">
<p>main.rs vs lib.rs</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-mainrs-vs-librs"></a></p>
</div>
<div>
<pre><code class="language-text">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓                                              
┃                                     _                                        ┃                                              
┃                          _ __  __ _(_)_ _    _ _ ___                         ┃                                              
┃                         | '  \/ _` | | ' \ _| '_(_-&lt;                         ┃                                              
┃                         |_|_|_\__,_|_|_||_(_)_| /__/                         ┃                                              
┃                                                                              ┃                                              
┃ _                 _ _                             _             _   _        ┃                                              
┃| |_  __ _ _ _  __| | |___ ___  _ _ _  _ _ _  _ _ (_)_ _  __ _  | |_| |_  ___ ┃                                              
┃| ' \/ _` | ' \/ _` | / -_|_-&lt; | '_| || | ' \| ' \| | ' \/ _` | |  _| ' \/ -_)┃                                              
┃|_||_\__,_|_||_\__,_|_\___/__/ |_|  \_,_|_||_|_||_|_|_||_\__, |  \__|_||_\___|┃                                              
┃                                                         |___/                ┃                                              
┃                                                                              ┃                                              
┃                       _ __ _ _ ___  __ _ _ _ __ _ _ __                       ┃                                              
┃                      | '_ \ '_/ _ \/ _` | '_/ _` | '  \                      ┃                                              
┃                      | .__/_| \___/\__, |_| \__,_|_|_|_|                     ┃                                              
┃                      |_|           |___/                                     ┃                                              
┃                                                                              ┃                                              
┃1. cargo new --bin                                                            ┃                                              
┃- Calling the command line parsing logic with the argument values             ┃                                              
┃- Setting up any other configuration                                          ┃                                              
┃- Calling a run function in lib.rs           ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┻━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃- Handling the error if run returns an error ┃All are rust basic entry:       ╳    _ _ _                                    ┃
┃                                             ┃1. main.rs is the running entry ╳   | (_) |__   _ _ ___                       ┃
┃                                             ┃2. lib.rs is the library entry  ╳   | | | '_ \_| '_(_-&lt;                       ┃
┃                                             ┃╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳╳    |_|_|_.__(_)_| /__/                       ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫                                                                              ┃
                                              ┃   _                 _ _               _ _   _   _          _           _     ┃
                                              ┃  | |_  __ _ _ _  __| | |___ ___  __ _| | | | |_| |_  ___  | |___  __ _(_)__  ┃
                                              ┃  | ' \/ _` | ' \/ _` | / -_|_-&lt; / _` | | | |  _| ' \/ -_) | / _ \/ _` | / _| ┃
                                              ┃  |_||_\__,_|_||_\__,_|_\___/__/ \__,_|_|_|  \__|_||_\___| |_\___/\__, |_\__| ┃
                                              ┃                                                                  |___/       ┃
                                              ┃        __   _   _          _           _          _     _                 _  ┃
                                              ┃   ___ / _| | |_| |_  ___  | |_ __ _ __| |__  __ _| |_  | |_  __ _ _ _  __| | ┃
                                              ┃  / _ \  _| |  _| ' \/ -_) |  _/ _` (_-&lt; / / / _` |  _| | ' \/ _` | ' \/ _` | ┃
                                              ┃  \___/_|    \__|_||_\___|  \__\__,_/__/_\_\ \__,_|\__| |_||_\__,_|_||_\__,_| ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┃                                                                              ┃
                                              ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
</div>
</div>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220703121446/https://juejin.cn/post/6919738138135003150">Rust 模块系统 - 掘金</a></p>
<blockquote>
<p>包（package）创建规则：</p>
</blockquote>
<pre><code>- 一个包中至多只能包含一个库Crate。
- 包中可以包含任意多个二进制Crate。
- 包中至少包含一个 crate，无论是库的还是二进制的。
- 包中应该包含一个 Cargo.toml 配置文件，用来说明如何去构建这些 crate。
</code></pre>
<blockquote>
<p>示例一：cargo new –bin 创建一个包含 二进制Crate 的包
示例二：cargo new –lib 创建一个包含库(lib)crate的包
示例三：–lib和–bin不可以同时使用，这种情况下可以示例一的基础上自己创建一个lib.rs文件</p>
</blockquote>
<ul>
<li>一般情况下，我们将与程序运行相关的代码放在 main.rs 文件，其他真正的任务逻辑放在 lib.rs 文件中。</li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220703121604/https://stackoverflow.com/questions/57756927/rust-modules-confusion-when-there-is-main-rs-and-lib-rs">Rust modules confusion when there is main.rs and lib.rs - Stack Overflow</a></p>
</li>
</ul>
<blockquote>
<p>这里有人详细介绍了只有lib.rs/main.rs的情况下，执行cargo run的情况。没有main.rs的时候，cargo run会告诉你：error: a bin target must be available for <code>cargo run</code></p>
</blockquote>
<ul>
<li><a href="https://www.reddit.com/r/rust/comments/c41iph/mainrs_vs_librs/">main.rs vs lib.rs : rust</a></li>
</ul>
<blockquote>
<p>A common pattern, even for binary-only crates, is to declare a “library” providing the majority of functionality, and then have main.rs just implement argument parsing and use that library.
This allows for integration tests written against the library, which might otherwise be hard to do with only main.rs.</p>
</blockquote>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220703121647/https://users.rust-lang.org/t/main-rs-and-lib-rs-at-same-level/42499">Main.rs and lib.rs at same level - help - The Rust Programming Language Forum</a></p>
<blockquote>
<p>这里有人跟着官方文档制作命令行工具时发现同样的疑惑点，底下有人引用了这个链接</p>
</blockquote>
<ul>
<li><a href="https://web.archive.org/web/20220424212816/https://doc.rust-lang.org/book/ch12-03-improving-error-handling-and-modularity.html#separation-of-concerns-for-binary-projects">Separation of Conerns for Binary Projects - The Rust Programming Language</a></li>
</ul>
</li>
</ul>
<div id="admonition-allocating-responsibilty-for-multiple-tasks" class="admonition quote">
<div class="admonition-title">
<p>Allocating Responsibilty for Multiple Tasks</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-allocating-responsibilty-for-multiple-tasks"></a></p>
</div>
<div>
<p>The organizational problem of allocating responsibility for multiple tasks to the main function is common to many binary projects. As a result, the Rust community has developed a process to use as a guideline for splitting the separate concerns of a binary program when main starts getting large. The process has the following steps:</p>
<ol>
<li>Split your program into a main.rs and a lib.rs and move your program’s logic to lib.rs.</li>
<li>As long as your command line parsing logic is small, it can remain in main.rs.</li>
<li>When the command line parsing logic starts getting complicated, extract it from main.rs and move it to lib.rs.</li>
</ol>
<blockquote>
<p>The responsibilities that remain in the main function after this process should be limited to the following:</p>
</blockquote>
<ul>
<li>Calling the command line parsing logic with the argument values</li>
<li>Setting up any other configuration</li>
<li>Calling a run function in lib.rs</li>
<li>Handling the error if run returns an error</li>
</ul>
<blockquote>
<p>This pattern is about separating concerns:</p>
</blockquote>
<ol>
<li>main.rs handles running the program</li>
<li>and lib.rs handles all the logic of the task at hand. </li>
</ol>
<blockquote>
<p>Because you can’t test the main function directly, this structure lets you test all of your program’s logic by moving it into functions in lib.rs. 
The only code that remains in main.rs will be small enough to verify its correctness by reading it. 
Let’s rework our program by following this process.</p>
</blockquote>
</div>
</div>
<div id="admonition-明确职责-用mvc类比" class="admonition tip">
<div class="admonition-title">
<p>明确职责, 用MVC类比</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-明确职责-用mvc类比"></a></p>
</div>
<div>
<blockquote>
<p>也就是说</p>
</blockquote>
<ol>
<li>main.rs只负责调用、配置和处理异常， 类似View</li>
<li>lib.rs主要负责具体的业务逻辑, 类似Control+Model</li>
</ol>
</div>
</div>
<div id="admonition-用crate来区分" class="admonition quote">
<div class="admonition-title">
<p>用crate来区分</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-用crate来区分"></a></p>
</div>
<div>
<p>Note that the main.rs does not declare any modules with mod, it only imports them with use (the distinction between the two is something a lot of new Rust programmers struggle with!).</p>
<p>The reason for this is that, in projects with both a lib.rs and a main.rs:</p>
<blockquote>
<p>Cargo effectively treats lib.rs as the root of your crate, and main.rs as a seperate binary that depends on your crate.</p>
</blockquote>
</div>
</div>
<div id="admonition-用binary和library来区分" class="admonition quote">
<div class="admonition-title">
<p>用binary和library来区分</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-用binary和library来区分"></a></p>
</div>
<div>
<p><strong>main.rs is always the root of your binary, and lib.rs is always the root of your library.</strong></p>
<blockquote>
<p>The important things to realize are:</p>
</blockquote>
<ul>
<li>These two roots are compiled seperately, and have their own entirely seperate module structure.</li>
<li>When you use the mod keyword, you are creating a module, not importing a module.</li>
<li>You almost never want to have multiple mod statements for a single file, as you’ll be duplicating the content.</li>
<li>If you want to use something from an existing module or from a library, that’s what the use keyword is for.</li>
</ul>
<blockquote>
<p>Let’s walk through your example:</p>
</blockquote>
<ol>
<li>In lib.rs, you use <strong>mod</strong> to declare that your library has two top level modules, cli and internal. There are corresponding files in the right place in your project, so Cargo knows how to link it all up. This part is fine, and what you intended to happen!</li>
<li>However, when you write mod lib in your main.rs, you’re not importing your library! You’re actually declaring that your binary has it’s own top level module, which just happens to be called lib. Cargo then sees that there is a file called lib.rs in the folder, and links that in, even though that’s not what you intended. It then sees that the lib.rs file has two mod statements and treats these as submodules of the binary’s lib module. The files aren’t in the right place for that to work, so compilation fails.</li>
<li>So the root cause of your issue is that you’ve effectively told the compiler to create your module structure twice, <strong>once in your library and once in your binary</strong>. </li>
<li>You really only meant to define these modules in your library, and then use them into your binary.</li>
</ol>
</div>
</div>
<h3 id="实际应用substrate的substrate-node-template"><a class="header" href="#实际应用substrate的substrate-node-template">实际应用：Substrate的substrate-node-template</a></h3>
<blockquote>
<p>根据官方文档知道，substrate是各种lib包，那么开发时如何运行呢？</p>
</blockquote>
<h4 id="区别cargo-run与cargo-build"><a class="header" href="#区别cargo-run与cargo-build">区别cargo run与cargo build</a></h4>
<ul>
<li><a href="https://kaisery.github.io/trpl-zh-cn/ch01-03-hello-cargo.html#%E6%9E%84%E5%BB%BA%E5%B9%B6%E8%BF%90%E8%A1%8C-cargo-%E9%A1%B9%E7%9B%AE">构建并运行Cargo - Rust 程序设计语言 简体中文版</a></li>
</ul>
<h4 id="在node包里面存在mainrs"><a class="header" href="#在node包里面存在mainrs">在node包里面存在main.rs</a></h4>
<ol>
<li>根Cargo.toml里面告诉cargo，这个项目总共有三个包</li>
</ol>
<div id="admonition-根cargotoml" class="admonition info">
<div class="admonition-title">
<p>根Cargo.toml</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-根cargotoml"></a></p>
</div>
<div>
<pre><code class="language-toml">[workspace]
members = [
    &quot;node&quot;,
    &quot;pallets/template&quot;,
    &quot;runtime&quot;,
]
[profile.release]
panic = &quot;unwind&quot;
</code></pre>
</div>
</div>
<ol start="2">
<li>然后cargo找到包含main.rs的node包作为入口</li>
</ol>
<div id="admonition-node-tree" class="admonition tip">
<div class="admonition-title">
<p>node tree</p>
<p><a class="admonition-anchor-link" href="layer2_design_abstract/6_module_manage/cargo_rustc.html#admonition-node-tree"></a></p>
</div>
<div>
<pre><code class="language-shell"> tree -L 2 node                                                                                                                                                                                                                         ─╯
node
├── Cargo.toml
├── build.rs
└── src
    ├── chain_spec.rs
    ├── cli.rs
    ├── command.rs
    ├── command_helper.rs
    ├── lib.rs
    ├── main.rs
    ├── rpc.rs
    └── service.rs

1 directory, 10 files
</code></pre>
</div>
</div>
<ol start="3">
<li>node/main.rs里面使用了文件名crate</li>
</ol>
<pre><pre class="playground"><code class="language-rust">//! Substrate Node Template CLI library.
#![warn(missing_docs)]

mod chain_spec;
#[macro_use]
// 对应service.rs
mod service;
// 对应cli.rs
mod cli;
// 对应command.rs
mod command;
// 对应command_helper.rs
mod command_helper;
// 对应rpc.rs
mod rpc;

fn main() -&gt; sc_cli::Result&lt;()&gt; {
    command::run()

</code></pre></pre>
<h2 id="参考资源-23"><a class="header" href="#参考资源-23">参考资源</a></h2>
<h3 id="online-book-25"><a class="header" href="#online-book-25">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/rustc/what-is-rustc.html">What is rustc? - The rustc book</a></li>
</ul>
<h3 id="fragment-25"><a class="header" href="#fragment-25">fragment</a></h3>
<ul>
<li><a href="https://skyao.io/learning-rust/docs/build/rustc.html">Rustc | Rust学习笔记</a></li>
<li><a href="https://web.archive.org/web/20220621034241/https://pp88.org/rust.zui.jia.shi.jian.rust.zui.jia.shi.jian/cargo.xiang.mu.pei.zhi.ji.jie.gou/">Cargo项目配置及结构 | 皮皮爸(pp8)</a></li>
</ul>
<h3 id="local-25"><a class="header" href="#local-25">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust扩展工具介绍"><a class="header" href="#rust扩展工具介绍">Rust扩展工具介绍</a></h1>
<!--ts-->
<ul>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#rust%E6%89%A9%E5%B1%95%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D">Rust扩展工具介绍</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#cargo%E5%AD%90%E5%91%BD%E4%BB%A4%E7%B3%BB%E5%88%97-cargo-install-">Cargo子命令系列: cargo install </a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#cargo-watch">cargo-watch</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#cargo-edit">cargo-edit</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#cargo-deb">cargo-deb</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#cargo-outdated">cargo-outdated</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#rustup%E7%B3%BB%E5%88%97-rust-component-add-tool_name">rustup系列: rust component add &lt;tool_name&gt;</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#clippy">clippy</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#rustc">rustc</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#rustfmt">rustfmt</a></li>
</ul>
</li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#online-book">online-book</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#fragment">fragment</a></li>
<li><a href="layer2_design_abstract/6_module_manage/rust_plugins.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:38 UTC 2022 -->
<!--te-->
<h2 id="cargo子命令系列-cargo-install"><a class="header" href="#cargo子命令系列-cargo-install">Cargo子命令系列: cargo install <binary crate name></a></h2>
<h3 id="cargo-watch"><a class="header" href="#cargo-watch">cargo-watch</a></h3>
<h3 id="cargo-edit"><a class="header" href="#cargo-edit">cargo-edit</a></h3>
<h3 id="cargo-deb"><a class="header" href="#cargo-deb">cargo-deb</a></h3>
<h3 id="cargo-outdated"><a class="header" href="#cargo-outdated">cargo-outdated</a></h3>
<h2 id="rustup系列-rust-component-add-tool_name"><a class="header" href="#rustup系列-rust-component-add-tool_name">rustup系列: rust component add &lt;tool_name&gt;</a></h2>
<h3 id="clippy"><a class="header" href="#clippy">clippy</a></h3>
<h3 id="rustc-1"><a class="header" href="#rustc-1">rustc</a></h3>
<h3 id="rustfmt"><a class="header" href="#rustfmt">rustfmt</a></h3>
<h2 id="参考资源-24"><a class="header" href="#参考资源-24">参考资源</a></h2>
<h3 id="online-book-26"><a class="header" href="#online-book-26">online-book</a></h3>
<ul>
<li><a href="https://rust-lang.github.io/rustup/concepts/components.html">Components - The rustup book</a></li>
<li><a href="https://rust-lang.github.io/rustup/concepts/channels.html#nightly-availability">Channels - The rustup book</a></li>
</ul>
<h3 id="fragment-26"><a class="header" href="#fragment-26">fragment</a></h3>
<ul>
<li><a href="https://rust-lang.github.io/rustup-components-history/">Rustup packages availability on x86_64-unknown-linux-gnu</a></li>
</ul>
<h3 id="local-26"><a class="header" href="#local-26">local</a></h3>
<ul>
<li><a href="marginnote3app://note/5D418160-6AC9-4FEF-843F-DA262F6A7DEB">&lt;精通Rust(第二版)&gt;-2.4 Cargo工具扩展</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="任务抽象"><a class="header" href="#任务抽象">任务抽象</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/layer3_task_abstract.html#%E4%BB%BB%E5%8A%A1%E6%8A%BD%E8%B1%A1">任务抽象</a>
<ul>
<li><a href="layer3_task_abstract/layer3_task_abstract.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/layer3_task_abstract.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/layer3_task_abstract.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/layer3_task_abstract.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:39 UTC 2022 -->
<!--te-->
<h2 id="参考资源-25"><a class="header" href="#参考资源-25">参考资源</a></h2>
<h3 id="online-book-27"><a class="header" href="#online-book-27">online-book</a></h3>
<h3 id="fragment-27"><a class="header" href="#fragment-27">fragment</a></h3>
<h3 id="local-27"><a class="header" href="#local-27">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="并发"><a class="header" href="#并发">并发</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/7_concurrency/7_concurrency.html#%E5%B9%B6%E5%8F%91">并发</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/7_concurrency.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/7_concurrency.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/7_concurrency/7_concurrency.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/7_concurrency/7_concurrency.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:38 UTC 2022 -->
<!--te-->
<h2 id="参考资源-26"><a class="header" href="#参考资源-26">参考资源</a></h2>
<h3 id="online-book-28"><a class="header" href="#online-book-28">online-book</a></h3>
<h3 id="fragment-28"><a class="header" href="#fragment-28">fragment</a></h3>
<h3 id="local-28"><a class="header" href="#local-28">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="从io模型开始"><a class="header" href="#从io模型开始">从IO模型开始</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E4%BB%8Eio%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%A7%8B">从IO模型开始</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#1-%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5%E9%98%BB%E5%A1%9E%E9%9D%9E%E9%98%BB%E5%A1%9E%E6%A6%82%E5%BF%B5%E5%8C%BA%E5%88%AB">1. 同步/异步、阻塞/非阻塞概念区别</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5%E5%85%B3%E6%B3%A8%E7%9A%84%E6%98%AF%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6%E8%B0%83%E7%94%A8%E8%80%85%E8%A7%86%E8%A7%92">同步和异步，关注的是消息通信机制。（调用者视角）</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E9%98%BB%E5%A1%9E%E5%92%8C%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%85%B3%E6%B3%A8%E7%9A%84%E6%98%AF%E7%A8%8B%E5%BA%8F%E7%AD%89%E5%BE%85%E8%B0%83%E7%94%A8%E7%BB%93%E6%9E%9C%E7%9A%84%E7%8A%B6%E6%80%81%E8%A2%AB%E8%B0%83%E7%94%A8%E8%80%85%E8%A7%86%E8%A7%92">阻塞和非阻塞，关注的是程序等待调用结果的状态。（被调用者视角）</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E9%98%BB%E5%A1%9E%E4%B8%8E%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E6%9C%89%E5%85%B3">阻塞，与系统调用有关。</a></li>
</ul>
</li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#2-%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5io-%E6%A8%A1%E5%9E%8B%E5%88%86%E7%B1%BB">2. 同步/异步IO 模型分类</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#3-%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9Eio-blocking-io">3. 同步阻塞I/O (blocking I/O)</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#4-io-%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8io-multiplexing-">4. I/O 多路复用（I/O Multiplexing )</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#5-epoll-%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9E%E9%9D%9E%E9%98%BB%E5%A1%9E%E6%A8%A1%E5%9E%8B">5. epoll: 同步阻塞/非阻塞模型</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#epoll%E4%B8%89%E4%B8%AA%E5%87%BD%E6%95%B0">epoll三个函数</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#epoll-%E4%B8%A4%E7%A7%8D%E8%A7%A6%E5%8F%91%E6%9C%BA%E5%88%B6">epoll 两种触发机制：</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E6%83%8A%E7%BE%A4%E9%97%AE%E9%A2%98">惊群问题：</a></li>
</ul>
</li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#6-%E5%BC%82%E6%AD%A5-io-%E6%A8%A1%E5%9E%8B-io_uring">6. 异步 I/O 模型: io_uring</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#1-reactor%E5%8F%8D%E5%BA%94%E5%99%A8-%E6%A8%A1%E5%BC%8F">1. Reactor（反应器） 模式</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#2-preactor%E4%B8%BB%E5%8A%A8%E5%99%A8-%E6%A8%A1%E5%BC%8F">2. Preactor（主动器） 模式</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#reactor-model">Reactor Model:</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E4%B8%89%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F">三种实现方式：</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C%E6%B5%81%E7%A8%8B">读写操作流程：</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E5%8F%82%E4%B8%8E%E8%80%85">参与者：</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/7_concurrency/io_models.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:39 UTC 2022 -->
<!--te-->
<h2 id="1-同步异步阻塞非阻塞概念区别"><a class="header" href="#1-同步异步阻塞非阻塞概念区别">1. 同步/异步、阻塞/非阻塞概念区别</a></h2>
<h3 id="同步和异步关注的是消息通信机制调用者视角"><a class="header" href="#同步和异步关注的是消息通信机制调用者视角">同步和异步，关注的是消息通信机制。（调用者视角）</a></h3>
<ul>
<li>同步，发出一个调用，在没有得到结果之前不返回。</li>
<li>异步，发出一个调用，在没有得到结果之前返回。</li>
</ul>
<h3 id="阻塞和非阻塞关注的是程序等待调用结果的状态被调用者视角"><a class="header" href="#阻塞和非阻塞关注的是程序等待调用结果的状态被调用者视角">阻塞和非阻塞，关注的是程序等待调用结果的状态。（被调用者视角）</a></h3>
<ul>
<li>阻塞，在调用结果返回之前，线程被挂起。</li>
<li>非阻塞，在调用结果返回之前，线程不会被挂起。</li>
</ul>
<h3 id="阻塞与系统调用有关"><a class="header" href="#阻塞与系统调用有关">阻塞，与系统调用有关。</a></h3>
<h2 id="2-同步异步io-模型分类"><a class="header" href="#2-同步异步io-模型分类">2. 同步/异步IO 模型分类</a></h2>
<pre><svg xmlns="http://www.w3.org/2000/svg" width="456" height="288">
    <style>
        line, path, circle,rect,polygon{stroke:black;stroke-width:2;stroke-opacity:1;fill-opacity:1;stroke-linecap:round;stroke-linejoin:miter;}text{font-family:monospace;font-size:14px;}rect.backdrop{stroke:none;fill:white;}.broken{stroke-dasharray:8;}.filled{fill:black;}.bg_filled{fill:white;}.nofill{fill:white;}.end_marked_arrow{marker-end:url(#arrow);}.start_marked_arrow{marker-start:url(#arrow);}.end_marked_diamond{marker-end:url(#diamond);}.start_marked_diamond{marker-start:url(#diamond);}.end_marked_circle{marker-end:url(#circle);}.start_marked_circle{marker-start:url(#circle);}.end_marked_open_circle{marker-end:url(#open_circle);}.start_marked_open_circle{marker-start:url(#open_circle);}.end_marked_big_open_circle{marker-end:url(#big_open_circle);}.start_marked_big_open_circle{marker-start:url(#big_open_circle);}
        
    </style>
    <defs>
        <marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,0 0,4 4,2 0,0"></polygon>
        </marker>
        <marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
        </marker>
        <marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="filled"></circle>
        </marker>
        <marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
        </marker>
        <marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
        </marker>
    </defs>
    <rect class="backdrop" x="0" y="0" width="456" height="288"></rect>
    <line x1="260" y1="72" x2="284" y2="72" class="solid"></line>
    <text x="298" y="12" >阻</text>
    <text x="322" y="12" >塞</text>
    <text x="346" y="12" >I</text>
    <line x1="368" y1="0" x2="360" y2="16" class="solid"></line>
    <text x="370" y="12" >O</text>
    <path d="M 392,0 A 16,16 0,0,0 392,16" class="nofill"></path>
    <text x="394" y="12" >BIO</text>
    <path d="M 424,0 A 16,16 0,0,1 424,16" class="nofill"></path>
    <text x="298" y="44" >非</text>
    <text x="322" y="44" >阻</text>
    <text x="346" y="44" >塞</text>
    <text x="370" y="44" >I</text>
    <line x1="384" y1="32" x2="376" y2="48" class="solid"></line>
    <text x="386" y="44" >O</text>
    <path d="M 408,32 A 16,16 0,0,0 408,48" class="nofill"></path>
    <text x="410" y="44" >NIO</text>
    <path d="M 440,32 A 16,16 0,0,1 440,48" class="nofill"></path>
    <line x1="100" y1="152" x2="132" y2="152" class="solid"></line>
    <text x="170" y="76" >同</text>
    <text x="194" y="76" >步</text>
    <text x="218" y="76" >I</text>
    <line x1="240" y1="64" x2="232" y2="80" class="solid"></line>
    <text x="242" y="76" >O</text>
    <text x="298" y="108" >I</text>
    <line x1="320" y1="96" x2="312" y2="112" class="solid"></line>
    <text x="322" y="108" >O</text>
    <text x="338" y="108" >多</text>
    <text x="362" y="108" >路</text>
    <text x="386" y="108" >复</text>
    <text x="410" y="108" >用</text>
    <text x="298" y="140" >信</text>
    <text x="322" y="140" >号</text>
    <text x="346" y="140" >驱</text>
    <text x="370" y="140" >动</text>
    <text x="394" y="140" >I</text>
    <line x1="416" y1="128" x2="408" y2="144" class="solid"></line>
    <text x="418" y="140" >O</text>
    <text x="2" y="156" >I</text>
    <line x1="24" y1="144" x2="16" y2="160" class="solid"></line>
    <text x="26" y="156" >O</text>
    <text x="42" y="156" >模</text>
    <text x="66" y="156" >型</text>
    <line x1="260" y1="232" x2="284" y2="232" class="solid"></line>
    <text x="298" y="204" >Linux</text>
    <text x="354" y="204" >AIO</text>
    <path d="M 384,192 A 16,16 0,0,1 384,208" class="nofill"></path>
    <text x="354" y="220" >io</text>
    <line x1="368" y1="224" x2="376" y2="224" class="solid"></line>
    <text x="378" y="220" >uring</text>
    <path d="M 424,208 A 16,16 0,0,1 424,224" class="nofill"></path>
    <text x="170" y="236" >异</text>
    <text x="194" y="236" >步</text>
    <text x="218" y="236" >I</text>
    <line x1="240" y1="224" x2="232" y2="240" class="solid"></line>
    <text x="242" y="236" >O</text>
    <text x="298" y="268" >windows</text>
    <path d="M 368,256 A 16,16 0,0,0 368,272" class="nofill"></path>
    <text x="370" y="268" >IOCP</text>
    <path d="M 408,256 A 16,16 0,0,1 408,272" class="nofill"></path>
    <g>
        <line x1="268" y1="8" x2="284" y2="8" class="solid"></line>
        <line x1="268" y1="8" x2="268" y2="64" class="solid"></line>
        <line x1="268" y1="40" x2="284" y2="40" class="solid"></line>
    </g>
    <g>
        <line x1="268" y1="80" x2="268" y2="136" class="solid"></line>
        <line x1="268" y1="104" x2="284" y2="104" class="solid"></line>
        <line x1="268" y1="136" x2="284" y2="136" class="solid"></line>
    </g>
    <g>
        <line x1="116" y1="72" x2="156" y2="72" class="solid"></line>
        <line x1="116" y1="72" x2="116" y2="144" class="solid"></line>
    </g>
    <g>
        <line x1="116" y1="160" x2="116" y2="232" class="solid"></line>
        <line x1="116" y1="232" x2="156" y2="232" class="solid"></line>
    </g>
    <g>
        <line x1="268" y1="200" x2="284" y2="200" class="solid"></line>
        <line x1="268" y1="200" x2="268" y2="224" class="solid"></line>
    </g>
    <g>
        <line x1="268" y1="240" x2="268" y2="264" class="solid"></line>
        <line x1="268" y1="264" x2="284" y2="264" class="solid"></line>
    </g>
    <g>
        <path d="M 352,192 A 16,16 0,0,0 352,208" class="nofill"></path>
        <path d="M 352,208 A 16,16 0,0,0 352,224" class="nofill"></path>
    </g>
</svg>
</pre>
<h2 id="3-同步阻塞io-blocking-io"><a class="header" href="#3-同步阻塞io-blocking-io">3. 同步阻塞I/O (blocking I/O)</a></h2>
<pre><svg xmlns="http://www.w3.org/2000/svg" width="528" height="320">
    <style>
        line, path, circle,rect,polygon{stroke:black;stroke-width:2;stroke-opacity:1;fill-opacity:1;stroke-linecap:round;stroke-linejoin:miter;}text{font-family:monospace;font-size:14px;}rect.backdrop{stroke:none;fill:white;}.broken{stroke-dasharray:8;}.filled{fill:black;}.bg_filled{fill:white;}.nofill{fill:white;}.end_marked_arrow{marker-end:url(#arrow);}.start_marked_arrow{marker-start:url(#arrow);}.end_marked_diamond{marker-end:url(#diamond);}.start_marked_diamond{marker-start:url(#diamond);}.end_marked_circle{marker-end:url(#circle);}.start_marked_circle{marker-start:url(#circle);}.end_marked_open_circle{marker-end:url(#open_circle);}.start_marked_open_circle{marker-start:url(#open_circle);}.end_marked_big_open_circle{marker-end:url(#big_open_circle);}.start_marked_big_open_circle{marker-start:url(#big_open_circle);}
        
    </style>
    <defs>
        <marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,0 0,4 4,2 0,0"></polygon>
        </marker>
        <marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
        </marker>
        <marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="filled"></circle>
        </marker>
        <marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
        </marker>
        <marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
        </marker>
    </defs>
    <rect class="backdrop" x="0" y="0" width="528" height="320"></rect>
    <rect x="4" y="24" width="80" height="272" class="solid nofill" rx="0"></rect>
    <text x="34" y="60" >Read</text>
    <text x="18" y="76" >recvfrom</text>
    <text x="10" y="220" >process</text>
    <text x="10" y="236" >datagram</text>
    <rect x="188" y="24" width="96" height="272" class="solid nofill" rx="0"></rect>
    <text x="202" y="44" >no</text>
    <text x="202" y="60" >datagram</text>
    <text x="202" y="76" >ready</text>
    <text x="202" y="140" >datagram</text>
    <text x="202" y="156" >ready</text>
    <text x="202" y="188" >copy</text>
    <text x="202" y="204" >datagram</text>
    <text x="210" y="268" >copy</text>
    <text x="210" y="284" >complete</text>
    <text x="2" y="12" >Application</text>
    <text x="210" y="12" >kernel</text>
    <text x="114" y="44" >syscall</text>
    <text x="370" y="92" >wait</text>
    <text x="370" y="108" >data</text>
    <text x="410" y="92" >for</text>
    <text x="370" y="220" >copy</text>
    <text x="370" y="236" >from</text>
    <text x="410" y="220" >data</text>
    <text x="410" y="236" >kernel</text>
    <text x="114" y="236" >return</text>
    <text x="466" y="236" >to</text>
    <text x="490" y="236" >user</text>
    <g>
        <line x1="228" y1="88" x2="228" y2="116" class="solid"></line>
        <polygon points="224,116 232,116 228,128" class="filled"></polygon>
    </g>
    <g>
        <line x1="228" y1="216" x2="228" y2="244" class="solid"></line>
        <polygon points="224,244 232,244 228,256" class="filled"></polygon>
    </g>
    <g>
        <line x1="308" y1="24" x2="340" y2="24" class="solid"></line>
        <line x1="340" y1="24" x2="340" y2="152" class="solid"></line>
        <line x1="340" y1="88" x2="356" y2="88" class="solid"></line>
        <line x1="356" y1="88" x2="356" y2="104" class="solid"></line>
        <line x1="340" y1="104" x2="356" y2="104" class="solid"></line>
        <line x1="308" y1="152" x2="340" y2="152" class="solid"></line>
    </g>
    <g>
        <line x1="100" y1="56" x2="168" y2="56" class="solid"></line>
        <polygon points="168,52 176,56 168,60" class="filled"></polygon>
    </g>
    <g>
        <line x1="308" y1="184" x2="340" y2="184" class="solid"></line>
        <line x1="340" y1="184" x2="340" y2="264" class="solid"></line>
        <line x1="340" y1="216" x2="356" y2="216" class="solid"></line>
        <line x1="356" y1="216" x2="356" y2="232" class="solid"></line>
        <line x1="340" y1="232" x2="356" y2="232" class="solid"></line>
        <line x1="308" y1="264" x2="340" y2="264" class="solid"></line>
    </g>
    <g>
        <polygon points="104,244 96,248 104,252" class="filled"></polygon>
        <line x1="104" y1="248" x2="172" y2="248" class="solid"></line>
    </g>
</svg>
</pre>
<blockquote>
<p>输入操作两个阶段：</p>
</blockquote>
<ol>
<li>进程等待内核把数据准备好；这个阶段可以阻塞也可非阻塞，设置socket属性。
<ul>
<li>阻塞： recvfrom 阻塞线程直到返回数据就绪的结果。</li>
<li>非阻塞：立即返回一个错误，轮询直到数据就绪。</li>
</ul>
</li>
<li>从内核缓冲区向进程缓冲区复制数据。（一直阻塞）</li>
</ol>
<p>异步I/O，recvfrom总是立即返回，两个阶段都由内核完成。</p>
<h2 id="4-io-多路复用io-multiplexing-"><a class="header" href="#4-io-多路复用io-multiplexing-">4. I/O 多路复用（I/O Multiplexing )</a></h2>
<p>IO多路复用是一种同步IO模型，实现一个线程可以监视多个文件句柄。</p>
<p>支持I/O多路复用的系统调用有 select/pselect/poll/epoll，本质都是同步I/O，因为数据拷贝都是阻塞的。 通过 select/epoll 来判断数据报是否准备好，即判断可读可写状态。</p>
<h2 id="5-epoll-同步阻塞非阻塞模型"><a class="header" href="#5-epoll-同步阻塞非阻塞模型">5. epoll: 同步阻塞/非阻塞模型</a></h2>
<pre><svg xmlns="http://www.w3.org/2000/svg" width="744" height="352">
    <style>
        line, path, circle,rect,polygon{stroke:black;stroke-width:2;stroke-opacity:1;fill-opacity:1;stroke-linecap:round;stroke-linejoin:miter;}text{font-family:monospace;font-size:14px;}rect.backdrop{stroke:none;fill:white;}.broken{stroke-dasharray:8;}.filled{fill:black;}.bg_filled{fill:white;}.nofill{fill:white;}.end_marked_arrow{marker-end:url(#arrow);}.start_marked_arrow{marker-start:url(#arrow);}.end_marked_diamond{marker-end:url(#diamond);}.start_marked_diamond{marker-start:url(#diamond);}.end_marked_circle{marker-end:url(#circle);}.start_marked_circle{marker-start:url(#circle);}.end_marked_open_circle{marker-end:url(#open_circle);}.start_marked_open_circle{marker-start:url(#open_circle);}.end_marked_big_open_circle{marker-end:url(#big_open_circle);}.start_marked_big_open_circle{marker-start:url(#big_open_circle);}
        
    </style>
    <defs>
        <marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,0 0,4 4,2 0,0"></polygon>
        </marker>
        <marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
        </marker>
        <marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="filled"></circle>
        </marker>
        <marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
        </marker>
        <marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
        </marker>
    </defs>
    <rect class="backdrop" x="0" y="0" width="744" height="352"></rect>
    <rect x="268" y="248" width="24" height="32" class="solid nofill" rx="0"></rect>
    <text x="210" y="28" >epoll</text>
    <line x1="248" y1="32" x2="256" y2="32" class="solid"></line>
    <text x="258" y="28" >ctl</text>
    <text x="522" y="28" >epoll</text>
    <line x1="560" y1="32" x2="568" y2="32" class="solid"></line>
    <text x="570" y="28" >wait</text>
    <text x="466" y="188" >event</text>
    <text x="362" y="316" >红黑树</text>
    <line x1="468" y1="304" x2="468" y2="320" class="solid"></line>
    <line x1="516" y1="304" x2="516" y2="320" class="solid"></line>
    <text x="658" y="316" >链表</text>
    <line x1="508" y1="328" x2="716" y2="328" class="solid"></line>
    <text x="2" y="156" >epoll</text>
    <line x1="40" y1="160" x2="48" y2="160" class="solid"></line>
    <text x="50" y="156" >create</text>
    <line x1="732" y1="304" x2="732" y2="320" class="solid"></line>
    <g>
        <line x1="196" y1="8" x2="460" y2="8" class="solid"></line>
        <line x1="196" y1="8" x2="196" y2="328" class="solid"></line>
        <line x1="460" y1="8" x2="460" y2="304" class="solid"></line>
        <line x1="460" y1="168" x2="496" y2="168" class="solid"></line>
        <polygon points="496,164 504,168 496,172" class="filled"></polygon>
        <line x1="196" y1="328" x2="460" y2="328" class="solid"></line>
    </g>
    <g>
        <line x1="508" y1="8" x2="716" y2="8" class="solid"></line>
        <line x1="508" y1="8" x2="508" y2="304" class="solid"></line>
        <line x1="716" y1="8" x2="716" y2="304" class="solid"></line>
    </g>
    <g>
        <line x1="588" y1="56" x2="628" y2="56" class="solid"></line>
        <line x1="588" y1="56" x2="588" y2="104" class="solid"></line>
        <line x1="628" y1="56" x2="628" y2="104" class="solid"></line>
        <line x1="588" y1="104" x2="628" y2="104" class="solid"></line>
        <line x1="612" y1="104" x2="612" y2="152" class="solid"></line>
        <line x1="588" y1="152" x2="628" y2="152" class="solid"></line>
        <line x1="588" y1="152" x2="588" y2="200" class="solid"></line>
        <line x1="628" y1="152" x2="628" y2="200" class="solid"></line>
        <line x1="588" y1="200" x2="628" y2="200" class="solid"></line>
        <line x1="612" y1="200" x2="612" y2="248" class="solid"></line>
        <line x1="588" y1="248" x2="628" y2="248" class="solid"></line>
        <line x1="588" y1="248" x2="588" y2="296" class="solid"></line>
        <line x1="628" y1="248" x2="628" y2="296" class="solid"></line>
        <line x1="588" y1="296" x2="628" y2="296" class="solid"></line>
    </g>
    <g>
        <line x1="340" y1="72" x2="372" y2="72" class="solid"></line>
        <line x1="340" y1="72" x2="340" y2="104" class="solid"></line>
        <line x1="372" y1="72" x2="372" y2="104" class="solid"></line>
        <line x1="324" y1="104" x2="396" y2="104" class="solid"></line>
        <line x1="324" y1="104" x2="324" y2="136" class="solid"></line>
        <line x1="396" y1="104" x2="396" y2="136" class="solid"></line>
        <line x1="300" y1="136" x2="332" y2="136" class="solid"></line>
        <line x1="300" y1="136" x2="300" y2="168" class="solid"></line>
        <line x1="332" y1="136" x2="332" y2="168" class="solid"></line>
        <line x1="380" y1="136" x2="404" y2="136" class="solid"></line>
        <line x1="380" y1="136" x2="380" y2="168" class="solid"></line>
        <line x1="404" y1="136" x2="404" y2="168" class="solid"></line>
        <line x1="300" y1="168" x2="332" y2="168" class="solid"></line>
        <line x1="316" y1="168" x2="316" y2="200" class="solid"></line>
        <line x1="380" y1="168" x2="404" y2="168" class="solid"></line>
        <line x1="276" y1="200" x2="340" y2="200" class="solid"></line>
        <line x1="276" y1="200" x2="276" y2="232" class="solid"></line>
        <line x1="340" y1="200" x2="340" y2="248" class="solid"></line>
        <line x1="276" y1="232" x2="284" y2="232" class="solid"></line>
        <line x1="324" y1="248" x2="356" y2="248" class="solid"></line>
        <line x1="324" y1="248" x2="324" y2="280" class="solid"></line>
        <line x1="356" y1="248" x2="356" y2="280" class="solid"></line>
        <line x1="324" y1="280" x2="356" y2="280" class="solid"></line>
    </g>
    <g>
        <line x1="116" y1="152" x2="152" y2="152" class="solid"></line>
        <polygon points="152,148 160,152 152,156" class="filled"></polygon>
    </g>
</svg>
</pre>
<h3 id="epoll三个函数"><a class="header" href="#epoll三个函数">epoll三个函数</a></h3>
<ul>
<li>epoll_create(int size) : 内核产生一个epoll实例数据结构，并返回一个epfd</li>
<li>epoll_ctl(int epfd, int op, int fd, struct epoll_event *event)：将被监听的描述符添加到红黑树或从红黑树中删除或者对监听事件进行修改。</li>
<li>epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout): 阻塞等待注册的事件发生，返回事件的数目，并将触发的事件写入events数组中</li>
</ul>
<h3 id="epoll-两种触发机制"><a class="header" href="#epoll-两种触发机制">epoll 两种触发机制：</a></h3>
<ul>
<li>水平触发机制（LT)。缓冲区只要有数据就触发读写。epoll 默认工作方式。select/poll只支持该方式。</li>
<li>边缘触发机制（ET)。缓冲区空或满的状态才触发读写。nginx 使用该方式，避免频繁读写。</li>
</ul>
<h3 id="惊群问题"><a class="header" href="#惊群问题">惊群问题：</a></h3>
<p>当多个进程/线程调用epoll_wait时会阻塞等待，当内核触发可读写事件，所有进程/线程都会进行响应，但是实际上只有一个进程/线程真实处理这些事件。 Liux 4.5 通过引入 EPOLLEXCLUSIVE
标识来保证一个事件发生时候只有一个线程会被唤醒，以避免多侦听下的惊群问题。</p>
<h2 id="6-异步-io-模型-io_uring"><a class="header" href="#6-异步-io-模型-io_uring">6. 异步 I/O 模型: io_uring</a></h2>
<p>Linux AIO 实现的并不理想，所以引入了新的异步I/O接口 io_uring。</p>
<pre><svg xmlns="http://www.w3.org/2000/svg" width="496" height="368">
    <style>
        line, path, circle,rect,polygon{stroke:black;stroke-width:2;stroke-opacity:1;fill-opacity:1;stroke-linecap:round;stroke-linejoin:miter;}text{font-family:monospace;font-size:14px;}rect.backdrop{stroke:none;fill:white;}.broken{stroke-dasharray:8;}.filled{fill:black;}.bg_filled{fill:white;}.nofill{fill:white;}.end_marked_arrow{marker-end:url(#arrow);}.start_marked_arrow{marker-start:url(#arrow);}.end_marked_diamond{marker-end:url(#diamond);}.start_marked_diamond{marker-start:url(#diamond);}.end_marked_circle{marker-end:url(#circle);}.start_marked_circle{marker-start:url(#circle);}.end_marked_open_circle{marker-end:url(#open_circle);}.start_marked_open_circle{marker-start:url(#open_circle);}.end_marked_big_open_circle{marker-end:url(#big_open_circle);}.start_marked_big_open_circle{marker-start:url(#big_open_circle);}
        
    </style>
    <defs>
        <marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,0 0,4 4,2 0,0"></polygon>
        </marker>
        <marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
        </marker>
        <marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="filled"></circle>
        </marker>
        <marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
        </marker>
        <marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
        </marker>
    </defs>
    <rect class="backdrop" x="0" y="0" width="496" height="368"></rect>
    <rect x="148" y="248" width="64" height="64" class="solid nofill" rx="0"></rect>
    <text x="162" y="284" >SQ</text>
    <rect x="332" y="248" width="64" height="64" class="solid nofill" rx="0"></rect>
    <text x="354" y="284" >CQ</text>
    <text x="58" y="188" >Tail</text>
    <text x="418" y="188" >Tail</text>
    <text x="90" y="220" >Kernel</text>
    <text x="58" y="12" >Head</text>
    <text x="418" y="12" >Head</text>
    <g>
        <line x1="4" y1="8" x2="44" y2="8" class="solid"></line>
        <line x1="4" y1="8" x2="4" y2="280" class="solid"></line>
        <line x1="4" y1="280" x2="128" y2="280" class="solid"></line>
        <polygon points="128,276 136,280 128,284" class="filled"></polygon>
    </g>
    <g>
        <line x1="108" y1="8" x2="188" y2="8" class="solid"></line>
        <line x1="108" y1="8" x2="108" y2="184" class="solid"></line>
        <line x1="188" y1="8" x2="188" y2="184" class="solid"></line>
        <line x1="108" y1="56" x2="188" y2="56" class="solid"></line>
        <line x1="108" y1="104" x2="188" y2="104" class="solid"></line>
        <line x1="108" y1="152" x2="188" y2="152" class="solid"></line>
        <line x1="108" y1="184" x2="188" y2="184" class="solid"></line>
    </g>
    <g>
        <line x1="316" y1="8" x2="404" y2="8" class="solid"></line>
        <line x1="316" y1="8" x2="316" y2="184" class="solid"></line>
        <line x1="404" y1="8" x2="404" y2="184" class="solid"></line>
        <line x1="316" y1="56" x2="404" y2="56" class="solid"></line>
        <line x1="316" y1="104" x2="404" y2="104" class="solid"></line>
        <line x1="316" y1="152" x2="404" y2="152" class="solid"></line>
        <line x1="316" y1="184" x2="404" y2="184" class="solid"></line>
    </g>
    <g>
        <polygon points="464,180 456,184 464,188" class="filled"></polygon>
        <line x1="464" y1="184" x2="484" y2="184" class="solid"></line>
        <line x1="484" y1="184" x2="484" y2="280" class="solid"></line>
        <line x1="412" y1="280" x2="484" y2="280" class="solid"></line>
    </g>
    <g>
        <line x1="76" y1="200" x2="436" y2="200" class="solid"></line>
        <line x1="76" y1="200" x2="76" y2="272" class="solid"></line>
        <line x1="436" y1="200" x2="436" y2="272" class="solid"></line>
    </g>
    <g>
        <line x1="76" y1="288" x2="76" y2="344" class="solid"></line>
        <line x1="436" y1="288" x2="436" y2="344" class="solid"></line>
        <line x1="76" y1="344" x2="436" y2="344" class="solid"></line>
    </g>
</svg>
</pre>
<p>io_uring接口通过两个主要数据结构工作：</p>
<ul>
<li>提交队列条目（sqe）</li>
<li>完成队列条目（cqe）</li>
</ul>
<p>这些结构的实例位于内核和应用程序之间的<strong>共享内存</strong>单生产者单消费者环形缓冲区中。</p>
<p>参考：</p>
<p><a href="https://thenewstack.io/how-io_uring-and-ebpf-will-revolutionize-programming-in-linux/">https://thenewstack.io/how-io_uring-and-ebpf-will-revolutionize-programming-in-linux/</a></p>
<p><a href="https://cor3ntin.github.io/posts/iouring/#io_uring">https://cor3ntin.github.io/posts/iouring/#io_uring</a></p>
<blockquote>
<p>因为处理 I/O 复用的编程模型相当复杂，为了简化编程，引入了下面两种模型:</p>
</blockquote>
<h3 id="1-reactor反应器-模式"><a class="header" href="#1-reactor反应器-模式">1. Reactor（反应器） 模式</a></h3>
<p>对应同步I/O，被动的事件分离和分发模型。服务等待请求事件的到来，再通过不受间断的同步处理事件，从而做出反应。</p>
<h3 id="2-preactor主动器-模式"><a class="header" href="#2-preactor主动器-模式">2. Preactor（主动器） 模式</a></h3>
<p>对应异步I/O，主动的事件分离和分发模型。这种设计允许多个任务并发的执行，从而提高吞吐量；并可执行耗时长的任务（各个任务间互不影响）。</p>
<h3 id="reactor-model"><a class="header" href="#reactor-model">Reactor Model:</a></h3>
<pre><svg xmlns="http://www.w3.org/2000/svg" width="576" height="288">
    <style>
        line, path, circle,rect,polygon{stroke:black;stroke-width:2;stroke-opacity:1;fill-opacity:1;stroke-linecap:round;stroke-linejoin:miter;}text{font-family:monospace;font-size:14px;}rect.backdrop{stroke:none;fill:white;}.broken{stroke-dasharray:8;}.filled{fill:black;}.bg_filled{fill:white;}.nofill{fill:white;}.end_marked_arrow{marker-end:url(#arrow);}.start_marked_arrow{marker-start:url(#arrow);}.end_marked_diamond{marker-end:url(#diamond);}.start_marked_diamond{marker-start:url(#diamond);}.end_marked_circle{marker-end:url(#circle);}.start_marked_circle{marker-start:url(#circle);}.end_marked_open_circle{marker-end:url(#open_circle);}.start_marked_open_circle{marker-start:url(#open_circle);}.end_marked_big_open_circle{marker-end:url(#big_open_circle);}.start_marked_big_open_circle{marker-start:url(#big_open_circle);}
        
    </style>
    <defs>
        <marker id="arrow" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,0 0,4 4,2 0,0"></polygon>
        </marker>
        <marker id="diamond" viewBox="-2 -2 8 8" refX="4" refY="2" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <polygon points="0,2 2,0 4,2 2,4 0,2"></polygon>
        </marker>
        <marker id="circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="filled"></circle>
        </marker>
        <marker id="open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="2" class="bg_filled"></circle>
        </marker>
        <marker id="big_open_circle" viewBox="0 0 8 8" refX="4" refY="4" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
            <circle cx="4" cy="4" r="3" class="bg_filled"></circle>
        </marker>
    </defs>
    <rect class="backdrop" x="0" y="0" width="576" height="288"></rect>
    <rect x="428" y="8" width="136" height="48" class="solid nofill" rx="0"></rect>
    <text x="442" y="44" >req</text>
    <text x="474" y="44" >handler</text>
    <rect x="4" y="40" width="56" height="48" class="solid nofill" rx="0"></rect>
    <rect x="428" y="216" width="136" height="48" class="solid nofill" rx="0"></rect>
    <text x="442" y="252" >req</text>
    <text x="474" y="252" >handler</text>
    <rect x="428" y="120" width="136" height="48" class="solid nofill" rx="0"></rect>
    <text x="442" y="156" >req</text>
    <text x="474" y="156" >handler</text>
    <text x="2" y="28" >req</text>
    <text x="346" y="28" >Dispatch</text>
    <text x="346" y="124" >Dispatch</text>
    <text x="354" y="220" >Dispatch</text>
    <text x="130" y="92" >event</text>
    <text x="226" y="124" >Service</text>
    <text x="226" y="140" >Handler</text>
    <text x="2" y="156" >req</text>
    <text x="122" y="188" >event</text>
    <g>
        <line x1="340" y1="40" x2="408" y2="40" class="solid"></line>
        <line x1="340" y1="40" x2="340" y2="128" class="solid"></line>
        <polygon points="408,36 416,40 408,44" class="filled"></polygon>
    </g>
    <g>
        <line x1="204" y1="88" x2="308" y2="88" class="solid"></line>
        <line x1="204" y1="88" x2="204" y2="168" class="solid"></line>
        <line x1="308" y1="88" x2="308" y2="168" class="solid"></line>
        <line x1="308" y1="136" x2="408" y2="136" class="solid"></line>
        <polygon points="408,132 416,136 408,140" class="filled"></polygon>
        <line x1="204" y1="168" x2="308" y2="168" class="solid"></line>
    </g>
    <g>
        <line x1="340" y1="144" x2="340" y2="232" class="solid"></line>
        <line x1="340" y1="232" x2="416" y2="232" class="solid"></line>
        <polygon points="416,228 424,232 416,236" class="filled"></polygon>
    </g>
    <g>
        <line x1="76" y1="72" x2="116" y2="72" class="solid"></line>
        <line x1="116" y1="72" x2="116" y2="120" class="solid"></line>
        <line x1="116" y1="120" x2="184" y2="120" class="solid"></line>
        <polygon points="184,116 192,120 184,124" class="filled"></polygon>
    </g>
    <g>
        <line x1="108" y1="152" x2="184" y2="152" class="solid"></line>
        <line x1="108" y1="152" x2="108" y2="192" class="solid"></line>
        <polygon points="184,148 192,152 184,156" class="filled"></polygon>
    </g>
    <g>
        <line x1="4" y1="168" x2="60" y2="168" class="solid"></line>
        <line x1="4" y1="168" x2="4" y2="216" class="solid"></line>
        <line x1="60" y1="168" x2="60" y2="216" class="solid"></line>
        <line x1="60" y1="200" x2="100" y2="200" class="solid"></line>
        <line x1="4" y1="216" x2="60" y2="216" class="solid"></line>
    </g>
</svg>
</pre>
<h4 id="三种实现方式"><a class="header" href="#三种实现方式">三种实现方式：</a></h4>
<ul>
<li>单线程模式。 accept()、read()、write()以及connect()操作 都在同一线程。</li>
<li>工作者线程池模式。非 I/O 操作交给线程池处理</li>
<li>多线程模式。主Reactor (master) ，负责网络监听 ， 子Reactor(worker) 读写网络数据。</li>
</ul>
<h4 id="读写操作流程"><a class="header" href="#读写操作流程">读写操作流程：</a></h4>
<ol>
<li>应用注册读写就绪事件和相关联的事件处理器</li>
<li>事件分离器等待事件发生</li>
<li>当发生读写就绪事件，事件分离器调用已注册的事件处理器</li>
<li>事件处理器执行读写操作</li>
</ol>
<h4 id="参与者"><a class="header" href="#参与者">参与者：</a></h4>
<ol>
<li>描述符（handle）：操作系统提供的资源，识别 socket等。</li>
<li>同步事件多路分离器。开启事件循环，等待事件的发生。封装了 多路复用函数 select/poll/epoll等。</li>
<li>事件处理器。提供回调函数，用于描述与应用程序相关的某个事件的操作。</li>
<li>具体的事件处理器。事件处理器接口的具体实现。使用描述符来识别事件和程序提供的服务。</li>
<li>Reactor 管理器。事件处理器的调度核心。分离每个事件，调度事件管理器，调用具体的函数处理某个事件。</li>
</ol>
<h2 id="参考资源-27"><a class="header" href="#参考资源-27">参考资源</a></h2>
<h3 id="online-book-29"><a class="header" href="#online-book-29">online-book</a></h3>
<ul>
<li><a href="https://time.geekbang.org/course/detail/100060601-365835">88. IO模型</a></li>
<li><a href="https://time.geekbang.org/course/detail/100060601-365838">89. epoll和io_uring</a></li>
<li><a href="https://time.geekbang.org/course/detail/100060601-367808">90. 事件驱动编程模型</a></li>
</ul>
<h3 id="fragment-29"><a class="header" href="#fragment-29">fragment</a></h3>
<h3 id="local-29"><a class="header" href="#local-29">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="多线程并发模型"><a class="header" href="#多线程并发模型">多线程并发模型</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B">多线程并发模型</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/7_concurrency/1_multi_models/multi_models.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:38 UTC 2022 -->
<!--te-->
<h2 id="参考资源-28"><a class="header" href="#参考资源-28">参考资源</a></h2>
<h3 id="online-book-30"><a class="header" href="#online-book-30">online-book</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch16-00-concurrency.html">Fearless Concurrency - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch20-00-final-project-a-web-server.html">Final Project: Building a Multithreaded Web Server - The Rust Programming Language</a></li>
</ul>
<h3 id="fragment-30"><a class="header" href="#fragment-30">fragment</a></h3>
<h3 id="local-30"><a class="header" href="#local-30">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="异步模型"><a class="header" href="#异步模型">异步模型</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html#%E5%BC%82%E6%AD%A5%E6%A8%A1%E5%9E%8B">异步模型</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/7_concurrency/2_async_models/async_models.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:38 UTC 2022 -->
<!--te-->
<h2 id="参考资源-29"><a class="header" href="#参考资源-29">参考资源</a></h2>
<h3 id="online-book-31"><a class="header" href="#online-book-31">online-book</a></h3>
<h3 id="fragment-31"><a class="header" href="#fragment-31">fragment</a></h3>
<h3 id="local-31"><a class="header" href="#local-31">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="元编程"><a class="header" href="#元编程">元编程</a></h1>
<!--ts-->
<ul>
<li><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html#%E5%85%83%E7%BC%96%E7%A8%8B">元编程</a>
<ul>
<li><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html#online-book">online-book</a></li>
<li><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html#fragment">fragment</a></li>
<li><a href="layer3_task_abstract/8_meta_programming/8_meta_programming.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:39 UTC 2022 -->
<!--te-->
<h2 id="参考资源-30"><a class="header" href="#参考资源-30">参考资源</a></h2>
<h3 id="online-book-32"><a class="header" href="#online-book-32">online-book</a></h3>
<h3 id="fragment-32"><a class="header" href="#fragment-32">fragment</a></h3>
<h3 id="local-32"><a class="header" href="#local-32">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="协议抽象"><a class="header" href="#协议抽象">协议抽象</a></h1>
<!--ts-->
<ul>
<li><a href="layer4_protocol_abstract/layer4_protocol_abstract.html#%E5%8D%8F%E8%AE%AE%E6%8A%BD%E8%B1%A1">协议抽象</a>
<ul>
<li><a href="layer4_protocol_abstract/layer4_protocol_abstract.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer4_protocol_abstract/layer4_protocol_abstract.html#online-book">online-book</a></li>
<li><a href="layer4_protocol_abstract/layer4_protocol_abstract.html#fragment">fragment</a></li>
<li><a href="layer4_protocol_abstract/layer4_protocol_abstract.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:40 UTC 2022 -->
<!--te-->
<h2 id="参考资源-31"><a class="header" href="#参考资源-31">参考资源</a></h2>
<h3 id="online-book-33"><a class="header" href="#online-book-33">online-book</a></h3>
<h3 id="fragment-33"><a class="header" href="#fragment-33">fragment</a></h3>
<h3 id="local-33"><a class="header" href="#local-33">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="多语言编程"><a class="header" href="#多语言编程">多语言编程</a></h1>
<!--ts-->
<ul>
<li><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html#%E5%A4%9A%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B">多语言编程</a>
<ul>
<li><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html#online-book">online-book</a></li>
<li><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html#fragment">fragment</a></li>
<li><a href="layer4_protocol_abstract/9_multilingual_programming/9_multilingual_programming.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:40 UTC 2022 -->
<!--te-->
<h2 id="参考资源-32"><a class="header" href="#参考资源-32">参考资源</a></h2>
<h3 id="online-book-34"><a class="header" href="#online-book-34">online-book</a></h3>
<h3 id="fragment-34"><a class="header" href="#fragment-34">fragment</a></h3>
<h3 id="local-34"><a class="header" href="#local-34">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="计算机网络"><a class="header" href="#计算机网络">计算机网络</a></h1>
<!--ts-->
<ul>
<li><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">计算机网络</a>
<ul>
<li><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html#online-book">online-book</a></li>
<li><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html#fragment">fragment</a></li>
<li><a href="layer4_protocol_abstract/10_computer_network/10_computer_network.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:40 UTC 2022 -->
<!--te-->
<h2 id="参考资源-33"><a class="header" href="#参考资源-33">参考资源</a></h2>
<h3 id="online-book-35"><a class="header" href="#online-book-35">online-book</a></h3>
<h3 id="fragment-35"><a class="header" href="#fragment-35">fragment</a></h3>
<h3 id="local-35"><a class="header" href="#local-35">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="生态系统"><a class="header" href="#生态系统">生态系统</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/layer5_ecosystem.html#%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F">生态系统</a>
<ul>
<li><a href="layer5_ecosystem/layer5_ecosystem.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/layer5_ecosystem.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/layer5_ecosystem.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/layer5_ecosystem.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:50 UTC 2022 -->
<!--te-->
<h2 id="参考资源-34"><a class="header" href="#参考资源-34">参考资源</a></h2>
<h3 id="online-book-36"><a class="header" href="#online-book-36">online-book</a></h3>
<h3 id="fragment-36"><a class="header" href="#fragment-36">fragment</a></h3>
<h3 id="local-36"><a class="header" href="#local-36">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="学习资源"><a class="header" href="#学习资源">学习资源</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/1_learning_resource/learning_resource.html#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90">学习资源</a></li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:41 UTC 2022 -->
<!--te--><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="官方动态"><a class="header" href="#官方动态">官方动态</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="社区特点"><a class="header" href="#社区特点">社区特点</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="学术动态"><a class="header" href="#学术动态">学术动态</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="开源观察"><a class="header" href="#开源观察">开源观察</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="命令行工具"><a class="header" href="#命令行工具">命令行工具</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数据处理"><a class="header" href="#数据处理">数据处理</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="嵌入式"><a class="header" href="#嵌入式">嵌入式</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="操作系统"><a class="header" href="#操作系统">操作系统</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="性能工具"><a class="header" href="#性能工具">性能工具</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="云原生"><a class="header" href="#云原生">云原生</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="前端开发"><a class="header" href="#前端开发">前端开发</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="网络基建"><a class="header" href="#网络基建">网络基建</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipfs-星际文件系统interplanetary-file-system"><a class="header" href="#ipfs-星际文件系统interplanetary-file-system">IPFS: 星际文件系统(InterPlanetary File System)</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/ipfs.jpeg" alt="ipfs" /></p>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs-%E6%98%9F%E9%99%85%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Finterplanetary-file-system">IPFS: 星际文件系统(InterPlanetary File System)</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E4%BB%8B%E7%BB%8D">IPFS介绍</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#1-%E4%BB%80%E4%B9%88%E6%98%AFipfs">1 什么是IPFS</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89ipfs">2 为什么有IPFS</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#http%E7%9A%84%E4%B8%AD%E5%BF%83%E5%8C%96%E6%98%AF%E4%BD%8E%E6%95%88%E7%9A%84-%E5%B9%B6%E4%B8%94%E6%88%90%E6%9C%AC%E5%BE%88%E9%AB%98">HTTP的中心化是低效的, 并且成本很高</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#web%E6%96%87%E4%BB%B6%E7%BB%8F%E5%B8%B8%E8%A2%AB%E5%88%A0%E9%99%A4">Web文件经常被删除</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#%E4%B8%AD%E5%BF%83%E5%8C%96%E9%99%90%E5%88%B6%E4%BA%86web%E7%9A%84%E6%88%90%E9%95%BF">中心化限制了web的成长</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#%E4%BA%92%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E9%AB%98%E5%BA%A6%E4%BE%9D%E8%B5%96%E4%B8%BB%E5%B9%B2%E7%BD%91">互联网应用高度依赖主干网</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#3-ipfs%E7%9A%84%E7%9B%AE%E6%A0%87">3 IPFS的目标</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#4-ipfs%E5%8C%85%E5%90%AB%E5%93%AA%E4%BA%9B%E5%86%85%E5%AE%B9">4 IPFS包含哪些内容</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8D%8F%E8%AE%AE%E7%B1%BB%E4%BC%BChttp%E5%8D%8F%E8%AE%AE">IPFS是一个协议，类似http协议</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%98%AF%E4%B8%80%E4%B8%AAweb%E5%8D%8F%E8%AE%AE">IPFS是一个web协议</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%98%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E5%8D%8F%E8%AE%AE">IPFS是模块化的协议</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%98%AF%E4%B8%80%E4%B8%AAp2p%E7%B3%BB%E7%BB%9F">IPFS是一个p2p系统</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E5%A4%A9%E7%94%9F%E6%98%AF%E4%B8%80%E4%B8%AAcdn">IPFS天生是一个CDN</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%8B%A5%E6%9C%89%E5%91%BD%E5%90%8D%E6%9C%8D%E5%8A%A1">IPFS拥有命名服务</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C">IPFS如何工作</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E4%B8%AD%E5%BF%83%E5%8C%96%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%BA%E7%82%B9">IPFS如何解决中心化服务器缺点</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#1-%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E5%BF%AB-%E4%B8%8D%E5%86%8D%E4%BE%9D%E8%B5%96%E4%B8%BB%E5%B9%B2%E7%BD%91-%E4%B8%AD%E5%BF%83%E5%8C%96%E6%9C%8D%E5%8A%A1%E5%99%A8">1 下载速度快, 不再依赖主干网, 中心化服务器</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#2-%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E5%8F%98%E5%BE%97%E9%9D%9E%E5%B8%B8%E4%BE%BF%E5%AE%9C">2 存储空间变得非常便宜</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#3-%E5%AE%89%E5%85%A8">3 安全</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#4-%E5%BC%80%E6%94%BE">4 开放</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E7%9A%84%E7%94%A8%E9%80%94">IPFS的用途</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E7%9A%84pow%E6%9C%BA%E5%88%B6">IPFS的POW机制</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E5%AE%B6%E6%97%8F">IPFS家族</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#main-projects">Main Projects</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#contributions">Contributions</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#movements">Movements</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs-%E4%B8%8E-filecoin">IPFS 与 Filecoin</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%86%E5%8F%91%E5%92%8C%E5%AE%9A%E4%BD%8D%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE%E7%B1%BB%E4%BC%BChttp%E5%8D%8F%E8%AE%AE">IPFS：数据的分发和定位（数据传输协议，类似HTTP协议）</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#filecoin-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E7%B1%BB%E4%BC%BC%E4%B8%80%E4%B8%AA%E4%BA%91%E5%AD%98%E5%82%A8">Filecoin: 数据存储（类似一个云存储）</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E5%92%8Cfilecoin%E5%85%B1%E5%90%8C%E4%BE%9D%E8%B5%96libp2p%E9%A1%B9%E7%9B%AE">IPFS和Filecoin共同依赖libp2p项目。</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#%E4%BD%BF%E7%94%A8ipfs%E7%9A%84%E5%BA%94%E7%94%A8">使用IPFS的应用</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E7%BD%91%E7%BB%9C%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C">IPFS网络如何运行</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs-nat-traversal">IPFS: NAT traversal</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#bitswap">BitSwap</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#ipfs%E9%9D%9Erust%E5%AE%9E%E7%8E%B0%E7%89%88%E6%9C%AC">IPFS非rust实现版本</a></li>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:43 UTC 2022 -->
<!--te-->
<h2 id="ipfs介绍"><a class="header" href="#ipfs介绍">IPFS介绍</a></h2>
<h3 id="1-什么是ipfs"><a class="header" href="#1-什么是ipfs">1 什么是IPFS</a></h3>
<p>星际文件系统(InterPlanetary File System). IPFS 是一个分布式的web, 点到点超媒体协议. 可以让我们的互联网速度更快, 更加安全, 并且更加开放. IPFS协议的目标是取代传统的互联网协议HTTP。</p>
<h3 id="2-为什么有ipfs"><a class="header" href="#2-为什么有ipfs">2 为什么有IPFS</a></h3>
<p>众所周知, 互联网是建立在HTTP协议上的. HTTP协议是个伟大的发明, 让我们的互联网得以快速发展.但是互联网发展到了今天HTTP逐渐出来了不足.</p>
<h4 id="http的中心化是低效的-并且成本很高"><a class="header" href="#http的中心化是低效的-并且成本很高">HTTP的中心化是低效的, 并且成本很高</a></h4>
<p>使用HTTP协议每次需要从中心化的服务器下载完整的文件(网页, 视频, 图片等), 速度慢, 效率低. 如果改用P2P的方式下载, 可以节省近60%的带宽. P2P将文件分割为小的块, 从多个服务器同时下载, 速度非常快.</p>
<h4 id="web文件经常被删除"><a class="header" href="#web文件经常被删除">Web文件经常被删除</a></h4>
<p>回想一下是不是经常你收藏的某个页面, 在使用的时候浏览器返回404(无法找到页面), http的页面平均生存周期大约只有100天. Web文件经常被删除(由于存储成本太高), 无法永久保存. IPFS提供了文件的历史版本回溯功能(就像git版本控制工具一样), 可以很容易的查看文件的历史版本, 数据可以得到永久保存</p>
<h4 id="中心化限制了web的成长"><a class="header" href="#中心化限制了web的成长">中心化限制了web的成长</a></h4>
<p>我们的现有互联网是一个高度中心化的网络. 互联网是人类的伟大发明, 也是科技创新的加速器. 各种管制将对这互联网的功能造成威胁, 例如: 互联网封锁, 管制, 监控等等.这些都源于互联网的中心化.而分布式的IPFS可以克服这些web的缺点.</p>
<h4 id="互联网应用高度依赖主干网"><a class="header" href="#互联网应用高度依赖主干网">互联网应用高度依赖主干网</a></h4>
<p>主干网受制于诸多因素的影响, 战争, 自然灾害, 互联网管制, 中心化服务器宕机等等, 都可能是我们的互联网应用中断服务. IPFS可以是互联网应用极大的降低互联网应用对主干网的依赖.</p>
<h3 id="3-ipfs的目标"><a class="header" href="#3-ipfs的目标">3 IPFS的目标</a></h3>
<p>IPFS不仅仅是为了加速web. 而是为了最终取代HTTP协议, 使互联网更加美好</p>
<h3 id="4-ipfs包含哪些内容"><a class="header" href="#4-ipfs包含哪些内容">4 IPFS包含哪些内容</a></h3>
<h4 id="ipfs是一个协议类似http协议"><a class="header" href="#ipfs是一个协议类似http协议">IPFS是一个协议，类似http协议</a></h4>
<ul>
<li>定义了基于内容的寻址文件系统</li>
<li>内容分发</li>
<li>使用的技术分布式哈希、p2p传输、版本管理系统</li>
<li>IPFS是一个文件系统</li>
</ul>
<p>有文件夹和文件 可挂载文件系统</p>
<h4 id="ipfs是一个web协议"><a class="header" href="#ipfs是一个web协议">IPFS是一个web协议</a></h4>
<ul>
<li>可以像http那样查看互联网页面</li>
<li>未来浏览器可以直接支持 ipfs:/ 或者 fs:/ 协议</li>
</ul>
<h4 id="ipfs是模块化的协议"><a class="header" href="#ipfs是模块化的协议">IPFS是模块化的协议</a></h4>
<ul>
<li>连接层：通过其他任何网络协议连接</li>
<li>路由层：寻找定位文件所在位置</li>
<li>数据块交换：采用BitTorrent技术</li>
</ul>
<h4 id="ipfs是一个p2p系统"><a class="header" href="#ipfs是一个p2p系统">IPFS是一个p2p系统</a></h4>
<ul>
<li>世界范围内的p2p文件传输网络</li>
<li>分布式网络结构</li>
<li>没有单点失效问题</li>
</ul>
<h4 id="ipfs天生是一个cdn"><a class="header" href="#ipfs天生是一个cdn">IPFS天生是一个CDN</a></h4>
<ul>
<li>文件添加到IPFS网络，将会在全世界进行CDN加速</li>
<li>bittorrent的带宽管理</li>
</ul>
<h4 id="ipfs拥有命名服务"><a class="header" href="#ipfs拥有命名服务">IPFS拥有命名服务</a></h4>
<ul>
<li>IPNS：基于SFS（自认证系统）命名体系</li>
<li>可以和现有域名系统绑定</li>
</ul>
<h2 id="ipfs如何工作"><a class="header" href="#ipfs如何工作">IPFS如何工作</a></h2>
<ol>
<li>IPFS为每一个文件分配一个独一无二的哈希值(文件指纹: 根据文件的内容进行创建), 即使是两个文件内容只有1个比特的不相同, 其哈希值也是不相同的.所以IPFS是基于文件内容进行寻址, 而不像传统的HTTP协议一样基于域名寻址.</li>
<li>IPFS在整个网络范围内去掉重复的文件, 并且为文件建立版本管理, 也就是说每一个文件的变更历史都将被记录(这一点类似版本控制工具git, svn等), 可以很容易个回到文件的历史版本查看数据.</li>
<li>当查询文件的时候, IPFS网络根据文件的哈希值(全网唯一)进行查找. 由于每个文件的哈希值全网唯一, 查询将很容易进行.</li>
<li>如果仅仅使用哈希值来区分文件的话, 会给传播造成困难, 因为哈希值不容易记忆, 就像ip地址一样不容易记忆, 于是人类发明的域名. IPFS利用IPNS将哈希值映射为容易记的名字</li>
<li>每个节点除了存储自己需要的数据, 还存储了一张哈希表, 用来记录文件存储所在的位置. 用来进行文件的查询下载.</li>
</ol>
<h2 id="ipfs如何解决中心化服务器缺点"><a class="header" href="#ipfs如何解决中心化服务器缺点">IPFS如何解决中心化服务器缺点</a></h2>
<h3 id="1-下载速度快-不再依赖主干网-中心化服务器"><a class="header" href="#1-下载速度快-不再依赖主干网-中心化服务器">1 下载速度快, 不再依赖主干网, 中心化服务器</a></h3>
<p>整个IPFS系统是一个分布式的文件存储系统, 那么在下载相关数据的时候, 将从多个节点同时下载, 相比于HTTP从中心服务器的下载速度要快很多, 大家都用过P2P下载(比如: 迅雷, BitTorrent), IPFS下载过程跟这个类似.</p>
<h3 id="2-存储空间变得非常便宜"><a class="header" href="#2-存储空间变得非常便宜">2 存储空间变得非常便宜</a></h3>
<p>由于IPFS使用的是区块链技术, 利用 Filecoin(也就是挖矿)来激励矿工分享自己的硬盘, 并且IFPS从全网去掉了冗余存储(从整个网络空间考虑, 这将大大节省网络存储空间), 将来的IPFS存储将会变得非常便宜(与我们现在的云盘, 各种中心化的CND相比较).</p>
<h3 id="3-安全"><a class="header" href="#3-安全">3 安全</a></h3>
<p>中心化服务器目前很难抵挡DDoS攻击, 当大量的访问请求从四面八方涌来, 中心化的服务器几乎会在一瞬间瘫痪, 巨大的访问量随时可能造成服务器宕机. IPFS天生就拥有抵挡这种攻击的能力. 因为所有的访问将会被分散到不同的节点. 甚至攻击者自己也是节点之一. 某种程度上讲, IPFS甚至能抵挡量子计算的攻击.</p>
<h3 id="4-开放"><a class="header" href="#4-开放">4 开放</a></h3>
<p>众所周知, 比特币是一种去中心化, 匿名的数据货币, 这些特性使得比特币无法被管制, 交易无法篡改. IPFS同样, 由于是建立在去中心化的分布式网络上的, 所以IFPS很难被中心化管理, 限制. 互联网将更加开放.</p>
<h2 id="ipfs的用途"><a class="header" href="#ipfs的用途">IPFS的用途</a></h2>
<blockquote>
<p>IPFS主要解决现有中心化服务器中的数据存储问题。它能够极大的降低数据存储的成本,提升数据下载速度。</p>
</blockquote>
<blockquote>
<p>那么凡是需要优化数据存储的地方几乎都可以使用IPFS来提升效率</p>
</blockquote>
<blockquote>
<p>下面是一张保存在ipfs网络的图片：</p>
</blockquote>
<p><img src="https://ipfs.io/ipfs/QmdDTor6dWzknFJPJuhJgrUYqd56WkFXYAxyxpEY7kUrEb" alt="" /></p>
<ul>
<li>在 /ipfs 和 /ipns 下面挂载全球文件系统：就是说我们所有的文件都可以存到上面.</li>
<li>挂载个人同步的文件夹, 可以自动进行版本管理, 自动备份. 也就意味着未来我们将拥有无限空间的网盘, 不用担心数据丢失, 不用担心隐私泄露(非对称加密). 国外的dropbox, 跟IPFS云盘相比, 都将变得微不足道 。</li>
<li>作为加密文件和数据共享系统。IPFS天生视乎就具备这样的能力, 文件加密, 数据共享, 都是小菜一碟.</li>
<li>作为带版本控制的软件包管理系统.</li>
<li>作为虚拟机的根文件系统</li>
<li>作为利用管理程序, 把IPFS作为虚拟机的引导文件系统：在线操作系统</li>
<li>作为数据库：应用可以直接操作IPFS的Merkle DAG数据结构, 并且可以使用IPFS的版本控制, 缓存. 试想一下我们的数据库直接存在IPFS的文件系统是什么体验? 自动备份, 永不丢失, 安全加密, 无限空间, 高速连接。</li>
<li>作为加密通讯平台，谁都别想窃听消息通信</li>
<li>作为加密CDN, 作为web的CDN, CDN功能全包.</li>
<li>永久web, 不存在不能访问的链接, 跟 404 说 byebye.</li>
</ul>
<h2 id="ipfs的pow机制"><a class="header" href="#ipfs的pow机制">IPFS的POW机制</a></h2>
<h2 id="ipfs家族"><a class="header" href="#ipfs家族">IPFS家族</a></h2>
<blockquote>
<p><a href="https://protocol.ai/work/">Work | Protocol Labs</a></p>
</blockquote>
<h3 id="main-projects"><a class="header" href="#main-projects">Main Projects</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220618215731222.png" alt="image-20220618215731222" /></p>
<h3 id="contributions"><a class="header" href="#contributions">Contributions</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220618220109640.png" alt="image-20220618220109640" /></p>
<h3 id="movements"><a class="header" href="#movements">Movements</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/image-20220618220532130.png" alt="image-20220618220532130" /></p>
<h3 id="ipfs-与-filecoin"><a class="header" href="#ipfs-与-filecoin">IPFS 与 Filecoin</a></h3>
<h4 id="ipfs数据的分发和定位数据传输协议类似http协议"><a class="header" href="#ipfs数据的分发和定位数据传输协议类似http协议">IPFS：数据的分发和定位（数据传输协议，类似HTTP协议）</a></h4>
<ul>
<li>传输：数据在节点之间进行传输</li>
<li>定位：寻址，发现数据的存储位置</li>
<li>存储：自己提供存储（可以保证存储的安全性），其它节点不保证数据存储的安全性</li>
<li>用户：下载数据免费，自己提供服务器，自己搭建节点</li>
<li>存储内容：只存储节点自己感兴趣的内容</li>
</ul>
<h4 id="filecoin-数据存储类似一个云存储"><a class="header" href="#filecoin-数据存储类似一个云存储">Filecoin: 数据存储（类似一个云存储）</a></h4>
<ul>
<li>存储：付费存储，用户付费，矿工和Filecoin网络保证存储的安全性</li>
<li>下载：付费下载，用户付费，矿工负责发送数据</li>
<li>用户：不需要自己提供存储，也不需要自己提供节点</li>
<li>存储内容：收费存储一切</li>
</ul>
<h4 id="ipfs和filecoin共同依赖libp2p项目"><a class="header" href="#ipfs和filecoin共同依赖libp2p项目">IPFS和Filecoin共同依赖libp2p项目。</a></h4>
<blockquote>
<p>Filecoin是IPFS的激励层，二者互补形式一对协议。为我们的互联网提供了很好的基础设施。</p>
</blockquote>
<p>了解上述的基本内容后：</p>
<ul>
<li>如果开发者仅仅想要的是一个安全、快速的云存储，那么选择Filecoin即可。</li>
<li>如果开发者除了数据存储需求，还需要分发数据，那么选择IPFS即可。</li>
<li>如果开发者既有数据存储需求，又有数据的分发需求，那么可以单独选择IPFS，也可以IPFS+Filecoin一起。</li>
</ul>
<blockquote>
<p>注意：IPFS可以做Filecoin的事情，存储，而filecoin并不能做IPFS的事情，数据传输</p>
</blockquote>
<h2 id="使用ipfs的应用"><a class="header" href="#使用ipfs的应用">使用IPFS的应用</a></h2>
<ul>
<li><del><a href="https://github.com/AKASHAorg/Community/releases">akasha</a>： 基于以太坊和IPFS的社交网络</del></li>
<li><del>Alexandria：去中心化的内容发布平台</del></li>
<li><a href="https://github.com/MichaelMure/Arbore">Arbore</a>：朋友之间的文件共享系统–相信很快就可以抛弃某度的云盘了</li>
<li><a href="https://github.com/dtube/dtube">dtube</a>：利用IPFS作为存储的视频分享网站</li>
<li><a href="https://github.com/whyrusleeping/git-ipfs-rehost">git-ipfs-rehost</a>：可以把github上的项目存储到IPFS上</li>
<li><a href="https://github.com/ipfs-search/ipfs-search">ipfs-search</a>：基于IFPS的搜索引擎</li>
<li><a href="https://github.com/ipfs-shipyard/ipfs-share-files">ipfs-share</a>：基于IFPS的文件分享</li>
<li><a href="http://ipfs.pics/">ipfs.pics</a>：基于IFPS的图片分享网站</li>
<li><a href="https://github.com/orbitdb/orbit">Orbit</a>：基于IFPS的分布式聊天工具</li>
<li><a href="https://github.com/BusterLabs/Partyshare">Partyshare</a>：一个简单的文件共享系统</li>
<li>http://computes.io：基于IPFS的分布式计算机（这个牛，把世界上的计算资源收集起来，构建一个巨大的分布式计算机）</li>
<li><a href="https://github.com/OpenBazaar?type=source">OpenBazaar</a>：openbazaar是一个去中心化的淘宝，口号是“买卖自由/Buy and Sell
Freely”，问题是一旦用户停止运行软件，商店就下线了，借助于IPFS，openbazaar2.0 打造一个离线商店。</li>
<li>Ubuntu：著名的linux发行版本Ubuntu正在计算把发行版本转移到IPFS上来，目前正在讨论方案。</li>
</ul>
<blockquote>
<p>更多可在这里查看：
<a href="https://ipfs.io/ipfs/QmUQs8yuYbQ7VbMpRoL6RFz4dMuK4RqCCmPmJc5fK7P4Yc/">Awesome IPFS</a></p>
</blockquote>
<blockquote>
<p>一些过期项目：
<a href="https://github.com/ipfs-inactive?type=source">IPFS Inactive repositories</a></p>
</blockquote>
<h2 id="ipfs网络如何运行"><a class="header" href="#ipfs网络如何运行">IPFS网络如何运行</a></h2>
<h2 id="ipfs-nat-traversal"><a class="header" href="#ipfs-nat-traversal">IPFS: NAT traversal</a></h2>
<h2 id="bitswap"><a class="header" href="#bitswap">BitSwap</a></h2>
<h2 id="ipfs非rust实现版本"><a class="header" href="#ipfs非rust实现版本">IPFS非rust实现版本</a></h2>
<h2 id="参考资源-35"><a class="header" href="#参考资源-35">参考资源</a></h2>
<ul>
<li><a href="https://www.zhihu.com/column/ipfsguide">IPFS指南 - 知乎</a></li>
<li><a href="https://github.com/rs-ipfs/rust-ipfs">rs-ipfs/rust-ipfs: The InterPlanetary File System (IPFS), implemented in Rust.</a></li>
<li><a href="https://opencollective.com/rs-ipfs">Rust IPFS - Open Collective</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/33170031">IPFS网络是如何运行的(p2p网络) - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/33057094">IPFS: NAT traversal(NAT穿越) - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/33148036">IPFS: BitSwap协议(数据块交换) - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/34158682">IPFS非rust实现版本</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="利用ipfs构建自己的去中心化分布式网站"><a class="header" href="#利用ipfs构建自己的去中心化分布式网站">利用IPFS构建自己的去中心化分布式网站</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_website.html#%E5%88%A9%E7%94%A8ipfs%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E5%88%86%E5%B8%83%E5%BC%8F%E7%BD%91%E7%AB%99">利用IPFS构建自己的去中心化分布式网站</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_website.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:44 UTC 2022 -->
<!--te-->
<h2 id="参考资源-36"><a class="header" href="#参考资源-36">参考资源</a></h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/32869413">如何基于IPFS建一个静态网站 - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/32682117">如何在IPFS里面上传一张图片 - 知乎</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipfspubsub功能使用"><a class="header" href="#ipfspubsub功能使用">IPFS：pubsub功能使用</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_pubsub.html#ipfspubsub%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8">IPFS：pubsub功能使用</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_pubsub.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:43 UTC 2022 -->
<!--te-->
<h2 id="参考资源-37"><a class="header" href="#参考资源-37">参考资源</a></h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/36502849">IPFS: pubsub功能的使用 - 知乎</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipfs伴侣插件使用"><a class="header" href="#ipfs伴侣插件使用">IPFS伴侣插件使用</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_companion.html#ipfs%E4%BC%B4%E4%BE%A3%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8">IPFS伴侣插件使用</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_companion.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:43 UTC 2022 -->
<!--te-->
<h2 id="参考资源-38"><a class="header" href="#参考资源-38">参考资源</a></h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/35566466">【应用】IPFS伴侣浏览器插件V2.2.0版本升级的重大意义 - 知乎</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="基于ipfs与ngrok构建网关"><a class="header" href="#基于ipfs与ngrok构建网关">基于IPFS与Ngrok构建网关</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_ngrok.html#%E5%9F%BA%E4%BA%8Eipfs%E4%B8%8Engrok%E6%9E%84%E5%BB%BA%E7%BD%91%E5%85%B3">基于IPFS与Ngrok构建网关</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/network/ipfs/ipfs_ngrok.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:43 UTC 2022 -->
<!--te-->
<h2 id="参考资源-39"><a class="header" href="#参考资源-39">参考资源</a></h2>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/35151037">【应用】（入门）基于IPFS和Ngrok构建自维护资源网关 - 知乎</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/35951053">【应用】（进阶）基于IPFS和Ngrok构建自维护资源网关 - 知乎</a> </li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="网络开发"><a class="header" href="#网络开发">网络开发</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="基于rust尝试webassembly"><a class="header" href="#基于rust尝试webassembly">基于Rust尝试WebAssembly</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/web/webassembly_try.html#%E5%9F%BA%E4%BA%8Erust%E5%B0%9D%E8%AF%95webassembly">基于Rust尝试WebAssembly</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/web/webassembly_try.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/5_open_source/2_network/web/webassembly_try.html#%E5%85%B3%E4%BA%8E%E5%BA%B7%E5%A8%81%E6%B8%B8%E6%88%8Fconways-game">关于康威游戏(Conway’s Game)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:44 UTC 2022 -->
<!--te-->
<h2 id="参考资源-40"><a class="header" href="#参考资源-40">参考资源</a></h2>
<ul>
<li><a href="https://rustwasm.github.io/docs/book/introduction.html">Introduction - Rust and WebAssembly</a></li>
<li><a href="https://web.archive.org/web/20220628021752/https://mp.weixin.qq.com/s/pEvCIZUmQkxBpgfG1IjWeQ">Rust和WebAssembly初体验</a></li>
<li><a href="https://web.archive.org/web/20220628021759/https://mp.weixin.qq.com/s/yZ-oeM8gvqaDLxbyHMq3cQ">安装Rust和WebAssembly工具链和helloworld</a></li>
<li><a href="https://web.archive.org/web/20220628021820/https://mp.weixin.qq.com/s/H-hXqMJ34rWgSGZU_WBBTA">Rust Assembly之实现康威生命游戏</a></li>
<li><a href="https://web.archive.org/web/20220628021845/https://mp.weixin.qq.com/s/RINEWLkLOXEAbzw_ZuZiyA">康威游戏之优化</a></li>
<li><a href="https://web.archive.org/web/20220628021902/https://mp.weixin.qq.com/s/Y_PL_rhLzdv4yXFNjrRNgw">Web Assembly之测试康威游戏代码</a></li>
<li><a href="https://web.archive.org/web/20220628021918/https://mp.weixin.qq.com/s/8GcasoM-K-T9EXY7LMuKnQ">Web Assembly之调试方法</a></li>
<li><a href="https://web.archive.org/web/20220628063042/https://mp.weixin.qq.com/s/3nn8on2ubRccgZxM8h2TJQ">Web Assembly康威游戏添加交互</a></li>
<li><a href="https://web.archive.org/web/20220628021938/https://mp.weixin.qq.com/s/t00GVCtN6iDKqlCi7zcA1A">Web Assembly之性能分析</a></li>
</ul>
<h3 id="关于康威游戏conways-game"><a class="header" href="#关于康威游戏conways-game">关于康威游戏(Conway’s Game)</a></h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Conway’s Game of Life - Wikipedia</a></li>
<li><a href="https://playgameoflife.com/">Play John Conway’s Game of Life</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/261431820">学术干货 | Conway’s Game of Life 生命游戏的建筑设计应用 - 知乎</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="音视频处理"><a class="header" href="#音视频处理">音视频处理</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="游戏与图像处理"><a class="header" href="#游戏与图像处理">游戏与图像处理</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="rust与其他编程语言"><a class="header" href="#rust与其他编程语言">Rust与其他编程语言</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="科学艺术研究"><a class="header" href="#科学艺术研究">科学艺术研究</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="其他工具"><a class="header" href="#其他工具">其他工具</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="安全参考"><a class="header" href="#安全参考">安全参考</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="商业观察"><a class="header" href="#商业观察">商业观察</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="区块链"><a class="header" href="#区块链">区块链</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%8C%BA%E5%9D%97%E9%93%BE">区块链</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#layers">Layers</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#osi%E7%BD%91%E7%BB%9C%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B">OSI网络七层模型</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E6%95%B0%E6%8D%AE%E5%B1%82">数据层</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E7%BD%91%E7%BB%9C%E5%B1%82">网络层</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%85%B1%E8%AF%86%E5%B1%82">共识层</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%B7%A5%E4%BD%9C%E9%87%8F%E8%AF%81%E6%98%8E%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6-pow-">工作量证明共识机制（ PoW ）</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E6%BF%80%E5%8A%B1%E5%B1%82">激励层</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%90%88%E7%BA%A6%E5%B1%82">合约层</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%BA%94%E7%94%A8%E5%B1%82">应用层</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#blockchains">Blockchains</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#blockchain-frameworks">Blockchain Frameworks</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#cross-chain">Cross-Chain</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#virtual-machines">Virtual Machines</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#general-purpose-consensus">General-Purpose Consensus</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#p2p-network-libraries">P2P Network Libraries</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#cryptography">Cryptography</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#layer2">Layer2</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#dapps">Dapps</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#other">Other</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/blockchain.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:46 UTC 2022 -->
<!--te-->
<h2 id="layers"><a class="header" href="#layers">Layers</a></h2>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/df67d027097043d3d1c8b180558bb3cc.png" alt="img" /></p>
<h3 id="osi网络七层模型"><a class="header" href="#osi网络七层模型">OSI网络七层模型</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/640.png" alt="图片" /></p>
<blockquote>
<p>下图详细说明了各层作用</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/640-20220621104210621.png" alt="图片" /></p>
<p>实际应用过程中，五层协议结构里面是没有表示层和会话层的。应该说它们和应用层合并了。</p>
<h3 id="数据层"><a class="header" href="#数据层">数据层</a></h3>
<p>区块链是通过区块（block）存储数据，每个数据节点之间都包含所有数据，即分布式账本。每个区块都包括了区块的大小、区块头、区块所包含的交易数量及部分或所有的近期新交易。</p>
<p>数据层主要是解决这些数据以什么样的形式组合在一起，形成一个有意义的区块。</p>
<p>区块链的数据结构中包括两种哈希指针，它们均是不可篡改特性的数据结构基础。</p>
<ol>
<li>
<p>一个是形成“区块+链”（block+chain）的链状数据结构</p>
</li>
<li>
<p>另一个是哈希指针形成的梅克尔树（如下图所示）。</p>
</li>
</ol>
<div id="admonition-用处" class="admonition tip">
<div class="admonition-title">
<p>用处</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/blockchain.html#admonition-用处"></a></p>
</div>
<div>
<p>链状数据结构使得对某一区块内的数据的修改很容易被发现；
梅克尔树的结构起类似作用，使得对其中的任何交易数据的修改很容易被发现。</p>
</div>
</div>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/9b432d8f0369921e21ac33f14c2bdeda.png" alt="img" /></p>
<h3 id="网络层"><a class="header" href="#网络层">网络层</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/b93a9b3345d59f5e13c0ec662a46f05a.png" alt="img" /></p>
<p>区块链使用的是去中心化的网络架构，没有中心化服务器，依靠用户点对点交换信息，主要包括 P2P 组网机制、数据传播和验证机制。</p>
<div id="admonition-p2p特性" class="admonition tip">
<div class="admonition-title">
<p>P2P特性</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/blockchain.html#admonition-p2p特性"></a></p>
</div>
<div>
<p>正是由于节点的 P2P 特性，数据传输是分散在各个节点之间进行的，部分节点或网络遭到破坏对其他部分影响很小。</p>
</div>
</div>
<p>节点指的是区块链客户端软件（比如比特币客户端、以太坊客户端），一般分为全节点和轻节点，全节点包含了所有区块链的区块数据，轻节点仅包括与自己相关的数据。</p>
<h3 id="共识层"><a class="header" href="#共识层">共识层</a></h3>
<p>共识层的功能是让高度分散的节点在 P2P 网络中，针对区块数据的有效性达成共识，决定了谁可以将新的区块添加到主链中（挖矿机制）。</p>
<h4 id="工作量证明共识机制-pow-"><a class="header" href="#工作量证明共识机制-pow-">工作量证明共识机制（ PoW ）</a></h4>
<div id="admonition-pow" class="admonition info">
<div class="admonition-title">
<p>PoW</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/blockchain.html#admonition-pow"></a></p>
</div>
<div>
<p>矿工需要将网络中未确认的交易按梅克尔树组装成候选区块，在候选区块的头部有一个 32位的随机数区域，矿工需要反复调整随机数并计算，目标是让整个区块的哈希值小于一个“目标值”，谁先完成这个目标谁就有权力将交易记录到区块链分布式账本中并获得一定的奖励。</p>
</div>
</div>
<p>挖矿的过程比拼的就是各个矿工节点的算力，可以变相认为谁的算力高谁的工作量就高，就有权力记账和获得奖励。</p>
<ul>
<li>比特币使用的是 PoW 机制；</li>
<li>以太坊开始使用的是 PoW 机制，后来改成了 PoS 机制，原因是该机制交易速度更快、资源消耗更低。</li>
</ul>
<p>这种挖矿计算是非对称的，挖矿可能需要经过许多次哈希计算，而要验证的确找到有效的随机数，只需要一次计算就可以，因此其他节点能够很快验证交易是否已经被记入账本。</p>
<h3 id="激励层"><a class="header" href="#激励层">激励层</a></h3>
<p>激励层的功能主要是提供一些激励措施，鼓励节点参与记账，保证整个网络的安全运行。通过共识机制胜出取得记账权的节点能获得一定的奖励。</p>
<p>目前比特币的激励措施是新区块产生时系统会奖励矿工一定的比特币（系统产生的新比特币，也会记录在分布式账本，来源地址是 0，因此整个过程叫挖矿），奖励最初是 50 个比特币，每四年减半一次，分别为 25 个、12.5
个，以此类推。当比特币数量达到 2100 万枚的上限后（2140 年），激励就全靠交易的手续费了。以太坊交易是靠 gas 手续费来激励矿工。</p>
<h3 id="合约层"><a class="header" href="#合约层">合约层</a></h3>
<p>合约层封装了各类脚本、算法和智能合约，使得区块链具有可编程能力。例如，<strong>比特币的脚本</strong>中就规定了比特币的交易方式和过程中的种种细节，不过这种脚本使用不够便捷且不是图灵完备的。</p>
<p>以太坊提出了智能合约的解决方案，提供了一种图灵完备的高级编程语言来编写智能合约，并使智能合约能够运行在分布式的以太坊虚拟机 EVM 上。</p>
<div id="admonition-智能合约" class="admonition tip">
<div class="admonition-title">
<p>智能合约</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/blockchain.html#admonition-智能合约"></a></p>
</div>
<div>
<p>智能合约就是存储在区块链上的一段代码，它们可以被区块链上的交易所触发，触发后，这段代码可以从区块链上读取数据或者向区块链上写入数据。</p>
</div>
</div>
<p>区块链系统（比特币、以太坊）可以认为是一个分布式状态机，通过交易触发合约（脚本、智能合约）运行来改变状态机的状态。</p>
<h3 id="应用层"><a class="header" href="#应用层">应用层</a></h3>
<p>应用层封装了区块链的各种应用场景，具体应用可参见<strong>90+ #Ethereum Apps You Can Use Right Now</strong>。</p>
<p>以下为一笔比特币转账交易的过程</p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/e6b83641ed6467b392d04a3e6fe69492.png" alt="img" /></p>
<h2 id="blockchains"><a class="header" href="#blockchains">Blockchains</a></h2>
<ul>
<li><a href="https://developer.aleo.org/aleo/getting_started/overview">Aleo</a>. Leo is a rust flavoured zk language.</li>
<li><a href="https://alephzero.org/">Aleph Zero</a>. DAG, PoS, snark smart contracts (substrate based).</li>
<li><a href="https://anoma.network/">Anoma.network</a>. PoS blockchain with privacy.</li>
<li><a href="https://github.com/be-cash/bitcoin-cash">Bitcoin Cash</a>. A library for creating and parsing Bitcoin Cash trasactions.</li>
<li><a href="https://github.com/cryptape/cita">CITA</a>. A high performance blockchain kernel for enterprise users.</li>
<li><a href="https://github.com/CodeChain-io/codechain">CodeChain</a>. Programmable multi-asset chain.</li>
<li><a href="https://concordium.com/">Concordium</a>. Privacy centric (zk) PoS chain, yet with built in identities and rust smart
contracts.</li>
<li><a href="https://github.com/Conflux-Chain/conflux-rust">Conflux</a>. The Rust implementation of Conflux protocol.</li>
<li><a href="https://github.com/darwinia-network/darwinia">Darwinia</a>. Relay chain of Darwinia Network, can connect to Polkadot as
parachain in Polkadot Model.</li>
<li><a href="https://dusk.network/">Dusk.network</a>. Privacy PoS using zk (plonk).</li>
<li><a href="https://github.com/enigmampc/enigma-core">Enigma</a> secures the decentralized web.</li>
<li><a href="https://elrond.com/">Elrond</a>. Elrond (EGOLD( - scalable and usable blockchain, written is Rust and has smart
contracts in Rust.</li>
<li><a href="https://github.com/exonum/exonum">Exonum</a>. An extensible open-source framework for creating private/permissioned
blockchain applications.</li>
<li><a href="https://github.com/ChainSafe/forest">Forest</a>. An implementation of Filecoin written in Rust.</li>
<li><a href="https://github.com/FuelLabs/fuel-core">Fuel</a>. Rust full node implementation of the Fuel v2 protocol.</li>
<li><a href="https://github.com/gear-tech/gear">Gear</a>. Computational component of Polkadot network.</li>
<li><a href="https://github.com/mimblewimble/grin">Grin</a>. Minimal implementation of the MimbleWimble protocol.</li>
<li><a href="https://github.com/holochain/holochain">Holochain</a>. The core Holochain framework written in rust, a container, and
hdk-rust library for writing Zomes.</li>
<li><a href="https://github.com/HuobiGroup/huobi-chain">Huobi Chain</a>. The next generation high performance public chain for
financial infrastructure.</li>
<li><a href="https://github.com/interledger-rs/interledger-rs">Interledger</a>. An easy-to-use, high-performance Interledger
implementation written in Rust.</li>
<li><a href="https://github.com/Internet-of-People/iop-rs">Internet of People</a>. Decentralized software stack that provides the
building blocks and tools to support a decentralized society.</li>
<li><a href="https://github.com/libra/libra">Libra</a>. Global currency and financial infrastructure that empowers billions of
people.</li>
<li><a href="https://github.com/sigp/lighthouse">Lighthouse</a>. Fast and secure Ethereum 2.0 client.</li>
<li><a href="https://github.com/nearprotocol/nearcore">NEAR</a>. NEAR Protocol - scalable and usable blockchain.</li>
<li><a href="https://github.com/nervosnetwork/ckb">Nervos CKB</a>. Nervos CKB is a public permissionless blockchain, the common
knowledge layer of Nervos network.</li>
<li><a href="https://github.com/nymtech/nym">NYM</a>. Selective privacy via a mixnet preventing metadata analysis.</li>
<li><a href="https://github.com/nomic-io/nomic">Nomic</a>. Nomic is a high-performance Bitcoin sidechain which is part of the Cosmos
network.</li>
<li><a href="https://github.com/ChainSafe/mina-rs">Mina Protocol</a>. A rust implementation of the mina succinct blockchain.</li>
<li><a href="https://mirprotocol.org/">Mir Protocol</a>. A succinct blockchain powered by zero-knowledge proofs. (plonk based)</li>
<li><a href="https://github.com/openethereum/openethereum">OpenEthereum</a>. The Ethereum Rust client</li>
<li><a href="https://github.com/paritytech/parity-bitcoin">Parity Bitcoin</a>. The Parity Bitcoin client.</li>
<li><a href="https://github.com/paritytech/parity-ethereum">Parity Ethereum</a>. The fast, light, and robust EVM and WASM client.</li>
<li><a href="https://github.com/paritytech/parity-zcash">Parity Zcash</a>. Rust implementation of Zcash protocol.</li>
<li><a href="https://github.com/paritytech/polkadot">Polkadot</a>. Polkadot Node Implementation.</li>
<li><a href="https://github.com/PolymathNetwork/Polymesh">Polymesh</a>. The Polymesh blockchain (built on Substrate) is an identity
orientated chain for the issuance, lifecycle management and settlement of regulated securities.</li>
<li><a href="https://github.com/QANplatform/its_alive">QAN</a>. Post-quantum blockchain.</li>
<li><a href="https://github.com/radixdlt/radixdlt-scrypto">Radix</a>. Sharded smart contract DeFi platform.</li>
<li><a href="https://github.com/Setheum-Labs/Setheum">Setheum</a>. SETHEUM : “Secure Evergreen Truthful Heterogeneous Economically
Unbiased Market” is an Ethical DeFi-friendly Blockchain (built on Substrate) working on achieving mass adoption,
security, scalability, affordability, inclusivity and ethical DeFi Governance.</li>
<li><a href="https://github.com/paritytech/shasper">Shasper</a>. Parity Shasper beacon chain implementation using the Substrate
framework.</li>
<li><a href="https://github.com/solana-labs/solana">Solana</a>. Blockchain Rebuilt for Scale.</li>
<li><a href="https://github.com/blockstack/stacks-blockchain">Stacks 2.0</a>. Proof of Transfer blockchain from Blockstack.</li>
<li><a href="https://github.com/tari-project">Tari</a>. The Tari Digital Assets Protocol.</li>
<li><a href="https://github.com/informalsystems/tendermint-rs">Tendermint</a>. Tendermint is a high-performance blockchain consensus
engine for Byzantine fault tolerant applications.</li>
<li><a href="https://github.com/witnet/witnet-rust">Witnet</a>. Open source implementation of Witnet decentralized oracle network
protocol in Rust.</li>
<li><a href="https://github.com/xx-labs/xxchain">xx-network</a>. Post-quantum blockchain, mixnet privacy preventing metadata
analysis. (Substrate rust+go)</li>
<li><a href="https://github.com/ZcashFoundation/zebra">Zebra</a>. An ongoing Rust implementation of a Zcash node.</li>
<li><a href="https://github.com/LayerXcom/zero-chain">Zero-chain</a>. A privacy-preserving blockchain on Substrate.</li>
</ul>
<h2 id="blockchain-frameworks"><a class="header" href="#blockchain-frameworks">Blockchain Frameworks</a></h2>
<ul>
<li><a href="https://github.com/paritytech/substrate">Substrate</a>. The platform for blockchain innovators.</li>
<li><a href="https://github.com/stellar/slingshot">slingshot</a>. A new blockchain architecture under active development, with a
strong focus on scalability, privacy and safety.</li>
<li><a href="https://github.com/tendermint/rust-abci">Tendermint ABCI</a>. Tendermint ABCI server, written in the Rust programming
language.</li>
<li><a href="https://github.com/nomic-io/orga">Orga</a>. A high-performance state machine engine designed for Tendermint-based
blockchain applications.</li>
</ul>
<h2 id="cross-chain"><a class="header" href="#cross-chain">Cross-Chain</a></h2>
<ul>
<li><a href="https://comit.network/">Comit</a> is an open protocol facilitating trustless cross-blockchain applications.</li>
<li><a href="https://github.com/informalsystems/ibc-rs">IBC</a>. Rust implementation of Cosmos’ Interblockchain Communication
Protocol
(IBC).</li>
</ul>
<h2 id="virtual-machines"><a class="header" href="#virtual-machines">Virtual Machines</a></h2>
<ul>
<li><a href="https://github.com/nervosnetwork/ckb-vm">CKB-VM</a>. RISC-V virtual machine.</li>
<li><a href="https://www.cosmwasm.com">CosmWasm</a>. Multi-chain smart contract platform built for the Cosmos ecosystem.</li>
<li><a href="https://github.com/paritytech/parity-ethereum/tree/master/evmbin">EVM Parity</a>. Parity implementation of EVM.</li>
<li><a href="https://github.com/FuelLabs/fuel-vm">FuelVM</a>
FuelVM interpreter in Rust.</li>
<li><a href="https://github.com/lunatic-solutions/lunatic">Lunatic</a>. Erlang-inspired runtime for WebAssembly.</li>
<li><a href="https://github.com/maticnetwork/miden">Polygon Miden</a>. SNARK based VM.</li>
<li><a href="https://github.com/spacemeshos/svm">SVM</a>
Spacemesh Virtual Machine.</li>
<li><a href="https://github.com/paritytech/wasmi">Wasmi</a>. WebAssembly interpreter.</li>
<li><a href="https://wasmer.io/">Wasmer</a>. A convenient Rust wrapper over WebAssembly backends.</li>
<li><a href="https://github.com/CraneStation/wasmtime">Wasmtime</a>. Standalone JIT-style runtime for WebAssembly, using Cranelift.</li>
<li><a href="https://github.com/matter-labs/zinc">Zinc</a>. Zinc zk smart contract language.</li>
</ul>
<h2 id="general-purpose-consensus"><a class="header" href="#general-purpose-consensus">General-Purpose Consensus</a></h2>
<ul>
<li><a href="https://github.com/pingcap/raft-rs">Raft</a>. Raft distributed consensus algorithm implemented in Rust.</li>
<li><a href="https://github.com/poanetwork/hbbft">Honey Badger</a>. An implementation of the paper “Honey Badger of BFT Protocols” in
Rust.</li>
<li><a href="https://github.com/MystenLabs/narwhal">Narwhal</a>. The consensus layer used by Sui.</li>
</ul>
<h2 id="p2p-network-libraries"><a class="header" href="#p2p-network-libraries">P2P Network Libraries</a></h2>
<ul>
<li><a href="https://github.com/placefortea/chamomile">chamomile</a>. P2P library. Support build robust stable connection on
p2p/distributed network.</li>
<li><a href="https://github.com/maidsafe/crust">crust</a>. Reliable P2P network connections in Rust with NAT traversal. One of the
most needed libraries for any server-less / decentralised projects.</li>
<li><a href="https://github.com/libp2p/rust-libp2p">rust-libp2p</a>. The Rust Implementation of the libp2p networking stack.</li>
<li><a href="https://github.com/driftluo/tentacle">Tentacle</a>. A multiplexed p2p network framework that supports custom protocols</li>
<li><a href="https://github.com/ustulation/p2p">P2P NAT-Traversal</a>. NAT Traversal techniques for p2p communication.</li>
<li><a href="https://github.com/maidsafe/qp2p">qp2p</a>. Peer-to-peer communications library for Rust based on QUIC protocol.</li>
<li><a href="https://github.com/maidsafe/sn_routing">sn_routing</a>. Routing - specialised storage DHT.</li>
</ul>
<h2 id="cryptography"><a class="header" href="#cryptography">Cryptography</a></h2>
<ul>
<li><a href="https://github.com/rust-cc/awesome-cryptography-rust">Awesome Cryptography Rust</a>.</li>
<li><a href="https://github.com/dalek-cryptography">Dalek Cryptography</a>.</li>
<li><a href="https://github.com/adria0/za">Za!</a>. An experimental rust zksnarks compiler with embeeded bellman-bn128 prover.</li>
<li><a href="https://github.com/0xProject/OpenZKP">OpenZKP</a>. Pure Rust implementations of Zero-Knowledge Proof systems.</li>
<li><a href="https://github.com/microsoft/Nova">Microsoft Nova</a>. Rust recursive snark without trusted setup.</li>
<li><a href="https://github.com/arkworks-rs">Arkworks</a>. An ecosystem for developing and programming with zkSNARKs</li>
</ul>
<h2 id="layer2"><a class="header" href="#layer2">Layer2</a></h2>
<ul>
<li><a href="https://github.com/OffchainLabs/arb-os">Arbitrum’s arb-os</a>
ArbOS is the “operating system” that runs an eth Layer 2 on an Arbitrum chain,</li>
<li><a href="https://github.com/noir-lang/noir">Noir language</a>. Noir is a Domain Specific Language for SNARK proving systems. (
Aztec eth L2)</li>
<li><a href="https://penumbra.zone/">Penumbra</a>. PoS network providing privacy to the Cosmos ecosystem.</li>
<li><a href="https://github.com/rust-bitcoin/rust-lightning">Rust-Lightning</a>
is a Bitcoin Lightning library written in Rust. The main crate, lightning, does not handle networking, persistence, or
any other I/O. Thus, it is runtime-agnostic, but users must implement basic networking logic, chain interactions, and
disk storage.</li>
<li><a href="https://github.com/matter-labs/zksync">zkSync</a>. Matter Labs’ scaling eth L2 engine secured by zero-knowledge proofs.</li>
</ul>
<h2 id="dapps"><a class="header" href="#dapps">Dapps</a></h2>
<ul>
<li><a href="https://github.com/project-serum/serum-dex">Serum-dex</a>. A decentralized exchange built on Solana.</li>
<li><a href="https://github.com/second-state/SewUp">SewUp</a>. A library to help you build your Ethereum webassembly contract with
Rust and just like develop in a common backend.</li>
</ul>
<h2 id="other"><a class="header" href="#other">Other</a></h2>
<ul>
<li><a href="https://github.com/iqlusioninc/abscissa">abscissa</a>. Micro-framework for CLI tools with strong focus on security.</li>
<li><a href="https://github.com/adria0/tesseracts">tesseracts</a>. A small block explorer for geth PoAs written in rust.</li>
<li><a href="https://github.com/nomic-io/merk">merk</a>. High performance Merkle key/value store written in Rust, based on RocksDB.</li>
</ul>
<h2 id="参考资源-41"><a class="header" href="#参考资源-41">参考资源</a></h2>
<h3 id="online-book-37"><a class="header" href="#online-book-37">online-book</a></h3>
<h3 id="fragment-37"><a class="header" href="#fragment-37">fragment</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220620094224/https://jishuin.proginn.com/p/763bfbd79e0a">Web3.0开发入门-技术圈</a></li>
<li><a href="https://github.com/rust-in-blockchain/awesome-blockchain-rust">rust-in-blockchain/awesome-blockchain-rust: Collect libraries and packages about blockchain/cryptography in Rust</a></li>
<li><a href="https://mp.weixin.qq.com/s/jeoJeL7P7Q4J2vrIKVB5ZA">有了HTTP，为什么还要RPC？</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain//layer5_ecosystem/7_business/blockchain/build-a-block-in-rust.html">使用rust建立一个简单的区块链</a></li>
</ul>
<h3 id="local-37"><a class="header" href="#local-37">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="使用rust建立一个简单的区块链"><a class="header" href="#使用rust建立一个简单的区块链">使用rust建立一个简单的区块链</a></h1>
<h2 id="参考资源-42"><a class="header" href="#参考资源-42">参考资源</a></h2>
<h3 id="online-book-38"><a class="header" href="#online-book-38">online-book</a></h3>
<h3 id="fragment-38"><a class="header" href="#fragment-38">fragment</a></h3>
<ul>
<li><a href="https://blog.logrocket.com/how-to-build-a-blockchain-in-rust/">How to build a blockchain in Rust - LogRocket Blog</a></li>
</ul>
<h3 id="local-38"><a class="header" href="#local-38">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate介绍与源码解读-1"><a class="header" href="#substrate介绍与源码解读-1">Substrate介绍与源码解读</a></h1>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/what_is_substrate.png" alt="what_is_substrate" /></p>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB">Substrate介绍与源码解读</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#gavin-wookpolkadot-and-substrate">Gavin Wook、Polkadot and Substrate</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#gavin-wook%E4%B8%8E%E6%B3%A2%E5%8D%A1%E8%B7%A8%E9%93%BE">Gavin Wook与波卡跨链</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%BB%8E%E6%B3%A2%E5%8D%A1%E5%88%B0substrate">从波卡到Substrate</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E8%B7%A8%E9%93%BE%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7">跨链的重要性</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%80%BB%E4%BD%93%E8%AE%BE%E8%AE%A1">总体设计</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%B8%B8%E8%A7%81%E5%8C%BA%E5%9D%97%E9%93%BE%E8%AE%BE%E8%AE%A1">常见区块链设计</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8C%BA%E5%9D%97%E9%93%BE%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86">区块链系统基础部分</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%93%BE%E7%9A%84%E5%8A%9F%E8%83%BD">链的功能</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%90%86%E5%BF%B5">Substrate理念</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%88%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8B%E4%BB%80%E4%B9%88%E6%98%AF%E5%8C%BA%E5%9D%97%E9%93%BE%E6%A1%86%E6%9E%B6">先认识一下：什么是区块链框架</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%8E%A5%E7%9D%80%E8%AF%B4%E8%AF%B4substrate%E4%B8%8Eweb3">接着说说Substrate与web3</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%94%A8web%E6%A1%86%E6%9E%B6%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E7%B1%BB%E6%AF%94">用web框架、游戏引擎类比</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-architecture">Substrate Architecture</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%BC%80%E5%8F%91%E8%80%85%E5%8F%AA%E9%9C%80%E8%A6%81%E5%85%B3%E6%B3%A8runtime%E9%93%BE%E5%8A%9F%E8%83%BD">开发者只需要关注Runtime(链功能)</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%98%8E%E6%99%B0runtime">明晰Runtime</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%88%A4%E6%96%AD%E6%A0%87%E5%87%86">判断标准</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%9A%84runtime">Substrate的Runtime</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%B8%AD%E5%BF%83%E5%8C%96%E5%8D%87%E7%BA%A7%E6%B5%81%E7%A8%8B">中心化升级流程</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%97%A0%E5%A4%AE%E5%8C%96%E5%8D%87%E7%BA%A7%E6%B5%81%E7%A8%8B%E5%8E%9F%E5%85%88">无央化升级流程(原先)</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E7%9A%84%E4%B8%8D%E5%90%8C">Substrate的不同</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%90%88%E7%BA%A6%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5">以太坊合约更新策略</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate%E5%AF%B9%E5%BA%94%E5%90%88%E7%BA%A6%E6%9B%B4%E6%96%B0%E7%AD%96%E7%95%A5">Substrate对应‘合约更新策略’</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">项目结构</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9E%B6%E6%9E%84">客户端架构</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%9E%B6%E6%9E%84%E5%9B%BE">架构图</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E">模块说明</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%AD%98%E5%82%A8">存储</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#runtime">Runtime</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#p2p%E7%BD%91%E7%BB%9C">p2p网络</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%B1%E8%AF%86">共识</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#rpc">RPC</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#telemetry-%E9%81%A5%E6%B5%8B">telemetry （遥测）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#tree-level1">Tree Level1</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%94%A8cargo%E7%BB%84%E7%BB%87%E4%BB%A3%E7%A0%81">用Cargo组织代码</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E4%B8%BB%E8%A6%81%E9%83%A8%E5%88%86%E4%BB%8B%E7%BB%8Dnodeframecore">主要部分介绍：Node、Frame、Core</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-node">Substrate Node:</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E9%87%8D%E7%82%B9%E8%AF%B4%E8%AF%B4nodepallets%E5%92%8Cruntime">重点说说node、pallets和runtime</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-frame">Substrate FRAME</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#substrate-coreclient">Substrate Core(client)</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%85%B6%E4%BB%96">其他</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#primitives">primitives</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#scriptsci">scripts/ci</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#utils">utils</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8A%9F%E8%83%BD%E9%80%BB%E8%BE%91">功能逻辑</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E7%89%B9%E8%89%B2%E4%BB%A3%E7%A0%81">特色代码</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#runtime-1">Runtime</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:47 UTC 2022 -->
<!--te-->
<h2 id="gavin-wookpolkadot-and-substrate-1"><a class="header" href="#gavin-wookpolkadot-and-substrate-1">Gavin Wook、Polkadot and Substrate</a></h2>
<h3 id="gavin-wook与波卡跨链-1"><a class="header" href="#gavin-wook与波卡跨链-1">Gavin Wook与波卡跨链</a></h3>
<p>所以对于开发人员来说，比起大家耳熟能详的v神(Vitalik Buterin)，更重要的人是实际上撑起整个以太坊世界的灵魂人物<strong>Gavin Wood</strong>。更何况很多山寨币实际上就是在以太坊的模型上修修改改，所以在我看来Gavin
Wood是撑起了当前半个区块链世界的人。</p>
<p>而Gavin Wood 离开了以太坊之后，开启的一个新项目叫做Polkadot(波卡)，这个项目的<strong>目的就是跨链，为了把各个割裂的区块链孤岛能够联系一起</strong>
。虽然目前有很多的项目都号称自己在做跨链，但是目前在我看来唯一在推进，逻辑上是可推理，之后可能成功的跨链项目就只有波卡能够成功。（后半段可能存在一定误导性，Polkadot的跨链可能在大部分人理解下应该是分片的变种，也就是基于Substrate开发的区块链可以部署到Polkadot上，经过Polkadot平台互相沟通）。</p>
<h3 id="从波卡到substrate-1"><a class="header" href="#从波卡到substrate-1">从波卡到Substrate</a></h3>
<p>而Gavin Wood 在开发的波卡的过程中，经过不断地思考，认为其实区块链发展这几年，大家做的很多事情都是相同的。</p>
<div id="admonition-抽离共同点开始造轮子" class="admonition abstract">
<div class="admonition-title">
<p>抽离共同点，开始造“轮子“</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-抽离共同点开始造轮子"></a></p>
</div>
<div>
<p>那么在以往的软件开发中，当大家发现大家都在做相同的事情的时候，就会将这件事情进行抽象，然后造“轮子”，将这些高层次的东西做封装，成为“开发框架”，将背后复杂的基础设施都封装起来，而使用这个“框架”的开发人员，就可以更加专注于自己的业务逻辑，而不必花费大量的精力去造“轮子”去完成那些每个链都要做的事情。</p>
</div>
</div>
<p>Gavin Wood 在开发波卡的中途先暂停了波卡的开发，将波卡及以太坊已有的成果进行抽象，命名为substrate作为区块链开发的基础框架，并把全部精力都转移到了substrate开发中。</p>
<div id="admonition-第一个轮子" class="admonition tip">
<div class="admonition-title">
<p>第一个轮子</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-第一个轮子"></a></p>
</div>
<div>
<p>所以“substrate”就是区块链世界的第一个“轮子”。</p>
</div>
</div>
<h3 id="跨链的重要性-1"><a class="header" href="#跨链的重要性-1">跨链的重要性</a></h3>
<p>另一方面，在软件开发领域或者互联网领域，大家其实都发现了占据了框架的地位实际上一定程度上占据了这个领域开发的生态，更何况对于跨链来说，当大家的链都比较同质化后，跨链会更加的方便。现在大家都把跨链当作区块链下一个引爆点，而跨链的属性界定了做“跨链”的人基本上只能一家独大，成为垄断地位。而接入跨链的链越多，这个跨链就越垄断(
因为大家使用跨链就是为了在不同的链之间兑换代币，能换的代币越多，使用这个跨链的人就越多，生态就越集中)，</p>
<p>而Gavin Wood 提供的substrate框架又<strong>能解决大部分链都在重复解决的问题</strong>，所以大家就更倾向于使用substrate开发自己的链。</p>
<div id="admonition-三角关系" class="admonition quote">
<div class="admonition-title">
<p>三角关系</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-三角关系"></a></p>
</div>
<div>
<p>这样就会在“用户-链-跨链”这个三角关系中将三方的利益绑定在一起，互惠互利，共同进步。</p>
</div>
</div>
<h2 id="总体设计-1"><a class="header" href="#总体设计-1">总体设计</a></h2>
<h3 id="常见区块链设计-1"><a class="header" href="#常见区块链设计-1">常见区块链设计</a></h3>
<p>目前所有的区块链系统几乎都是从比特币/以太坊模型演变而来。一般来说，一个区块链系统应该具有：</p>
<h4 id="区块链系统基础部分-1"><a class="header" href="#区块链系统基础部分-1">区块链系统基础部分</a></h4>
<ul>
<li>共识系统 （区块链分布式基石）</li>
<li>p2p连接与广播系统</li>
<li>存储系统</li>
<li>交易池系统</li>
<li>rpc系统（区块链与外界交互主要通道）</li>
</ul>
<div id="admonition-基础通用" class="admonition info">
<div class="admonition-title">
<p>基础通用</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-基础通用"></a></p>
</div>
<div>
<p>基础部分是当前区块链模型下都会具备的组件，其中共识与P2P体现区块链的分布式本质</p>
</div>
</div>
<h4 id="链的功能-1"><a class="header" href="#链的功能-1">链的功能</a></h4>
<div id="admonition-竞争关键" class="admonition info">
<div class="admonition-title">
<p>竞争关键</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-竞争关键"></a></p>
</div>
<div>
<p>链功能是区块链间相互竞争的关键部分. 与系统基础部分相比，这部分差异很大，提供的是除去区块链模型外，这条链能够提供的功能。另一方面在区块链升级中，一般来说系统基础部分改动较小，而链的功能部分改动较大，特别是许多链为了追求开发速度，一开始只能提供转账功能，在后续的版本中才慢慢升级其他功能</p>
</div>
</div>
<p>例如：</p>
<ul>
<li>比特币的UTXO结构加上交易脚本</li>
<li>以太坊的虚拟机与智能合约</li>
<li>eos的账户系统及虚拟机</li>
<li>有的山寨币特化部分智能合约或部分native层成为系统级功能：
<ul>
<li>提供随机数</li>
<li>提供质押对赌</li>
<li>oracle数据输入</li>
<li>引入复杂密码学方案</li>
<li>等等。。。</li>
</ul>
</li>
</ul>
<h4 id="substrate理念-1"><a class="header" href="#substrate理念-1">Substrate理念</a></h4>
<div id="admonition-分离变与不变" class="admonition tip">
<div class="admonition-title">
<p>分离变与不变</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-分离变与不变"></a></p>
</div>
<div>
<p>Substrate作为一个区块链框架，认为所有的链都应该具备区块链系统基础部分，而由开发者自由定制链的功能部分</p>
</div>
</div>
<h3 id="先认识一下什么是区块链框架-1"><a class="header" href="#先认识一下什么是区块链框架-1">先认识一下：什么是区块链框架</a></h3>
<p>简单来说，或者从本质上讲，区块链框架是一个（巨大的）工具和库的集合，用于构建一个完整的、可运行的、安全的、功能完整的（尽管是基本的）区块链。</p>
<p>区块链框架负责处理以下方面的大部分繁重工作：</p>
<ul>
<li>共识P2P网络</li>
<li>帐户管理</li>
<li>基本的区块链逻辑（区块、交易等）</li>
<li>区块链交互的客户端</li>
</ul>
<h3 id="接着说说substrate与web3-1"><a class="header" href="#接着说说substrate与web3-1">接着说说Substrate与web3</a></h3>
<p>Substrate 可以被描述为一个区块链框架——具体来说，一个用于构建定制区块链的框架。这些区块链可以完全自主运行，这意味着它们不依赖任何外部技术来运行。</p>
<p>然而，Substrate 背后的公司 Parity（由以太坊联合创始人 Gavin Wood 共同创立）也建立了 Polkadot 网络。 Polkadot 本质上是一个分散的、基于协议的区块链平台，用于实现安全的跨区块链通信。</p>
<div id="admonition-波卡本身就是跨链桥梁" class="admonition tip">
<div class="admonition-title">
<p>波卡本身就是跨链桥梁</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-波卡本身就是跨链桥梁"></a></p>
</div>
<div>
<p>这意味着 Polkadot可以用作区块链之间的一种桥梁，负责链之间的通信层，并使不同区块链（甚至是以太坊和比特币等系统）之间的交互成为可能。</p>
</div>
</div>
<div id="admonition-web3愿景" class="admonition quote">
<div class="admonition-title">
<p>web3愿景</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-web3愿景"></a></p>
</div>
<div>
<p>这代表着在实现 Web3 的愿景（一个分散的、基于区块链的互联网版本）方面取得了重大进展。</p>
</div>
</div>
<p>由于它们是由同一个人开发的，因此 Substrate 对与Polkadot的集成具有一流的支持，因此您使用Substrate创建的任何区块链都可以无缝连接到 Polkadot。</p>
<p>Substrate 还提供无分叉运行时升级——在不触发硬分叉的情况下升级区块链状态转换功能的能力。</p>
<div id="admonition-文档教程" class="admonition info">
<div class="admonition-title">
<p>文档教程</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-文档教程"></a></p>
</div>
<div>
<p>当然，由于提供了大量的代码，Substrate 附带了大量的文档和教程来帮助您入门。</p>
</div>
</div>
<h3 id="用web框架游戏引擎类比-1"><a class="header" href="#用web框架游戏引擎类比-1">用web框架、游戏引擎类比</a></h3>
<div id="admonition-sustrate与web框架大有不同" class="admonition warning">
<div class="admonition-title">
<p>Sustrate与web框架大有不同</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-sustrate与web框架大有不同"></a></p>
</div>
<div>
<p>如果你以前使用过一个广泛的 Web 框架，那么区块链框架就是——根本不是这样的。范围、活动部件的数量、相关概念和扩展点只是处于不同的规模。</p>
</div>
</div>
<blockquote>
<p>一个更好的比较可能是一个成熟的游戏引擎（想想 Unity），它为你需要的一切功能提供基本实现，以及可能需要的许多扩展点，供自定义。</p>
</blockquote>
<p>当然，这意味着已经在架构方面做出了一些决定：你将无法轻易更改。</p>
<p>根据你的用例，可能需要更多的可定制性，而框架可能会以某种方式对其进行限制。</p>
<p>这是标准的权衡：区块链框架可以节省你的时间，但代价是你不得不忍受的一些事情。</p>
<p>然而，正如我们将在下面更详细地探讨的那样，Substrate在这方面提供了一些灵活性。</p>
<p>使您能够在多个阶段在更多的技术自由和易于开发之间进行选择。</p>
<p>Substrate的后端是用 Rust 构建的。它（以及 Parity 通常所做的大部分工作）也是完全开源的。</p>
<blockquote>
<p>因此，您不仅可以使用 Substrate，还可以通过回馈和分叉其中的一部分来改进它，以根据您自己的需求进行定制。</p>
</blockquote>
<h3 id="substrate-architecture-1"><a class="header" href="#substrate-architecture-1">Substrate Architecture</a></h3>
<p>Gavin Wood 作为以太坊实际核心的开发者，自然早已对这套系统的框架了然于心，所以从Substrate框架提出的开始（2018年9月），就对区块链系统作出了2个关键的区分：</p>
<div id="admonition-coreruntime" class="admonition info">
<div class="admonition-title">
<p>Core&amp;Runtime</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-coreruntime"></a></p>
</div>
<div>
<p>Substrate Core: 系统基础部分
Runtime：链功能</p>
</div>
</div>
<div id="admonition-substrte-architecture" class="admonition tip">
<div class="admonition-title">
<p>Substrte Architecture</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrte-architecture"></a></p>
</div>
<div>
<pre><code class="language-text">┌───────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                       │
│                                                                                                       │
│      ┌─────────────────┐     ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│      │ fund management │     │     Account     │    │    Contract     │    │   Democratic    │        │
│      │    transfer     │     │     system      │    │       VM        │    │   referendum    │        │
│      └─────────────────┘     └─────────────────┘    └─────────────────┘    └─────────────────┘        │
│                                                                                                       │
│                                                  ######  #     # #     # ####### ### #     # #######  │
│      ┌─────────────────┐     ┌─────────────────┐ #     # #     # ##    #    #     #  ##   ## #        │
│      │     Equity      │     │      etc.       │ #     # #     # # #   #    #     #  # # # # #        │
│      │   calculation   │     │                 │ ######  #     # #  #  #    #     #  #  #  # #####    │
│      └─────────────────┘     └─────────────────┘ #   #   #     # #   # #    #     #  #     # #        │
│                                                  #    #  #     # #    ##    #     #  #     # #        │
│                                                  #     #  #####  #     #    #    ### #     # #######  │
├───────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                       │
│      ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐    ┌─────────────────┐       │
│      │    Consensus    │     │ Network system  │     │     Trading     │    │                 │       │
│      │    mechanism    │     │      (p2p)      │     │      Pool       │    │       RPC       │       │
│      └─────────────────┘     └─────────────────┘     └─────────────────┘    │                 │       │
│                                                                             └─────────────────┘       │
│                                                             #####  ####### ######  #######            │
│      ┌─────────────────┐                                   #     # #     # #     # #                  │
│      │      etc.       │                                   #       #     # #     # #                  │
│      │                 │                                   #       #     # ######  #####              │
│      └─────────────────┘                                   #       #     # #   #   #                  │
│                                                            #     # #     # #    #  #                  │
│                                                             #####  ####### #     # #######            │
│                                                                                                       │
└───────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<h3 id="开发者只需要关注runtime链功能-1"><a class="header" href="#开发者只需要关注runtime链功能-1">开发者只需要关注Runtime(链功能)</a></h3>
<p>根据这样的划分，当开发者使用Substrate框架的时候，无需关心区块链基础功能也就是Core部分的工作，而只需关心自己链能够提供的功能，也就是Runtime部分的工作。</p>
<div id="admonition-vm类似以太坊的智能合约" class="admonition tip">
<div class="admonition-title">
<p>VM类似以太坊的智能合约</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-vm类似以太坊的智能合约"></a></p>
</div>
<div>
<p>注意图中虚拟机EVM也是Runtime的一个组件。与以太坊的结构相比，相当于把以太坊的智能合约功能也能随意作为一个链的功能组件添加进入使用Substrate开发的链中</p>
</div>
</div>
<h3 id="明晰runtime-1"><a class="header" href="#明晰runtime-1">明晰Runtime</a></h3>
<p>这里一直强调Runtime是“链的功能”有一些通俗与不严谨，这里使用一个更抽象的描述：</p>
<div id="admonition-runtime明确" class="admonition danger">
<div class="admonition-title">
<p>Runtime明确</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-runtime明确"></a></p>
</div>
<div>
<p>需要对运行结果进行共识的功能部分应该归属于Runtime</p>
</div>
</div>
<p>这个定义比较抽象，且由于需要对“世界状态”或类似概念有比较深入的了解才好解释，故不展开讲解。更严格来说，“需要对运行结果进行共识的功能组件”是“链的功能”的一个子集。</p>
<h4 id="判断标准-1"><a class="header" href="#判断标准-1">判断标准</a></h4>
<div id="admonition-判断标准" class="admonition tip">
<div class="admonition-title">
<p>判断标准</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-判断标准"></a></p>
</div>
<div>
<p>这里有一个简单的判定标准判断某个功能是否应该放在Runtime内：</p>
<p>对于某个功能，若只改动一个节点的代码对于所有的逻辑运行的结果与其他不改动的节点运行的结果相同，则认为这个部分应该放在Runtime之外，如果运行结果不同，则认为应该放在Runtime之内。</p>
</div>
</div>
<div id="admonition-举例" class="admonition example">
<div class="admonition-title">
<p>举例</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-举例"></a></p>
</div>
<div>
<p>举个例子：比如我改变了交易池的排序代码，使得对某个账户有利的交易能优先打包。这个改动会令自己这个节点产出的区块不公平的打包交易，但是只要打包出来的区块大家都可以认可，则所有节点共识的“状态的变化”仍然是一致的。很明显，这个功能组件不应该是Runtime的功能，因为它不会改变对于验证一个区块时的“状态变化”的验证。比如我改变了转账功能的代码，能给某个账户凭空增加钱，那么显然，这种改动对于这个改动过的节点执行的结果将会与其他节点不同，则共识不会通过。所以转账这个功能就应该放在Runtime当中，让所有节点执行的都是一致的。</p>
</div>
</div>
<p>这部分结合native与wasm后会容易理解</p>
<p>所以到底什么是Runtime，我认为使用“链上功能”来描述最为恰当，因为其隐含了对于执行结果的共识问题。</p>
<h3 id="substrate的runtime-1"><a class="header" href="#substrate的runtime-1">Substrate的Runtime</a></h3>
<p>Substrate的Runtime当然没有止步于仅将区块链系统做了模块化划分，提供框架功能这一步，事实上，由于抽象出了Runtime，Substrate实现了以往所有区块链都无法实现的一个功能：区块链系统升级。</p>
<h4 id="中心化升级流程-1"><a class="header" href="#中心化升级流程-1">中心化升级流程</a></h4>
<div id="admonition-centralized-system-upgrading" class="admonition tip">
<div class="admonition-title">
<p>Centralized System Upgrading</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-centralized-system-upgrading"></a></p>
</div>
<div>
<pre><code class="language-text">┌────────────────────────────────Centralized System Upgrading(Internet App)────────────────────────────────┐
│                                                                                                          │
│                                                                                                          │
│                         ┌───────────────────┐      ┌─────────────┐    ┌─────────────┐    ┌─────────────┐ │
│                     ┌──▶│    Update Code    │      │   Deploy    │    │   Upgrade   │    │ Centralized │ │
│     .─────────.     │   │(Backend/Frontend)─┼──────▶   Server    │───▶│  Sucessful  │────▶Upgrade Easy │ │
│    ╱           ╲    │   └───────────────────┘      └─────────────┘    └─────────────┘    └─────────────┘ │
│   ( Bug/Upgrade )───┤                                                 ┌─────────────┐                    │
│    `.         ,'    │                                                 │  Somebody   │                    │
│      `───────'      │                                              ┌─▶│   Upgrade   ├─┐                  │
│                     │   ┌───────────────────┐      ┌─────────────┐ │  └─────────────┘ │  ┌─────────────┐ │
│                     └──▶│    Update Code    │      │   Publish   │ │                  │  │ Fragmented  │ │
│                         │       (App)      ─┼──────▶  App Store  │─┤  ┌─────────────┐ ├─▶│   version   │ │
│                         └───────────────────┘      └─────────────┘ │  │  Somebody   │ │  └─────────────┘ │
│                                                                    └─▶│   Reject    │─┘                  │
│                                                                       └─────────────┘                    │
│                                                                                                          │
│                                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<p>对于中心化的互联网系统而言，由于代码与数据的控制权在自己手上，所以可以随时进行版本的升级与修改。但是即便如此，也只有网页H5，后台代码可以做到随时升级，在移动互联网中，app还是需要用户自行更新。其中android生态尤为突出，apk版本的碎片化一度是困扰开发者的难题。为了应对app应用的碎片化，推出了许多功能各异的框架能够用户在不更新app的情况下进行“热更新”，一度成为技术的热门追捧。这些热更新的框架本质上都是允许从后台下载一段更新代码，通过各种方式加载运行新的代码来完成。一般情况下通过这种热更新提供的功能都会带来一定的性能损耗以运行最新的热更新代码。但是即便是热更新，更新代码的控制权也同样处于中心化组织的手中。</p>
<h4 id="无央化升级流程原先-1"><a class="header" href="#无央化升级流程原先-1">无央化升级流程(原先)</a></h4>
<div id="admonition-decentralized-system-upgradingpre" class="admonition tip">
<div class="admonition-title">
<p>Decentralized System Upgrading(pre)</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-decentralized-system-upgradingpre"></a></p>
</div>
<div>
<pre><code class="language-text">┌───────────────────────────────────Decentralized System Upgrading(Blockchain Dapp)────────────────────────────────────┐
│                                                                                                 ┌─────────────┐      │
│                                                                                                 │   Upgrade   │      │
│                                                                                  ┌───Yes───────▶│  Sucessful  │      │
│                                                                                  │              └─────────────┘      │
│                                                                                  Λ                                   │
│                                                                                 ╱ ╲                                  │
│                                                                                ╱   ╲                                 │
│                                                                               ╱     ╲                                │
│                                                          ┌────────┐          ╱       ╲                               │
│                                                          │ Deploy │      Most deployments                            │
│                                              ┌──Support─▶│  Node  │─────▶(Under Byzantine                            │
│                                              │           └────────┘      Fault Tolerance)                            │
│                                              │                               ╲       ╱                               │
│                                              Λ                                ╲     ╱                                │
│                                             ╱ ╲                                ╲   ╱                                 │
│                                            ╱   ╲                                ╲ ╱                                  │
│                                           ╱     ╲                                V              ┌──────────────────┐ │
│     .─────────.      ┌─────────────┐     ╱       ╲                               │              │   Upgrade Fail   │ │
│    ╱           ╲     │ Update Node │    ╱ Running ╲                              └───No────────▶│(Cause Fragmented)│ │
│   ( Bug/Upgrade ─────▶    Code     ├────▶  Node    ▏                                            └──────────────────┘ │
│    `.         ,'     └─────────────┘    ╲ (Minner ╱                                                       ▲          │
│      `───────'                           ╲       ╱                                                        │          │
│                                           ╲     ╱                                                         │          │
│                                            ╲   ╱                                                          │          │
│     .─────────.                             ╲ ╱                                                           │          │
│  ,─'           '─.                           V                                                            │          │
│ ;    Community    :                          │           ┌────────┐                                       │          │
│ :    proposal     ;                          │           │ Reject │                                       │          │
│  ╲   (BIP/EIP)   ╱                           └───Reject─▶│ Deploy │───────────────────────────────────────┘          │
│   '─.         ,─'                                        └────────┘                                                  │
│      `───────'                                                                                                       │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre>
</div>
</div>
<p>区块链领域就大大不同了。 即便代码更新的权力在某个组织的手上，但是运行这些代码的人可不一定会听这个组织的指挥，无法容易的命令分散节点统一的进行新代码的部署更新。</p>
<div id="admonition-分布式自治的优缺点" class="admonition tip">
<div class="admonition-title">
<p>分布式自治的优缺点</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-分布式自治的优缺点"></a></p>
</div>
<div>
<p>这是区块链带来的分布式自治的优点，同时也是一个巨大的缺点。</p>
</div>
</div>
<p>比特币社区就是这个领域下的一个典型，由于比特币社区的分裂，部分人并不认同不更改区块大小而是采用隔离见证的方案，分裂出了BCH，对BTC的生态产生的极大的损害。ETH的升级同样也困难重重，每次升级都需要进行长时间的等待以防有节点未升级而产生的分叉。</p>
<p>EOS由于其中心化的特点使得升级稍微简单一些，但仍然出现了由于升级带来的分叉的恶性事件。我们可以形象把区块链下的系统升级称为“全球升级”，因为其要求分布式环境下的大部分节点都更新了代码才使得升级能够成功。相较于中心化控制的系统，区块链系统的升级困难重重且充满风险。</p>
<div id="admonition-高度判断" class="admonition tip">
<div class="admonition-title">
<p>高度判断</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-高度判断"></a></p>
</div>
<div>
<p>同时区块链的升级还有另一个问题：高度判断</p>
<p>一个区块链系统升级后，不得不在代码中加入许多的“高度判断”，以区分不同高度下运行的代码，保证同步能够正常执行，兼容老数据。这种做法很原始但是又无法绕开，给开发者带来极大的思维负担，且需要大量的测试来保证不出现Bug。</p>
</div>
</div>
<p>比如目前比特币的源码中就有许多的区块高度判定使得在同步老区块的时候执行老代码，新区块的时候执行新代码。而中心化系统的数据控制权在自己手上，并且也不存在需要从某个数据源同步的情况，所以完全不需要担心这个问题。</p>
<h4 id="substrate的不同-1"><a class="header" href="#substrate的不同-1">Substrate的不同</a></h4>
<p>Substrate横空而出，推出了目前区块链领域最完美的升级方案。其采用“链上代码”的思想，将整个Runtime都做成了可直接更新的组件，让所有节点能够强制运行最新的Runtime代码。</p>
<div id="admonition-substrate-runtime" class="admonition info">
<div class="admonition-title">
<p>Substrate Runtime</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrate-runtime"></a></p>
</div>
<div>
<p>简单来说，Runtime在Substrate框架下，将会用同一份代码编译出两份可执行文件：</p>
<ol>
<li>一份Rust的本地代码，我们一般称为native代码，native与其他代码无异，是这个执行文件中的二进制数据，直接运行。在Substrate的相关代码以native命名</li>
<li>一份wasm的链上代码，我们一般成为wasm代码，wasm被部署到链上，所有人可获取，wasm通过构建一个wasm的运行时环境执行 。在Substrate的相关代码以wasm命名 在节点启动的时候可以选择执行策略，使用native, possible，wasm或者both。不同的执行策略会执行不同的执行文件</li>
</ol>
</div>
</div>
<p>由于这两份代码是由相同的代码编译出来的，所以其执行逻辑完全相同 (有一些很小的暗坑要注意)。其中wasm将会部署到链上，所有人都可以获取到，也就是说即使本地运行的不是最新版本的节点，只要同步了区块，一定可以获取到最新的wasm代码。</p>
<p>换句话说，一个写在Runtime内部的代码，也就是代表这条链功能性的代码，存在两份，分别是native与wasm。wasm代码被部署到链上，是“链上数据”，可以通过同步区块所有人统一获取并执行。这样就可以保证在区块链中所有矿工执行的都是最新的代码。</p>
<div id="admonition-哪种更合理" class="admonition tip">
<div class="admonition-title">
<p>哪种更合理</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-哪种更合理"></a></p>
</div>
<div>
<p>这里需要强调，代码的部署可以通过“民主提议”，“sudo控制权限”，“开发者自定一种部署条件”等方式进行，到底哪种方式“更区块链”，“更合理”，不在本文讨论范围内，这与这条链的设计目的相关。Substrate只是提供了这种“热更新”的强大机制，如何使用这种机制是这条链的问题。</p>
</div>
</div>
<h4 id="以太坊合约更新策略-1"><a class="header" href="#以太坊合约更新策略-1">以太坊合约更新策略</a></h4>
<div id="admonition-合约更新策略" class="admonition info">
<div class="admonition-title">
<p>合约更新策略</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-合约更新策略"></a></p>
</div>
<div>
<p>我们使用以太坊中“合约更新策略”来解释Substrate的Runtime机制：</p>
</div>
</div>
<p>由于以太坊部署一个合约后，其地址已经被固定，且数据完全存储在这个合约地址下，若这个合约需要升级功能或出现Bug，将会带来许多的问题（比如许多垃圾山寨币的ERC20合约有溢出漏洞，被攻击后损失惨重，只能通过重新部署合约，**
并将老合约的数据重新导入的方式**进行合约升级，且此时的合约地址只能使用新的了）。</p>
<p>许多开发人员不断探索后发展出了如下的以太坊合约升级方式：</p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Substrate_runtime_intro.jpeg" alt="Substrate_runtime_intro" /></p>
<p>熟悉以太坊的开发人员应该很容易理解上图表达的意思。</p>
<p>其核心思想是将一个合约拆分成为“逻辑合约”与“数据合约”，并使用一个“核心合约”将它们串在一起，这个核心合约就是用户的入口。</p>
<p>由于以太坊部署后的地址是固定的，所以将逻辑合约做成一个独立的合约，并将其地址设置在核心合约当中。那么只要更改核心合约中设置的地址，就可以更改核心合约执行的逻辑了。</p>
<p>并且由于以太坊的合约部署后都存在于“世界状态”当中，那么在同步区块时，老数据就会自动使用老的逻辑合约执行，而新的数据使用新的逻辑合约执行。</p>
<div id="admonition-链上代码" class="admonition tip">
<div class="admonition-title">
<p>链上代码</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-链上代码"></a></p>
</div>
<div>
<p>这里的“逻辑合约”就是“链上代码”的概念，它存在于被共识的数据当中，具备历史的意义</p>
</div>
</div>
<h4 id="substrate对应合约更新策略-1"><a class="header" href="#substrate对应合约更新策略-1">Substrate对应‘合约更新策略’</a></h4>
<p>那么将Substrate的框架对应过来，其中：</p>
<ul>
<li>“核心合约”的部分就是节点采用wasm执行去从“状态”存储中加载出最新的合约代码</li>
<li>“逻辑合约”的部分就是这条链的Runtime</li>
<li>“数据合约”的部分就是这条链自己的状态数据</li>
</ul>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/v2-b9bb441d00298a06de67ab8fdd368c08_720w.jpg" alt="img" /></p>
<div id="admonition-wasm" class="admonition tip">
<div class="admonition-title">
<p>wasm</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-wasm"></a></p>
</div>
<div>
<p>由此可见，由于wasm代码的存在，可以保证即使节点没有更新到最新版本，仍然能够<strong>以最新的代码运行</strong>，保证不会因为代码的不同而分叉。同时在节点同步老数据的过程中也<strong>不会因为本地代码是最新的而导致同步出错</strong></p>
</div>
</div>
<h2 id="项目结构-1"><a class="header" href="#项目结构-1">项目结构</a></h2>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/substrate_github.gif" alt="substrate_github" /></p>
<h3 id="客户端架构-1"><a class="header" href="#客户端架构-1">客户端架构</a></h3>
<h4 id="架构图-1"><a class="header" href="#架构图-1">架构图</a></h4>
<div id="admonition-substrate-client" class="admonition tip">
<div class="admonition-title">
<p>Substrate Client</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-substrate-client"></a></p>
</div>
<div>
<pre><code class="language-text">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃         ___ _   _ ___ ___ _____ ___    _ _____ ___    ___ _    ___ ___ _  _ _____        ┃
┃        / __| | | | _ ) __|_   _| _ \  /_\_   _| __|  / __| |  |_ _| __| \| |_   _|       ┃
┃        \__ \ |_| | _ \__ \ | | |   / / _ \| | | _|  | (__| |__ | || _|| .` | | |         ┃
┃        |___/\___/|___/___/ |_| |_|_\/_/ \_\_| |___|  \___|____|___|___|_|\_| |_|         ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃     ┌───────────────┐     ┌──────────────────────────────────────────────────────────┐   ┃
┃     │               │     │                                                          │   ┃
┃     │               │     │                                                          │   ┃
┃     │               │     │                           RPC                            │   ┃
┃     │               │     │                                                          │   ┃
┃     │      P2P      │     │                                                          │   ┃
┃     │    NETWORK    │     └──────────────────────────────────────────────────────────┘   ┃
┃     │               │     ┌────────────────────────────────────────┐ ┌───────────────┐   ┃
┃     │               │     │                                        │ │               │   ┃
┃     │               │     │            ┌───────────────┐           │ │               │   ┃
┃     │               │     │            │               │           │ │   CONSENSUS   │   ┃
┃     └───────────────┘     │            │     Wasm      │           │ │               │   ┃
┃          .───────.        │            │    Runtime    │           │ │               │   ┃
┃       ,─'         '─.     │            │               │           │ └───────────────┘   ┃
┃      ╱               ╲░   │            └───────────────┘           │                     ┃
┃     ;     NATIVE      :░  │                                        │ ┌───────────────┐   ┃
┃     :     RUNTIME     ;░░ │                                        │ │               │   ┃
┃      ╲               ╱░░░ │                STORAGE                 │ │               │   ┃
┃       ╲             ╱░░░  │                                        │ │   TELEMETRY   │   ┃
┃        '─.       ,─'░░░   │                                        │ │               │   ┃
┃          ░`─────'░░░░░    │                                        │ │               │   ┃
┃             ░░░░░░░       └────────────────────────────────────────┘ └───────────────┘   ┃
┃                                                                                          ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
</div>
</div>
<p>现在我们知道了 Substrate 是什么，让我们对框架、它的移动部分以及我们可以用来创建自定义区块链的扩展点进行高级概述。 
由于我们在这里处理的是去中心化的点对点系统，所以我们谈论的基本单元是节点,这是我们的区块链运行的地方。
该节点在客户端内部运行，并提供系统运行所需的所有基本组件，例如p2p网络、区块链的存储、块处理和共识的逻辑，以及从外部与区块链交互的能力。</p>
<h4 id="模块说明-1"><a class="header" href="#模块说明-1">模块说明</a></h4>
<blockquote>
<p>substrate客户端是基于substrate实现的区块链的节点客户端（可以理解为全节点），
它主要由以下几个组件组成（以下也就是告诉我们实现一条链由哪几部分组成）：</p>
</blockquote>
<h5 id="存储-1"><a class="header" href="#存储-1">存储</a></h5>
<p>用来维持区块链系统所呈现的状态演变。substrate提供了的存储方式是一种简单有效的key-value对存储机制的方式。</p>
<h5 id="runtime-2"><a class="header" href="#runtime-2">Runtime</a></h5>
<p>这里就可以回答上面的问题，什么是runtime？runtime定义了区块的处理方式，主要是状态转换的逻辑。在substrate中，runtime code被编译成wasm作为区块链存储状态的一部分。</p>
<h5 id="p2p网络-1"><a class="header" href="#p2p网络-1">p2p网络</a></h5>
<p>允许客户端和其它网络参与者进行通信。</p>
<h5 id="共识-1"><a class="header" href="#共识-1">共识</a></h5>
<p>提供了一种逻辑，能使网络参与者就区块链的状态达成一致。 substrate 支持提供自定义的共识引擎。</p>
<h5 id="rpc-1"><a class="header" href="#rpc-1">RPC</a></h5>
<p>远程过程调用。</p>
<h5 id="telemetry-遥测-1"><a class="header" href="#telemetry-遥测-1">telemetry （遥测）</a></h5>
<p>通过嵌入式Prometheus服务器的方式对外展示（我理解应该是类似于区块链浏览器一样的东西，或者是提供信息给区块链浏览器展示）。</p>
<h3 id="tree-level1-1"><a class="header" href="#tree-level1-1">Tree Level1</a></h3>
<p>首先来看看项目的整理结构：</p>
<pre><code class="language-shell"> tree -L 1 | pbcopy                                                                                                                                                                                                                        ─╯
.
├── Cargo.lock
├── Cargo.toml
├── HEADER-APACHE2
├── HEADER-GPL3
├── LICENSE-APACHE2
├── LICENSE-GPL3
├── README.md
├── bin
├── client
├── docker
├── docs
├── frame
├── primitives
├── rustfmt.toml
├── scripts
├── shell.nix
├── test-utils
└── utils

9 directories, 9 files
</code></pre>
<h4 id="用cargo组织代码-1"><a class="header" href="#用cargo组织代码-1">用Cargo组织代码</a></h4>
<p>Substrate非常明显使用Cargo来组织代码：</p>
<ol>
<li>项目根目录的Cargo.toml会用workspace+members导入各子模块</li>
</ol>
<pre><code class="language-yaml">[ workspace ]
  resolver = &quot;2&quot;

  members = [...]
</code></pre>
<div id="admonition-workspacememgers" class="admonition info">
<div class="admonition-title">
<p>workspace+memgers</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-workspacememgers"></a></p>
</div>
<div>
<p>在[workspace]项下, members 属性表示工作区目录中的程序库列表</p>
</div>
</div>
<ol start="2">
<li>各子模块之间也用Cargo.toml来相互导入使用</li>
</ol>
<pre><code class="language-yaml">[ dependencies ]
  sc-consensus = { version = &quot;0.10.0-dev&quot;, path = &quot;../../client/consensus/common&quot; }
</code></pre>
<div id="admonition-高内聚低耦合" class="admonition tip">
<div class="admonition-title">
<p>高内聚，低耦合</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-高内聚低耦合"></a></p>
</div>
<div>
<p>这里正是通过Cargo.toml的语法，将模块功能内聚之后供调用</p>
</div>
</div>
<h3 id="主要部分介绍nodeframecore-1"><a class="header" href="#主要部分介绍nodeframecore-1">主要部分介绍：Node、Frame、Core</a></h3>
<h4 id="substrate-node-1"><a class="header" href="#substrate-node-1">Substrate Node:</a></h4>
<p>我们将从 Substrate Node 开始。这是我们可以开始的最高级别；</p>
<p>它提供了最多的预建功能和最少的技术自由度。它是完全可运行的，包括所有基本组件的默认实现，例如:</p>
<ul>
<li>账户管理</li>
<li>特权访问</li>
<li>共识</li>
<li>…</li>
</ul>
<p>我们可以自定义链的创世块（即初始状态）以开始。 在这里，我们可以运行节点并熟悉 Substrate 提供的开箱即用的功能，玩转状态并与正在运行的区块链交互以熟悉。</p>
<p>另一种实现相同目的的方法是使用 <a href="https://substrate.io/developers/playground/">Substrate Playground</a>，您可以在其中查看后端和前端模板以熟悉它们。
然而，一旦我们准备好真正构建自己的区块链，我们最好降低一层并使用 FRAME。</p>
<pre><code class="language-shell">tree bin -L 2 | pbcopy                                                                                                                                                                                                                       ─╯
bin
├── node
│   ├── bench
│   ├── cli
│   ├── executor
│   ├── inspect
│   ├── primitives
│   ├── rpc
│   ├── runtime
│   └── testing
├── node-template: 使用Substrate写项目的基础模版
│   ├── LICENSE
│   ├── README.md
│   ├── docker-compose.yml
│   ├── docs
│   ├── node
│   ├── pallets
│   ├── runtime
│   ├── scripts
│   └── shell.nix
└── utils
    ├── chain-spec-builder
    └── subkey

18 directories, 4 files
</code></pre>
<h5 id="重点说说nodepallets和runtime-1"><a class="header" href="#重点说说nodepallets和runtime-1">重点说说node、pallets和runtime</a></h5>
<div id="admonition-nodepalletsruntimes" class="admonition tip">
<div class="admonition-title">
<p>node、pallets、runtimes</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-nodepalletsruntimes"></a></p>
</div>
<div>
<p>│   ├── node: 链的一些基础功能的实现（或者说比较底层的实现，如网络、rpc，搭建链的最基础的code)
│   ├── pallets: 放置的就是各个pallet，也就是业务相关的模块
│   ├── runtime: 可以简单理解为把所有pallet组合到一起，也就是业务相关的逻辑</p>
</div>
</div>
<p>三者的关系大致如下：</p>
<div id="admonition-nodepalletsruntime的关系" class="admonition tip">
<div class="admonition-title">
<p>node、pallets、runtime的关系</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-nodepalletsruntime的关系"></a></p>
</div>
<div>
<pre><code class="language-text">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃             ___ _   _ ___ ___ _____ ___    _ _____ ___   _  _  ___  ___  ___             ┃
┃            / __| | | | _ ) __|_   _| _ \  /_\_   _| __| | \| |/ _ \|   \| __|            ┃
┃            \__ \ |_| | _ \__ \ | | |   / / _ \| | | _|  | .` | (_) | |) | _|             ┃
┃            |___/\___/|___/___/ |_| |_|_\/_/ \_\_| |___| |_|\_|\___/|___/|___|            ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃                                                                                          ┃
┃  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ ┃
┃  ┃                         ___ _   _ _  _ _____ ___ __  __ ___                         ┃ ┃
┃  ┃                        | _ \ | | | \| |_   _|_ _|  \/  | __|                        ┃ ┃
┃  ┃                        |   / |_| | .` | | |  | || |\/| | _|                         ┃ ┃
┃  ┃                        |_|_\\___/|_|\_| |_| |___|_|  |_|___|                        ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┃    ┌───────────────┐    ┌───────────────┐    ┌───────────────┐   ┌───────────────┐  ┃ ┃
┃  ┃    │               │    │               │    │               │   │               │  ┃ ┃
┃  ┃    │   pallet 1    │    │   pallet 2    │    │      ...      │   │   pallet n    │  ┃ ┃
┃  ┃    │               │    │               │    │               │   │               │  ┃ ┃
┃  ┃    └───────────────┘    └───────────────┘    └───────────────┘   └───────────────┘  ┃ ┃
┃  ┃                                                                                     ┃ ┃
┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛ ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
</div>
</div>
<blockquote>
<p>当然，对于pallets来说，在runtime中使用的pallet，有些是我们自己开发的pallet，有些是substrate中已经开发好的pallet，甚至还有些是pallet是第三方开发的pallet。</p>
</blockquote>
<h4 id="substrate-frame-1"><a class="header" href="#substrate-frame-1">Substrate FRAME</a></h4>
<p>FRAME (Framework for Runtime Aggregation of Modularized Entities) 是一个框架，用于从现有库构建 Substrate 运行时(Runtime)
，并具有高度的自由度来确定我们的区块链逻辑。</p>
<p>我们基本上是从 Substrate 的预构建节点模板开始，可以添加所谓的托盘（pallet, Substrate 库模块的名称）来定制和扩展我们的链。</p>
<p>在这个抽象级别，我们还能够完全自定义我们区块链的逻辑、状态和数据类型。这当然是大多数旨在接近 Substrate 的基本定制项目在易于开发和技术自由之间利用两全其美的地方。</p>
<div id="admonition-专注定制" class="admonition tip">
<div class="admonition-title">
<p>专注定制</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-专注定制"></a></p>
</div>
<div>
<p>从这个起点开始，我们必须投入最少的时间来建立我们的区块链，并且可以完全专注于我们自己的定制。</p>
</div>
</div>
<p>我们仍然需要在它们到来时采用一些默认值——或者更确切地说，因为它们可以被配置——但是如果我们从根本上想要做不同的事情，我们可以从 Core 开始再降低一步。</p>
<div id="admonition-frame" class="admonition info">
<div class="admonition-title">
<p>FRAME</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-frame"></a></p>
</div>
<div>
<p>The Framework for Runtime Aggregation of Modularized Entities (FRAME) is a set of modules and support libraries that simplify runtime development. 
In Substrate , these modules are called Pallets, each hosting domain-specific logic to include in a chain’s runtime.</p>
<p>FRAME also provides some helper modules to interact with important Substrate Primitives that provide the interface to the core client.</p>
<p>The following diagram shows the architectural overview of FRAME and its support libraries:</p>
</div>
</div>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/frame-arch.png" alt="frame-arch" /></p>
<p><a href="https://docs.substrate.io/v3/runtime/frame/">FRAME | Substrate_</a></p>
<pre><code class="language-shell">tree frame -L 1 | pbcopy
frame
├── alliance: The Alliance Pallet provides a collective that curates a list of accounts and URLs, deemed by the voting members to be unscrupulous actors.
├── assets: A simple, secure module for dealing with fungible assets. The Assets module provides functionality for asset management of fungible asset classes with a fixed supply
├── atomic-swap: A module for atomically sending funds.
├── aura: The Aura module extends Aura consensus by managing offline reporting.
├── authority-discovery: This module is used by the client/authority-discovery to retrieve the current set of authorities.
├── authorship
├── babe
├── bags-list
├── balances: The Balances module provides functionality for handling accounts and balances.
├── beefy
├── beefy-mmr
├── benchmarking
├── bounties
├── child-bounties
├── collective
├── contracts
├── conviction-voting
├── democracy
├── election-provider-multi-phase
├── election-provider-support
├── elections-phragmen
├── examples
├── executive
├── gilt
├── grandpa
├── identity
├── im-online
├── indices
├── lottery
├── membership
├── merkle-mountain-range
├── multisig
├── nicks
├── node-authorization
├── nomination-pools
├── offences
├── preimage
├── proxy
├── randomness-collective-flip
├── ranked-collective
├── recovery
├── referenda
├── remark
├── scheduler
├── scored-pool
├── session
├── society
├── staking
├── state-trie-migration
├── sudo
├── support
├── system
├── timestamp
├── tips
├── transaction-payment
├── transaction-storage
├── treasury
├── try-runtime
├── uniques
├── utility
├── vesting
└── whitelist

62 directories, 0 files

</code></pre>
<h4 id="substrate-coreclient-1"><a class="header" href="#substrate-coreclient-1">Substrate Core(client)</a></h4>
<p>Substrate Core 本质上意味着我们可以以任何我们想要的方式实现我们的运行时，只要它以 WebAssembly 为目标并遵守 Substrate 块创建的基本法则。</p>
<p>然后，我们可以使用这个运行时并在 Substrate 节点中运行它。</p>
<div id="admonition-最高自由度" class="admonition info">
<div class="admonition-title">
<p>最高自由度</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-最高自由度"></a></p>
</div>
<div>
<p>这种方法当然需要最多的工作和最高的难度，但它也具有最高的技术自由度，同时仍然能够在 Substrate 生态系统中无缝工作。</p>
</div>
</div>
<p>说到 Substrate 的生态系统，有一个充满活力（充满活力）的开发者社区，他们在自己的项目中使用 Substrate，其中许多人通过共享自己的托盘(pallet)来回馈生态系统。</p>
<p>您可以通过使用诸如 <a href="https://substratemarketplace.com/">Substrate Market</a>
之类的站点或仅在托管 <a href="https://crates.io/">crates.io: Rust Package Registry</a> 的任何地方找到托盘(pallet)，因为 Substrate 托盘本质上是自包含的 Rust
库，您可以将其集成到您的 Substrate 项目中, 并根据需要进行配置。</p>
<p>与任何其他库一样，建议首先审核代码，并了解依赖外部代码与编写自己的代码之间的权衡。</p>
<p>在玩了一点预建节点之后，我们应该专注于 FRAME，学习如何通过在 Substrate 模板节点之上构建自定义区块链。这也是许多精彩教程的起点。</p>
<pre><code class="language-shell"> tree client -L 1 | pbcopy                                                                                                                                                                                                                    ─╯
client
├── allocator
├── api
├── authority-discovery
├── basic-authorship
├── beefy
├── block-builder
├── chain-spec
├── cli
├── consensus
├── db
├── executor
├── finality-grandpa
├── informant
├── keystore
├── network
├── network-gossip
├── offchain
├── peerset
├── proposer-metrics
├── rpc
├── rpc-api
├── rpc-servers
├── service
├── state-db
├── sync-state-rpc
├── sysinfo
├── telemetry
├── tracing
├── transaction-pool
└── utils

30 directories, 0 files
</code></pre>
<h3 id="其他-1"><a class="header" href="#其他-1">其他</a></h3>
<h4 id="primitives-1"><a class="header" href="#primitives-1">primitives</a></h4>
<pre><code class="language-shell">tree primitives -L 1 | pbcopy
primitives
├── api
├── application-crypto
├── arithmetic
├── authority-discovery
├── authorship
├── beefy
├── block-builder
├── blockchain
├── consensus
├── core
├── database
├── debug-derive
├── externalities
├── finality-grandpa
├── inherents
├── io
├── keyring
├── keystore
├── maybe-compressed-blob
├── merkle-mountain-range
├── npos-elections
├── offchain
├── panic-handler
├── rpc
├── runtime
├── runtime-interface
├── sandbox
├── serializer
├── session
├── staking
├── state-machine
├── std
├── storage
├── tasks
├── test-primitives
├── timestamp
├── tracing
├── transaction-pool
├── transaction-storage-proof
├── trie
├── version
└── wasm-interface

42 directories, 0 files

</code></pre>
<h4 id="scriptsci-1"><a class="header" href="#scriptsci-1">scripts/ci</a></h4>
<pre><code class="language-shell">tree scripts/ci | pbcopy
scripts/ci
├── common
│   └── lib.sh
├── deny.toml
├── docker
│   ├── subkey.Dockerfile
│   └── substrate.Dockerfile
├── github
│   ├── check_labels.sh
│   └── generate_changelog.sh
├── gitlab
│   ├── check_runtime.sh
│   ├── check_signed.sh
│   ├── ensure-deps.sh
│   ├── pipeline
│   │   ├── build.yml
│   │   ├── check.yml
│   │   ├── publish.yml
│   │   └── test.yml
│   ├── publish_draft_release.sh
│   └── skip_if_draft.sh
├── monitoring
│   ├── alerting-rules
│   │   ├── alerting-rule-tests.yaml
│   │   └── alerting-rules.yaml
│   └── grafana-dashboards
│       ├── README_dashboard.md
│       ├── substrate-networking.json
│       └── substrate-service-tasks.json
├── node-template-release
│   ├── Cargo.toml
│   └── src
│       └── main.rs
└── node-template-release.sh

10 directories, 23 files

</code></pre>
<h4 id="utils-1"><a class="header" href="#utils-1">utils</a></h4>
<pre><code class="language-shell">tree utils -L 1 | pbcopy
utils
├── build-script-utils
├── fork-tree
├── frame
├── prometheus
└── wasm-builder

5 directories, 0 files

</code></pre>
<h2 id="功能逻辑-1"><a class="header" href="#功能逻辑-1">功能逻辑</a></h2>
<div id="admonition-注意" class="admonition tip">
<div class="admonition-title">
<p>注意</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_intro.html#admonition-注意"></a></p>
</div>
<div>
<p>这里将结合前面提到的runtim/core分块方式来进行功能模块说明</p>
</div>
</div>
<h2 id="特色代码-1"><a class="header" href="#特色代码-1">特色代码</a></h2>
<h2 id="参考资源-43"><a class="header" href="#参考资源-43">参考资源</a></h2>
<h3 id="online-book-39"><a class="header" href="#online-book-39">online-book</a></h3>
<ul>
<li><a href="https://github.com/paritytech/substrate">paritytech/substrate: Substrate: The platform for blockchain innovators</a></li>
<li><a href="https://docs.substrate.io/v3/getting-started/architecture/">Architecture | Substrate_</a></li>
<li><a href="https://www.bilibili.com/video/BV1KT4y1Y7Uf">substrate轻松学</a></li>
</ul>
<h3 id="fragment-39"><a class="header" href="#fragment-39">fragment</a></h3>
<ul>
<li><a href="https://www.zhihu.com/column/c_74315572">链块与分散的数据 - 知乎</a></li>
<li><a href="https://web.archive.org/web/20220627112702/https://mp.weixin.qq.com/s/MP0LXWVqUn5R4C6fAbe1nQ">区块链与substrate</a></li>
<li><a href="https://web.archive.org/web/20220618042220/https://zhuanlan.zhihu.com/p/47805322">substrate 源码解析与运用 - 介绍 - 知乎</a></li>
<li><a href="https://www.zhihu.com/column/substrate">Substrate区块链开发 - 知乎</a></li>
<li><a href="https://substrate.io/ecosystem/">Substrate Ecosystem | Substrate_</a></li>
<li><a href="https://blog.logrocket.com/substrate-blockchain-framework-core-concepts/"><strong>Substrate blockchain development: Core concepts - LogRocket
Blog</strong></a>：对Substrate的简要介绍</li>
<li><a href="https://substrate.io/developers/playground/">Playground | Substrate_</a></li>
<li><a href="https://substratemarketplace.com/">Substrate Market</a></li>
<li><a href="https://crates.io/">crates.io: Rust Package Registry</a></li>
<li><a href="https://docs.substrate.io/quick-start/">Quick start | Substrate Docs</a></li>
<li><a href="https://docs.substrate.io/tutorials/">Tutorials | Substrate Docs</a></li>
<li><a href="https://substrate.io/ecosystem/projects/">Projects | Substrate_</a>: 一些基于Substrate建立的项目，值得参考</li>
<li><a href="https://docs.substrate.io/tutorials/v3/kitties/pt1/">Build the Substrate Kitties Chain | Substrate_</a>: 教你建立一个nft平台</li>
<li><a href="https://docs.substrate.io/v3/runtime/frame/">FRAME | Substrate_</a></li>
<li><a href="https://medium.com/frctls/the-substrate-guide-i-wish-i-had-6bc76b10ddd2">The Substrate Guide I Wish I Had. Fractal’s blockchain lead Shelby… | by Fractal | Fractal | Medium</a></li>
<li><a href="https://docs.substrate.io/reference/how-to-guides/">How-to quick reference guides | Substrate Docs</a></li>
</ul>
<h3 id="runtime-3"><a class="header" href="#runtime-3">Runtime</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220627114404/https://zhuanlan.zhihu.com/p/79539782">剖析Substrate Runtime - 知乎</a>
<blockquote>
<p>基于Substrate开发自己的运行时模块，会遇到一个比较大的挑战，就是理解Substrate运行时（Runtime）。
本文首先介绍了Runtime的架构，类型，常用宏，并结合一个实际的演示项目，做了具体代码分析，以帮助大家更好地理解在Substrate中它们是如何一起工作的。</p>
</blockquote>
</li>
</ul>
<h3 id="local-39"><a class="header" href="#local-39">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate官方教程梳理与练习"><a class="header" href="#substrate官方教程梳理与练习">Substrate官方教程梳理与练习</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">Substrate官方教程梳理与练习</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%80%BB%E8%A7%88">总览</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#get-started">Get Started</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#build-a-local-blockchain">Build a local blockchain</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E8%AE%BE%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83">设置开发环境</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8rustup%E8%AE%BE%E7%BD%AErust%E7%8E%AF%E5%A2%83">使用rustup设置rust环境</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%A3%80%E6%9F%A5%E7%8E%AF%E5%A2%83">检查环境</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%90%AF%E5%8A%A8%E9%93%BE%E8%8A%82%E7%82%B9">启动链节点</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%B8%8B%E8%BD%BDnode-template">下载node-template</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#node-templeate%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84">node-templeate项目结构</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#cargotoml">Cargo.toml</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E8%AF%91%E5%89%8D%E7%9A%84%E6%A3%80%E6%9F%A5">编译前的检查</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E8%AF%91">编译</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98">可能遇到的问题</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C%E8%8A%82%E7%82%B9">本地运行节点</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#docker%E8%BF%90%E8%A1%8C%E8%8A%82%E7%82%B9">docker运行节点</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%89%8D%E7%AB%AF%E8%AE%BF%E9%97%AE">前端访问</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8%E5%89%8D%E7%AB%AF%E6%A8%A1%E7%89%88">使用前端模版</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8polkadot-js%E8%AE%BF%E9%97%AE%E8%8A%82%E7%82%B9">使用polkadot-js访问节点</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F">Substrate使用方式</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8subtrate-node">使用subtrate node</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8substrate-frame">使用substrate frame</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8substrate-core">使用substrate core</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#simulate-a-network">Simulate a network</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#add-trusted-nodes">Add trusted nodes</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#authorize-specific-nodes">Authorize specific nodes</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#monitor-node-metrics">Monitor node metrics</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#upgrade-a-running-network">Upgrade a running network</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#work-with-pallets">Work with pallets</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%96%87%E6%A1%A3%E4%BB%A3%E7%A0%81%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98">文档/代码更新问题</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E5%89%8D%E7%BD%AErust%E7%9F%A5%E8%AF%86">Pallet前置Rust知识</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E7%BB%84%E6%88%90">Pallet组成</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#add-a-pallet-to-the-runtime">Add a pallet to the runtime</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#runtime%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90">runtime结构分析</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#runtimecargotoml%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90">runtime/Cargo.toml结构分析</a>
<ul>
<li>[[package]{…}](#package)</li>
<li>[[package.metadata.docs.rs]{…}](#packagemetadatadocsrs)</li>
<li>[[dependencies]{…}](#dependencies)</li>
<li>[[build-dependencies]{…}](#build-dependencies)</li>
<li>[[features]{…}](#features)</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9B%9B%E6%AD%A5%E6%B7%BB%E5%8A%A0pallet">四步添加pallet</a>
<ul>
<li>[添加依赖: Cargo.toml/[dependincies]](#添加依赖-cargotomldependincies)</li>
<li>[添加feature: Cargo.toml/[features]](#添加feature-cargotomlfeatures)</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E9%85%8D%E7%BD%AE-%E6%B7%BB%E5%8A%A0config%E6%8E%A5%E5%8F%A3-srclibrs">配置-&gt;添加config接口: src/lib.rs</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%AE%9A%E4%B9%89%E8%BF%90%E8%A1%8C%E6%97%B6-srclibrsconstruct_runtime">定义运行时: src/lib.rs/construct_runtime!</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E8%AF%91-%E8%BF%90%E8%A1%8C-%E5%90%AF%E5%8A%A8%E5%89%8D%E7%AB%AF">编译-&gt;运行-&gt;启动前端</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E9%AA%8C%E8%AF%81%E5%8A%9F%E8%83%BD">验证功能</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%B8%BA%E5%B8%90%E6%88%B7%E8%AE%BE%E7%BD%AE%E6%98%B5%E7%A7%B0">为帐户设置昵称</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%BD%BF%E7%94%A8nicks-pallet%E6%9F%A5%E8%AF%A2%E8%B4%A6%E6%88%B7%E4%BF%A1%E6%81%AF">使用Nicks pallet查询账户信息</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98">可能出现的问题</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#configure-the-contracts-pallet">Configure the contracts pallet</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#signed%E4%B8%8Esudo%E6%9C%89%E4%B8%8D%E5%90%8C%E6%9D%83%E9%99%90">signed与sudo有不同权限。</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#use-macros-in-a-custom-pallet">Use macros in a custom pallet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E7%BB%84%E4%BB%B6%E6%B7%B1%E5%85%A5">Pallet组件深入</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#1-pallet-hooks">1. Pallet Hooks</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#2-pallet-extrinsics">2. Pallet Extrinsics</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#3-pallet-errors">3. Pallet Errors</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#4-pallet-config">4. Pallet Config</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#5-pallet-use-other-pallet">5. Pallet Use Other Pallet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#6-pallet-extension">6. Pallet Extension</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#7-pallet-debug">7. Pallet Debug</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#8-pallet-rpc">8. Pallet RPC</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#9-pallet-benchmarking">9. Pallet Benchmarking</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#develop-smart-contracts">Develop smart contracts</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#prepare-your-first-contract">Prepare your first contract</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#develop-a-smart-contract">Develop a smart contract</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#use-maps-for-storing-values">Use maps for storing values</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#buid-a-token-contract">Buid a token contract</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#troubleshoot-smart-contracts">Troubleshoot smart contracts</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-with-other-chains">Connect with other chains</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#start-a-local-relay-chain">Start a local relay chain</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-a-local-parachain">Connect a local parachain</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-to-rococo-testnet">Connect to Rococo testnet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#access-evm-accounts">Access EVM accounts</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E6%96%87%E6%A1%A3%E7%BB%83%E4%B9%A0">substrate文档练习</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E5%9F%BA%E7%A1%80">pallet基础</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%B0%9D%E8%AF%95%E6%B7%BB%E5%8A%A0pallet%E5%88%B0runtime">尝试添加pallet到runtime</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E5%86%99pallet%E5%88%B0rust%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86">编写pallet到rust前置知识</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E5%88%B0pallet">编写简单到pallet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E7%9A%84%E7%BB%84%E6%88%90">pallet的组成</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E6%8A%80%E5%B7%A7%E7%BB%86%E8%8A%82">Pallet技巧细节</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#storage%E9%93%BE%E4%B8%8A%E5%90%84%E4%B8%AA%E7%B1%BB%E5%9E%8B%E4%BD%BF%E7%94%A8">storage（链上）各个类型使用</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#error%E7%B1%BB%E5%9E%8B%E7%9A%84%E4%BD%BF%E7%94%A8">Error类型的使用</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%86%99%E8%B0%83%E5%BA%A6%E5%87%BD%E6%95%B0%E7%9A%84%E5%A5%97%E8%B7%AF">写调度函数的套路</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#hooks%E7%9A%84%E4%BD%BF%E7%94%A8">hooks的使用</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E4%B8%AD%E7%9A%84config">pallet中的Config</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%85%B6%E5%AE%83pallet">在pallet中使用其它pallet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%B0%81%E8%A3%85%E5%92%8C%E6%89%A9%E5%B1%95%E7%8E%B0%E6%9C%89pallet">封装和扩展现有pallet</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E8%B0%83%E8%AF%95">调试</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#pallet%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">pallet中的类型转换；</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%93%BE%E4%B8%8B%E5%B7%A5%E4%BD%9C%E8%80%85offchain-worker">在pallet中使用链下工作者（Offchain worker）</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E4%B8%AD%E9%93%BE%E4%B8%8A%E5%86%99%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8offchain-index">在pallet中链上写本地存储（offchain index）；</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E7%9A%84ocw%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%93%BE%E4%B8%8B%E5%AD%98%E5%82%A8offchain-storage">在pallet的ocw中使用链下存储（offchain storage）；</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%85%B6%E5%AE%83pallet%E4%BD%BF%E7%94%A8%E5%85%B6%E5%AE%83pallet%E7%9A%84%E5%AD%98%E5%82%A8">在pallet中使用其它pallet（使用其它pallet的存储）；</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%9C%A8pallet%E4%B8%AD%E6%B7%BB%E5%8A%A0rpc%E6%8E%A5%E5%8F%A3">在pallet中添加rpc接口</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%B8%BA%E6%9F%90%E4%BA%9Btrait%E6%8F%90%E4%BE%9B%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0">为某些trait提供默认实现。</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6">智能合约</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%88%9D%E6%8E%A2ink">初探ink!</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%B7%B1%E5%85%A5ink">深入ink!</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#erc20">ERC20</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E8%BF%9E%E6%8E%A5%E5%85%B6%E4%BB%96%E9%93%BE">连接其他链</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E4%B8%AD%E7%BB%A7%E9%93%BE%E8%BF%9E%E6%8E%A5">中继链连接</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%B9%B3%E8%A1%8C%E9%93%BE%E8%BF%9E%E6%8E%A5">平行链连接</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E6%B5%8B%E8%AF%95">测试</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95">编写测试</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#benchmarking">benchmarking</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#%E5%8D%87%E7%BA%A7">升级</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:49 UTC 2022 -->
<!--te-->
<h1 id="总览"><a class="header" href="#总览">总览</a></h1>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2679.3896px" preserveAspectRatio="none" style="width:850px;height:2679px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 2679" width="850.6405px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="96.0814" x="6.4054" y="1327.6146"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="83.2705" x="12.8109" y="1342.3439">Substrate Tutorials</text><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="130.6707" x="134.5139" y="461.6761"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="49.9623" x="140.9194" y="476.4054">Get started</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#get-started" target="_top" title="#get-started" xlink:actuate="onRequest" xlink:href="#get-started" xlink:show="new" xlink:title="#get-started" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="193.4439" y="476.4054">jump</text></a><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="140.9194" y="486.8443"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="117.8598" x="140.9194" y="497.2831">开始接触Substrate基础内容</text><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="138.9977" x="297.2118" y="88.2548"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="101.8463" x="303.6172" y="102.9841">Build a local blockchain</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#build-a-local-blockchain" target="_top" title="#build-a-local-blockchain" xlink:actuate="onRequest" xlink:href="#build-a-local-blockchain" xlink:show="new" xlink:title="#build-a-local-blockchain" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="408.0256" y="102.9841">jump</text></a><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="283.1198" x="468.2366" y="12.8109"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="474.642" y="27.5402">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="474.642" y="37.979"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="266.4657" x="474.642" y="48.4179">1. 有良好的互联网连接并可以访问本地计算机上的 shell 终端。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="233.1575" x="474.642" y="58.8567">2. 您相当(generally)熟悉软件开发并使用命令行界面。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="474.642" y="69.2956">3. 相当熟悉区块链和智能合约平台。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="270.309" x="474.642" y="79.7344">4. 你已经安装了 Rust 并按照安装中的描述设置了你的开发环境。</text><path d="M436.2095,99.8796 L442.6149,99.8796 C452.2231,99.8796 452.2231,50.5328 461.8312,50.5328 L468.2366,50.5328 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="85.8827" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="166.5411" x="468.2366" y="101.0656"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="474.642" y="115.795">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="474.642" y="126.2338"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="114.0166" x="474.642" y="136.6726">1. 下载链端模版和前端模版</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="128.1085" x="474.642" y="147.1115">- substrate-node-template</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="474.642" y="157.5503">- substrate-front-end-template</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="114.0166" x="474.642" y="167.9892">2. 启动节点、启动前端查看</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="96.0814" x="474.642" y="178.428">3. 在前端进行转账操作</text><path d="M436.2095,99.8796 L442.6149,99.8796 C452.2231,99.8796 452.2231,144.007 461.8312,144.007 L468.2366,144.007 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,99.8796 290.8063,99.8796 L297.2118,99.8796 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="169.3935" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="210.098" x="297.2118" y="207.3506"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="83.9111" x="303.6172" y="222.08">Simulate a network</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#simulate-a-network" target="_top" title="#simulate-a-network" xlink:actuate="onRequest" xlink:href="#simulate-a-network" xlink:show="new" xlink:title="#simulate-a-network" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="390.0904" y="222.08">jump</text></a><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="303.6172" y="232.5188"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="143.4815" x="303.6172" y="242.9577">本教程提供了有关如何使用一组认证</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="179.3519" x="303.6172" y="253.3965">私有验证器启动私有区块链网络的基本介绍。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="303.6172" y="263.8354"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="162.6978" x="303.6172" y="274.2742">Substrate节点模板使用认证共识模型，</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="143.4815" x="303.6172" y="284.713">将块生产限制为授权账户轮换列表。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="197.2871" x="303.6172" y="295.1519">授权账户（认证机构）负责以循环方式创建区块。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="303.6172" y="305.5907"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="161.4167" x="303.6172" y="316.0296">在本教程中将通过使用两个预定义的帐户</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="143.4815" x="303.6172" y="326.4684">作为认证机制，使节点能够生成块，</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="188.3195" x="303.6172" y="336.9073">以此来了解权限共识模型在实践中的工作原理。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="303.6172" y="347.3461"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="161.4167" x="303.6172" y="357.7849">在这个模拟网络中，两个节点使用不同的</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="170.3843" x="303.6172" y="368.2238">帐户和密钥启动，但在单台计算机上运行。</text><rect fill="#F1F1F1" height="85.8827" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="263.9035" x="539.3369" y="199.7592"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="545.7423" y="214.4886">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="545.7423" y="224.9274"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="53.8056" x="545.7423" y="235.3662">完成上一节课</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="251.0927" x="545.7423" y="245.8051">1. 安装Rust和Rust工具链，为Substrate 开发配置了环境。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="249.8116" x="545.7423" y="256.2439">2. 已完成构建本地区块链并在本地安装Substrate节点模板。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="545.7423" y="266.6828">3. 熟悉软件开发和使用命令行界面。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="545.7423" y="277.1216">4. 熟悉区块链和智能合约平台。</text><path d="M507.3097,292.0474 L513.7151,292.0474 C523.3233,292.0474 523.3233,242.7006 532.9314,242.7006 L539.3369,242.7006 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="85.8827" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="253.6549" x="539.3369" y="298.4528"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="545.7423" y="313.1822">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="545.7423" y="323.621"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="158.8546" x="545.7423" y="334.0598">1. 使用预定义的帐户启动区块链节点。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="167.8222" x="545.7423" y="344.4987">2. 了解用于启动节点的关键命令行选项。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="545.7423" y="354.9375">3. 确定节点是否正在运行并产生块。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="167.8222" x="545.7423" y="365.3764">4. 将第二个节点连接到正在运行的网络。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="240.844" x="545.7423" y="375.8152">5. 验证对等计算机(peer computers)产生并最终确定块。</text><path d="M507.3097,292.0474 L513.7151,292.0474 C523.3233,292.0474 523.3233,341.3942 532.9314,341.3942 L539.3369,341.3942 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,292.0474 290.8063,292.0474 L297.2118,292.0474 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="119.7815" x="297.2118" y="446.4932"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="82.63" x="303.6172" y="461.2226">Add trusted nodes</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#add-trusted-nodes" target="_top" title="#add-trusted-nodes" xlink:actuate="onRequest" xlink:href="#add-trusted-nodes" xlink:show="new" xlink:title="#add-trusted-nodes" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="388.8093" y="461.2226">jump</text></a><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="66.6164" x="449.0203" y="397.1464"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="455.4258" y="411.8758">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="455.4258" y="422.3146"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="53.8056" x="455.4258" y="432.7534">完成上一节课</text><path d="M416.9932,458.1181 L423.3986,458.1181 C433.0068,458.1181 433.0068,419.2101 442.6149,419.2101 L449.0203,419.2101 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="171.6654" x="449.0203" y="454.0846"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="455.4258" y="468.814">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="455.4258" y="479.2528"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="455.4258" y="489.6917">1. 生成用作网络授权的密钥对。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="114.0166" x="455.4258" y="500.1305">2. 创建自定义链规范文件。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="158.8546" x="455.4258" y="510.5694">3. 启动一个私有的两节点区块链网络。</text><path d="M416.9932,458.1181 L423.3986,458.1181 C433.0068,458.1181 433.0068,486.5872 442.6149,486.5872 L449.0203,486.5872 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,458.1181 290.8063,458.1181 L297.2118,458.1181 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="146.0437" x="297.2118" y="586.4668"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="108.8922" x="303.6172" y="601.1961">Authorize specific nodes</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#authorize-specific-nodes" target="_top" title="#authorize-specific-nodes" xlink:actuate="onRequest" xlink:href="#authorize-specific-nodes" xlink:show="new" xlink:title="#authorize-specific-nodes" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="415.0716" y="601.1961">jump</text></a><rect fill="#F1F1F1" height="54.5662" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="81.9894" x="475.2826" y="531.9006"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="481.688" y="546.6299">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="481.688" y="557.0687"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="69.1786" x="481.688" y="567.5076">1. 完成上一节课</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="64.0543" x="481.688" y="577.9464">2. 熟悉libp2p</text><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="39.7136" x="589.2992" y="547.5588"/><a href="https://wiki.polkadot.network/docs/faq#networking" target="_top" title="https://wiki.polkadot.network/docs/faq#networking" xlink:actuate="onRequest" xlink:href="https://wiki.polkadot.network/docs/faq#networking" xlink:show="new" xlink:title="https://wiki.polkadot.network/docs/faq#networking" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="26.9028" x="595.7046" y="562.2882">libp2p</text></a><path d="M557.272,559.1837 L563.6775,559.1837 C573.2856,559.1837 573.2856,559.1837 582.8937,559.1837 L589.2992,559.1837 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M443.2555,598.0916 L449.6609,598.0916 C459.269,598.0916 459.269,559.1837 468.8772,559.1837 L475.2826,559.1837 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="230.5953" x="475.2826" y="599.2776"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="481.688" y="614.007">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="481.688" y="624.4458"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="105.049" x="481.688" y="634.8847">1. 检查并编译节点模板。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="217.7845" x="481.688" y="645.3235">2. 将节点授权托盘(pallet)添加到节点模板运行时。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="481.688" y="655.7623">3. 启动多个节点并授权新节点加入。</text><path d="M443.2555,598.0916 L449.6609,598.0916 C459.269,598.0916 459.269,631.7802 468.8772,631.7802 L475.2826,631.7802 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,598.0916 290.8063,598.0916 L297.2118,598.0916 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="131.9518" x="297.2118" y="731.6598"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="94.8003" x="303.6172" y="746.3891">monitor node metrics</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#monitor-node-metrics" target="_top" title="#monitor-node-metrics" xlink:actuate="onRequest" xlink:href="#monitor-node-metrics" xlink:show="new" xlink:title="#monitor-node-metrics" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="400.9797" y="746.3891">jump</text></a><rect fill="#F1F1F1" height="54.5662" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="153.7302" x="461.1907" y="677.0935"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="467.5961" y="691.8229">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="467.5961" y="702.2617"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="140.9194" x="467.5961" y="712.7006">完成Build a local blockchain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="110.1733" x="467.5961" y="723.1394">完成Simulate a network</text><path d="M429.1635,743.2846 L435.569,743.2846 C445.1771,743.2846 445.1771,704.3766 454.7852,704.3766 L461.1907,704.3766 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="297.2118" x="461.1907" y="744.4706"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="467.5961" y="759.2">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="467.5961" y="769.6388"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="467.5961" y="780.0776">1. 安装 Prometheus 和 Grafana。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="249.8116" x="467.5961" y="790.5165">2. 配置 Prometheus 以捕获 Substrate 节点的时间序列。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="284.4009" x="467.5961" y="800.9553">3. 配置 Grafana 以可视化使用 Prometheus 端点收集的节点指标。</text><path d="M429.1635,743.2846 L435.569,743.2846 C445.1771,743.2846 445.1771,776.9731 454.7852,776.9731 L461.1907,776.9731 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,743.2846 290.8063,743.2846 L297.2118,743.2846 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="157.5735" x="297.2118" y="876.8527"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="120.422" x="303.6172" y="891.5821">Upgrade a running network</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#upgrade-a-running-network" target="_top" title="#upgrade-a-running-network" xlink:actuate="onRequest" xlink:href="#upgrade-a-running-network" xlink:show="new" xlink:title="#upgrade-a-running-network" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="426.6014" y="891.5821">jump</text></a><rect fill="#F1F1F1" height="54.5662" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="270.309" x="486.8124" y="822.2865"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="493.2178" y="837.0159">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="493.2178" y="847.4547"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="493.2178" y="857.8936">1. Build a local blockchain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="257.4981" x="493.2178" y="868.3324">2. 从 Add a pallet to the runtime 了解如何添加pallet</text><path d="M454.7852,888.4776 L461.1907,888.4776 C470.7988,888.4776 470.7988,849.5696 480.4069,849.5696 L486.8124,849.5696 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="303.6172" x="486.8124" y="889.6636"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="493.2178" y="904.3929">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="493.2178" y="914.8318"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="290.8063" x="493.2178" y="925.2706">1. 使用 Sudo 托盘(sudo pallet)模拟链升级的治理(governance)。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="176.7898" x="493.2178" y="935.7095">2. 升级运行节点的运行时以包含新的托盘。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="96.0814" x="493.2178" y="946.1483">3. 为运行时安排升级。</text><path d="M454.7852,888.4776 L461.1907,888.4776 C470.7988,888.4776 470.7988,922.1661 480.4069,922.1661 L486.8124,922.1661 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M265.1846,483.7398 L271.5901,483.7398 C281.1982,483.7398 281.1982,888.4776 290.8063,888.4776 L297.2118,888.4776 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M102.4868,1339.2394 L108.8922,1339.2394 C118.5004,1339.2394 118.5004,483.7398 128.1085,483.7398 L134.5139,483.7398 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="174.2276" x="134.5139" y="1151.5805"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="74.3029" x="140.9194" y="1166.3098">Work with pallets</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#work-with-pallets" target="_top" title="#work-with-pallets" xlink:actuate="onRequest" xlink:href="#work-with-pallets" xlink:show="new" xlink:title="#work-with-pallets" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="217.7845" y="1166.3098">jump</text></a><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="140.9194" y="1176.7487"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="161.4167" x="140.9194" y="1187.1875">通过示例介绍pallets的结构和相关使用</text><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="153.7302" x="340.7687" y="1016.8263"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="116.5787" x="347.1741" y="1031.5557">Add a pallet to the runtime</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#add-a-pallet-to-the-runtime" target="_top" title="#add-a-pallet-to-the-runtime" xlink:actuate="onRequest" xlink:href="#add-a-pallet-to-the-runtime" xlink:show="new" xlink:title="#add-a-pallet-to-the-runtime" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="466.315" y="1031.5557">jump</text></a><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="151.168" x="526.526" y="967.4795"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="532.9314" y="982.2089">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="532.9314" y="992.6477"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="532.9314" y="1003.0865">1. Build a local blockchain</text><path d="M494.4989,1028.4512 L500.9043,1028.4512 C510.5124,1028.4512 510.5124,989.5432 520.1206,989.5432 L526.526,989.5432 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="316.428" x="526.526" y="1024.4177"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="532.9314" y="1039.1471">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="532.9314" y="1049.5859"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="185.7573" x="532.9314" y="1060.0248">1. 了解如何更新运行时依赖项以包含新托盘。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="303.6172" x="532.9314" y="1070.4636">2. 了解如何配置特定于托盘(pallet-specific)的 Rust 特征(trait)。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="230.5953" x="532.9314" y="1080.9025">3. 通过使用前端模板与新托盘交互来查看运行时的更改。</text><path d="M494.4989,1028.4512 L500.9043,1028.4512 C510.5124,1028.4512 510.5124,1056.9203 520.1206,1056.9203 L526.526,1056.9203 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M308.7415,1173.6441 L315.1469,1173.6441 C324.7551,1173.6441 324.7551,1028.4512 334.3632,1028.4512 L340.7687,1028.4512 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="167.8222" x="340.7687" y="1141.1416"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="130.6707" x="347.1741" y="1155.871">Configure the contracts pallet</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#configure-the-contracts-pallet" target="_top" title="#configure-the-contracts-pallet" xlink:actuate="onRequest" xlink:href="#configure-the-contracts-pallet" xlink:show="new" xlink:title="#configure-the-contracts-pallet" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="480.4069" y="1155.871">jump</text></a><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="151.168" x="540.6179" y="1102.2337"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="547.0234" y="1116.963">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="547.0234" y="1127.4019"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="547.0234" y="1137.8407">1. Build a local blockchain</text><path d="M508.5908,1152.7665 L514.9962,1152.7665 C524.6044,1152.7665 524.6044,1124.2973 534.2125,1124.2973 L540.6179,1124.2973 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="540.6179" y="1159.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="547.0234" y="1173.9012">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="547.0234" y="1184.3401"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="547.0234" y="1194.7789"/><path d="M508.5908,1152.7665 L514.9962,1152.7665 C524.6044,1152.7665 524.6044,1181.2356 534.2125,1181.2356 L540.6179,1181.2356 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M308.7415,1173.6441 L315.1469,1173.6441 C324.7551,1173.6441 324.7551,1152.7665 334.3632,1152.7665 L340.7687,1152.7665 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="169.7438" x="340.7687" y="1286.3346"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="132.5923" x="347.1741" y="1301.064">Use macros in a custom pallet</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#use-macros-in-a-custom-pallet" target="_top" title="#use-macros-in-a-custom-pallet" xlink:actuate="onRequest" xlink:href="#use-macros-in-a-custom-pallet" xlink:show="new" xlink:title="#use-macros-in-a-custom-pallet" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="482.3286" y="1301.064">jump</text></a><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="151.168" x="542.5396" y="1216.1101"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="548.945" y="1230.8395">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="548.945" y="1241.2783"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="548.945" y="1251.7172"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="548.945" y="1262.156">1. Build a local blockchain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="107.6112" x="548.945" y="1272.5948">2. Simulate a network</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="93.5192" x="548.945" y="1283.0337">3. 需要1～2h编译运行</text><path d="M510.5124,1297.9594 L516.9179,1297.9594 C526.526,1297.9594 526.526,1253.8321 536.1341,1253.8321 L542.5396,1253.8321 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="220.3466" x="542.5396" y="1304.3649"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="548.945" y="1319.0942">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="548.945" y="1329.5331"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="122.9842" x="548.945" y="1339.9719">1. 了解定制托盘的基本结构。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="207.5358" x="548.945" y="1350.4108">2. 查看 Rust 宏如何简化需要编写的代码的示例。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="176.7898" x="548.945" y="1360.8496">3. 启动一个包含自定义托盘的区块链节点。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="158.8546" x="548.945" y="1371.2884">4. 添加暴露存在证明托盘的前端代码。</text><path d="M510.5124,1297.9594 L516.9179,1297.9594 C526.526,1297.9594 526.526,1342.0868 536.1341,1342.0868 L542.5396,1342.0868 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M308.7415,1173.6441 L315.1469,1173.6441 C324.7551,1173.6441 324.7551,1297.9594 334.3632,1297.9594 L340.7687,1297.9594 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M102.4868,1339.2394 L108.8922,1339.2394 C118.5004,1339.2394 118.5004,1173.6441 128.1085,1173.6441 L134.5139,1173.6441 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="145.4032" x="134.5139" y="1662.1279"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="108.2517" x="140.9194" y="1676.8573">Develop smart contracts</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#develop-smart-contracts" target="_top" title="#develop-smart-contracts" xlink:actuate="onRequest" xlink:href="#develop-smart-contracts" xlink:show="new" xlink:title="#develop-smart-contracts" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="251.7332" y="1676.8573">jump</text></a><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="140.9194" y="1687.2961"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="140.9194" y="1697.735"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="151.168" x="311.9442" y="1441.9664"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="114.0166" x="318.3497" y="1456.6958">Prepare your first contract</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#prepare-your-first-contract" target="_top" title="#prepare-your-first-contract" xlink:actuate="onRequest" xlink:href="#prepare-your-first-contract" xlink:show="new" xlink:title="#prepare-your-first-contract" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="434.9284" y="1456.6958">jump</text></a><rect fill="#F1F1F1" height="33.6885" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="495.1394" y="1392.6196"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="501.5448" y="1407.349">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="501.5448" y="1417.7878"/><path d="M463.1123,1453.5913 L469.5177,1453.5913 C479.1258,1453.5913 479.1258,1409.4639 488.734,1409.4639 L495.1394,1409.4639 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="210.098" x="495.1394" y="1439.119"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="501.5448" y="1453.8484">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="501.5448" y="1464.2872"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="501.5448" y="1474.7261">1. 了解如何创建智能合约项目。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="197.2871" x="501.5448" y="1485.1649">2. 使用ink!智能合约语言构建和测试智能合约。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="188.3195" x="501.5448" y="1495.6037">3. 在本地 Substrate 节点上部署智能合约。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="501.5448" y="1506.0426">4. 通过浏览器与智能合约交互。</text><path d="M463.1123,1453.5913 L469.5177,1453.5913 C479.1258,1453.5913 479.1258,1476.841 488.734,1476.841 L495.1394,1476.841 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M279.9171,1684.1916 L286.3225,1684.1916 C295.9307,1684.1916 295.9307,1453.5913 305.5388,1453.5913 L311.9442,1453.5913 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="147.9653" x="311.9442" y="1581.94"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="110.8139" x="318.3497" y="1596.6693">Develop a smart contract</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#develop-a-smart-contract" target="_top" title="#develop-a-smart-contract" xlink:actuate="onRequest" xlink:href="#develop-a-smart-contract" xlink:show="new" xlink:title="#develop-a-smart-contract" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="431.7257" y="1596.6693">jump</text></a><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="166.5411" x="491.9367" y="1527.3738"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="498.3421" y="1542.1031">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="498.3421" y="1552.542"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="498.3421" y="1562.9808">1. Prepare your first contract</text><path d="M459.9096,1593.5648 L466.315,1593.5648 C475.9231,1593.5648 475.9231,1549.4375 485.5313,1549.4375 L491.9367,1549.4375 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="171.6654" x="491.9367" y="1584.312"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="498.3421" y="1599.0414">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="498.3421" y="1609.4802"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="498.3421" y="1619.919">1. 了解如何使用智能合约模板。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="122.9842" x="498.3421" y="1630.3579">2. 使用智能合约存储简单值。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="158.8546" x="498.3421" y="1640.7967">3. 使用智能合约增加和检索存储的值。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="498.3421" y="1651.2356">4. 向智能合约添加公共和私有功能。</text><path d="M459.9096,1593.5648 L466.315,1593.5648 C475.9231,1593.5648 475.9231,1622.034 485.5313,1622.034 L491.9367,1622.034 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M279.9171,1684.1916 L286.3225,1684.1916 C295.9307,1684.1916 295.9307,1593.5648 305.5388,1593.5648 L311.9442,1593.5648 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="159.4951" x="311.9442" y="1706.2553"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="122.3436" x="318.3497" y="1720.9847">Use maps for storing values</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#use-maps-for-storing-values" target="_top" title="#use-maps-for-storing-values" xlink:actuate="onRequest" xlink:href="#use-maps-for-storing-values" xlink:show="new" xlink:title="#use-maps-for-storing-values" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="443.2555" y="1720.9847">jump</text></a><rect fill="#F1F1F1" height="33.6885" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="503.4665" y="1672.5668"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="509.8719" y="1687.2961">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="509.8719" y="1697.735"/><path d="M471.4393,1717.8801 L477.8448,1717.8801 C487.4529,1717.8801 487.4529,1689.411 497.061,1689.411 L503.4665,1689.411 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="44.1274" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="503.4665" y="1719.0662"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="509.8719" y="1733.7955">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="509.8719" y="1744.2343"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="509.8719" y="1754.6732"/><path d="M471.4393,1717.8801 L477.8448,1717.8801 C487.4529,1717.8801 487.4529,1741.1298 497.061,1741.1298 L503.4665,1741.1298 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M279.9171,1684.1916 L286.3225,1684.1916 C295.9307,1684.1916 295.9307,1717.8801 305.5388,1717.8801 L311.9442,1717.8801 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="131.9518" x="311.9442" y="1846.2289"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="94.8003" x="318.3497" y="1860.9582">Buid a token contract</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#build-a-token-contract" target="_top" title="#build-a-token-contract" xlink:actuate="onRequest" xlink:href="#build-a-token-contract" xlink:show="new" xlink:title="#build-a-token-contract" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="415.7121" y="1860.9582">jump</text></a><rect fill="#F1F1F1" height="65.0051" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="166.5411" x="475.9231" y="1776.0044"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="482.3286" y="1790.7337">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="482.3286" y="1801.1726"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="482.3286" y="1811.6114"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="482.3286" y="1822.0503">1. Prepare your first contract</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="482.3286" y="1832.4891">2. Develop a smart contract</text><path d="M443.896,1857.8537 L450.3014,1857.8537 C459.9096,1857.8537 459.9096,1808.5069 469.5177,1808.5069 L475.9231,1808.5069 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="85.8827" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="212.6601" x="475.9231" y="1853.8203"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="482.3286" y="1868.5496">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="482.3286" y="1878.9885"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="199.8493" x="482.3286" y="1889.4273">1. 了解 ERC-20 标准中定义的基本属性和接口。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="146.0437" x="482.3286" y="1899.8662">2. 创建符合 ERC-20 标准的代币。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="105.049" x="482.3286" y="1910.305">3. 在合约之间转移代币。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="185.7573" x="482.3286" y="1920.7439">4. 处理涉及批准或第三方的转移活动的路由。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="482.3286" y="1931.1827">5. 创建与令牌活动相关的事件。</text><path d="M443.896,1857.8537 L450.3014,1857.8537 C459.9096,1857.8537 459.9096,1896.7617 469.5177,1896.7617 L475.9231,1896.7617 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M279.9171,1684.1916 L286.3225,1684.1916 C295.9307,1684.1916 295.9307,1857.8537 305.5388,1857.8537 L311.9442,1857.8537 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="168.4627" x="311.9442" y="1952.5139"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="131.3112" x="318.3497" y="1967.2432">Troubleshoot smart contracts</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#troubleshoot-smart-contracts" target="_top" title="#troubleshoot-smart-contracts" xlink:actuate="onRequest" xlink:href="#troubleshoot-smart-contracts" xlink:show="new" xlink:title="#troubleshoot-smart-contracts" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="452.2231" y="1967.2432">jump</text></a><path d="M279.9171,1684.1916 L286.3225,1684.1916 C295.9307,1684.1916 295.9307,1964.1387 305.5388,1964.1387 L311.9442,1964.1387 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M102.4868,1339.2394 L108.8922,1339.2394 C118.5004,1339.2394 118.5004,1684.1916 128.1085,1684.1916 L134.5139,1684.1916 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="153.0897" x="134.5139" y="2315.4964"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="115.9382" x="140.9194" y="2330.2257">Connect with other chains</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-with-other-chains" target="_top" title="#connect-with-other-chains" xlink:actuate="onRequest" xlink:href="#connect-with-other-chains" xlink:show="new" xlink:title="#connect-with-other-chains" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="259.4197" y="2330.2257">jump</text></a><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="137.0761" x="319.6307" y="2058.7989"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="99.9246" x="326.0362" y="2073.5283">Start a local relay chain</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#start-a-local-relay-chain" target="_top" title="#start-a-local-relay-chain" xlink:actuate="onRequest" xlink:href="#start-a-local-relay-chain" xlink:show="new" xlink:title="#start-a-local-relay-chain" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="428.523" y="2073.5283">jump</text></a><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="151.168" x="488.734" y="1988.5744"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="495.1394" y="2003.3038">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="495.1394" y="2013.7426"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="495.1394" y="2024.1815">1. Build a local blockchain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="102.4868" x="495.1394" y="2034.6203">2. Add trusted nodes</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="78.1462" x="495.1394" y="2045.0592">3. 了解波卡的架构</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="60.211" x="495.1394" y="2055.498">4. 了解平行链</text><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="118.5004" x="671.9292" y="1996.6413"/><a href="https://wiki.polkadot.network/docs/learn-architecture" target="_top" title="https://wiki.polkadot.network/docs/learn-architecture" xlink:actuate="onRequest" xlink:href="https://wiki.polkadot.network/docs/learn-architecture" xlink:show="new" xlink:title="https://wiki.polkadot.network/docs/learn-architecture" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="105.6895" x="678.3346" y="2011.3706">Atchitecture of Polkadot</text></a><path d="M639.902,2026.2964 L646.3075,2026.2964 C655.9156,2026.2964 655.9156,2008.2661 665.5237,2008.2661 L671.9292,2008.2661 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="60.8515" x="671.9292" y="2032.7018"/><a href="https://wiki.polkadot.network/docs/learn-parachains" target="_top" title="https://wiki.polkadot.network/docs/learn-parachains" xlink:actuate="onRequest" xlink:href="https://wiki.polkadot.network/docs/learn-parachains" xlink:show="new" xlink:title="https://wiki.polkadot.network/docs/learn-parachains" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="48.0407" x="678.3346" y="2047.4312">Parachains</text></a><path d="M639.902,2026.2964 L646.3075,2026.2964 C655.9156,2026.2964 655.9156,2044.3267 665.5237,2044.3267 L671.9292,2044.3267 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M456.7069,2070.4238 L463.1123,2070.4238 C472.7204,2070.4238 472.7204,2026.2964 482.3286,2026.2964 L488.734,2026.2964 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="179.3519" x="488.734" y="2076.8292"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="495.1394" y="2091.5585">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="495.1394" y="2101.9974"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="78.1462" x="495.1394" y="2112.4362">1. 确认软件需求。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="166.5411" x="495.1394" y="2122.8751">2. 设置平行链(para chain)构建环境。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="495.1394" y="2133.3139">3. 准备中继链(relay chain)规格。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="96.0814" x="495.1394" y="2143.7528">4. 在本地启动中继链。</text><path d="M456.7069,2070.4238 L463.1123,2070.4238 C472.7204,2070.4238 472.7204,2114.5511 482.3286,2114.5511 L488.734,2114.5511 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M287.6036,2327.1212 L294.009,2327.1212 C303.6172,2327.1212 303.6172,2070.4238 313.2253,2070.4238 L319.6307,2070.4238 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="150.5275" x="319.6307" y="2232.461"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="113.376" x="326.0362" y="2247.1904">Connect a local parachain</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-a-local-parachain" target="_top" title="#connect-a-local-parachain" xlink:actuate="onRequest" xlink:href="#connect-a-local-parachain" xlink:show="new" xlink:title="#connect-a-local-parachain" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="441.9744" y="2247.1904">jump</text></a><rect fill="#F1F1F1" height="54.5662" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="245.9683" x="502.1854" y="2165.084"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="508.5908" y="2179.8133">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="508.5908" y="2190.2521"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="143.4815" x="508.5908" y="2200.691">1. Start a local relay chain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="233.1575" x="508.5908" y="2211.1298">2. 注意与1的波卡版本一致，比如： polkadot-v0.9.24</text><path d="M470.1583,2244.0859 L476.5637,2244.0859 C486.1718,2244.0859 486.1718,2192.3671 495.78,2192.3671 L502.1854,2192.3671 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="220.9872" x="502.1854" y="2232.461"/><a href="https://github.com/substrate-developer-hub/substrate-parachain-template/tree/polkadot-v0.9.24" target="_top" title="https://github.com/substrate-developer-hub/substrate-parachain-template/tree/polkadot-v0.9.24" xlink:actuate="onRequest" xlink:href="https://github.com/substrate-developer-hub/substrate-parachain-template/tree/polkadot-v0.9.24" xlink:show="new" xlink:title="https://github.com/substrate-developer-hub/substrate-parachain-template/tree/polkadot-v0.9.24" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="208.1763" x="508.5908" y="2247.1904">polkadot-v0.9.24/substrate-parachain-template</text></a><path d="M470.1583,2244.0859 L476.5637,2244.0859 C486.1718,2244.0859 486.1718,2244.0859 495.78,2244.0859 L502.1854,2244.0859 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="54.5662" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="207.5358" x="502.1854" y="2268.5216"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="508.5908" y="2283.2509">目标内容</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="508.5908" y="2293.6898"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="194.7249" x="508.5908" y="2304.1286">1. 在中继链上为你的平行链注册一个 ParaID。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="508.5908" y="2314.5674">2. 在中继链上开始生产平行链。</text><path d="M470.1583,2244.0859 L476.5637,2244.0859 C486.1718,2244.0859 486.1718,2295.8047 495.78,2295.8047 L502.1854,2295.8047 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M287.6036,2327.1212 L294.009,2327.1212 C303.6172,2327.1212 303.6172,2244.0859 313.2253,2244.0859 L319.6307,2244.0859 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="157.5735" x="319.6307" y="2380.026"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="120.422" x="326.0362" y="2394.7554">Connect to Rococo testnet</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#connect-to-rococo-testnet" target="_top" title="#connect-to-rococo-testnet" xlink:actuate="onRequest" xlink:href="#connect-to-rococo-testnet" xlink:show="new" xlink:title="#connect-to-rococo-testnet" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="449.0203" y="2394.7554">jump</text></a><rect fill="#F1F1F1" height="75.4439" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="156.2924" x="509.2313" y="2335.8986"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="515.6368" y="2350.628">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="515.6368" y="2361.0668"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="125.5463" x="515.6368" y="2371.5057">1. 回顾Add trusted nodes:</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="117.8598" x="515.6368" y="2381.9445">- 如何生成并修改链规范文件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="93.5192" x="515.6368" y="2392.3834">- 如何生成和存储keys</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="143.4815" x="515.6368" y="2402.8222">2. Connect a local parachain</text><path d="M477.2042,2391.6509 L483.6096,2391.6509 C493.2178,2391.6509 493.2178,2373.6206 502.8259,2373.6206 L509.2313,2373.6206 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="509.2313" y="2424.1534"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="515.6368" y="2438.8828">目标内容</text><path d="M477.2042,2391.6509 L483.6096,2391.6509 C493.2178,2391.6509 493.2178,2435.7782 502.8259,2435.7782 L509.2313,2435.7782 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M287.6036,2327.1212 L294.009,2327.1212 C303.6172,2327.1212 303.6172,2391.6509 313.2253,2391.6509 L319.6307,2391.6509 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="134.5139" x="319.6307" y="2551.3161"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="97.3625" x="326.0362" y="2566.0455">Access EVM accounts</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#access-evm-accounts" target="_top" title="#access-evm-accounts" xlink:actuate="onRequest" xlink:href="#access-evm-accounts" xlink:show="new" xlink:title="#access-evm-accounts" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" text-decoration="underline" textLength="21.7784" x="425.9608" y="2566.0455">jump</text></a><rect fill="#F1F1F1" height="169.3935" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="274.1522" x="486.1718" y="2460.2139"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="492.5772" y="2474.9433">前置条件</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="0" x="492.5772" y="2485.3821"/><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="53.8056" x="492.5772" y="2495.821">一、完成课程</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="138.3572" x="492.5772" y="2506.2598">1. Build a local blockchain</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="153.7302" x="492.5772" y="2516.6987">2. Add a pallet to the runtime</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="163.9789" x="492.5772" y="2527.1375">3. Use macros in a custom pallet</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="53.8056" x="492.5772" y="2537.5764">二、熟悉操作</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="161.4167" x="492.5772" y="2548.0152">1. 启动一个 Substrate 区块链节点。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="149.887" x="492.5772" y="2558.454">2. 在运行时添加、移除和配置托盘。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="261.3414" x="492.5772" y="2568.8929">3. 通过使用 Polkadot-JS 或其他前端连接到节点来提交交易。</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="53.8056" x="492.5772" y="2579.3317">三、掌握概念</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="105.049" x="492.5772" y="2589.7706">1. 以太坊核心概念和术语</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="140.9194" x="492.5772" y="2600.2094">2. 以太坊虚拟机 (EVM) 基础知识</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="131.9518" x="492.5772" y="2610.6482">3. 去中心化应用程序和智能合约</text><text fill="#000000" font-family="monospace" font-size="8.9676" lengthAdjust="spacing" textLength="69.1786" x="492.5772" y="2621.0871">4. 托盘设计原则</text><path d="M454.1447,2562.941 L460.5501,2562.941 C470.1583,2562.941 470.1583,2544.9107 479.7664,2544.9107 L486.1718,2544.9107 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><rect fill="#F1F1F1" height="23.2497" rx="8.0068" ry="8.0068" style="stroke:#181818;stroke-width:0.9608138658628484;" width="48.6812" x="486.1718" y="2642.4183"/><text fill="#000000" font-family="sans-serif" font-size="8.9676" lengthAdjust="spacing" textLength="35.8704" x="492.5772" y="2657.1476">目标内容</text><path d="M454.1447,2562.941 L460.5501,2562.941 C470.1583,2562.941 470.1583,2654.0431 479.7664,2654.0431 L486.1718,2654.0431 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M287.6036,2327.1212 L294.009,2327.1212 C303.6172,2327.1212 303.6172,2562.941 313.2253,2562.941 L319.6307,2562.941 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/><path d="M102.4868,1339.2394 L108.8922,1339.2394 C118.5004,1339.2394 118.5004,2327.1212 128.1085,2327.1212 L134.5139,2327.1212 " fill="none" style="stroke:#181818;stroke-width:0.640542577241899;"/></g></svg></figure>
<h1 id="get-started"><a class="header" href="#get-started">Get Started</a></h1>
<h2 id="build-a-local-blockchain"><a class="header" href="#build-a-local-blockchain">Build a local blockchain</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="564px" preserveAspectRatio="none" style="width:951px;height:564px;background:#FFFFFF;" version="1.1" viewBox="0 0 951 564" width="951px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="211" x="10" y="262.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="20" y="285.9639">Build a local blockchain</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="28" x="183" y="285.9639">返回</text></a><rect fill="#F1F1F1" height="101.4844" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="628" x="271" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="281" y="42.9951">Compile a Substrate node:</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="0" x="281" y="59.292"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="608" x="281" y="75.5889">git clone https://github.com/substrate-developer-hub/substrate-node-template</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="392" x="281" y="91.8857">cd substrate-node-template &amp;&amp; git checkout latest</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="168" x="281" y="108.1826">cargo build --release</text><path d="M221,281.1172 L231,281.1172 C246,281.1172 246,70.7422 261,70.7422 L271,70.7422 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="68.8906" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="308" x="271" y="141.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="281" y="164.4795">Start the local node:</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="0" x="281" y="180.7764"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="288" x="281" y="197.0732">./target/release/node-template --dev</text><path d="M221,281.1172 L231,281.1172 C246,281.1172 246,175.9297 261,175.9297 L271,175.9297 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="150.375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="668" x="271" y="230.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="204" x="281" y="253.3701">Install the front-end template:</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="0" x="281" y="269.667"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="112" x="281" y="285.9639">node --version</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="112" x="281" y="302.2607">yarn --version</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="152" x="281" y="318.5576">npm install -g yarn</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="648" x="281" y="334.8545">git clone https://github.com/substrate-developer-hub/substrate-front-end-template</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="248" x="281" y="351.1514">cd substrate-front-end-template</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="96" x="281" y="367.4482">yarn install</text><path d="M221,281.1172 L231,281.1172 C246,281.1172 246,305.5625 261,305.5625 L271,305.5625 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="85.1875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="588" x="271" y="400.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="281" y="423.7451">Start the front-end template:</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="0" x="281" y="440.042"/><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="80" x="281" y="456.3389">yarn start</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="568" x="281" y="472.6357">Open http://localhost:8000 in a browser to view the front-end template.</text><path d="M221,281.1172 L231,281.1172 C246,281.1172 246,443.3438 261,443.3438 L271,443.3438 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="236" x="271" y="505.9375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="216" x="281" y="528.9326">Transfer funds from an account</text><path d="M221,281.1172 L231,281.1172 C246,281.1172 246,524.0859 261,524.0859 L271,524.0859 " fill="none" style="stroke:#181818;stroke-width:1.0;"/></g></svg></figure>
<blockquote>
<p>这里主要使用官方提供的默认模版启动节点。</p>
</blockquote>
<ul>
<li><a href="https://docs.substrate.io/tutorials/get-started/build-local-blockchain/">Build a local blockchain | Substrate_ Docs</a></li>
</ul>
<div id="admonition-一定要注意文档是否更新" class="admonition note">
<div class="admonition-title">
<p>一定要注意文档是否更新</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-一定要注意文档是否更新"></a></p>
</div>
<div>
<p>由于rust对crate的版本只能检查，无法解决冲突问题，需要手动进行，所以一定要注意文档是否有更新，尤其是里面的代码</p>
</div>
</div>
<p><a href="https://github.com/substrate-developer-hub/substrate-docs/issues/1132">New Substrate documentation released · Issue #1132 · substrate-developer-hub/substrate-docs</a></p>
<blockquote>
<p>另外，substrate官方文档也一直处在更新状态中。</p>
</blockquote>
<h3 id="设置开发环境"><a class="header" href="#设置开发环境">设置开发环境</a></h3>
<h4 id="使用rustup设置rust环境"><a class="header" href="#使用rustup设置rust环境">使用rustup设置rust环境</a></h4>
<pre><code class="language-shell"># 1.安装预编译包
sudo apt update &amp;&amp; sudo apt install -y git clang curl libssl-dev llvm libudev-dev

# 2.安装Rust编译环境
curl https://sh.rustup.rs -sSf | sh
source ~/.cargo/env
rustup default stable
rustup update
rustup update nightly
rustup target add wasm32-unknown-unknown --toolchain nightly
</code></pre>
<h4 id="检查环境"><a class="header" href="#检查环境">检查环境</a></h4>
<pre><code class="language-shell">rustc --version
rustup show
</code></pre>
<h3 id="启动链节点"><a class="header" href="#启动链节点">启动链节点</a></h3>
<div id="admonition-node-template" class="admonition info">
<div class="admonition-title">
<p>node-template</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-node-template"></a></p>
</div>
<div>
<p>node-template实际上是官方提供的使用substrate开发的模板链，可以理解为substrate官方提供的样例，后续任何人想使用substrate可以在这个样例的基础上进行修改，这样开发链就更方便。</p>
<blockquote>
<p>这就好比以前的好多山寨链，在btc的源码上改下创世区块的配置，就是一条新链。那么substrate其实也一样，提供了node-template这样一个模板，后续根据需求在这个上面改吧改吧，就能产生一条新链。</p>
</blockquote>
</div>
</div>
<h4 id="下载node-template"><a class="header" href="#下载node-template">下载node-template</a></h4>
<pre><code class="language-shell">git clone https://github.com/substrate-developer-hub/substrate-node-template
cd substrate-node-template
git checkout latest
</code></pre>
<div id="admonition-注意查看最新分支的编号" class="admonition note">
<div class="admonition-title">
<p>⚠️注意查看最新分支的编号</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-注意查看最新分支的编号"></a></p>
</div>
<div>
<p>/home/substrate-node-template on  #polkadot-v0.9.24</p>
</div>
</div>
<h4 id="node-templeate项目结构"><a class="header" href="#node-templeate项目结构">node-templeate项目结构</a></h4>
<div id="admonition-node-template项目结构" class="admonition info">
<div class="admonition-title">
<p>node-template项目结构</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-node-template项目结构"></a></p>
</div>
<div>
<pre><code class="language-shell">tree -L 2                                                                                                                                                                                                                              ─╯
.
├── Cargo.lock
├── Cargo.toml
├── LICENSE
├── README.md
├── docker-compose.yml
├── docs
│   └── rust-setup.md
├── node
│   ├── Cargo.toml
│   ├── build.rs
│   └── src
├── pallets
│   └── template
├── runtime
│   ├── Cargo.toml
│   ├── build.rs
│   └── src
├── rustfmt.toml
├── scripts
│   ├── docker_run.sh
│   └── init.sh
├── shell.nix
└── target
    ├── CACHEDIR.TAG
    └── release

10 directories, 15 files
</code></pre>
</div>
</div>
<h4 id="cargotoml"><a class="header" href="#cargotoml">Cargo.toml</a></h4>
<pre><code class="language-toml">[workspace]
members = [
    &quot;node&quot;,
    &quot;pallets/template&quot;,
    &quot;runtime&quot;,
]
[profile.release]
panic = &quot;unwind&quot;
</code></pre>
<blockquote>
<p>可见node-template主要包含三部分：node、pallets/template、runtime</p>
</blockquote>
<h4 id="编译前的检查"><a class="header" href="#编译前的检查">编译前的检查</a></h4>
<pre><code class="language-shell">cargo check -p node-template-runtime
</code></pre>
<div id="admonition-idea将会在修改cargotoml之后自动执行指令进行检查" class="admonition tip">
<div class="admonition-title">
<p>IDEA将会在修改Cargo.toml之后自动执行指令进行检查</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-idea将会在修改cargotoml之后自动执行指令进行检查"></a></p>
</div>
<div>
<pre><code class="language-shell">cargo metadata --verbose --format-version 1 --all-features
</code></pre>
</div>
</div>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/commands/cargo-metadata.html">cargo metadata - The Cargo Book</a></li>
</ul>
<blockquote>
<p>Output JSON to stdout containing information about the workspace members and resolved dependencies of the current
package.</p>
</blockquote>
<p>It is recommended to include the –format-version flag to future-proof your code to ensure the output is in the format
you are expecting.</p>
<h4 id="编译"><a class="header" href="#编译">编译</a></h4>
<pre><code class="language-shell">cargo build --release
</code></pre>
<blockquote>
<p>这个过程比较慢，会下载并编译上面三部分内的Cargo.toml列出的所有包</p>
</blockquote>
<h4 id="可能遇到的问题"><a class="header" href="#可能遇到的问题">可能遇到的问题</a></h4>
<ul>
<li>安装cmake</li>
</ul>
<pre><code class="language-shell">brew install cmake
</code></pre>
<h4 id="本地运行节点"><a class="header" href="#本地运行节点">本地运行节点</a></h4>
<pre><code class="language-shell">./target/release/node-template --dev
</code></pre>
<h4 id="docker运行节点"><a class="header" href="#docker运行节点">docker运行节点</a></h4>
<h3 id="前端访问"><a class="header" href="#前端访问">前端访问</a></h3>
<p><a href="https://docs.substrate.io/tutorials/get-started/build-local-blockchain/#install-the-front-end-template">Build a local blockchain | Substrate_ Docs</a></p>
<h3 id="使用前端模版"><a class="header" href="#使用前端模版">使用前端模版</a></h3>
<pre><code class="language-shell">node --version
yarn --version
npm install -g yarn
git clone https://github.com/substrate-developer-hub/substrate-front-end-template
cd substrate-front-end-template
yarn install
yarn start
</code></pre>
<blockquote>
<p>启动后访问本地：http://localhost:8000</p>
</blockquote>
<h4 id="使用polkadot-js访问节点"><a class="header" href="#使用polkadot-js访问节点">使用polkadot-js访问节点</a></h4>
<div id="admonition-polkadot-js-app" class="admonition info">
<div class="admonition-title">
<p>polkadot-js-app</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-polkadot-js-app"></a></p>
</div>
<div>
<p>在substrate官方的教程中，是使用了substrate的前端模板来访问刚才启动的节点。但是在实际的开发中，后端人员其实更多的使用polkadot-js-app来访问我们的节点，所以这里我们也使用它来访问我们的节点。</p>
</div>
</div>
<ul>
<li>在浏览器中输入https://polkadot.js.org/apps, 点击左上角会展开；</li>
</ul>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/CleanShot%202022-07-01%20at%2020.08.02%402x.png" alt="CleanShot 2022-07-01 at 20.08.02@2x" /></p>
<ul>
<li>
<p>在展开的菜单中点击DEVELOPMENT；</p>
</li>
<li>
<p>点击Local Node；</p>
</li>
<li>
<p>点击switch。</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/CleanShot%202022-07-01%20at%2020.17.59%402x.png" alt="CleanShot 2022-07-01 at 20.17.59@2x" /></p>
<h3 id="substrate使用方式"><a class="header" href="#substrate使用方式">Substrate使用方式</a></h3>
<blockquote>
<p>使用substrate的方式主要有以下几种：</p>
</blockquote>
<h4 id="使用subtrate-node"><a class="header" href="#使用subtrate-node">使用subtrate node</a></h4>
<p>开发者可以运行已经设计好的substrate节点，并配置genesis区块，在此方式下只需要提供一个json文件就可以启动自己的区块链。其实我们上一节的substrate初体验，也可以看成是使用此种方式的一个例子。</p>
<h4 id="使用substrate-frame"><a class="header" href="#使用substrate-frame">使用substrate frame</a></h4>
<p>frame其实是一组模块（pallet）和支持库。使用substrate frame可以轻松的创建自己的自定义运行时，因为frame是用来构建底层节点的。使用frame还可以配置数据类型，也可以从模块库中选择甚至是添加自己定义的模块。</p>
<h4 id="使用substrate-core"><a class="header" href="#使用substrate-core">使用substrate core</a></h4>
<p>使用substrate code运行开发者完全从头开始设计运行时（runtime，问题：什么是runtime？），当然此种方式也是使用substrate自由度最大的方式。</p>
<div id="admonition-几种方式的关系可以用图描述如下技术自由-vs-开发便利" class="admonition tip">
<div class="admonition-title">
<p>几种方式的关系可以用图描述如下：技术自由 vs 开发便利</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-几种方式的关系可以用图描述如下技术自由-vs-开发便利"></a></p>
</div>
<div>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/technical-freedom.png" alt="Technical freedom vs development ease" /></p>
</div>
</div>
<h2 id="simulate-a-network"><a class="header" href="#simulate-a-network">Simulate a network</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="689.0656px" preserveAspectRatio="none" style="width:850px;height:689px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 689" width="850.4159px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="76.1008" x="4.1585" y="336.695"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="54.4765" x="8.317" y="346.2575">Simulate a network</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" text-decoration="underline" textLength="11.6438" x="64.4569" y="346.2575">返回</text></a><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="108.5372" x="101.0519" y="109.6645"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="100.2202" x="105.2104" y="119.2271">Start the first alice blockchain node</text><rect fill="#F1F1F1" height="48.9795" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="271.135" x="230.3816" y="8.317"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="61.546" x="234.5401" y="17.8796">清理之前alice的链数据:</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="24.6567"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="262.818" x="234.5401" y="31.4337">./target/release/node-template purge-chain --base-path /tmp/alice --chain local</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="222.8963" x="234.5401" y="38.2108">Are you sure to remove "/tmp/alice/chains/local_testnet/db"? [y/N]:</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="44.9879"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="51.765"/><path d="M209.589,117.2116 L213.7476,117.2116 C219.9853,117.2116 219.9853,32.8068 226.2231,32.8068 L230.3816,32.8068 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#90EE90" height="89.6419" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="257.8278" x="230.3816" y="65.6135"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="36.1791" x="234.5401" y="75.1761">启动alice节点</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="81.9532"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="99.8043" x="234.5401" y="88.7302">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="73.1898" x="234.5401" y="95.5073">--base-path /tmp/alice</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="43.2485" x="234.5401" y="102.2844">--chain local</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="23.2877" x="234.5401" y="109.0615">--alice</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="39.9217" x="234.5401" y="115.8385">--port 30333</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="46.5753" x="234.5401" y="122.6156">--ws-port 9945</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="49.9022" x="234.5401" y="129.3927">--rpc-port 9933</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="249.5108" x="234.5401" y="136.1698">--node-key 0000000000000000000000000000000000000000000000000000000000000001</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="182.9746" x="234.5401" y="142.9468">--telemetry-url "wss://telemetry.polkadot.io/submit/ 0"</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="36.5949" x="234.5401" y="149.7239">--validator</text><path d="M209.589,117.2116 L213.7476,117.2116 C219.9853,117.2116 219.9853,110.4345 226.2231,110.4345 L230.3816,110.4345 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="62.5336" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="234.5401" x="230.3816" y="163.5725"/><a href="https://docs.substrate.io/tutorials/get-started/simulate-network/#review-the-command-line-options" target="_top" title="点击查看" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/simulate-network/#review-the-command-line-options" xlink:show="new" xlink:title="点击查看" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" text-decoration="underline" textLength="97.3092" x="234.5401" y="173.135">Review the command-line options</text></a><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="56.5558" x="234.5401" y="179.9121">For more details:</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="186.6892"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="226.2231" x="234.5401" y="193.4663">./target/release/node-template --help &gt; the-command-line-options.txt</text><rect fill="#000000" height="1.4555" style="stroke:#000000;stroke-width:0.0;" width="1.4555" x="248.6791" y="198.2896"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="2.0793" x="250.7583" y="200.2434">:</text><a href="https://docs.substrate.io/tutorials/get-started/simulate-network/#review-the-node-messages-displayed" target="_top" title="点击查看" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/simulate-network/#review-the-node-messages-displayed" xlink:show="new" xlink:title="点击查看" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" text-decoration="underline" textLength="108.5372" x="252.8376" y="200.2434">Review the node messages displayed</text></a><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="234.5401" y="207.0204"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="109.7847" x="234.5401" y="213.7975">&#128296; Initializing Genesis block/state</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="76.5166" x="234.5401" y="220.5746">&#127991; Local node identity is</text><path d="M209.589,117.2116 L213.7476,117.2116 C219.9853,117.2116 219.9853,194.8393 226.2231,194.8393 L230.3816,194.8393 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><path d="M80.2593,344.242 L84.4178,344.242 C90.6556,344.242 90.6556,117.2116 96.8933,117.2116 L101.0519,117.2116 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="130.3044" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="182.9746" x="101.0519" y="275.3926"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="132.2407" x="105.2104" y="284.9552">Add a second node to the blockchain network</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="291.7323"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="128.0822" x="105.2104" y="298.5093">现在开始使用 alice 帐户密钥的节点正在运行，</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="138.8943" x="105.2104" y="305.2864">接着可以使用 bob 帐户将另一个节点添加到网络中。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="312.0635"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="128.0822" x="105.2104" y="318.8406">因为要加入一个已经在运行的网络，所以可以使用</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="116.4384" x="105.2104" y="325.6176">正在运行的节点来识别新节点要加入的网络。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="332.3947"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="139.726" x="105.2104" y="339.1718">这些命令与之前使用的命令相似，但有一些重要区别。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="46.5753" x="105.2104" y="345.9489">1. --base-path</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="29.9413" x="105.2104" y="352.7259">2. --port</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="39.9217" x="105.2104" y="359.503">3. --ws-port</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="43.2485" x="105.2104" y="366.2801">4. --rpc-port</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="174.6575" x="105.2104" y="373.0572">5. --bootnodes: 指定一个单独启动节点，这个节点来自于alias</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="379.8342"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="79.0117" x="105.2104" y="386.6113">总共有4步，重点介绍后面两步</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="56.5558" x="105.2104" y="393.3884">1. 重新打开一个终端</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="98.1409" x="105.2104" y="400.1655">2. 进入substrate-node-template</text><rect fill="#F1F1F1" height="62.5336" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="183.8063" x="304.819" y="234.4232"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="46.5753" x="310.6409" y="243.9857">清除之前的链数据</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="308.9775" y="250.7628"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="139.726" x="308.9775" y="257.5399">./target/release/node-template purge-chain</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="66.5362" x="308.9775" y="264.3169">--base-path /tmp/bob</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="43.2485" x="308.9775" y="271.094">--chain local</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="6.6536" x="308.9775" y="277.8711">-y</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="308.9775" y="284.6482"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="175.4892" x="308.9775" y="291.4252">通过在命令中添加-y，可以在不提示确认操作的情况下删除链数据。</text><path d="M284.0264,340.5448 L288.1849,340.5448 C294.4227,340.5448 294.4227,265.69 300.6605,265.69 L304.819,265.69 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#90EE90" height="89.6419" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="317.7104" x="304.819" y="305.2738"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="81.091" x="308.9775" y="314.8364">启动第二个节点，用bob的账号</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="308.9775" y="321.6134"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="99.8043" x="308.9775" y="328.3905">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="66.5362" x="308.9775" y="335.1676">--base-path /tmp/bob</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="43.2485" x="308.9775" y="341.9447">--chain local</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="16.6341" x="308.9775" y="348.7217">--bob</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="39.9217" x="308.9775" y="355.4988">--port 30334</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="46.5753" x="308.9775" y="362.2759">--ws-port 9946</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="49.9022" x="308.9775" y="369.053">--rpc-port 9934</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="182.9746" x="308.9775" y="375.8301">--telemetry-url "wss://telemetry.polkadot.io/submit/ 0"</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="36.5949" x="308.9775" y="382.6071">--validator</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="309.3933" x="308.9775" y="389.3842">--bootnodes /ip4/127.0.0.1/tcp/30333/p2p/12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp</text><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="41.5851" x="643.3219" y="253.5231"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="33.2681" x="647.4804" y="263.0856">--base-path</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,261.0701 639.1634,261.0701 L643.3219,261.0701 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="23.7035" x="643.3219" y="276.9342"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="15.3865" x="647.4804" y="286.4968">--bob</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,284.4813 639.1634,284.4813 L643.3219,284.4813 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="24.1194" x="643.3219" y="300.3453"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="15.8023" x="647.4804" y="309.9079">--port</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,307.8924 639.1634,307.8924 L643.3219,307.8924 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="34.0998" x="643.3219" y="323.7565"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="25.7828" x="647.4804" y="333.319">--ws-port</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,331.3035 639.1634,331.3035 L643.3219,331.3035 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="15.0941" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="35.3474" x="643.3219" y="347.1676"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="27.0303" x="647.4804" y="356.7301">--rpc-port</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,354.7146 639.1634,354.7146 L643.3219,354.7146 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#F1F1F1" height="76.0878" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="202.1037" x="643.3219" y="370.5787"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="35.7632" x="647.4804" y="380.1413">--bootnodes</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="647.4804" y="386.9183"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="110.6164" x="647.4804" y="393.6954">ip4 表示节点的 IP 地址使用 IPv4 格式</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="189.6282" x="647.4804" y="400.4725">127.0.0.1 指定运行节点的 IP 地址,在这种情况下，本地主机的地址。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="111.4481" x="647.4804" y="407.2496">tcp 将 TCP 指定为用于对等通信的协议。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="193.7867" x="647.4804" y="414.0266">30333 指定用于点对点通信的端口号,在这种情况下，TCP 流量的端口号。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="647.4804" y="420.8037"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="172.9941" x="647.4804" y="427.5808">12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="93.1507" x="647.4804" y="434.3579">标识该网络要与之通信的运行节点。</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="139.726" x="647.4804" y="441.1349">在这种情况下，节点的标识符开始使用 alice 帐户。</text><path d="M622.5294,350.0948 L626.6879,350.0948 C632.9256,350.0948 632.9256,408.6226 639.1634,408.6226 L643.3219,408.6226 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><path d="M284.0264,340.5448 L288.1849,340.5448 C294.4227,340.5448 294.4227,350.0948 300.6605,350.0948 L304.819,350.0948 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><path d="M80.2593,344.242 L84.4178,344.242 C90.6556,344.242 90.6556,340.5448 96.8933,340.5448 L101.0519,340.5448 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><rect fill="#90EE90" height="225.1835" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="274.4618" x="101.0519" y="454.9835"/><a href="https://docs.substrate.io/tutorials/get-started/simulate-network/#verify-blocks-are-produced-and-finalized" target="_top" title="https://docs.substrate.io/tutorials/get-started/simulate-network/#verify-blocks-are-produced-and-finalized" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/simulate-network/#verify-blocks-are-produced-and-finalized" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/simulate-network/#verify-blocks-are-produced-and-finalized" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" text-decoration="underline" textLength="113.5274" x="105.2104" y="464.5461">Verify blocks are produced and finalized</text></a><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="471.3232"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="104.7945" x="105.2104" y="478.1002">为了方便识别，还在每行前面加了标记：</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="106.4579" x="105.2104" y="484.8773">✌️  version 4.0.0-dev-9c89be106cb</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="259.4912" x="105.2104" y="491.6544">❤️  by Substrate DevHub &lt;https://github.com/substrate-developer-hub&gt;, 2017-2022</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="116.4384" x="105.2104" y="498.4315">&#128203; Chain specification: Local Testnet</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="53.229" x="105.2104" y="505.2085">&#127991;  Node name: Bob</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="53.229" x="105.2104" y="511.9856">&#128100; Role: AUTHORITY</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="196.2818" x="105.2104" y="518.7627">&#128190; Database: RocksDb at /tmp/bob/chains/local_testnet/db/full</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="202.9354" x="105.2104" y="525.5398">⛓  Native runtime: node-template-100 (node-template-1.tx1.au1)</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="266.1448" x="105.2104" y="532.3168">&#128296; Initializing Genesis block/state (state: 0x0336…17a1, header-hash: 0x387f…a9b7)</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="266.1448" x="105.2104" y="539.0939">&#128116; Loading GRANDPA authority set from genesis on what appears to be first startup.</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="256.1644" x="105.2104" y="545.871">Using default protocol ID "sup" because none is configured in the chain specs</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="259.4912" x="105.2104" y="552.6481">&#127991;  Local node identity is: 12D3KooWCPbSKhf9WggmGev8RBwzB5WKDNi9BjA8gjwsA4uDSkxN</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="79.8434" x="105.2104" y="559.4251">&#128187; Operating system: macos</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="83.1703" x="105.2104" y="566.2022">&#128187; CPU architecture: x86_64</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="86.4971" x="105.2104" y="572.9793">&#128230; Highest known block at #0</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="166.3405" x="105.2104" y="579.7564">&#127991;  Local node identity is: &lt;encrypted account name&gt;</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="586.5334"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="149.7065" x="105.2104" y="593.3105">&#128269; Discovered new external address for our node</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="119.7652" x="105.2104" y="600.0876">The first node was started by alice:</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="606.8647"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="123.092" x="105.2104" y="613.6418">&#128164; Idle (1 peers), best... finalized...</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="113.1115" x="105.2104" y="620.4188">The node has a one peer (1 peers).</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="202.9354" x="105.2104" y="627.1959">The nodes have produced some blocks (best: #4 (0x2b8a…fdc4)).</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="199.6086" x="105.2104" y="633.973">The blocks are being finalized (finalized #2 (0x8b6a…dce6)).</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="640.7501"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="89.8239" x="105.2104" y="647.5271">&#128588; Starting consensus session</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="105.2104" y="654.3042"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="119.7652" x="105.2104" y="661.0813">&#127873; Prepared block for proposing at ...</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="123.092" x="105.2104" y="667.8584">&#128278; Pre-sealed block for proposal at ...</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="89.8239" x="105.2104" y="674.6354">✨ Imported #85 (0x5f7a…9b10)</text><rect fill="#F1F1F1" height="96.419" rx="5.1981" ry="5.1981" style="stroke:#181818;stroke-width:0.6237769080234834;" width="311.0568" x="396.3063" y="519.3658"/><text fill="#000000" font-family="sans-serif" font-size="5.8219" lengthAdjust="spacing" textLength="69.863" x="400.4648" y="528.9283">需要关注的标记有两个：&#128269;和&#128164;</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="400.4648" y="535.7054"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="149.7065" x="400.4648" y="542.4825">&#128269; Discovered new external address for our node</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="119.7652" x="400.4648" y="549.2595">The first node was started by alice:</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="400.4648" y="556.0366"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="133.9041" x="400.4648" y="562.8137">注意：新版本已经更新，没有这个标记，改成如下：</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="302.7397" x="400.4648" y="569.5908">discovered: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp /ip4/172.16.0.79/tcp/30333</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="109.7847" x="400.4648" y="576.3678">这也和第一个alice节点启动的身份码一致</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="400.4648" y="583.1449"/><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="123.092" x="400.4648" y="589.922">&#128164; Idle (1 peers), best... finalized...</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="113.1115" x="400.4648" y="596.6991">The node has a one peer (1 peers).</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="202.9354" x="400.4648" y="603.4761">The nodes have produced some blocks (best: #4 (0x2b8a…fdc4)).</text><text fill="#000000" font-family="monospace" font-size="5.8219" lengthAdjust="spacing" textLength="0" x="400.4648" y="610.2532"/><path d="M375.5137,567.5753 L379.6722,567.5753 C385.91,567.5753 385.91,567.5753 392.1477,567.5753 L396.3063,567.5753 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/><path d="M80.2593,344.242 L84.4178,344.242 C90.6556,344.242 90.6556,567.5753 96.8933,567.5753 L101.0519,567.5753 " fill="none" style="stroke:#181818;stroke-width:0.4158512720156556;"/></g></svg></figure>
<h2 id="add-trusted-nodes"><a class="header" href="#add-trusted-nodes">Add trusted nodes</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1641.3571px" preserveAspectRatio="none" style="width:850px;height:1641px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 1641" width="850.3222px" zoomAndPan="magnify"><defs/><g><rect fill="#6495ED" height="11.6954" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="78.298" x="3.2221" y="814.627"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="21.2661" x="6.4443" y="822.0363">(重点内容)</text><a href="https://docs.substrate.io/tutorials/get-started/trusted-network/" target="_top" title="https://docs.substrate.io/tutorials/get-started/trusted-network/" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/trusted-network/" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/trusted-network/" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" text-decoration="underline" textLength="41.5656" x="27.7104" y="822.0363">Add trusted nodes</text></a><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" text-decoration="underline" textLength="9.022" x="69.276" y="822.0363">返回</text></a><rect fill="#00FFFF" height="106.2148" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="184.3063" x="97.6308" y="6.4443"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="64.4428" x="100.8529" y="13.8536">About Substrate Consensus:</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="19.1047"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="177.862" x="100.8529" y="24.3558">The Substrate node template uses a proof of authority consensus model</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="141.7741" x="100.8529" y="29.6069">also referred to as authority round or Aura consensus .</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="139.1964" x="100.8529" y="34.8579">The Aura consensus protocol limits block production to</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="100.5307" x="100.8529" y="40.109">a rotating list of authorized accounts.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="45.3601"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="134.0409" x="100.8529" y="50.6112">The authorized accounts—authorities—create blocks in</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="144.3518" x="100.8529" y="55.8622">a round robin fashion and are generally considered to be</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="92.7976" x="100.8529" y="61.1133">trusted participants in the network.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="66.3644"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="128.8855" x="100.8529" y="71.6155">This consensus model provides a simple approach to</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="164.9735" x="100.8529" y="76.8666">starting a solo blockchain for a limited number of participants.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="82.1176"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="136.6187" x="100.8529" y="87.3687">In this tutorial, you'll see how to generate the keys</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="152.0849" x="100.8529" y="92.6198">required to authorize a node to participate in the network,</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="144.3518" x="100.8529" y="97.8709">how to configure and share information about the network</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="157.2403" x="100.8529" y="103.1219">with other authorized accounts, and how to launch the network</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="90.2199" x="100.8529" y="108.373">with an approved set of validators.</text><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,59.5517 94.4086,59.5517 L97.6308,59.5517 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="11.6954" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="78.9424" x="97.6308" y="264.462"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="72.4981" x="100.8529" y="271.8714">Generate your account and keys</text><rect fill="#F1F1F1" height="37.9507" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="122.4412" x="192.6839" y="119.1033"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="53.1653" x="195.906" y="126.5127">Key generation options:</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="195.906" y="131.7637"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="74.7536" x="195.906" y="137.0148">1. a node-template subcommand</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="115.997" x="195.906" y="142.2659">2. the standalone subkey command-line program</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="77.3313" x="195.906" y="147.517">3. the Polkadot-JS application</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="103.1084" x="195.906" y="152.768">4. third-party key generation utilities.</text><path d="M176.5732,270.3097 L179.7953,270.3097 C184.6285,270.3097 184.6285,138.0787 189.4617,138.0787 L192.6839,138.0787 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="11.6954" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="107.9416" x="192.6839" y="246.0832"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="101.4973" x="195.906" y="253.4926">Generate local keys using the node template:</text><rect fill="#F1F1F1" height="100.9637" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="343.4799" x="316.7362" y="163.4983"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="96.6641" x="319.9583" y="170.9077">Generate a random secret phrase and keys</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="176.1588"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="213.95" x="319.9583" y="181.4098">./target/release/node-template key generate --scheme Sr25519 --password-interactive</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="123.7301" x="319.9583" y="186.6609">Type a password for the generated keys: &lt;123456&gt;</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="191.912"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="25.7771" x="319.9583" y="197.1631">displayed:</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="291.2813" x="319.9583" y="202.4141">./target/release/node-template key generate --scheme Sr25519 --password-interactive                            ─╯</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="33.5102" x="319.9583" y="207.6652">Key password:</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="212.9163"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="265.5042" x="319.9583" y="218.1674">Secret phrase:       answer cotton spike caution blouse only radio artefact middle guilt bleak original</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="325.1137" y="223.4185">Network ID:        substrate</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="228.6695">Secret seed:       0xfcd01919178fa73e7223bdeea134b1ef809b75d3fabd672a52dcc69b964813b6</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="233.9206">Public key (hex):  0x5413998d3c189f62288daaf2bd2ca3da5e78b00be9172a36ae063aae4cc7f607</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="239.1717">Account ID:        0x5413998d3c189f62288daaf2bd2ca3da5e78b00be9172a36ae063aae4cc7f607</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="172.7066" x="325.1137" y="244.4228">Public key (SS58): 5DxwhfEDto6kGkHz1SZQWE1hDGM8E2LFQNujQdJ3vHNWrnc3</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="172.7066" x="325.1137" y="249.6738">SS58 Address:      5DxwhfEDto6kGkHz1SZQWE1hDGM8E2LFQNujQdJ3vHNWrnc3</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="254.9249"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="337.0356" x="319.9583" y="260.176">您现在拥有 Sr25519 密钥，用于使用 aura 为一个节点生成块。在此示例中，帐户的 Sr25519 公钥是 5DxwhfEDto6kGkHz1SZQWE1hDGM8E2LFQNujQdJ3vHNWrnc3</text><path d="M300.6255,251.9309 L303.8476,251.9309 C308.6808,251.9309 308.6808,213.9802 313.514,213.9802 L316.7362,213.9802 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="69.4572" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="436.9219" x="316.7362" y="270.9063"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="31.577" x="319.9583" y="278.3156">使用生成的密钥</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="283.5667"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="430.4776" x="319.9583" y="288.8178">./target/release/node-template key inspect --password-interactive --scheme Ed25519 "answer cotton spike caution blouse only radio artefact middle guilt bleak original"</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="319.9583" y="294.0689"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="51.5542" x="319.9583" y="299.3199">Key password: 123456</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="265.5042" x="319.9583" y="304.571">Secret phrase:       answer cotton spike caution blouse only radio artefact middle guilt bleak original</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="325.1137" y="309.8221">Network ID:        substrate</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="315.0732">Secret seed:       0xfcd01919178fa73e7223bdeea134b1ef809b75d3fabd672a52dcc69b964813b6</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="320.3243">Public key (hex):  0xb293f948a04a5bac3b8321f99bb4c9532f6ffe2b8ff40926b23c68c9726ca40a</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.1054" x="325.1137" y="325.5753">Account ID:        0xb293f948a04a5bac3b8321f99bb4c9532f6ffe2b8ff40926b23c68c9726ca40a</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="172.7066" x="325.1137" y="330.8264">Public key (SS58): 5G6rLZNtZPyMrYTo2YXL9nzaatJ837hmKPnsgYqDURgAWBgX</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="172.7066" x="325.1137" y="336.0775">SS58 Address:      5G6rLZNtZPyMrYTo2YXL9nzaatJ837hmKPnsgYqDURgAWBgX</text><path d="M300.6255,251.9309 L303.8476,251.9309 C308.6808,251.9309 308.6808,305.6349 313.514,305.6349 L316.7362,305.6349 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M176.5732,270.3097 L179.7953,270.3097 C184.6285,270.3097 184.6285,251.9309 189.4617,251.9309 L192.6839,251.9309 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="74.7083" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="182.373" x="192.6839" y="346.8078"/><a href="https://docs.substrate.io/tutorials/get-started/trusted-network/#generate-a-second-set-of-keys" target="_top" title="https://docs.substrate.io/tutorials/get-started/trusted-network/#generate-a-second-set-of-keys" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/trusted-network/#generate-a-second-set-of-keys" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/trusted-network/#generate-a-second-set-of-keys" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" text-decoration="underline" textLength="68.3093" x="195.906" y="354.2171">Generate a second set of keys</text></a><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="195.906" y="359.4682"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="112.7748" x="195.906" y="364.7193">此教程的专用网络仅包含两个节点，因此需要两组密钥。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="195.906" y="369.9704"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="58.6429" x="195.906" y="375.2214">有几个选项可以继续本教程：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="75.398" x="195.906" y="380.4725">1. 可以将密钥用于预定义帐户之一。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="165.6179" x="195.906" y="385.7236">2. 可以使用本地计算机上的不同身份重复上一节中的步骤，以生成第二个密钥对。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="129.5299" x="195.906" y="390.9747">3. 您可以派生一个子密钥对来模拟本地计算机上的第二个身份。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="129.5299" x="195.906" y="396.2257">4. 您可以招募其他参与者来生成加入您的私有网络所需的密钥。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="195.906" y="401.4768"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="90.2199" x="195.906" y="406.7279">出于说明目的，本教程中使用的第二组键是：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="172.7066" x="195.906" y="411.979">Sr25519：5EJPj83tJuJtTVE2v7B9ehfM7jNT44CBFaPWicvBwYyUKBS6 用于aura。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="175.9287" x="195.906" y="417.2301">Ed25519：5FeJQsfmbbJLTH1pvehBxrZrT5kHvJFj84ZaY5LK7NU87gZS 用于grapdpa</text><path d="M176.5732,270.3097 L179.7953,270.3097 C184.6285,270.3097 184.6285,384.1619 189.4617,384.1619 L192.6839,384.1619 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,270.3097 94.4086,270.3097 L97.6308,270.3097 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="74.7083" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="163.6846" x="97.6308" y="561.3845"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="78.9424" x="100.8529" y="568.7939">Create a custom chain specification</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="574.045"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="144.3518" x="100.8529" y="579.296">生成用于区块链的密钥后，您就可以使用这些密钥对创建自定义链规范，</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="157.2403" x="100.8529" y="584.5471">然后与作为验证器(validators)的受信任网络参与者共享您的自定义链规范。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="589.7982"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="139.8408" x="100.8529" y="595.0493">为了使其他人能够参与您的区块链网络，请确保他们生成自己的密钥。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="600.3004"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="144.3518" x="100.8529" y="605.5514">收集完网络参与者的密钥后，可以创建自定义链规范以替换本地链规范。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="610.8025"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="139.8408" x="100.8529" y="616.0536">为简单起见，本教程中创建的自定义链规范是本地链规范的修改版本，</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="63.1539" x="100.8529" y="621.3047">用于说明如何创建双节点网络。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="626.5557"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="148.8628" x="100.8529" y="631.8068">如果您拥有所需的密钥，您可以按照相同的步骤将更多节点添加到网络中。</text><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="152.7293" x="277.4261" y="587.6399"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="76.3647" x="280.6482" y="595.0493">Modify the local chain specification</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="280.6482" y="600.3004"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="146.2851" x="280.6482" y="605.5514">这个操作很重要，后续课程还会用到。(Connect to Rococo testnet)</text><rect fill="#F1F1F1" height="32.6997" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="112.1304" x="446.2661" y="544.4381"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="93.442" x="449.4882" y="551.8475">Export the local chain specification to a file</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="449.4882" y="557.0985"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="105.6861" x="449.4882" y="562.3496">./target/release/node-template build-spec</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="67.0205" x="449.4882" y="567.6007">--disable-default-bootnode</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="79.909" x="449.4882" y="572.8518">--chain local &gt; customSpec.json</text><rect fill="#F08080" height="79.9594" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="78.6202" x="574.5072" y="427.9603"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="51.232" x="577.7293" y="435.3697">head customSpec.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="577.7293" y="440.6208"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="43.8211" x="577.7293" y="445.8718"># customSpec.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="577.7293" y="451.1229">{</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="61.865" x="580.3071" y="456.374">"name": "Local Testnet",</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="580.3071" y="461.6251">"id": "local_testnet",</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="54.1319" x="580.3071" y="466.8762">"chainType": "Local",</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="580.3071" y="472.1272">"bootNodes": [],</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="69.5982" x="580.3071" y="477.3783">"telemetryEndpoints": null,</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="48.9765" x="580.3071" y="482.6294">"protocolId": null,</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="48.9765" x="580.3071" y="487.8805">"properties": null,</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="61.865" x="580.3071" y="493.1315">"consensusEngine": null,</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="580.3071" y="498.3826">"codeSubstitutes": {},</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="577.7293" y="503.6337">}</text><path d="M558.3965,560.7879 L561.6187,560.7879 C566.4519,560.7879 566.4519,467.94 571.2851,467.94 L574.5072,467.94 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="32.6997" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="103.1084" x="574.5072" y="514.364"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="58.9651" x="577.7293" y="521.7733">tail -n 80 customSpec.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="577.7293" y="527.0244"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="96.6641" x="577.7293" y="532.2755">此命令显示 Wasm 二进制字段后面的最后部分，</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="81.1979" x="577.7293" y="537.5266">包括运行时使用的几个托盘的详细信息，</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="68.3093" x="577.7293" y="542.7776">例如 sudo 和 balances 托盘。</text><path d="M558.3965,560.7879 L561.6187,560.7879 C566.4519,560.7879 566.4519,530.7138 571.2851,530.7138 L574.5072,530.7138 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="53.704" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="271.9484" x="574.5072" y="553.5079"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="193.3283" x="577.7293" y="560.9173">Modify the name field to identify this chain specification as a custom chain specification.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="577.7293" y="566.1683"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="577.7293" y="571.4194">"name": "My Custom Testnet",</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="597.0622" y="575.1567"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="83.7756" x="598.6732" y="576.6705">:Modify aura field to specify the nodes</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="577.7293" y="581.9216"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="67.0205" x="577.7293" y="587.1727">"aura": { "authorities": [</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="262.9265" x="580.3071" y="592.4237">"5CfBuoHDvZ4fd8jkLQicNL8tgjnK8pVG9AiuJrsNrRAx6CNW", "5CXGP4oPXC1Je3zf5wEDkYeAqGcGXyKWSRX2Jm14GdME5Xc5"</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="580.3071" y="597.6748">]</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="5.1554" x="577.7293" y="602.9259">},</text><path d="M558.3965,560.7879 L561.6187,560.7879 C566.4519,560.7879 566.4519,580.3599 571.2851,580.3599 L574.5072,580.3599 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="79.9594" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="155.9515" x="574.5072" y="613.6562"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="99.5641" x="577.7293" y="621.0655">Modify the grandpa field to specify the nodes</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="577.7293" y="626.3166"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="30.9325" x="577.7293" y="631.5677">"grandpa": {</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="585.4625" y="636.8188">"authorities": [</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="590.6179" y="642.0698">[</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="131.4632" x="595.7733" y="647.3209">"5CuqCGfwqhjGzSqz5mnq36tMe651mU9Ji8xQ4JRuUTvPcjVN",</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="595.7733" y="652.572">1</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="5.1554" x="590.6179" y="657.8231">],</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="590.6179" y="663.0741">[</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="131.4632" x="595.7733" y="668.3252">"5DpdMN4bVTMy67TfMMtinQTcUmLhZBWoWarHvEYPM4jYziqm",</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="595.7733" y="673.5763">1</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="590.6179" y="678.8274">]</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="2.5777" x="585.4625" y="684.0785">]</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="5.1554" x="580.3071" y="689.3295">},</text><path d="M558.3965,560.7879 L561.6187,560.7879 C566.4519,560.7879 566.4519,653.6359 571.2851,653.6359 L574.5072,653.6359 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M430.1554,598.7387 L433.3776,598.7387 C438.2108,598.7387 438.2108,560.7879 443.044,560.7879 L446.2661,560.7879 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="69.4572" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="191.395" x="446.2661" y="700.0598"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="30.9325" x="449.4882" y="707.4692">Add validators</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="449.4882" y="712.7202"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="22.555" x="449.4882" y="717.9713">如你所见：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="449.4882" y="723.2224"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="151.4405" x="449.4882" y="728.4735">可以通过修改 aura 和 grandpa 部分来添加和更改链规范中的权限地址。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="81.1979" x="449.4882" y="733.7246">可以使用此技术添加任意数量的验证器。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="449.4882" y="738.9756"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="27.066" x="449.4882" y="744.2267">添加验证器：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="91.5087" x="449.4882" y="749.4778">1. 修改 aura 部分以包含 Sr25519 地址。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="107.6194" x="449.4882" y="754.7289">2. 修改爷爷部分以包括 Ed25519 地址和投票权重。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="449.4882" y="759.9799"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="184.9507" x="449.4882" y="765.231">确保为每个验证器使用唯一的密钥。如果两个验证器具有相同的密钥，它们会产生冲突的块。</text><path d="M430.1554,598.7387 L433.3776,598.7387 C438.2108,598.7387 438.2108,734.7884 443.044,734.7884 L446.2661,734.7884 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M261.3154,598.7387 L264.5375,598.7387 C269.3707,598.7387 269.3707,598.7387 274.2039,598.7387 L277.4261,598.7387 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,598.7387 94.4086,598.7387 L97.6308,598.7387 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="48.4529" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="105.0417" x="97.6308" y="642.5371"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="98.5974" x="100.8529" y="649.9465">Convert the chain specification to raw format</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="655.1975"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="77.3313" x="100.8529" y="660.4486">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="25.7771" x="100.8529" y="665.6997">build-spec</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="59.2873" x="100.8529" y="670.9508">--chain=customSpec.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="12.8886" x="100.8529" y="676.2018">--raw</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="67.0205" x="100.8529" y="681.4529">--disable-default-bootnode</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="51.5542" x="100.8529" y="686.704">&gt; customSpecRaw.json</text><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,666.7636 94.4086,666.7636 L97.6308,666.7636 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="85.2104" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="226.1941" x="97.6308" y="775.9613"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="89.8976" x="100.8529" y="783.3707">Share the chain specification with others</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="788.6217"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="108.2638" x="100.8529" y="793.8728">如果你正在创建私有区块链网络以与其他参与者共享，</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="103.7528" x="100.8529" y="799.1239">请确保只有一个人创建链规范并与该规范中的所有其</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="76.6869" x="100.8529" y="804.375">他验证器共享生成的该规范的原始版本</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="92.1531" x="100.8529" y="809.626">（例如 customSpecRaw.json 文件）网络。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="814.8771"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="107.6194" x="100.8529" y="820.1282">因为 Rust 编译器生成的优化的 WebAssembly 二进</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="110.1971" x="100.8529" y="825.3793">制文件在确定性上无法重现，所以每个生成 Wasm 运行</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="84.42" x="100.8529" y="830.6304">时的人都会生成稍微不同的 Wasm blob。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="835.8814"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="108.2638" x="100.8529" y="841.1325">为了确保确定性，区块链网络中的所有参与者必须使用</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="58.6429" x="100.8529" y="846.3836">完全相同的原始链规范文件。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="851.6347"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="219.7498" x="100.8529" y="856.8857">有关此问题的更多信息，请参阅&lt;Hunting down a non-determinism-bug in our Rust Wasm build&gt;。</text><rect fill="#F1F1F1" height="11.6954" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="143.0629" x="339.9356" y="812.7189"/><a href="https://dev.to/gnunicorn/hunting-down-a-non-determinism-bug-in-our-rust-wasm-build-4fk1" target="_top" title="https://dev.to/gnunicorn/hunting-down-a-non-determinism-bug-in-our-rust-wasm-build-4fk1" xlink:actuate="onRequest" xlink:href="https://dev.to/gnunicorn/hunting-down-a-non-determinism-bug-in-our-rust-wasm-build-4fk1" xlink:show="new" xlink:title="https://dev.to/gnunicorn/hunting-down-a-non-determinism-bug-in-our-rust-wasm-build-4fk1" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" text-decoration="underline" textLength="136.6187" x="343.1577" y="820.1282">Hunting down a non-determinism-bug in our Rust Wasm build</text></a><path d="M323.8249,818.5665 L327.047,818.5665 C331.8802,818.5665 331.8802,818.5665 336.7134,818.5665 L339.9356,818.5665 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,818.5665 94.4086,818.5665 L97.6308,818.5665 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="79.9594" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="182.373" x="97.6308" y="867.616"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="83.4534" x="100.8529" y="875.0254">Prepare to launch the private network</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="880.2765"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="153.3738" x="100.8529" y="885.5275">将自定义链规范分发给所有网络参与者后，就可以启动自己的私有区块链了。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="890.7786"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="112.7748" x="100.8529" y="896.0297">这些步骤类似于在启动第一个区块链节点中执行的步骤。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="901.2808"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="157.8848" x="100.8529" y="906.5318">但是，如果按照本教程中的步骤操作，则可以将多台计算机添加到您的网络中。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="911.7829"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="54.1319" x="100.8529" y="917.034">要继续，请验证以下内容：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="106.975" x="100.8529" y="922.2851">1. 已经为至少两个权限帐户生成或收集了帐户密钥。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="175.9287" x="100.8529" y="927.5362">2. 已经更新自定义链规范，以包含用于块生产（aura）和块完成（grandpa）的密钥。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="170.1289" x="100.8529" y="932.7872">3. 已将自定义链规范转换为原始格式，并将原始链规范分发给参与私有网络的节点。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="938.0383"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="135.3298" x="100.8529" y="943.2894">如果已完成这些步骤，您就可以启动私有区块链中的第一个节点了。</text><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,907.5957 94.4086,907.5957 L97.6308,907.5957 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="90.4615" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="153.3738" x="97.6308" y="1011.3032"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="100.8529" y="1018.7126">Start the first node</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="77.3313" x="100.8529" y="1023.9637">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="59.2873" x="106.0083" y="1029.2147">--base-path /tmp/node01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="106.0083" y="1034.4658">--chain ./customSpecRaw.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="30.9325" x="106.0083" y="1039.7169">--port 30333</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="36.0879" x="106.0083" y="1044.968">--ws-port 9945</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="106.0083" y="1050.2191">--rpc-port 9933</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="141.7741" x="106.0083" y="1055.4701">--telemetry-url "wss://telemetry.polkadot.io/submit/ 0"</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="28.3548" x="106.0083" y="1060.7212">--validator</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="51.5542" x="106.0083" y="1065.9723">--rpc-methods Unsafe</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="106.0083" y="1071.2234">--name MyNode01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="106.0083" y="1076.4745">--password-interactive</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1081.7255"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="121.7968" x="100.8529" y="1086.9766">此命令还使用您自己的密钥而不是预定义的帐户来启动节点。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="117.2858" x="100.8529" y="1092.2277">由于没有使用具有已知密钥的预定义帐户，因此需要在单独</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="63.1539" x="100.8529" y="1097.4788">的步骤中将密钥添加到密钥库。</text><rect fill="#F1F1F1" height="32.6997" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="127.5967" x="267.1152" y="954.0197"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="56.3874" x="270.3374" y="961.429">--base-path /tmp/node01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="270.3374" y="966.6801"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="121.1524" x="270.3374" y="971.9312">The --base-path command-line option specifies a</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="115.997" x="270.3374" y="977.1823">custom location for the chain associated with</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="270.3374" y="982.4333">this first node.</text><path d="M251.0045,1056.534 L254.2267,1056.534 C259.0599,1056.534 259.0599,970.3695 263.8931,970.3695 L267.1152,970.3695 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="69.4572" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="137.5853" x="267.1152" y="993.1636"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="67.3427" x="270.3374" y="1000.573">--chain ./customSpecRaw.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="270.3374" y="1005.824"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="115.997" x="270.3374" y="1011.0751">The --chain command-line option specifies the</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="69.5982" x="270.3374" y="1016.3262">custom chain specification.</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="281.2926" y="1020.0634"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="28.0326" x="282.9037" y="1021.5773">--port 30333</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="281.2926" y="1025.3145"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="32.8658" x="282.9037" y="1026.8284">--ws-port 9945</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="281.2926" y="1030.5656"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="33.8324" x="282.9037" y="1032.0794">--rpc-port 9933</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="281.2926" y="1035.8167"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="118.5747" x="282.9037" y="1037.3305">--telemetry-url "wss://telemetry.polkadot.io/submit/ 0"</text><rect fill="#000000" height="1.1277" style="stroke:#000000;stroke-width:0.0;" width="1.1277" x="281.2926" y="1041.0677"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="23.1994" x="282.9037" y="1042.5816">:--validator</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="270.3374" y="1047.8327"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="128.8855" x="270.3374" y="1053.0837">The --validator command-line option indicates that</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="103.1084" x="270.3374" y="1058.3348">this node is an authority for the chain.</text><path d="M251.0045,1056.534 L254.2267,1056.534 C259.0599,1056.534 259.0599,1027.8922 263.8931,1027.8922 L267.1152,1027.8922 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="37.9507" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="155.9515" x="267.1152" y="1069.0651"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="48.6543" x="270.3374" y="1076.4745">--rpc-methods Unsafe</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="270.3374" y="1081.7255"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="131.4632" x="270.3374" y="1086.9766">The --rpc-methods Unsafe command-line option allows</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="149.5072" x="270.3374" y="1092.2277">you to continue the tutorial using an unsafe communication</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="131.4632" x="270.3374" y="1097.4788">mode because your blockchain is not being used in a</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="48.9765" x="270.3374" y="1102.7298">production setting.</text><path d="M251.0045,1056.534 L254.2267,1056.534 C259.0599,1056.534 259.0599,1088.0405 263.8931,1088.0405 L267.1152,1088.0405 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="27.4486" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="140.4852" x="267.1152" y="1113.4601"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="40.9212" x="270.3374" y="1120.8695">--name MyNode01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="270.3374" y="1126.1205"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="128.8855" x="270.3374" y="1131.3716">The --name command-line option enables you to give</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="134.0409" x="270.3374" y="1136.6227">your node a human-readable name in the telemetry UI.</text><path d="M251.0045,1056.534 L254.2267,1056.534 C259.0599,1056.534 259.0599,1127.1844 263.8931,1127.1844 L267.1152,1127.1844 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="11.6954" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="55.743" x="267.1152" y="1147.353"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="49.2987" x="270.3374" y="1154.7623">--password-interactive</text><path d="M251.0045,1056.534 L254.2267,1056.534 C259.0599,1056.534 259.0599,1153.2007 263.8931,1153.2007 L267.1152,1153.2007 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,1056.534 94.4086,1056.534 L97.6308,1056.534 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="95.0531" x="97.6308" y="1225.4017"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="88.6088" x="100.8529" y="1232.8111">View information about node operations</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1238.0622"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="40.5989" x="100.8529" y="1243.3132">注意其中的这些信息</text><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="183.0174" x="208.7945" y="1165.4926"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="15.144" x="212.0167" y="1172.902">--chain</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="212.0167" y="1178.153"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="176.5732" x="212.0167" y="1183.4041">输出表明正在使用的链规范是您使用 --chain 命令行选项创建和指定的自定义链规范。</text><path d="M192.6839,1236.5005 L195.906,1236.5005 C200.7392,1236.5005 200.7392,1176.5914 205.5724,1176.5914 L208.7945,1176.5914 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="175.2843" x="208.7945" y="1194.1344"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="21.5883" x="212.0167" y="1201.5437">--validator</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="212.0167" y="1206.7948"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="168.84" x="212.0167" y="1212.0459">输出表明该节点是一个授权，因为您使用 --validator 命令行选项启动了该节点。</text><path d="M192.6839,1236.5005 L195.906,1236.5005 C200.7392,1236.5005 200.7392,1205.2332 205.5724,1205.2332 L208.7945,1205.2332 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="184.9507" x="208.7945" y="1222.7762"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="11.2775" x="212.0167" y="1230.1855">state</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="212.0167" y="1235.4366"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="178.5064" x="212.0167" y="1240.6877">输出显示使用块哈希（状态：0x2bde…8f66，标头哈希：0x6c78…37de）初始化创世块。</text><path d="M192.6839,1236.5005 L195.906,1236.5005 C200.7392,1236.5005 200.7392,1233.8749 205.5724,1233.8749 L208.7945,1233.8749 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="27.4486" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="144.9962" x="208.7945" y="1251.418"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="28.677" x="212.0167" y="1258.8273">node identify</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="212.0167" y="1264.0784"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="121.7968" x="212.0167" y="1269.3295">输出指定您的节点的本地节点身份。在此示例中，节点身份为</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="138.5519" x="212.0167" y="1274.5806">12d3koowlmrydlontytytytdyzlwde1paxzxtw5rgjmhlfzw96sx。</text><path d="M192.6839,1236.5005 L195.906,1236.5005 C200.7392,1236.5005 200.7392,1265.1423 205.5724,1265.1423 L208.7945,1265.1423 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="119.2191" x="208.7945" y="1285.3108"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="23.1994" x="212.0167" y="1292.7202">IP address</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="212.0167" y="1297.9713"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="112.7748" x="212.0167" y="1303.2223">输出指定用于节点的 IP 地址是本地主机 127.0.0.1。</text><path d="M192.6839,1236.5005 L195.906,1236.5005 C200.7392,1236.5005 200.7392,1296.4096 205.5724,1296.4096 L208.7945,1296.4096 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,1236.5005 94.4086,1236.5005 L97.6308,1236.5005 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="74.7083" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="132.7521" x="97.6308" y="1391.0473"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="55.4208" x="100.8529" y="1398.4567">Add keys to the keystore</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1403.7077"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="76.6869" x="100.8529" y="1408.9588">启动第一个节点后，尚未生成任何块。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1414.2099"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="126.3078" x="100.8529" y="1419.461">下一步是将两种类型的密钥添加到网络中每个节点的密钥库中。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1424.712"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="31.577" x="100.8529" y="1429.9631">对于每个节点：</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="81.8423" x="100.8529" y="1435.2142">1. 添加 aura 权限密钥以启用块生产。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="89.5754" x="100.8529" y="1440.4653">2. 添加g randpa 权限密钥以启用块完成。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1445.7164"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="100.8529" y="1450.9674">有几种方法可以将密钥插入密钥库。</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1456.2185"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="121.1524" x="100.8529" y="1461.4696">对于本教程，您可以使用 key 子命令插入本地生成的密钥。</text><rect fill="#F1F1F1" height="95.7126" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="153.3738" x="246.4936" y="1313.9526"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="58.3207" x="251.0045" y="1321.362">Insert the aura secret key:</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1326.613"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="77.3313" x="249.7157" y="1331.8641">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="87.6422" x="249.7157" y="1337.1152">key insert --base-path /tmp/node01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="67.0205" x="254.8711" y="1342.3663">--chain customSpecRaw.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="254.8711" y="1347.6174">--scheme Sr25519</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="64.4428" x="254.8711" y="1352.8684">--suri &lt;your-secret-seed&gt;</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="254.8711" y="1358.1195">--password-interactive</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="254.8711" y="1363.3706">--key-type aura</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1368.6217"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="134.0409" x="249.7157" y="1373.8728">Replace &lt;your-secret-seed&gt; with the secret phrase or</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="136.6187" x="249.7157" y="1379.1238">secret seed for the first key pair that you generated</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="110.8415" x="249.7157" y="1384.3749">in Generate local keys using node template.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1389.626"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="146.9295" x="249.7157" y="1394.8771">You can also insert a key from a specified file location.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1400.1281"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="123.7301" x="249.7157" y="1405.3792">./target/release/node-template key insert --help</text><path d="M230.3829,1428.4015 L233.605,1428.4015 C238.4382,1428.4015 238.4382,1361.8089 243.2714,1361.8089 L246.4936,1361.8089 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="53.704" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="112.1304" x="246.4936" y="1416.1095"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="65.4094" x="249.7157" y="1423.5188">Insert the grandpa secret key</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1428.7699"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="105.6861" x="249.7157" y="1434.021">./target/release/node-template key insert</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="59.2873" x="254.8711" y="1439.2721">--base-path /tmp/node01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="67.0205" x="254.8711" y="1444.5232">--chain customSpecRaw.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="41.2434" x="254.8711" y="1449.7742">--scheme Ed25519</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="61.865" x="254.8711" y="1455.0253">--suri &lt;your-secret-key&gt;</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="254.8711" y="1460.2764">--password-interactive</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="254.8711" y="1465.5275">--key-type gran</text><path d="M230.3829,1428.4015 L233.605,1428.4015 C238.4382,1428.4015 238.4382,1442.9615 243.2714,1442.9615 L246.4936,1442.9615 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="22.1975" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="119.8635" x="246.4936" y="1476.2578"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="113.097" x="249.7157" y="1483.6671">Verify that your keys are in the keystore for node01</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1488.9182"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="113.4193" x="249.7157" y="1494.1693">ls /tmp/node01/chains/local_testnet/keystore</text><path d="M230.3829,1428.4015 L233.605,1428.4015 C238.4382,1428.4015 238.4382,1487.3565 243.2714,1487.3565 L246.4936,1487.3565 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="37.9507" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="135.3298" x="246.4936" y="1504.8995"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="37.699" x="249.7157" y="1512.3089">Restart the node</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="249.7157" y="1517.56"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="128.8855" x="249.7157" y="1522.811">After you have added your keys to the keystore for</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="126.3078" x="249.7157" y="1528.0621">the first node under /tmp/node01, you can restart</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="126.3078" x="249.7157" y="1533.3132">the node using the command you used previously in</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="59.2873" x="249.7157" y="1538.5643">&lt;Start the first node&gt;.</text><path d="M230.3829,1428.4015 L233.605,1428.4015 C238.4382,1428.4015 238.4382,1523.8749 243.2714,1523.8749 L246.4936,1523.8749 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,1428.4015 94.4086,1428.4015 L97.6308,1428.4015 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="43.2018" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="132.7521" x="97.6308" y="1472.1999"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="70.2426" x="100.8529" y="1479.6092">Enable other participants to join</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1484.8603"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="121.1524" x="100.8529" y="1490.1114">tip: You can now allow other validators to join</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="126.3078" x="100.8529" y="1495.3625">the network using the --bootnodes and --validator</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="54.1319" x="100.8529" y="1500.6135">command-line options.</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1505.8646"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="126.3078" x="100.8529" y="1511.1157">To add a second validator to the private network:</text><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,1493.8008 94.4086,1493.8008 L97.6308,1493.8008 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/><rect fill="#F1F1F1" height="85.2104" rx="4.0277" ry="4.0277" style="stroke:#181818;stroke-width:0.48332069749810463;" width="220.3942" x="97.6308" y="1549.2946"/><text fill="#000000" font-family="sans-serif" font-size="4.511" lengthAdjust="spacing" textLength="70.2426" x="100.8529" y="1556.7039">Start a second blockchain node</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="0" x="100.8529" y="1561.955"/><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="77.3313" x="100.8529" y="1567.2061">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="59.2873" x="106.0083" y="1572.4571">--base-path /tmp/node02</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="72.1759" x="106.0083" y="1577.7082">--chain ./customSpecRaw.json</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="30.9325" x="106.0083" y="1582.9593">--port 30334</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="36.0879" x="106.0083" y="1588.2104">--ws-port 9946</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="106.0083" y="1593.4615">--rpc-port 9934</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="141.7741" x="106.0083" y="1598.7125">--telemetry-url "wss://telemetry.polkadot.io/submit/ 0"</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="28.3548" x="106.0083" y="1603.9636">--validator</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="51.5542" x="106.0083" y="1609.2147">--rpc-methods Unsafe</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="38.6657" x="106.0083" y="1614.4658">--name MyNode02</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="28.3548" x="106.0083" y="1619.7168">--bootnodes</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="208.7945" x="106.0083" y="1624.9679">/ip4/127.0.0.1/tcp/30333/p2p/12D3KooWLmrYDLoNTyTYtRdDyZLWDe1paxzxTw5RgjmHLfzW96SX</text><text fill="#000000" font-family="monospace" font-size="4.511" lengthAdjust="spacing" textLength="56.7096" x="106.0083" y="1630.219">--password-interactive</text><path d="M81.5201,820.4746 L84.7422,820.4746 C89.5754,820.4746 89.5754,1591.8998 94.4086,1591.8998 L97.6308,1591.8998 " fill="none" style="stroke:#181818;stroke-width:0.32221379833206976;"/></g></svg></figure>
<h2 id="authorize-specific-nodes"><a class="header" href="#authorize-specific-nodes">Authorize specific nodes</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1596.6887px" preserveAspectRatio="none" style="width:850px;height:1596px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 1596" width="850.3311px" zoomAndPan="magnify"><defs/><g><rect fill="#008B8B" height="60.5857" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="154.9669" x="3.3113" y="767.8653"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="56.2914" x="6.6225" y="775.4796">Authorize specific nodes</text></a><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="1.3245" x="62.9139" y="775.4796"> </text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="9.2715" x="64.2384" y="775.4796">返回</text></a><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="6.6225" y="780.8759"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="92.7152" x="6.6225" y="786.2722">using the node authorization pallet</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="6.6225" y="791.6685"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="148.3444" x="6.6225" y="797.0648">The node-authorization pallet is a prebuilt FRAME pallet</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="143.0464" x="6.6225" y="802.4611">that enables you to manage a configurable set of nodes</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="6.6225" y="807.8574">for a network. Each node is identified by a PeerId.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="6.6225" y="813.2538"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="6.6225" y="818.6501">Each PeerId is owned by one and only one AccountId</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="55.6291" x="6.6225" y="824.0464">that claims the node.</text><rect fill="#BA55D3" height="152.3231" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="170.8609" x="174.8344" y="6.6225"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="61.9205" x="178.1457" y="14.2368">Why permissioned network</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="19.6331"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="178.1457" y="25.0294">In Add trusted nodes, you saw how to build a simple</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="178.1457" y="30.4257">network with a known set of validator nodes. That tutorial</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="156.2914" x="178.1457" y="35.8221">illustrated a simplified version of a permissioned network.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="41.2184"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="158.9404" x="178.1457" y="46.6147">In a permissioned network, only authorized nodes are allowed</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="164.2384" x="178.1457" y="52.011">to perform specific network activities. For example, you might</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="158.9404" x="178.1457" y="57.4073">grant some nodes the permission to validate blocks and other</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="124.5033" x="178.1457" y="62.8036">nodes the permission to propagate transactions.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="68.2"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="161.5894" x="178.1457" y="73.5963">A blockchain with nodes that are granted specific permissions</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="148.3444" x="178.1457" y="78.9926">is different from a public or permissionless blockchain.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="156.2914" x="178.1457" y="84.3889">In a permissionless blockchain, anyone can join the network</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="164.2384" x="178.1457" y="89.7852">by running the node software on suitable hardware. In general,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="164.2384" x="178.1457" y="95.1815">a permissionless blockchain offers greater decentralization of</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="178.1457" y="100.5779">the network. However, there are use cases where creating a</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="119.2053" x="178.1457" y="105.9742">permissioned blockchain might be appropriate.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="111.3705"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="156.2914" x="178.1457" y="116.7668">For example,a permissioned blockchain would be suitable for</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="84.7682" x="178.1457" y="122.1631">the following types of projects:</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="127.5594"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="100.6623" x="178.1457" y="132.9558">1. For a private or consortium network</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="178.1457" y="138.3521">such as a private enterprise or a non-profit organization.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.9603" x="178.1457" y="143.7484">2. In highly-regulated data environments</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="161.5894" x="178.1457" y="149.1447">such as healthcare, finance, or business-to-business ledgers.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="156.2914" x="178.1457" y="154.541">3. For testing of a pre-public blockchain network at scale.</text><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,82.784 171.5232,82.784 L174.8344,82.784 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="85.0993" x="174.8344" y="278.3992"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="78.4768" x="178.1457" y="286.0135">Node authorization and ownership</text><rect fill="#F1F1F1" height="49.793" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="178.8079" x="276.4901" y="165.5681"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="149.3377" x="279.8013" y="173.1824">There are two ways you can authorize a node to join the network:</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="178.5787"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="148.3444" x="279.8013" y="183.975">1. By adding the PeerId to the list of predefined nodes.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="140.3974" x="279.8013" y="189.3713">You must be approved by the governance or sudo pallet</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="68.8742" x="279.8013" y="194.7676">in the network to do this.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="200.1639"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="166.8874" x="279.8013" y="205.5603">2. By asking for a paired peer connection from a specific node.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="172.1854" x="279.8013" y="210.9566">This node can either be a predefined node PeerId or a normal one.</text><path d="M259.9338,284.4086 L263.245,284.4086 C268.2119,284.4086 268.2119,190.4646 273.1788,190.4646 L276.4901,190.4646 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="44.3967" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="141.7219" x="276.4901" y="221.9837"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="105.298" x="279.8013" y="229.5979">any user can claim to be the owner of a PeerId</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="234.9942"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="279.8013" y="240.3906">To protect against false claims, you should claim</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="92.7152" x="279.8013" y="245.7869">the node before you start the node.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="251.1832"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="279.8013" y="256.5795">After you start the node, its PeerID is visible to</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="279.8013" y="261.9758">the network and anyone could subsequently claim it.</text><path d="M259.9338,284.4086 L263.245,284.4086 C268.2119,284.4086 268.2119,244.182 273.1788,244.182 L276.4901,244.182 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="60.5857" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="149.6689" x="276.4901" y="273.0029"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="52.9801" x="279.8013" y="280.6172">As the owner of a node</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="286.0135"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="279.8013" y="291.4098">you can add and remove connections for your node.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="296.8061"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="121.8543" x="279.8013" y="302.2024">For example, you can manipulate the connection</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="111.2583" x="279.8013" y="307.5988">between a predefined node and your node or</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="279.8013" y="312.9951">between your node and other non-predefined nodes.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="318.3914"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="143.0464" x="279.8013" y="323.7877">You can't change the connections for predefined nodes.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="279.8013" y="329.184">They are always allowed to connect with each other.</text><path d="M259.9338,284.4086 L263.245,284.4086 C268.2119,284.4086 268.2119,303.2957 273.1788,303.2957 L276.4901,303.2957 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="44.3967" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="147.0199" x="276.4901" y="340.2111"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="34.7682" x="279.8013" y="347.8254">offchain worker</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="140.3974" x="279.8013" y="353.2217">The node-authorization pallet uses an offchain worker</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="90.0662" x="279.8013" y="358.618">to configure its node connections.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.8013" y="364.0143"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="127.1523" x="279.8013" y="369.4106">Make sure to enable the offchain worker when you</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="127.1523" x="279.8013" y="374.807">start the node because it is disabled by default</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="63.5762" x="279.8013" y="380.2033">for non-authority nodes.</text><path d="M259.9338,284.4086 L263.245,284.4086 C268.2119,284.4086 268.2119,362.4095 273.1788,362.4095 L276.4901,362.4095 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="145.6954" x="276.4901" y="391.2303"/><a href="https://wiki.polkadot.network/docs/faq#networking" target="_top" title="https://wiki.polkadot.network/docs/faq#networking" xlink:actuate="onRequest" xlink:href="https://wiki.polkadot.network/docs/faq#networking" xlink:show="new" xlink:title="https://wiki.polkadot.network/docs/faq#networking" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="139.0728" x="279.8013" y="398.8446">Need to be familiar with peer-to-peer networking in Substrate</text></a><path d="M259.9338,284.4086 L263.245,284.4086 C268.2119,284.4086 268.2119,397.2398 273.1788,397.2398 L276.4901,397.2398 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,284.4086 171.5232,284.4086 L174.8344,284.4086 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="33.6041" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="181.457" x="174.8344" y="409.8717"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="41.3907" x="178.1457" y="417.486">Tutorial objectives</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="422.8823"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.9073" x="178.1457" y="428.2786">1. Check out and compile the node template.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="174.8344" x="178.1457" y="433.6749">2. Add the node authorization pallet to the node template runtime.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="150.9934" x="178.1457" y="439.0712">3. Launch multiple nodes and authorize new nodes to join.</text><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,426.6737 171.5232,426.6737 L174.8344,426.6737 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="33.6041" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="75.4967" x="174.8344" y="450.0983"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="54.9669" x="178.1457" y="457.7126">Build the node template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="178.1457" y="463.1089"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="68.8742" x="178.1457" y="468.5052">cd substrate-node-template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="50.3311" x="178.1457" y="473.9015">git checkout latest</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="55.6291" x="178.1457" y="479.2978">cargo build --release</text><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,466.9004 171.5232,466.9004 L174.8344,466.9004 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="82.4503" x="174.8344" y="571.0239"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-the-node-authorization-pallet" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-the-node-authorization-pallet" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-the-node-authorization-pallet" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-the-node-authorization-pallet" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="75.8278" x="178.1457" y="578.6382">Add the node authorization pallet</text></a><rect fill="#F1F1F1" height="65.982" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="189.404" x="273.8411" y="450.0983"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="24.8344" x="277.1523" y="457.7126">Cargo.toml</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="277.1523" y="463.1089"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="172.1854" x="277.1523" y="468.5052">the Cargo.toml file controls two important pieces of information:</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="277.1523" y="473.9015"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="164.2384" x="277.1523" y="479.2978">1. The pallets to be imported as dependencies for the runtime,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="158.9404" x="277.1523" y="484.6942">including the location and version of the pallets to import.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="140.3974" x="277.1523" y="490.0905">2. The features in each pallet that should be enabled</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="182.7815" x="277.1523" y="495.4868">when compiling the native Rust binary. By enabling the standard (std)</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="182.7815" x="277.1523" y="500.8831">feature set from each pallet , you can compile the runtime to include</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="169.5364" x="277.1523" y="506.2794">functions, types, and primitives that would otherwise be missing</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="100.6623" x="277.1523" y="511.6757">when you build the WebAssembly binary.</text><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="53.9735" x="479.8013" y="467.7592"/><a href="https://doc.rust-lang.org/cargo/guide/dependencies.html" target="_top" title="https://doc.rust-lang.org/cargo/guide/dependencies.html" xlink:actuate="onRequest" xlink:href="https://doc.rust-lang.org/cargo/guide/dependencies.html" xlink:show="new" xlink:title="https://doc.rust-lang.org/cargo/guide/dependencies.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="47.351" x="483.1126" y="475.3735">cargo dependencies</text></a><path d="M463.245,483.0893 L466.5563,483.0893 C471.5232,483.0893 471.5232,473.7686 476.4901,473.7686 L479.8013,473.7686 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="39.7351" x="479.8013" y="486.4006"/><a href="https://doc.rust-lang.org/cargo/reference/features.html" target="_top" title="https://doc.rust-lang.org/cargo/reference/features.html" xlink:actuate="onRequest" xlink:href="https://doc.rust-lang.org/cargo/reference/features.html" xlink:show="new" xlink:title="https://doc.rust-lang.org/cargo/reference/features.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="33.1126" x="483.1126" y="494.0148">cargo features</text></a><path d="M463.245,483.0893 L466.5563,483.0893 C471.5232,483.0893 471.5232,492.41 476.4901,492.41 L479.8013,492.41 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M257.2848,577.0333 L260.596,577.0333 C265.5629,577.0333 265.5629,483.0893 270.5298,483.0893 L273.8411,483.0893 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="93.3775" x="273.8411" y="587.2129"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="86.755" x="277.1523" y="594.8271">Add note-authorization dependencies</text><rect fill="#F1F1F1" height="55.1894" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="154.9669" x="383.7748" y="522.7028"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="77.1523" x="387.0861" y="530.3171">runtime/Cargo.toml-&gt;[depencies]</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="387.0861" y="535.7134"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="387.0861" y="541.1097">[dependencies]</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="76.8212" x="387.0861" y="546.506">pallet-node-authorization = {</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="66.2252" x="397.6821" y="551.9024">default-features = false,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="137.7483" x="397.6821" y="557.2987">git = "https://github.com/paritytech/substrate.git",</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="58.2781" x="397.6821" y="562.695">tag = "devhub/latest",</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="60.9272" x="397.6821" y="568.0913">version = "4.0.0-dev" }</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="15.894" x="387.0861" y="573.4876">&lt;code&gt;</text><path d="M367.2185,593.2223 L370.5298,593.2223 C375.4967,593.2223 375.4967,550.2975 380.4636,550.2975 L383.7748,550.2975 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="55.1894" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="144.3709" x="383.7748" y="584.5147"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="71.8543" x="387.0861" y="592.129">runtime/Cargo.toml-&gt;[features]</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="387.0861" y="597.5253"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="26.4901" x="387.0861" y="602.9216">[features]</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="45.0331" x="387.0861" y="608.3179">default = ['std']</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="18.543" x="387.0861" y="613.7142">std = [</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="7.947" x="389.7351" y="619.1106">...</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="389.7351" y="624.5069">"pallet-node-authorization/std",    # add this line</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="7.947" x="389.7351" y="629.9032">...</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="387.0861" y="635.2995">]</text><path d="M367.2185,593.2223 L370.5298,593.2223 C375.4967,593.2223 375.4967,612.1094 380.4636,612.1094 L383.7748,612.1094 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="17.4151" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="101.9868" x="383.7748" y="646.3266"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="59.2715" x="387.0861" y="653.9409">check new dependencies</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="95.3642" x="387.0861" y="659.3372">cargo check -p node-template-runtime</text><path d="M367.2185,593.2223 L370.5298,593.2223 C375.4967,593.2223 375.4967,655.0341 380.4636,655.0341 L383.7748,655.0341 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M257.2848,577.0333 L260.596,577.0333 C265.5629,577.0333 265.5629,593.2223 270.5298,593.2223 L273.8411,593.2223 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="33.6041" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="160.2649" x="273.8411" y="670.3642"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="58.6093" x="277.1523" y="677.9785">Add an administrative rule</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="277.1523" y="683.3748"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="277.1523" y="688.7711">To simulate governance in this tutorial, you can configure</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="150.9934" x="277.1523" y="694.1675">the pallet to use the EnsureRoot privileged function that</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="98.0132" x="277.1523" y="699.5638">can be called using the Sudo pallet .</text><rect fill="#F1F1F1" height="22.8115" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="85.4305" x="450.6623" y="675.7606"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="38.4106" x="453.9735" y="683.3748">runtime/src/lib.rs</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="453.9735" y="688.7711"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="78.8079" x="453.9735" y="694.1675">use frame_system::EnsureRoot；</text><path d="M434.106,687.1663 L437.4172,687.1663 C442.3841,687.1663 442.3841,687.1663 447.351,687.1663 L450.6623,687.1663 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M257.2848,577.0333 L260.596,577.0333 C265.5629,577.0333 265.5629,687.1663 270.5298,687.1663 L273.8411,687.1663 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,577.0333 171.5232,577.0333 L174.8344,577.0333 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="95.3642" x="174.8344" y="919.6968"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="88.7417" x="178.1457" y="927.3111">Implement the Config trait for the pallet</text><rect fill="#F1F1F1" height="103.7562" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="141.7219" x="286.755" y="710.5909"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="54.3046" x="290.0662" y="718.2051">About Pallet Config Trait</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="723.6014"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="116.5563" x="290.0662" y="728.9978">Every pallet has a Rust trait called Config.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="734.3941"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.9603" x="290.0662" y="739.7904">The Config trait is used to identify the</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.9073" x="290.0662" y="745.1867">parameters and types that the pallet needs.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="750.583"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="119.2053" x="290.0662" y="755.9793">Most of the pallet -specific code required to</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="135.0993" x="290.0662" y="761.3757">add a pallet is implemented using the Config trait.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="766.772"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="127.1523" x="290.0662" y="772.1683">You can review what you to need to implement for</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="290.0662" y="777.5646">any pallet by referring to its Rust documentation</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="90.0662" x="290.0662" y="782.9609">or the source code for the pallet.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="788.3572"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="290.0662" y="793.7536">For example, to see what you need to implement for</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="290.0662" y="799.1499">the Config trait in the node-authorization pallet,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.9073" x="290.0662" y="804.5462">you can refer to the Rust documentation for</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="90.0662" x="290.0662" y="809.9425">pallet_node_authorization::Config.</text><path d="M270.1987,925.7062 L273.5099,925.7062 C278.4768,925.7062 278.4768,762.469 283.4437,762.469 L286.755,762.469 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="140.7285" x="286.755" y="820.9696"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="134.106" x="290.0662" y="828.5839">To implement the node-authorization pallet in your runtime</text><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="45.0331" x="444.0397" y="820.9696"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="38.4106" x="447.351" y="828.5839">runtime/src/lib.rs</text><rect fill="#F1F1F1" height="39.0004" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="109.2715" x="505.6291" y="714.761"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="57.6159" x="508.9404" y="722.3752">Add the parameter_types</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="508.9404" y="727.7716"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="47.6821" x="508.9404" y="733.1679">parameter_types! {</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="100" x="511.5894" y="738.5642">pub const MaxWellKnownNodes: u32 = 8；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="100" x="511.5894" y="743.9605">pub const MaxPeerIdLength: u32 = 128；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="508.9404" y="749.3568">}</text><path d="M489.0728,826.979 L492.3841,826.979 C497.351,826.979 497.351,734.2612 502.3179,734.2612 L505.6291,734.2612 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="71.3783" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="144.3709" x="505.6291" y="760.3839"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="46.6887" x="508.9404" y="767.9982">Add the impl section</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="508.9404" y="773.3945"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="137.7483" x="508.9404" y="778.7908">impl pallet_node_authorization::Config for Runtime {</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="52.3179" x="511.5894" y="784.1871">type Event = Event；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="115.894" x="511.5894" y="789.5834">type MaxWellKnownNodes = MaxWellKnownNodes；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.298" x="511.5894" y="794.9798">type MaxPeerIdLength = MaxPeerIdLength；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.298" x="511.5894" y="800.3761">type AddOrigin = EnsureRoot&lt;AccountId&gt;；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.245" x="511.5894" y="805.7724">type RemoveOrigin = EnsureRoot&lt;AccountId&gt;；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.9073" x="511.5894" y="811.1687">type SwapOrigin = EnsureRoot&lt;AccountId&gt;; //</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="116.5563" x="511.5894" y="816.565">type ResetOrigin = EnsureRoot&lt;AccountId&gt;; //</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="63.5762" x="511.5894" y="821.9613">type WeightInfo = (); //</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="508.9404" y="827.3577">}</text><path d="M489.0728,826.979 L492.3841,826.979 C497.351,826.979 497.351,796.0731 502.3179,796.0731 L505.6291,796.0731 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="71.3783" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="255.6291" x="505.6291" y="838.3847"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="104.9669" x="508.9404" y="845.999">Add the pallet to the construct_runtime macro</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="508.9404" y="851.3953"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="50.3311" x="508.9404" y="856.7916">construct_runtime!(</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="58.2781" x="508.9404" y="862.188">pub enum Runtime where</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="516.8874" y="867.5843">Block = Block,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="68.8742" x="516.8874" y="872.9806">NodeBlock = opaque::Block,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="103.3113" x="516.8874" y="878.3769">UncheckedExtrinsic = UncheckedExtrinsic</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="511.5894" y="883.7732">{</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="50.3311" x="516.8874" y="889.1695">/* Add This Line */</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="241.0596" x="516.8874" y="894.5659">NodeAuthorization: pallet_node_authorization::{Pallet, Call, Storage, Event&lt;T&gt;, Config&lt;T&gt;},</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="511.5894" y="899.9622">}</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="7.2848" x="508.9404" y="905.3585">)；</text><path d="M489.0728,826.979 L492.3841,826.979 C497.351,826.979 497.351,874.0739 502.3179,874.0739 L505.6291,874.0739 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="22.8115" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="101.9868" x="505.6291" y="916.3856"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="28.8079" x="508.9404" y="923.9998">Cargo check</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="508.9404" y="929.3961"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="95.3642" x="508.9404" y="934.7925">cargo check -p node-template-runtime</text><path d="M489.0728,826.979 L492.3841,826.979 C497.351,826.979 497.351,927.7913 502.3179,927.7913 L505.6291,927.7913 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M427.4834,826.979 L430.7947,826.979 C435.7616,826.979 435.7616,826.979 440.7285,826.979 L444.0397,826.979 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M270.1987,925.7062 L273.5099,925.7062 C278.4768,925.7062 278.4768,826.979 283.4437,826.979 L286.755,826.979 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="71.3783" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="168.2119" x="286.755" y="1007.6314"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="96.3576" x="290.0662" y="1015.2457">Add genesis storage for authorized nodes</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="1020.642"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="158.9404" x="290.0662" y="1026.0383">Before you can launch the network to use node authorization,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="290.0662" y="1031.4346">some additional configuration is needed to handle the peer</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="98.0132" x="290.0662" y="1036.831">identifiers and account identifiers .</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="1042.2273"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="290.0662" y="1047.6236">For example, the PeerId is encoded in bs58 format,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="148.3444" x="290.0662" y="1053.0199">so you need to add a new dependency for the bs58 library</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="161.5894" x="290.0662" y="1058.4162">in the node/Cargo.toml to decode the PeerId to get its bytes.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="1063.8125"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="290.0662" y="1069.2089">To keep things simple, the authorized nodes are associated</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="66.2252" x="290.0662" y="1074.6052">with predefined accounts.</text><rect fill="#F1F1F1" height="28.2078" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="45.0331" x="471.5232" y="1002.4809"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="38.4106" x="474.8344" y="1010.0951">node/Cargo.toml</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="474.8344" y="1015.4915"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="474.8344" y="1020.8878">[dependencies]</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="474.8344" y="1026.2841">bs58 = "0.4.0"</text><path d="M454.9669,1043.3206 L458.2781,1043.3206 C463.245,1043.3206 463.245,1016.5847 468.2119,1016.5847 L471.5232,1016.5847 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="60.2649" x="471.5232" y="1037.3112"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="53.6424" x="474.8344" y="1044.9254">node/src/chain_spec.rs</text><rect fill="#F1F1F1" height="39.0004" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="149.6689" x="548.3444" y="945.8195"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="70.5298" x="551.6556" y="953.4338">Add genesis storage for nodes</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="551.6556" y="958.8301"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="143.0464" x="551.6556" y="964.2264">// A struct wraps Vec&lt;u8&gt;, represents as our `PeerId`.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="70.8609" x="551.6556" y="969.6228">use sp_core::OpaquePeerId；</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="551.6556" y="975.0191">// The genesis config that serves for our pallet.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="137.0861" x="551.6556" y="980.4154">use node_template_runtime::NodeAuthorizationConfig；</text><path d="M531.7881,1043.3206 L535.0993,1043.3206 C540.0662,1043.3206 540.0662,965.3197 545.0331,965.3197 L548.3444,965.3197 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="60.5857" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="149.6689" x="548.3444" y="991.4425"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="82.4503" x="551.6556" y="999.0567">Locate the testnet_genesis function</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="551.6556" y="1004.4531"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="143.0464" x="551.6556" y="1009.8494">/// Configure initial storage state for FRAME modules.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="50.3311" x="551.6556" y="1015.2457">fn testnet_genesis(</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="50.3311" x="554.3046" y="1020.642">wasm_binary: &amp;[u8],</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="121.8543" x="554.3046" y="1026.0383">initial_authorities: Vec&lt;(AuraId, GrandpaId)&gt;,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="52.9801" x="554.3046" y="1031.4346">root_key: AccountId,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="87.4172" x="554.3046" y="1036.831">endowed_accounts: Vec&lt;AccountId&gt;,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="58.2781" x="554.3046" y="1042.2273">_enable_println: bool,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="52.9801" x="554.3046" y="1047.6236">) -&gt; GenesisConfig {</text><path d="M531.7881,1043.3206 L535.0993,1043.3206 C540.0662,1043.3206 540.0662,1021.7353 545.0331,1021.7353 L548.3444,1021.7353 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="82.1709" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="298.0132" x="548.3444" y="1058.6507"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="84.106" x="551.6556" y="1066.2649">Within the GenesisConfig declaration</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="551.6556" y="1071.6613"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="119.2053" x="554.3046" y="1077.0576">node_authorization: NodeAuthorizationConfig {</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="31.7881" x="559.6026" y="1082.4539">nodes: vec![</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="564.9007" y="1087.8502">(</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="272.8477" x="570.1987" y="1093.2465">OpaquePeerId(bs58::decode("12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2").into_vec().unwrap()),</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="570.1987" y="1098.6428">endowed_accounts[0].clone()</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="5.298" x="564.9007" y="1104.0392">),</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="2.649" x="564.9007" y="1109.4355">(</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="272.8477" x="570.1987" y="1114.8318">OpaquePeerId(bs58::decode("12D3KooWQYV9dGMFoRzNStwpXztXaBUjtPqi6aU76ZgUriHhKust").into_vec().unwrap()),</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="570.1987" y="1120.2281">endowed_accounts[1].clone()</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="5.298" x="564.9007" y="1125.6244">),</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="5.298" x="559.6026" y="1131.0207">],</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="5.298" x="554.3046" y="1136.4171">},</text><path d="M531.7881,1043.3206 L535.0993,1043.3206 C540.0662,1043.3206 540.0662,1099.7361 545.0331,1099.7361 L548.3444,1099.7361 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M454.9669,1043.3206 L458.2781,1043.3206 C463.245,1043.3206 463.245,1043.3206 468.2119,1043.3206 L471.5232,1043.3206 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M270.1987,925.7062 L273.5099,925.7062 C278.4768,925.7062 278.4768,1043.3206 283.4437,1043.3206 L286.755,1043.3206 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="22.8115" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="73.1788" x="286.755" y="1085.6322"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="66.5563" x="290.0662" y="1093.2465">Verify that the node compiles</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="290.0662" y="1098.6428"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="55.6291" x="290.0662" y="1104.0392">cargo build --release</text><path d="M270.1987,925.7062 L273.5099,925.7062 C278.4768,925.7062 278.4768,1097.038 283.4437,1097.038 L286.755,1097.038 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,925.7062 171.5232,925.7062 L174.8344,925.7062 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="84.4371" x="174.8344" y="1362.5595"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="77.8146" x="178.1457" y="1370.1738">Launch the permissioned network</text><rect fill="#F1F1F1" height="60.5857" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="192.053" x="275.8278" y="1147.4441"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="279.1391" y="1155.0584">For the purposes of this tutorial</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1160.4547"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="92.7152" x="279.1391" y="1165.851">you are going to launch four nodes.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1171.2473"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="153.6424" x="279.1391" y="1176.6437">Three of the nodes are associated with predefined accounts</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="279.1391" y="1182.04">and all three of those nodes are allowed to author</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="52.9801" x="279.1391" y="1187.4363">and validate blocks.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1192.8326"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="148.3444" x="279.1391" y="1198.2289">The fourth node is a sub-node that is only authorized to</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="185.4305" x="279.1391" y="1203.6252">read data from a selected node with the approval of that node's owner.</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1177.737 272.5166,1177.737 L275.8278,1177.737 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="12.0188" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="75.8278" x="275.8278" y="1214.6523"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#obtain-node-keys-and-peerids" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#obtain-node-keys-and-peerids" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#obtain-node-keys-and-peerids" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#obtain-node-keys-and-peerids" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="69.2053" x="279.1391" y="1222.2666">Obtain node keys and peerIDs</text></a><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1220.6617 272.5166,1220.6617 L275.8278,1220.6617 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="55.1894" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="205.298" x="275.8278" y="1233.2937"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#start-the-first-node" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#start-the-first-node" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#start-the-first-node" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#start-the-first-node" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="42.3841" x="279.1391" y="1240.9079">Start the first node</text></a><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1246.3043"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="79.4702" x="279.1391" y="1251.7006">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="34.4371" x="279.1391" y="1257.0969">--chain=local</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="279.1391" y="1262.4932">--base-path /tmp/validator1</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="18.543" x="279.1391" y="1267.8895">--alice</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="198.6755" x="279.1391" y="1273.2858">--node-key=c12b6d18942f5ee8528c8e2baf4e147b5c5c18710926ea492d09cbd9f6c9f82a</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="31.7881" x="279.1391" y="1278.6822">--port 30333</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="279.1391" y="1284.0785">--ws-port 9944</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1260.8883 272.5166,1260.8883 L275.8278,1260.8883 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="55.1894" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="205.298" x="275.8278" y="1295.1055"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="51.3245" x="279.1391" y="1302.7198">Start the second node</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1308.1161"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="79.4702" x="279.1391" y="1313.5125">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="34.4371" x="279.1391" y="1318.9088">--chain=local</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="279.1391" y="1324.3051">--base-path /tmp/validator2</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="13.245" x="279.1391" y="1329.7014">--bob</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="198.6755" x="279.1391" y="1335.0977">--node-key=6ce3be907dbcabf20a9a5a60a712b4256a54196000a8ed4050d352bc113f8c58</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="31.7881" x="279.1391" y="1340.494">--port 30334</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="279.1391" y="1345.8904">--ws-port 9945</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1322.7002 272.5166,1322.7002 L275.8278,1322.7002 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="60.5857" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="205.298" x="275.8278" y="1356.9174"/><text fill="#000000" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" textLength="108.6093" x="279.1391" y="1364.5317">Add a third node to the list of well-known nodes</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1369.928"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="79.4702" x="279.1391" y="1375.3243">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="34.4371" x="279.1391" y="1380.7207">--chain=local</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="279.1391" y="1386.117">--base-path /tmp/validator3</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="279.1391" y="1391.5133">--name charlie</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="198.6755" x="279.1391" y="1396.9096">--node-key=3a9d5b35b9fb4c42aafadeca046f6bf56107bd2579687f069b42646684b94d9e</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="31.7881" x="279.1391" y="1402.3059">--port 30335</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="279.1391" y="1407.7022">--ws-port=9946</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="63.5762" x="279.1391" y="1413.0985">--offchain-worker always</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1387.2103 272.5166,1387.2103 L275.8278,1387.2103 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="39.0004" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="139.0728" x="275.8278" y="1424.1256"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#authorize-access-for-the-third-node" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#authorize-access-for-the-third-node" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#authorize-access-for-the-third-node" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#authorize-access-for-the-third-node" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="80.4636" x="279.1391" y="1431.7399">Authorize access for the third node</text></a><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1437.1362"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="132.4503" x="279.1391" y="1442.5325">This tutorial uses the sudo pallet for governance.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="129.8013" x="279.1391" y="1447.9288">Therefore, yu can use the sudo pallet to call the</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.9603" x="279.1391" y="1453.3252">add_well_known_node function provided by</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="127.1523" x="279.1391" y="1458.7215">node-authorization pallet to add the third node.</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1443.6258 272.5166,1443.6258 L275.8278,1443.6258 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><rect fill="#F1F1F1" height="119.9452" rx="4.1391" ry="4.1391" style="stroke:#181818;stroke-width:0.49668874172185434;" width="205.298" x="275.8278" y="1469.7486"/><a href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-a-sub-node" target="_top" title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-a-sub-node" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-a-sub-node" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/permissioned-network/#add-a-sub-node" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="4.6358" lengthAdjust="spacing" text-decoration="underline" textLength="36.4238" x="279.1391" y="1477.3628">Add a sub-node</text></a><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1482.7591"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="158.9404" x="279.1391" y="1488.1555">The fourth node in this network is not as a well-known node.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1493.5518"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="103.3113" x="279.1391" y="1498.9481">1. This node is owned by the user dave,</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="108.6093" x="279.1391" y="1504.3444">2. but is a sub-node of the charlie node.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1509.7407"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="113.9073" x="279.1391" y="1515.137">The sub-node can only access the network by</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="105.9603" x="279.1391" y="1520.5334">connecting to the node owned by charlie.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1525.9297"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="190.7285" x="279.1391" y="1531.326">The parent node is responsible for any sub-node it authorizes to connect</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="177.4834" x="279.1391" y="1536.7223">and controls access if the sub-node needs to be removed or audited.</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="0" x="279.1391" y="1542.1186"/><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="79.4702" x="279.1391" y="1547.5149">./target/release/node-template</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="34.4371" x="279.1391" y="1552.9113">--chain=local</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="71.5232" x="279.1391" y="1558.3076">--base-path /tmp/validator4</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="29.1391" x="279.1391" y="1563.7039">--name dave</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="198.6755" x="279.1391" y="1569.1002">--node-key=a99331ff4f0e0a0434a6263da0a5823ea3afcfffe590c9f3014e6cf620f2b19a</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="31.7881" x="279.1391" y="1574.4965">--port 30336</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="37.0861" x="279.1391" y="1579.8928">--ws-port 9947</text><text fill="#000000" font-family="monospace" font-size="4.6358" lengthAdjust="spacing" textLength="63.5762" x="279.1391" y="1585.2892">--offchain-worker always</text><path d="M259.2715,1368.5689 L262.5828,1368.5689 C267.5497,1368.5689 267.5497,1529.7211 272.5166,1529.7211 L275.8278,1529.7211 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/><path d="M158.2781,798.1581 L161.5894,798.1581 C166.5563,798.1581 166.5563,1368.5689 171.5232,1368.5689 L174.8344,1368.5689 " fill="none" style="stroke:#181818;stroke-width:0.33112582781456956;"/></g></svg></figure>
<h2 id="monitor-node-metrics"><a class="header" href="#monitor-node-metrics">Monitor node metrics</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="469.8832px" preserveAspectRatio="none" style="width:850px;height:469px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 469" width="850.3972px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="85.6206" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="243.0841" x="3.972" y="191.8365"/><a href="https://docs.substrate.io/tutorials/get-started/node-metrics/" target="_top" title="https://docs.substrate.io/tutorials/get-started/node-metrics/" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/node-metrics/" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/node-metrics/" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" text-decoration="underline" textLength="58.3879" x="7.9439" y="200.9701">Monitor node metrics</text></a><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="1.5888" x="66.3318" y="200.9701"> </text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" text-decoration="underline" textLength="11.1215" x="67.9206" y="200.9701">返回</text></a><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="7.9439" y="207.4431"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="197.0093" x="7.9439" y="213.9162">Substrate exposes metrics about the operation of your network.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="7.9439" y="220.3892"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="149.3458" x="7.9439" y="226.8623">For example, you can collect information about:</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="136.6355" x="7.9439" y="233.3353">1. how many peers your node is connected to</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="120.7477" x="7.9439" y="239.8084">2. how much memory your node is using.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="7.9439" y="246.2815"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="235.1402" x="7.9439" y="252.7545">To visualize these metrics, you can use tools like Prometheus and Grafana.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="7.9439" y="259.2276"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="190.6542" x="7.9439" y="265.7006">This tutorial demonstrates how to use Grafana and Prometheus</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="168.4112" x="7.9439" y="272.1737">to scrape and visualize these types of node metrics .</text><rect fill="#8FBC8F" height="182.7165" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="395.6075" x="266.9159" y="7.9439"/><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="62.757" x="270.8879" y="17.0775">A possible architecture</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="23.5506"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="387.6636" x="270.8879" y="30.0236">+-----------+                     +-------------+                                                              +---------+</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="387.6636" x="270.8879" y="36.4967">| Substrate |                     | Prometheus  |                                                              | Grafana |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="387.6636" x="270.8879" y="42.9697">+-----------+                     +-------------+                                                              +---------+</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="49.4428">|               -----------------\ |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="55.9158">|               | Every 1 minute |-|                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="62.3889">|               |----------------| |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="68.862">|                                  |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="75.335">|        GET current metric values |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="81.8081">|&lt;---------------------------------|                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="88.2811">|                                  |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="94.7542">| `substrate_peers_count 5`        |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="101.2273">|---------------------------------&gt;|                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="107.7003">|                                  | --------------------------------------------------------------------\    |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="114.1734">|                                  |-| Save metric value with corresponding time stamp in local database |    |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="120.6464">|                                  | |-------------------------------------------------------------------|    |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="127.1195">|                                  |                                         -------------------------------\ |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="133.5925">|                                  |                                         | Every time user opens graphs |-|</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="140.0656">|                                  |                                         |------------------------------| |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="146.5387">|                                  |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="153.0117">|                                  |       GET values of metric `substrate_peers_count` from time-X to time-Y |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="159.4848">|                                  |&lt;-------------------------------------------------------------------------|</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="165.9578">|                                  |                                                                          |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="172.4309">|                                  | `substrate_peers_count (1582023828, 5), (1582023847, 4) [...]`           |</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="178.9039">|                                  |-------------------------------------------------------------------------&gt;|</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="352.7103" x="289.9533" y="185.377">|                                  |                                                                          |</text><path d="M247.0561,234.6468 L251.028,234.6468 C256.986,234.6468 256.986,99.3022 262.9439,99.3022 L266.9159,99.3022 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><rect fill="#F1F1F1" height="40.3092" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="297.1028" x="266.9159" y="198.6043"/><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="49.6495" x="270.8879" y="207.7379">Tutorial objectives</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="214.211"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="108.0374" x="270.8879" y="220.684">1. Install Prometheus and Grafana.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="231.9626" x="270.8879" y="227.1571">2. Configure Prometheus to capture a time series for your Substrate node.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="289.1589" x="270.8879" y="233.6301">3. Configure Grafana to visualize the node metrics collected using the Prometheus endpoint.</text><path d="M247.0561,234.6468 L251.028,234.6468 C256.986,234.6468 256.986,218.7589 262.9439,218.7589 L266.9159,218.7589 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><rect fill="#F1F1F1" height="14.417" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="93.3411" x="266.9159" y="246.8575"/><a href="https://docs.substrate.io/tutorials/get-started/node-metrics/#install-prometheus-and-grafana" target="_top" title="https://docs.substrate.io/tutorials/get-started/node-metrics/#install-prometheus-and-grafana" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/node-metrics/#install-prometheus-and-grafana" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/node-metrics/#install-prometheus-and-grafana" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" text-decoration="underline" textLength="85.3972" x="270.8879" y="255.9911">Install Prometheus and Grafana</text></a><path d="M247.0561,234.6468 L251.028,234.6468 C256.986,234.6468 256.986,254.066 262.9439,254.066 L266.9159,254.066 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><rect fill="#F1F1F1" height="14.417" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="69.5093" x="266.9159" y="269.2184"/><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="61.5654" x="270.8879" y="278.352">Start a Substrate node</text><path d="M247.0561,234.6468 L251.028,234.6468 C256.986,234.6468 256.986,276.4269 262.9439,276.4269 L266.9159,276.4269 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><rect fill="#F1F1F1" height="169.7704" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="316.1682" x="266.9159" y="291.5793"/><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="146.9626" x="270.8879" y="300.7129">Configure Prometheus to scrape your Substrate node</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="50.8411" x="270.8879" y="307.1859"># prometheus.yml</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="313.659"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="31.7757" x="270.8879" y="320.132"># --snip--</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="326.6051"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="212.8972" x="270.8879" y="333.0782"># A scrape configuration containing exactly one endpoint to scrape:</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="95.3271" x="270.8879" y="339.5512"># Here it's Prometheus itself.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="47.6636" x="270.8879" y="346.0243">scrape_configs:</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="301.8692" x="277.243" y="352.4973"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="88.972" x="277.243" y="358.9704">- job_name: "substrate_node"</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="365.4434"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="117.5701" x="283.5981" y="371.9165"># metrics_path defaults to '/metrics'</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="88.972" x="283.5981" y="378.3896"># scheme defaults to 'http'.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="384.8626"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="251.028" x="283.5981" y="391.3357"># Override the global default and scrape targets from this job every 5 seconds.</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="247.8505" x="283.5981" y="397.8087"># ** NOTE: you want to have this *LESS THAN* the block time in order to ensure</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="152.5234" x="283.5981" y="404.2818"># ** that you have a data point for every block!</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="60.3738" x="283.5981" y="410.7549">scrape_interval: 5s</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="417.2279"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="47.6636" x="283.5981" y="423.701">static_configs:</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="92.1495" x="289.9533" y="430.174">- targets: ["localhost:9615"]</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="436.6471"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="270.8879" y="443.1201"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="190.6542" x="270.8879" y="449.5932"># specify a custom config file instead if you made one here:</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="130.2804" x="270.8879" y="456.0663">./prometheus --config.file prometheus.yml</text><rect fill="#F1F1F1" height="27.3631" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="93.7383" x="602.9439" y="362.7829"/><text fill="#000000" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" textLength="81.8224" x="606.9159" y="371.9165">Check all Prometheus metrics</text><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="0" x="606.9159" y="378.3896"/><text fill="#000000" font-family="monospace" font-size="5.5607" lengthAdjust="spacing" textLength="85.7944" x="606.9159" y="384.8626">curl localhost:9615/metrics</text><rect fill="#F1F1F1" height="14.417" rx="4.965" ry="4.965" style="stroke:#181818;stroke-width:0.5957943925233644;" width="129.0888" x="716.5421" y="369.256"/><a href="https://docs.substrate.io/tutorials/get-started/node-metrics/#visualizing-prometheus-metrics-with-grafana" target="_top" title="https://docs.substrate.io/tutorials/get-started/node-metrics/#visualizing-prometheus-metrics-with-grafana" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/node-metrics/#visualizing-prometheus-metrics-with-grafana" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/node-metrics/#visualizing-prometheus-metrics-with-grafana" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="5.5607" lengthAdjust="spacing" text-decoration="underline" textLength="121.1449" x="720.514" y="378.3896">Visualizing Prometheus metrics with Grafana</text></a><path d="M696.6822,376.4645 L700.6542,376.4645 C706.6121,376.4645 706.6121,376.4645 712.5701,376.4645 L716.5421,376.4645 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><path d="M583.0841,376.4645 L587.0561,376.4645 C593.014,376.4645 593.014,376.4645 598.972,376.4645 L602.9439,376.4645 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/><path d="M247.0561,234.6468 L251.028,234.6468 C256.986,234.6468 256.986,376.4645 262.9439,376.4645 L266.9159,376.4645 " fill="none" style="stroke:#181818;stroke-width:0.3971962616822429;"/></g></svg></figure>
<h2 id="upgrade-a-running-network"><a class="header" href="#upgrade-a-running-network">Upgrade a running network</a></h2>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1495.8356px" preserveAspectRatio="none" style="width:850px;height:1495px;background:#FFFFFF;" version="1.1" viewBox="0 0 850 1495" width="850.4567px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="109.6185" x="4.5674" y="739.2682"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="85.8678" x="9.1349" y="749.7711">Upgrade a running network</text><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#总览" target="_top" title="#总览" xlink:actuate="onRequest" xlink:href="#总览" xlink:show="new" xlink:title="#总览" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="12.7888" x="96.8297" y="749.7711">返回</text></a><rect fill="#F1F1F1" height="165.4483" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="268.5653" x="137.0231" y="9.1349"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="70.7953" x="141.5905" y="19.6377">Forkless upgrade intro</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="27.0812"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="252.1225" x="141.5905" y="34.5247">Unlike many blockchains, the Substrate development framework supports</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="248.4686" x="141.5905" y="41.9682">forkless upgrades to the runtime that is the core of the blockchain.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="49.4117"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="233.8528" x="141.5905" y="56.8552">Most blockchain projects require a hard fork of the code base to</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="215.583" x="141.5905" y="64.2987">support ongoing development of new features or enhancements</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="76.7329" x="141.5905" y="71.7422">to existing features.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="79.1857"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="259.4304" x="141.5905" y="86.6292">With Substrate , you can deploy enhanced runtime capabilities—including</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="135.1961" x="141.5905" y="94.0727">breaking changes—without a hard fork.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="101.5162"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="211.9291" x="141.5905" y="108.9597">Because the definition of the runtime is itself an element</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="222.8909" x="141.5905" y="116.4032">in a Substrate chain's state, network participants can update</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="222.8909" x="141.5905" y="123.8467">this value by calling the set_code function in a transaction.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="131.2902"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="219.237" x="141.5905" y="138.7337">Because updates to the runtime state are validates using the</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="141.5905" y="146.1772">blockchain's consensus mechanisms and cryptographic guarantees,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="233.8528" x="141.5905" y="153.6207">network participants can use the blockchain itself to distribute</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="222.8909" x="141.5905" y="161.0641">updated or extended runtime logic without needing to fork the</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="149.8119" x="141.5905" y="168.5076">chain or release a new blockchain client.</text><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="39.28" x="428.4256" y="70.7132"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="30.1451" x="432.993" y="81.2161">Hard Fork</text><path d="M405.5884,91.859 L410.1558,91.859 C417.007,91.859 417.007,79.0024 423.8581,79.0024 L428.4256,79.0024 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="98.1999" x="428.4256" y="96.4264"/><a href="https://paritytech.github.io/substrate/master/frame_system/pallet/enum.Call.html#variant.set_code" target="_top" title="https://paritytech.github.io/substrate/master/frame_system/pallet/enum.Call.html#variant.set_code" xlink:actuate="onRequest" xlink:href="https://paritytech.github.io/substrate/master/frame_system/pallet/enum.Call.html#variant.set_code" xlink:show="new" xlink:title="https://paritytech.github.io/substrate/master/frame_system/pallet/enum.Call.html#variant.set_code" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="89.065" x="432.993" y="106.9293">Substrate set_code function</text></a><path d="M405.5884,91.859 L410.1558,91.859 C417.007,91.859 417.007,104.7156 423.8581,104.7156 L428.4256,104.7156 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,91.859 132.4557,91.859 L137.0231,91.859 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="46.3523" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="253.9495" x="137.0231" y="183.718"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="57.093" x="141.5905" y="194.2209">Tutorial objectives</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="201.6644"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="241.1607" x="141.5905" y="209.1079">1. Use the Sudo pallet to simulate governance for a chain upgrade.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="244.8146" x="141.5905" y="216.5514">2. Upgrade the runtime for a running node to include a new pallet .</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="135.1961" x="141.5905" y="223.9949">3. Schedule an upgrade for a runtime.</text><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,206.8942 132.4557,206.8942 L137.0231,206.8942 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="98.4568" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="250.2955" x="137.0231" y="271.0096"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="136.5664" x="141.5905" y="281.5125">Authorize an upgrade using the Sudo pallet</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="288.9559"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="141.5905" y="296.3994">In FRAME, the Root origin identifies the runtime administrator.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="208.2751" x="141.5905" y="303.8429">Only this administrator can update the runtime by calling</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="222.8909" x="141.5905" y="311.2864">the set_code function. To invoke this function using the Root</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="141.5905" y="318.7299">origin, you can use the the sudo function in the Sudo pallet to</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="241.1607" x="141.5905" y="326.1734">specify the account that has superuser administrative permissions.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="333.6169"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="226.5449" x="141.5905" y="341.0604">By default, the chain specification file for the node template</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="219.237" x="141.5905" y="348.5039">specifies that the alice development account is the owner of</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="226.5449" x="141.5905" y="355.9474">the Sudo administrative account. Therefore, this tutorial uses</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="168.0817" x="141.5905" y="363.3909">the alice account to perform runtime upgrades.</text><rect fill="#F1F1F1" height="150.5613" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="257.6034" x="410.1558" y="183.718"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="135.6529" x="414.7233" y="194.2209">Resource accounting for runtime upgrades</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="201.6644"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="414.7233" y="209.1079">Function calls that are dispatched to the Substrate runtime are</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="226.5449" x="414.7233" y="216.5514">always associated with a weight to account for resource usage.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="414.7233" y="223.9949">The FRAME System module sets boundaries on the block length and</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="164.4277" x="414.7233" y="231.4384">block weight that these transactions can use.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="238.8819"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="215.583" x="414.7233" y="246.3253">However, the set_code function is intentionally designed to</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="222.8909" x="414.7233" y="253.7688">consume the maximum weight that can fit in a block. Forcing a</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="233.8528" x="414.7233" y="261.2123">runtime upgrade to consume an entire block prevents transactions</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="248.4686" x="414.7233" y="268.6558">in the same block from executing on different versions of a runtime.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="276.0993"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="244.8146" x="414.7233" y="283.5428">The weight annotation for the set_code function also specifies that</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="248.4686" x="414.7233" y="290.9863">the function is in the Operational class because it provides network</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="237.5067" x="414.7233" y="298.4298">capabilities. Functions calls that are identified as operational:</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="305.8733"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="182.6975" x="414.7233" y="313.3168">1. Can consume the entire weight limit of a block.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="109.6185" x="414.7233" y="320.7603">2. Are given maximum priority.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="171.7356" x="414.7233" y="328.2038">3. Are exempt from paying the transaction fees.</text><path d="M387.3186,320.238 L391.8861,320.238 C398.7372,320.238 398.7372,258.9986 405.5884,258.9986 L410.1558,258.9986 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="113.3438" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="268.5653" x="410.1558" y="343.4142"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="97.7431" x="414.7233" y="353.917">Managing resource accounting</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="361.3605"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="230.1988" x="414.7233" y="368.804">In this tutorial, the sudo_unchecked_weight function is used to</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="193.6593" x="414.7233" y="376.2475">invoke the set_code function for the runtime upgrade.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="383.691"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="244.8146" x="414.7233" y="391.1345">The sudo_unchecked_weight function is the same as the sudo function</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="252.1225" x="414.7233" y="398.578">except that it supports an additional parameter to specify the weight</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="259.4304" x="414.7233" y="406.0215">to use for the call. This parameter enables you to work around resource</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="244.8146" x="414.7233" y="413.465">accounting safeguards to specify a weight of zero for the call that</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="248.4686" x="414.7233" y="420.9085">dispatches the set_code function. This setting allows for a block to</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="252.1225" x="414.7233" y="428.352">take an indefinite time to compute to ensure that the runtime upgrade</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="197.3133" x="414.7233" y="435.7955">does not fail, no matter how complex the operation is.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="414.7233" y="443.239"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="193.6593" x="414.7233" y="450.6825">It can take all the time it needs to succeed or fail.</text><path d="M387.3186,320.238 L391.8861,320.238 C398.7372,320.238 398.7372,400.0861 405.5884,400.0861 L410.1558,400.0861 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,320.238 132.4557,320.238 L137.0231,320.238 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="38.9089" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="308.7587" x="137.0231" y="482.4712"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="152.0956" x="141.5905" y="492.9741">Upgrade the runtime to add the Scheduler pallet</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="500.4176"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="255.7765" x="141.5905" y="507.8611">The node template doesn't include the Scheduler pallet in its runtime.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="299.6239" x="141.5905" y="515.3046">To illustrate a runtime upgrade, let's add the Scheduler pallet to a running node.</text><rect fill="#F1F1F1" height="46.3523" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="199.1402" x="468.619" y="465.8928"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="173.5626" x="473.1865" y="476.3957">First Screen: Start the local node in development mode</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="95.0027" x="473.1865" y="483.8392"># Leave this node running.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="190.0054" x="473.1865" y="491.2827"># You can edit and re-compile to upgrade the runtime</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="182.6975" x="473.1865" y="498.7262"># without stopping or restarting the running node.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="102.3106" x="473.1865" y="506.1697">cargo run --release -- --dev</text><path d="M445.7818,501.9256 L450.3493,501.9256 C457.2004,501.9256 457.2004,489.069 464.0516,489.069 L468.619,489.069 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="121.4938" x="468.619" y="521.3801"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="112.3589" x="473.1865" y="531.8829">Second Screen: Upgrade Operation</text><path d="M445.7818,501.9256 L450.3493,501.9256 C457.2004,501.9256 457.2004,529.6692 464.0516,529.6692 L468.619,529.6692 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,501.9256 132.4557,501.9256 L137.0231,501.9256 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="151.1822" x="137.0231" y="612.0544"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="142.0473" x="141.5905" y="622.5573">substrate-node-template/runtime/Cargo.toml</text><rect fill="#F1F1F1" height="76.1263" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="213.756" x="311.0425" y="547.0933"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="133.3692" x="315.6099" y="557.5962">Add the Scheduler pallet as a dependency</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="51.1553" x="315.6099" y="565.0397">[dependencies]</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.9618" x="315.6099" y="572.4832">...</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="73.079" x="315.6099" y="579.9267">pallet-scheduler = {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="80.3869" x="330.2257" y="587.3702">version = "4.0.0-dev",</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="91.3487" x="330.2257" y="594.8136">default-features = false,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="190.0054" x="330.2257" y="602.2571">git = "https://github.com/paritytech/substrate.git",</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="105.9645" x="333.8796" y="609.7006">branch = "polkadot-v0.9.24" }</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.9618" x="315.6099" y="617.1441">...</text><path d="M288.2053,620.3436 L292.7727,620.3436 C299.6239,620.3436 299.6239,585.1565 306.475,585.1565 L311.0425,585.1565 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="61.2393" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="147.0715" x="311.0425" y="632.3545"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="137.9366" x="315.6099" y="642.8574">Add the Scheduler pallet to the features list.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="36.5395" x="315.6099" y="650.3009">[features]</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="62.1171" x="315.6099" y="657.7444">default = ["std"]</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="25.5776" x="315.6099" y="665.1879">std = [</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.9618" x="319.2638" y="672.6314">...</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="84.0408" x="319.2638" y="680.0748">"pallet-scheduler/std",</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.9618" x="319.2638" y="687.5183">...</text><path d="M288.2053,620.3436 L292.7727,620.3436 C299.6239,620.3436 299.6239,662.9742 306.475,662.9742 L311.0425,662.9742 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,620.3436 132.4557,620.3436 L137.0231,620.3436 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="143.4175" x="137.0231" y="943.6253"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="134.2826" x="141.5905" y="954.1282">substrate-node-template/runtime/src/lib.rs</text><rect fill="#F1F1F1" height="46.3523" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="190.9189" x="303.2778" y="702.7287"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="146.158" x="307.8452" y="713.2316">Add the types required by the Scheduler pallet</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="65.7711" x="307.8452" y="720.6751">parameter_types! {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="178.13" x="311.4992" y="728.1186">pub MaximumSchedulerWeight: Weight = 10_000_000；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="152.5524" x="311.4992" y="735.5621">pub const MaxScheduledPerBlock: u32 = 50；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="3.6539" x="307.8452" y="743.0056">}</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,725.9049 298.7104,725.9049 L303.2778,725.9049 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="120.7873" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="227.4584" x="303.2778" y="758.2159"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="211.9291" x="307.8452" y="768.7188">Add the implementation for the Config trait for the Scheduler pallet .</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="307.8452" y="776.1623"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="157.1198" x="307.8452" y="783.6058">impl pallet_scheduler::Config for Runtime {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="72.1655" x="311.4992" y="791.0493">type Event = Event；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="79.4734" x="311.4992" y="798.4928">type Origin = Origin；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="126.9747" x="311.4992" y="805.9363">type PalletsOrigin = OriginCaller；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="64.8576" x="311.4992" y="813.3798">type Call = Call；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="163.5142" x="311.4992" y="820.8233">type MaximumWeight = MaximumSchedulerWeight；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="214.6695" x="311.4992" y="828.2668">type ScheduleOrigin = frame_system::EnsureRoot&lt;AccountId&gt;；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="181.784" x="311.4992" y="835.7103">type MaxScheduledPerBlock = MaxScheduledPerBlock；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="79.4734" x="311.4992" y="843.1538">type WeightInfo = ()；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="167.1682" x="311.4992" y="850.5972">type OriginPrivilegeCmp = EqualPrivilegeOnly；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="101.3971" x="311.4992" y="858.0407">type PreimageProvider = ()；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="123.3208" x="311.4992" y="865.4842">type NoPreimagePostponement = ()；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="3.6539" x="307.8452" y="872.9277">}</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,818.6096 298.7104,818.6096 L303.2778,818.6096 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="98.4568" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="204.1644" x="303.2778" y="888.1381"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="195.0296" x="307.8452" y="898.641">Add the Scheduler pallet inside the construct_runtime! macro.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="307.8452" y="906.0845"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="69.425" x="307.8452" y="913.528">construct_runtime!(</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="80.3869" x="311.4992" y="920.9715">pub enum Runtime where</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="51.1553" x="311.4992" y="928.415">Block = Block,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="95.0027" x="311.4992" y="935.8584">NodeBlock = opaque::Block,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="142.504" x="311.4992" y="943.3019">UncheckedExtrinsic = UncheckedExtrinsic</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="3.6539" x="311.4992" y="950.7454">{</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="36.5395" x="318.8071" y="958.1889">/* snip */</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="102.3106" x="318.8071" y="965.6324">Scheduler: pallet_scheduler,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="3.6539" x="311.4992" y="973.0759">}</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.0484" x="307.8452" y="980.5194">)；</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,937.3665 298.7104,937.3665 L303.2778,937.3665 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="31.4654" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="194.5728" x="303.2778" y="995.7298"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="174.4761" x="307.8452" y="1006.2327">Add the following trait dependency at the top of the file:</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="307.8452" y="1013.6762"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="185.4379" x="307.8452" y="1021.1196">pub use frame_support::traits::EqualPrivilegeOnly；</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,1011.4625 298.7104,1011.4625 L303.2778,1011.4625 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="91.0133" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="297.7969" x="303.2778" y="1036.33"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="107.3348" x="307.8452" y="1046.8329">Increment the spec_version in the</text><a href="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html" target="_top" title="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html" xlink:actuate="onRequest" xlink:href="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html" xlink:show="new" xlink:title="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="70.3385" x="417.007" y="1046.8329">RuntimeVersion struct</text></a><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="307.8452" y="1054.2764"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="190.0054" x="307.8452" y="1061.7199">pub const VERSION: RuntimeVersion = RuntimeVersion {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="175.3896" x="311.4992" y="1069.1634">spec_name: create_runtime_str!("node-template"),</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="175.3896" x="311.4992" y="1076.6069">impl_name: create_runtime_str!("node-template"),</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="76.7329" x="311.4992" y="1084.0504">authoring_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="285.0081" x="311.4992" y="1091.4939">spec_version: 101,  // *Increment* this value, the template uses 100 as a base</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="58.4632" x="311.4992" y="1098.9374">impl_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="98.6566" x="311.4992" y="1106.3808">apis: RUNTIME_API_VERSIONS,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="84.0408" x="311.4992" y="1113.8243">transaction_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.0484" x="307.8452" y="1121.2678">}；</text><rect fill="#F1F1F1" height="83.5698" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="221.0639" x="623.9119" y="1014.3385"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="168.9952" x="628.4793" y="1024.8414">Review the components of the RuntimeVersion struct</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="628.4793" y="1032.2849"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="160.7738" x="628.4793" y="1039.7284">spec_name specifies the name of the runtime.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="157.1198" x="628.4793" y="1047.1719">impl_name specifies the name of the client.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="211.9291" x="628.4793" y="1054.6154">authoring_version specifies the version for block authors.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="182.6975" x="628.4793" y="1062.0589">spec_version specifies the version of the runtime.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="179.0435" x="628.4793" y="1069.5024">impl_version specifies the version of the client.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="153.4659" x="628.4793" y="1076.9459">apis specifies the list of supported APIs.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="160.7738" x="628.4793" y="1084.3894">transaction_version specifies the version of</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="131.5422" x="628.4793" y="1091.8328">the dispatchable function interface.</text><path d="M601.0747,1081.8367 L605.6421,1081.8367 C612.4933,1081.8367 612.4933,1056.1234 619.3444,1056.1234 L623.9119,1056.1234 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="29.6883" x="623.9119" y="1107.0432"/><a href="https://docs.substrate.io/reference/glossary/#author" target="_top" title="https://docs.substrate.io/reference/glossary/#author" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/reference/glossary/#author" xlink:show="new" xlink:title="https://docs.substrate.io/reference/glossary/#author" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="20.5535" x="628.4793" y="1117.5461">author</text></a><path d="M601.0747,1081.8367 L605.6421,1081.8367 C612.4933,1081.8367 612.4933,1115.3324 619.3444,1115.3324 L623.9119,1115.3324 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="36.0828" x="623.9119" y="1132.7565"/><a href="https://docs.substrate.io/reference/glossary/#dispatch" target="_top" title="https://docs.substrate.io/reference/glossary/#dispatch" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/reference/glossary/#dispatch" xlink:show="new" xlink:title="https://docs.substrate.io/reference/glossary/#dispatch" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="26.9479" x="628.4793" y="1143.2593">dispatch</text></a><path d="M601.0747,1081.8367 L605.6421,1081.8367 C612.4933,1081.8367 612.4933,1141.0456 619.3444,1141.0456 L623.9119,1141.0456 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,1081.8367 298.7104,1081.8367 L303.2778,1081.8367 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="38.9089" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="177.2166" x="303.2778" y="1136.4782"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="154.3794" x="307.8452" y="1146.9811">Build the updated runtime in the second terminal</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="307.8452" y="1154.4246"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="131.5422" x="307.8452" y="1161.8681"># without stopping the running node.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="168.0817" x="307.8452" y="1169.3116">cargo build --release -p node-template-runtime</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,1155.9326 298.7104,1155.9326 L303.2778,1155.9326 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="256.69" x="303.2778" y="1184.5219"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="247.5551" x="307.8452" y="1195.0248">Connect to the local node to upgrade the runtime to use the new build artifact.</text><path d="M280.4406,951.9145 L285.0081,951.9145 C291.8592,951.9145 291.8592,1192.8111 298.7104,1192.8111 L303.2778,1192.8111 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,951.9145 132.4557,951.9145 L137.0231,951.9145 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="79.9301" x="137.0231" y="969.3386"/><a href="https://polkadot.js.org/apps/#/extrinsics?rpc=ws://127.0.0.1:9944" target="_top" title="https://polkadot.js.org/apps/#/extrinsics?rpc=ws://127.0.0.1:9944" xlink:actuate="onRequest" xlink:href="https://polkadot.js.org/apps/#/extrinsics?rpc=ws://127.0.0.1:9944" xlink:show="new" xlink:title="https://polkadot.js.org/apps/#/extrinsics?rpc=ws://127.0.0.1:9944" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="70.7953" x="141.5905" y="979.8414">Polkadot-JS application</text></a><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,977.6277 132.4557,977.6277 L137.0231,977.6277 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="68.6828" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="327.0285" x="137.0231" y="1313.7661"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="68.0548" x="141.5905" y="1324.269">Schedule an Upgrade</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="1331.7125"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="285.0081" x="141.5905" y="1339.156">Now that the node template has been upgraded to include the Scheduler pallet ,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="255.7765" x="141.5905" y="1346.5995">the schedule function can be used to perform the next runtime upgrade.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="141.5905" y="1354.043"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="281.3541" x="141.5905" y="1361.4865">In the previous part, the sudo_unchecked_weight function was used to override</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="285.0081" x="141.5905" y="1368.93">the weight associated with the set_code function; in this section, the runtime</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="317.8936" x="141.5905" y="1376.3735">upgrade will be scheduled so that it can be processed as the only extrinsic in a block.</text><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="78.1032" x="486.8888" y="1210.2352"/><a href="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/enum.Call.html#variant.schedule" target="_top" title="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/enum.Call.html#variant.schedule" xlink:actuate="onRequest" xlink:href="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/enum.Call.html#variant.schedule" xlink:show="new" xlink:title="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/enum.Call.html#variant.schedule" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="68.9683" x="491.4562" y="1220.738">the schedule function</text></a><path d="M464.0516,1348.1075 L468.619,1348.1075 C475.4702,1348.1075 475.4702,1218.5244 482.3213,1218.5244 L486.8888,1218.5244 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="35.1693" x="486.8888" y="1235.9484"/><a href="https://docs.substrate.io/main-docs/fundamentals/transaction-types/" target="_top" title="https://docs.substrate.io/main-docs/fundamentals/transaction-types/" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/main-docs/fundamentals/transaction-types/" xlink:show="new" xlink:title="https://docs.substrate.io/main-docs/fundamentals/transaction-types/" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="26.0344" x="491.4562" y="1246.4513">extrinsic</text></a><path d="M464.0516,1348.1075 L468.619,1348.1075 C475.4702,1348.1075 475.4702,1244.2376 482.3213,1244.2376 L486.8888,1244.2376 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="158.0048" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="250.2955" x="486.8888" y="1261.6617"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="95.4594" x="491.4562" y="1272.1645">Prepare an Upgraded Runtime</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="76.7329" x="491.4562" y="1279.608">// runtime/src/lib.rs</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="190.0054" x="491.4562" y="1287.0515">pub const VERSION: RuntimeVersion = RuntimeVersion {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="175.3896" x="495.1102" y="1294.495">spec_name: create_runtime_str!("node-template"),</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="175.3896" x="495.1102" y="1301.9385">impl_name: create_runtime_str!("node-template"),</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="76.7329" x="495.1102" y="1309.382">authoring_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="168.0817" x="495.1102" y="1316.8255">spec_version: 102,  // *Increment* this value.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="58.4632" x="495.1102" y="1324.269">impl_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="98.6566" x="495.1102" y="1331.7125">apis: RUNTIME_API_VERSIONS,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="84.0408" x="495.1102" y="1339.156">transaction_version: 1,</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="10.0484" x="491.4562" y="1346.5995">}；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="491.4562" y="1354.043"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="36.5395" x="491.4562" y="1361.4865">/* snip */</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="491.4562" y="1368.93"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="65.7711" x="491.4562" y="1376.3735">parameter_types! {</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="237.5067" x="495.1102" y="1383.817">pub const ExistentialDeposit: u128 = 1000;  // Update this value.</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="108.705" x="495.1102" y="1391.2604">pub const MaxLocks: u32 = 50；</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="3.6539" x="491.4562" y="1398.7039">}</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="491.4562" y="1406.1474"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="36.5395" x="491.4562" y="1413.5909">/* snip */</text><path d="M464.0516,1348.1075 L468.619,1348.1075 C475.4702,1348.1075 475.4702,1340.664 482.3213,1340.664 L486.8888,1340.664 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="31.4654" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="177.2166" x="486.8888" y="1428.8013"/><text fill="#000000" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" textLength="86.3246" x="491.4562" y="1439.3042">Build the upgraded runtime</text><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="0" x="491.4562" y="1446.7477"/><text fill="#000000" font-family="monospace" font-size="6.3944" lengthAdjust="spacing" textLength="168.0817" x="491.4562" y="1454.1912">cargo build --release -p node-template-runtime</text><path d="M464.0516,1348.1075 L468.619,1348.1075 C475.4702,1348.1075 475.4702,1444.534 482.3213,1444.534 L486.8888,1444.534 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><rect fill="#F1F1F1" height="16.5784" rx="5.7093" ry="5.7093" style="stroke:#181818;stroke-width:0.6851155292853305;" width="76.7329" x="486.8888" y="1469.4015"/><a href="https://docs.substrate.io/tutorials/get-started/forkless-upgrade/#upgrade-the-runtime" target="_top" title="https://docs.substrate.io/tutorials/get-started/forkless-upgrade/#upgrade-the-runtime" xlink:actuate="onRequest" xlink:href="https://docs.substrate.io/tutorials/get-started/forkless-upgrade/#upgrade-the-runtime" xlink:show="new" xlink:title="https://docs.substrate.io/tutorials/get-started/forkless-upgrade/#upgrade-the-runtime" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="6.3944" lengthAdjust="spacing" text-decoration="underline" textLength="67.5981" x="491.4562" y="1479.9044">Upgrade the Runtime</text></a><path d="M464.0516,1348.1075 L468.619,1348.1075 C475.4702,1348.1075 475.4702,1477.6907 482.3213,1477.6907 L486.8888,1477.6907 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/><path d="M114.1859,747.5574 L118.7534,747.5574 C125.6045,747.5574 125.6045,1348.1075 132.4557,1348.1075 L137.0231,1348.1075 " fill="none" style="stroke:#181818;stroke-width:0.4567436861902203;"/></g></svg></figure>
<h1 id="work-with-pallets"><a class="header" href="#work-with-pallets">Work with pallets</a></h1>
<h2 id="文档代码更新问题"><a class="header" href="#文档代码更新问题">文档/代码更新问题</a></h2>
<pre><code class="language-admonisth warn title='substrate文档更新带来的问题'">由于目前substrate的源码和文档都在快速更新，所以可能出现一些未曾说过的问题。比如链接找不到、目录里面不存在对应文章链接、编译时依赖包版本冲突。这些都需要对文档的熟悉、对rust编程的熟悉才能轻松越过。
</code></pre>
<h2 id="pallet前置rust知识"><a class="header" href="#pallet前置rust知识">Pallet前置Rust知识</a></h2>
<p><a id="Pallet-Preset"></a>Pallet-Preset</p>
<h2 id="pallet组成"><a class="header" href="#pallet组成">Pallet组成</a></h2>
<div id="admonition-pallet基础模版" class="admonition info">
<div class="admonition-title">
<p>pallet基础模版</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-pallet基础模版"></a></p>
</div>
<div>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 1. Imports and Dependencies
pub use pallet::*;

#[frame_support::pallet]
pub mod pallet {
    use frame_support::pallet_prelude::*;
    use frame_system::pallet_prelude::*;

    // 2. Declaration of the Pallet type
    // This is a placeholder to implement traits and methods.
    #[pallet::pallet]
    #[pallet::generate_store(pub (super) trait Store)]
    pub struct Pallet&lt;T&gt;(_);

    // 3. Runtime Configuration Trait
    // All types and constants go here.
    // Use #[pallet::constant] and #[pallet::extra_constants]
    // to pass in values to metadata.
    #[pallet::config]
    pub trait Config: frame_system::Config { ... }

    // 4. Runtime Storage
    // Use to declare storage items.
<span class="boring">    [pallet::storage]
</span><span class="boring">    [pallet::getter(fn something)]
</span>    pub MyStorage&lt;T: Config&gt; = StorageValue&lt;_, u32&gt;;

    // 5. Runtime Events
    // Can stringify event types to metadata.
    #[pallet::event]
    #[pallet::generate_deposit(pub (super) fn deposit_event)]
    pub enum Event&lt;T: Config&gt; {...
}

// 6. Hooks
// Define some logic that should be executed
// regularly in some context, for e.g. on_initialize.
#[pallet::hooks]
impl&lt;T: Config&gt; Hooks&lt;BlockNumberFor&lt;T&gt;&gt; for Pallet&lt;T&gt; { ... }

// 7. Extrinsics
// Functions that are callable from outside the runtime.
#[pallet::call]
impl&lt;T: Config&gt; Pallet&lt;T&gt; { ... }

}
<span class="boring">}
</span></code></pre></pre>
</div>
</div>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="922px" preserveAspectRatio="none" style="width:756px;height:922px;background:#FFFFFF;" version="1.1" viewBox="0 0 756 922" width="756px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="113" x="10" y="442.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="20" y="465.2217">Pallet基本格式</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="267" x="173" y="20"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="183" y="42.9951">1. 依赖：Imports and Dependencies</text><path d="M123,460.375 L133,460.375 C148,460.375 148,38.1484 163,38.1484 L173,38.1484 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="299" x="173" y="76.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="279" x="183" y="99.292">2. 类型声明: Declaration of the Pallet type</text><path d="M123,460.375 L133,460.375 C148,460.375 148,94.4453 163,94.4453 L173,94.4453 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="78" x="173" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="183" y="268.1826">Runtime</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="309" x="301" y="132.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="289" x="311" y="155.5889">3. 运行时配置：Runtime Configuration Trait</text><path d="M251,263.3359 L261,263.3359 C276,263.3359 276,150.7422 291,150.7422 L301,150.7422 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="232" x="301" y="273.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="311" y="296.3311">4. 运行时存储: Runtime Storage</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="116" x="583" y="188.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="593" y="211.8857">Storage Value</text><path d="M533,291.4844 L543,291.4844 C558,291.4844 558,207.0391 573,207.0391 L583,207.0391 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="107" x="583" y="245.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="593" y="268.1826">Storage Map</text><path d="M533,291.4844 L543,291.4844 C558,291.4844 558,263.3359 573,263.3359 L583,263.3359 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="161" x="583" y="301.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="593" y="324.4795">Storage Double Map</text><path d="M533,291.4844 L543,291.4844 C558,291.4844 558,319.6328 573,319.6328 L583,319.6328 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="121" x="583" y="357.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="593" y="380.7764">Storage N Map</text><path d="M533,291.4844 L543,291.4844 C558,291.4844 558,375.9297 573,375.9297 L583,375.9297 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M251,263.3359 L261,263.3359 C276,263.3359 276,291.4844 291,291.4844 L301,291.4844 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="225" x="301" y="329.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="311" y="352.6279">5. 运行时事件: Runtime Events</text><path d="M251,263.3359 L261,263.3359 C276,263.3359 276,347.7813 291,347.7813 L301,347.7813 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M123,460.375 L133,460.375 C148,460.375 148,263.3359 163,263.3359 L173,263.3359 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="198" x="173" y="611.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178" x="183" y="634.1123">6. 生命周期钩子函数-Hooks</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="67" x="421" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="431" y="493.3701">normal</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="99" x="538" y="414.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="548" y="437.0732">on_initialize</text><path d="M488,488.5234 L498,488.5234 C513,488.5234 513,432.2266 528,432.2266 L538,432.2266 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="69" x="538" y="470.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="49" x="548" y="493.3701">on_idle</text><path d="M488,488.5234 L498,488.5234 C513,488.5234 513,488.5234 528,488.5234 L538,488.5234 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="92" x="538" y="526.6719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="548" y="549.667">on_finalize</text><path d="M488,488.5234 L498,488.5234 C513,488.5234 513,544.8203 528,544.8203 L538,544.8203 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M371,629.2656 L381,629.2656 C396,629.2656 396,488.5234 411,488.5234 L421,488.5234 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="78" x="421" y="639.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="431" y="662.2607">upgrade</text><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="108" x="549" y="582.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="559" y="605.9639">pre_upgrade</text><path d="M499,657.4141 L509,657.4141 C524,657.4141 524,601.1172 539,601.1172 L549,601.1172 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="163" x="549" y="639.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="559" y="662.2607">on_runtime_upgrade</text><path d="M499,657.4141 L509,657.4141 C524,657.4141 524,657.4141 539,657.4141 L549,657.4141 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="116" x="549" y="695.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="559" y="718.5576">post_upgrade</text><path d="M499,657.4141 L509,657.4141 C524,657.4141 524,713.7109 539,713.7109 L549,713.7109 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M371,629.2656 L381,629.2656 C396,629.2656 396,657.4141 411,657.4141 L421,657.4141 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="128" x="421" y="751.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="431" y="774.8545">offchain_worker</text><path d="M371,629.2656 L381,629.2656 C396,629.2656 396,770.0078 411,770.0078 L421,770.0078 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="109" x="421" y="808.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="431" y="831.1514">integrity_test</text><path d="M371,629.2656 L381,629.2656 C396,629.2656 396,826.3047 411,826.3047 L421,826.3047 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M123,460.375 L133,460.375 C148,460.375 148,629.2656 163,629.2656 L173,629.2656 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#F1F1F1" height="36.2969" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:1.5;" width="209" x="173" y="864.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="189" x="183" y="887.4482">7. Extrinsics: 对外提供的功能</text><path d="M123,460.375 L133,460.375 C148,460.375 148,882.6016 163,882.6016 L173,882.6016 " fill="none" style="stroke:#181818;stroke-width:1.0;"/></g></svg></figure>
<h2 id="add-a-pallet-to-the-runtime"><a class="header" href="#add-a-pallet-to-the-runtime">Add a pallet to the runtime</a></h2>
<blockquote>
<p>设置昵称：添加第一个Pallet到Runtime</p>
</blockquote>
<blockquote>
<p>substrate node template提供了一个最小的可工作的运行时，但是为了保持精炼，它并不包括Frame中的大多数的Pallet</p>
</blockquote>
<div id="admonition-官方教程地址" class="admonition info">
<div class="admonition-title">
<p>官方教程地址</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-官方教程地址"></a></p>
</div>
<div>
<p><a href="https://docs.substrate.io/tutorials/work-with-pallets/add-a-pallet/">Add a pallet to the runtime | Substrate_ Docs</a></p>
</div>
</div>
<p>接下来接着使用前面的node template</p>
<h3 id="runtime结构分析"><a class="header" href="#runtime结构分析">runtime结构分析</a></h3>
<pre><code class="language-shell">tree -L 2 runtime                                                                                               ─╯
runtime
├── Cargo.toml
├── build.rs
└── src
    └── lib.rs

1 directory, 3 files
</code></pre>
<h3 id="runtimecargotoml结构分析"><a class="header" href="#runtimecargotoml结构分析">runtime/Cargo.toml结构分析</a></h3>
<h4 id="package-"><a class="header" href="#package-">[package] {...}</a></h4>
<h4 id="packagemetadatadocsrs-"><a class="header" href="#packagemetadatadocsrs-">[package.metadata.docs.rs] {...}</a></h4>
<h4 id="dependencies-"><a class="header" href="#dependencies-">[dependencies] {...}</a></h4>
<h4 id="build-dependencies-"><a class="header" href="#build-dependencies-">[build-dependencies] {...}</a></h4>
<h4 id="features-"><a class="header" href="#features-">[features] {...}</a></h4>
<h3 id="四步添加pallet"><a class="header" href="#四步添加pallet">四步添加pallet</a></h3>
<h4 id="添加依赖-cargotomldependincies"><a class="header" href="#添加依赖-cargotomldependincies">添加依赖: Cargo.toml/[dependincies]</a></h4>
<pre><code class="language-toml">pallet-nicks = { default-features = false, version = '4.0.0-dev', git = 'https://github.com/paritytech/substrate.git', tag = 'monthly-2021-08' }
</code></pre>
<div id="admonition-排地雷" class="admonition note">
<div class="admonition-title">
<p>排地雷</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-排地雷"></a></p>
</div>
<div>
<p>由于官方文档和代码一直都在更新，可能会出现问题，这里就需要根据默认依赖的substrate分支进行更换</p>
<pre><code class="language-toml">[dependencies]
sp-std = { version = &quot;4.0.0-dev&quot;, default-features = false, git = &quot;https://github.com/paritytech/substrate.git&quot;, branch = &quot;polkadot-v0.9.24&quot; }
</code></pre>
<p>如上所示，对应的分支为：branch = “polkadot-v0.9.24”, 所以需要改成：</p>
<pre><code class="language-toml">[dependencies.pallet-nicks]
default-features = false
git = 'https://github.com/paritytech/substrate.git'
#tag = 'monthly-2021-10'
#tag = 'monthly-2022-04'
branch = &quot;polkadot-v0.9.24&quot;
version = '4.0.0-dev'
</code></pre>
<blockquote>
<p>详见: <a href="layer5_ecosystem/7_business/blockchain/substrate//layer2_design_abstract/6_module_manage/cargo_rustc.html#cargo-%E4%B8%8E-git-%E7%9A%84%E5%85%B3%E8%81%94">cargo 与 git</a></p>
</blockquote>
</div>
</div>
<h4 id="添加feature-cargotomlfeatures"><a class="header" href="#添加feature-cargotomlfeatures">添加feature: Cargo.toml/[features]</a></h4>
<pre><code class="language-toml">[features]
default = [&quot;std&quot;]
std = [
    #--snip--
    'pallet-nicks/std',
    #--snip--
]
</code></pre>
<h4 id="配置-添加config接口-srclibrs"><a class="header" href="#配置-添加config接口-srclibrs">配置-&gt;添加config接口: src/lib.rs</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// Add this code block to your template for Nicks:
parameter_types! {
    // Choose a fee that incentivizes desireable behavior.
    pub const NickReservationFee: u128 = 100;
    pub const MinNickLength: usize = 8;
    // Maximum bounds on storage are important to secure your chain.
    pub const MaxNickLength: usize = 32;
}

impl pallet_nicks::Config for Runtime {
    // The Balances pallet implements the ReservableCurrency trait.
    // https://substrate.dev/rustdocs/v3.0.0/pallet_balances/index.html#implementations-2
    type Currency = pallet_balances::Module&lt;Runtime&gt;;

    // Use the NickReservationFee from the parameter_types block.
    type ReservationFee = NickReservationFee;

    // No action is taken when deposits are forfeited.
    type Slashed = ();

    // Configure the FRAME System Root origin as the Nick pallet admin.
    // https://substrate.dev/rustdocs/v3.0.0/frame_system/enum.RawOrigin.html#variant.Root
    type ForceOrigin = frame_system::EnsureRoot&lt;AccountId&gt;;

    // Use the MinNickLength from the parameter_types block.
    type MinLength = MinNickLength;

    // Use the MaxNickLength from the parameter_types block.
    type MaxLength = MaxNickLength;

    // The ubiquitous event type.
    type Event = Event;
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="定义运行时-srclibrsconstruct_runtime"><a class="header" href="#定义运行时-srclibrsconstruct_runtime">定义运行时: src/lib.rs/construct_runtime!</a></h4>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>construct_runtime!(
    pub enum Runtime where
        Block = Block,
        NodeBlock = opaque::Block,
        UncheckedExtrinsic = UncheckedExtrinsic
    {
        /* --snip-- */

        /*** Add This Line ***/
        Nicks: pallet_nicks::{Module, Call, Storage, Event&lt;T&gt;},
    }
);
<span class="boring">}
</span></code></pre></pre>
<h3 id="编译-运行-启动前端"><a class="header" href="#编译-运行-启动前端">编译-&gt;运行-&gt;启动前端</a></h3>
<pre><code class="language-shell">cargo build --release
./target/release/node-template --dev --tmp
yarn start
</code></pre>
<h3 id="验证功能"><a class="header" href="#验证功能">验证功能</a></h3>
<h4 id="为帐户设置昵称"><a class="header" href="#为帐户设置昵称">为帐户设置昵称</a></h4>
<ul>
<li>检查帐户选择列表以验证当前选择了 Alice 帐户。</li>
<li>在 Pallet Interactor 组件中，确认选择了 Extrinsic。</li>
<li>从可调用的托盘列表中选择nicks。</li>
<li>选择 <strong>settName</strong> 作为要从 nicks palette 调用的函数。</li>
<li>键入一个长于 MinNickLength（8 个字符）且不长于 MaxNickLength（32 个字符）的名称。</li>
<li>单击Signed以执行该功能。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/CleanShot%202022-07-03%20at%2010.51.26.png" alt="CleanShot 2022-07-03 at 10.51.26" /></p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/CleanShot%202022-07-03%20at%2010.54.34.png" alt="CleanShot 2022-07-03 at 10.54.34" /></p>
<h4 id="使用nicks-pallet查询账户信息"><a class="header" href="#使用nicks-pallet查询账户信息">使用Nicks pallet查询账户信息</a></h4>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/CleanShot%202022-07-03%20at%2011.00.08.png" alt="CleanShot 2022-07-03 at 11.00.08" /></p>
<ul>
<li>
<p>按图所示进行设置，查询，复制Alice的地址进行查询会返回一个元组，里面的两个值分别指：</p>
<ul>
<li>Alice 帐户的十六进制编码昵称。</li>
<li>为保护昵称而从 Alice 的账户中保留的金额。</li>
</ul>
</li>
</ul>
<blockquote>
<p>如果使用Bob的地址，会返回None，因为没有给他设置昵称。</p>
</blockquote>
<h3 id="可能出现的问题"><a class="header" href="#可能出现的问题">可能出现的问题</a></h3>
<ul>
<li><a href="https://github.com/substrate-developer-hub/pallet-did/issues/9">Conflicts when adding pallet to substrate-node-template · Issue #9 · substrate-developer-hub/pallet-did</a></li>
<li><a href="https://substrate.stackexchange.com/questions/2774/error-failed-to-select-a-version-for-parity-util-mem">substrate node template - “error: failed to select a version for <code>parity-util-mem</code>” - Substrate and Polkadot Stack Exchange</a></li>
</ul>
<h2 id="configure-the-contracts-pallet"><a class="header" href="#configure-the-contracts-pallet">Configure the contracts pallet</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<blockquote>
<p>指定调用源头unsigned, signed or sudo</p>
</blockquote>
<ul>
<li><a href="https://docs.substrate.io/tutorials/work-with-pallets/specify-origin/">Specify the origin for a call | Substrate_ Docs</a></li>
</ul>
<blockquote>
<p>前面已经介绍用Alice的地址来设置并查询nickname(setName)，里面还有其他函数(killName、forceName、clearName)这里将会进行调用验证</p>
</blockquote>
<h3 id="signed与sudo有不同权限"><a class="header" href="#signed与sudo有不同权限">signed与sudo有不同权限。</a></h3>
<p>点击Sudo按钮将会发出一个 Sudid 事件以通知节点参与者 Root 源发送了一个呼叫。 但是，内部调度会因 DispatchError 而失败（Sudo 按钮的 sudo 函数是“外部”调度）。</p>
<blockquote>
<p>特别是，这是 DispatchError::Module 变体的一个实例，它会提供两个元数据：一个索引号和一个错误号。</p>
</blockquote>
<ul>
<li>索引号与产生错误的pallet有关；它对应于construct_runtime!中pallet的索引（位置）！。</li>
<li>错误编号与该托盘的错误枚举中相关变体的索引相对应。</li>
</ul>
<blockquote>
<p>使用这些数字查找托盘错误时，请记住索引是从零开始。</p>
</blockquote>
<p>比如：</p>
<ul>
<li>索引为 9（第十个托盘），对应nicks,</li>
<li>错误为 2（第三个错误）,
对应<a href="https://github.com/paritytech/substrate/blob/master/frame/nicks/src/lib.rs#L99-L108">substrate源码</a>中定义的第三个错误</li>
</ul>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// Error for the nicks pallet.
#[pallet::error]
pub enum Error&lt;T&gt; {
    /// A name is too short.    
    TooShort,
    /// A name is too long.
    TooLong,
    /// An account isn't named.
    Unnamed,
}
<span class="boring">}
</span></code></pre></pre>
<ul>
<li>取决于您的construct_runtime中尼克斯托盘的位置！宏，您可能会看到不同的索引编号。不管 index 的值如何，你应该看到错误值是 2，它对应于 Nick 的 Pallet 的 Error 枚举的第三个变体，Unnamed
变体。这应该不足为奇，因为 Bob 尚未保留昵称，因此无法清除！</li>
</ul>
<h2 id="use-macros-in-a-custom-pallet"><a class="header" href="#use-macros-in-a-custom-pallet">Use macros in a custom pallet</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="pallet组件深入"><a class="header" href="#pallet组件深入">Pallet组件深入</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h3 id="1-pallet-hooks"><a class="header" href="#1-pallet-hooks">1. Pallet Hooks</a></h3>
<div id="admonition-基于执行过程看hooks" class="admonition info">
<div class="admonition-title">
<p>基于执行过程看hooks</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-基于执行过程看hooks"></a></p>
</div>
<div>
<figure><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="910px" preserveAspectRatio="none" style="width:765px;height:910px;background:#FFFFFF;" version="1.1" viewBox="0 0 765 910" width="765px" zoomAndPan="magnify"><defs/><g><ellipse cx="196" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#90EE90" height="121.8281" style="stroke:#000000;stroke-width:1.5;" width="605" x="116" y="40"/><path d="M256,40 L256,49.2969 L246,59.2969 L116,59.2969 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="119" y="53.9951">Initializes the block</text><path d="M286,69.2969 L286,105.5625 L266,109.5625 L286,113.5625 L286,149.8281 A0,0 0 0 0 286,149.8281 L711,149.8281 A0,0 0 0 0 711,149.8281 L711,79.2969 L701,69.2969 L286,69.2969 A0,0 0 0 0 286,69.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M701,69.2969 L701,79.2969 L711,79.2969 L701,69.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="292" y="86.3638">会执行所有pallet</text><line style="stroke:#181818;stroke-width:1.0;" x1="286" x2="711" y1="94.4297" y2="94.4297"/><line style="stroke:#181818;stroke-width:1.0;" x1="286" x2="711" y1="96.4297" y2="96.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="292" y="111.4966">就是construct_runtime!中包含的pallet，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404" x="292" y="126.6294">并且也是按照construct_runtime!中定义的顺序的on_initialize函数，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="292" y="141.7622">不过会最先执行System模块的（frame-system）.</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="126" y="85.5938"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="136" y="106.7324">on_initialize</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="120" x="136" y="120.7012">区块初始化的时候调用</text><rect fill="none" height="232.1094" style="stroke:#000000;stroke-width:1.5;" width="172" x="110" y="171.8281"/><path d="M247,171.8281 L247,181.125 L237,191.125 L110,191.125 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="113" y="185.8232">Upgrade the block</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="144" y="208.125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="154" y="229.2637">pre_upgrade</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="154" y="243.2324">升级之前的检查</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="152" x="120" y="276.0625"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="129" x="130" y="297.2012">on_runtime_upgrade</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="132" x="130" y="311.1699">执行模块升级的时候调用</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="107" x="142.5" y="344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="87" x="152.5" y="365.1387">post_upgrade</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="152.5" y="379.1074">升级之后的处理</text><rect fill="none" height="96.2344" style="stroke:#000000;stroke-width:1.5;" width="122" x="135" y="413.9375"/><path d="M176,413.9375 L176,423.2344 L166,433.2344 L135,433.2344 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="138" y="427.9326">Test</text><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="145" y="450.2344"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="82" x="155" y="471.373">integrity_test</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="72" x="155" y="485.3418">运行集成测试</text><rect fill="none" height="124.1719" style="stroke:#000000;stroke-width:1.5;" width="716" x="38" y="520.1719"/><path d="M181,520.1719 L181,529.4688 L171,539.4688 L38,539.4688 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="41" y="534.167">Executes extrinsics</text><path d="M364,581.8398 L364,590.4063 L344,594.4063 L364,598.4063 L364,606.9727 A0,0 0 0 0 364,606.9727 L744,606.9727 A0,0 0 0 0 744,606.9727 L744,591.8398 L734,581.8398 L364,581.8398 A0,0 0 0 0 364,581.8398 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M734,581.8398 L734,591.8398 L744,591.8398 L734,581.8398 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359" x="370" y="598.9067">区块初始化后，就会根据交易（extrinsics）列表的顺序执行。</text><rect fill="#F1F1F1" height="75.875" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="296" x="48" y="556.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="110" x="58" y="577.6074">offchain_worker：</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="163" x="58" y="591.5762">在一个 pallet 上实现此函数后</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="276" x="58" y="605.5449">可以在此函数中长时间的执行需要链下执行的功能。</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="192" x="58" y="619.5137">该函数会在每次区块导入的时候调用</text><rect fill="none" height="203.0625" style="stroke:#000000;stroke-width:1.5;" width="723.5" x="11" y="654.3438"/><path d="M148,654.3438 L148,663.6406 L138,673.6406 L11,673.6406 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="14" y="668.3389">Finalizes the block</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="350" x="21" y="690.6406"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="330" x="31" y="711.7793">on_idle：区块finalize的时候调用，不过比on_finalize先调用</text><path d="M327.5,734.6094 L327.5,786.0078 L307.5,790.0078 L327.5,794.0078 L327.5,845.4063 A0,0 0 0 0 327.5,845.4063 L724.5,845.4063 A0,0 0 0 0 724.5,845.4063 L724.5,744.6094 L714.5,734.6094 L327.5,734.6094 A0,0 0 0 0 327.5,734.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M714.5,734.6094 L714.5,744.6094 L724.5,744.6094 L714.5,734.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="333.5" y="751.6763">区块中的交易执行完后，确认区块</text><line style="stroke:#181818;stroke-width:1.0;" x1="327.5" x2="724.5" y1="759.7422" y2="759.7422"/><line style="stroke:#181818;stroke-width:1.0;" x1="327.5" x2="724.5" y1="761.7422" y2="761.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="333.5" y="776.8091">确认区块时会调用所有pallet</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="333.5" y="791.9419">（就是construct_runtime!中包含的pallet，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="333.5" y="807.0747">并且也是按照construct_runtime!中定义的顺序）</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="333.5" y="822.2075">的on_idle和on_finalize函数，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376" x="333.5" y="837.3403">不过这次最后执行System模块（frame-system）的hooks函数.</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="223" x="84.5" y="773.0234"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="203" x="94.5" y="794.1621">on_initialize：区块初始化的时候调用</text><ellipse cx="196" cy="888.4063" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;fill:none;"/><ellipse cx="196" cy="888.4063" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="30" y2="85.5938"/><polygon fill="#181818" points="192,75.5938,196,85.5938,200,75.5938,196,79.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="256.0625" y2="276.0625"/><polygon fill="#181818" points="192,266.0625,196,276.0625,200,266.0625,196,270.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="324" y2="344"/><polygon fill="#181818" points="192,334,196,344,200,334,196,338" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="133.5313" y2="208.125"/><polygon fill="#181818" points="192,198.125,196,208.125,200,198.125,196,202.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="391.9375" y2="450.2344"/><polygon fill="#181818" points="192,440.2344,196,450.2344,200,440.2344,196,444.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="498.1719" y2="556.4688"/><polygon fill="#181818" points="192,546.4688,196,556.4688,200,546.4688,196,550.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="724.6094" y2="773.0234"/><polygon fill="#181818" points="192,763.0234,196,773.0234,200,763.0234,196,767.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="632.3438" y2="690.6406"/><polygon fill="#181818" points="192,680.6406,196,690.6406,200,680.6406,196,684.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="196" x2="196" y1="806.9922" y2="877.4063"/><polygon fill="#181818" points="192,867.4063,196,877.4063,200,867.4063,196,871.4063" style="stroke:#181818;stroke-width:1.0;"/></g></svg></figure>
</div>
</div>
<h3 id="2-pallet-extrinsics"><a class="header" href="#2-pallet-extrinsics">2. Pallet Extrinsics</a></h3>
<p><a id="Pallet-Extrinsics"></a>Pallet-Extrinsics</p>
<h3 id="3-pallet-errors"><a class="header" href="#3-pallet-errors">3. Pallet Errors</a></h3>
<p><a id="Pallet-Errors"></a>Pallet-Errors</p>
<h3 id="4-pallet-config"><a class="header" href="#4-pallet-config">4. Pallet Config</a></h3>
<p><a id="Pallet-Config"></a>Pallet-Config</p>
<h3 id="5-pallet-use-other-pallet"><a class="header" href="#5-pallet-use-other-pallet">5. Pallet Use Other Pallet</a></h3>
<p><a id="Pallet-Use-Other-Pallet"></a>Pallet-Use-Other-Pallet</p>
<h3 id="6-pallet-extension"><a class="header" href="#6-pallet-extension">6. Pallet Extension</a></h3>
<p><a id="Pallet-Extension"></a>Pallet-Extension</p>
<h3 id="7-pallet-debug"><a class="header" href="#7-pallet-debug">7. Pallet Debug</a></h3>
<p><a id="Pallet-Debug"></a>Pallet-Debug</p>
<h3 id="8-pallet-rpc"><a class="header" href="#8-pallet-rpc">8. Pallet RPC</a></h3>
<p><a id="Pallet-RPC"></a>Pallet-RPC</p>
<h3 id="9-pallet-benchmarking"><a class="header" href="#9-pallet-benchmarking">9. Pallet Benchmarking</a></h3>
<p><a id="Pallet-Benchmarking"></a>Pallet-Benchmarking</p>
<h1 id="develop-smart-contracts"><a class="header" href="#develop-smart-contracts">Develop smart contracts</a></h1>
<h2 id="prepare-your-first-contract"><a class="header" href="#prepare-your-first-contract">Prepare your first contract</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="develop-a-smart-contract"><a class="header" href="#develop-a-smart-contract">Develop a smart contract</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="use-maps-for-storing-values"><a class="header" href="#use-maps-for-storing-values">Use maps for storing values</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="buid-a-token-contract"><a class="header" href="#buid-a-token-contract">Buid a token contract</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="troubleshoot-smart-contracts"><a class="header" href="#troubleshoot-smart-contracts">Troubleshoot smart contracts</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h1 id="connect-with-other-chains"><a class="header" href="#connect-with-other-chains">Connect with other chains</a></h1>
<h2 id="start-a-local-relay-chain"><a class="header" href="#start-a-local-relay-chain">Start a local relay chain</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="connect-a-local-parachain"><a class="header" href="#connect-a-local-parachain">Connect a local parachain</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="connect-to-rococo-testnet"><a class="header" href="#connect-to-rococo-testnet">Connect to Rococo testnet</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h2 id="access-evm-accounts"><a class="header" href="#access-evm-accounts">Access EVM accounts</a></h2>
<blockquote>
<p><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#substrate%E5%AE%98%E6%96%B9%E6%95%99%E7%A8%8B%E6%A2%B3%E7%90%86%E4%B8%8E%E7%BB%83%E4%B9%A0">返回顶部</a></p>
</blockquote>
<h1 id="参考资源-44"><a class="header" href="#参考资源-44">参考资源</a></h1>
<h2 id="substrate文档练习"><a class="header" href="#substrate文档练习">substrate文档练习</a></h2>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628074841/https://mp.weixin.qq.com/s/2DuNX0-a14yPKT1nJNjk7Q">构建一条链的体验</a></p>
<blockquote>
<p>substrate官方教程里面的<a href="https://docs.substrate.io/tutorials/v3/create-your-first-substrate-chain/">第一课</a>名称叫做创建我们的第一条链，
实际上我觉得应该叫做启动substrate默认模板链的节点更贴切，因为这个教程里面实际上就是把一个用substrate已经开发好的模板链的代码拉下来，然后编译一下，然后再启动起来。
这个过程实际上和我们拉一个比特币的代码，然后编译下然后再启动 ，并没有太大的不同。</p>
</blockquote>
<ul>
<li>
<p>substrate 开发环境</p>
<blockquote>
<ul>
<li>启动链的节点：
&gt; 这里要用到node-template的代码。node-template实际上是官方提供的使用substrate开发的模板链，
&gt; 可以理解为substrate官方提供的样例，后续任何人想使用substrate可以在这个样例的基础上进行修改，这样开发链就更方便。
&gt; 这就好比以前的好多山寨链，在btc的源码上改下创世区块的配置，就是一条新链。 那么substrate其实也一样，提供了node-template这样一个模板，后续根据需求在这个上面改吧改吧，就能产生一条新链。</li>
</ul>
</blockquote>
</li>
<li>
<p>使用polkadot-js访问节点:
在substrate官方的教程中，是使用了substrate的前端模板来访问刚才启动的节点。但是在实际的开发中，后端人员其实更多的使用polkadot-js-app来访问我们的节点，所以这里我们也使用它来访问我们的节点。</p>
</li>
<li>
<p><a href="https://docs.substrate.io/tutorials/v3/create-your-first-substrate-chain/">文档资料</a></p>
</li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628084629/https://mp.weixin.qq.com/s/GSWxgEA-CtdB8pi-gHe1ig">Substrate快速入门</a></p>
<blockquote>
<p>substrate采用模块化的方法进行开发，它定义了一组丰富的原语，给开发人员提供了强大的、熟悉的编程方法。</p>
</blockquote>
<ul>
<li>
<p>使用方式介绍：</p>
<ol>
<li>
<p>使用substrate node: 使用json文件启动</p>
</li>
<li>
<p>使用substrate frame: 业务逻辑自由</p>
<blockquote>
<p>frame其实是一组模块（pallet）和支持库。使用substrate
frame可以轻松的创建自己的自定义运行时，因为frame是用来构建底层节点的。使用frame还可以配置数据类型，也可以从模块库中选择甚至是添加自己定义的模块。</p>
</blockquote>
</li>
<li>
<p>使用substrate core: runtime自由</p>
<blockquote>
<p>使用substrate code运行开发者完全从头开始设计运行时（runtime，问题：什么是runtime？），当然此种方式也是使用substrate自由度最大的方式。</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p>Substrate Client:</p>
<blockquote>
<p>substrate客户端是基于substrate实现的区块链的节点客户端（可以理解为全节点），它主要由以下几个组件组成（以下也就是告诉我们实现一条链由哪几部分组成）：</p>
</blockquote>
<ol>
<li>存储: 用来维持区块链系统所呈现的状态演变。substrate提供了的存储方式是一种简单有效的key-value对存储机制的方式。</li>
<li>Runtime: 这里就可以回答上面的问题，什么是runtime？runtime定义了区块的处理方式，主要是状态转换的逻辑。在substrate中，runtime code被编译成wasm作为区块链存储状态的一部分。</li>
<li>p2p网络: 允许客户端和其它网络参与者进行通信。</li>
<li>共识: 提供了一种逻辑，能使网络参与者就区块链的状态达成一致。substrate支持提供自定义的共识引擎。</li>
<li>RPC: 远程过程调用。</li>
<li>telemetry: 通过嵌入式Prometheus服务器的方式对外展示（我理解应该是类似于区块链浏览器一样的东西，或者是提供信息给区块链浏览器展示）。</li>
</ol>
</li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628065030/https://mp.weixin.qq.com/s/MrnenO7AWhrf_-3Qs-aRJg">构建一个PoE(Prove of Existence)去中心化的应用</a></p>
<blockquote>
<p>substrat官方手册的第三个例子，使用substrate来创建自定义的存在证明dapp。我们本节的主要内容分为以下三步：</p>
</blockquote>
<ol>
<li>基于node template启动一条substrate的链。</li>
<li>修改node template来添加我们自己定制的Poe pallet，并实现我们的PoE API。</li>
<li>修改前端模板以添加与PoE API交互的自定义用户界面。</li>
</ol>
<ul>
<li>接口设计</li>
<li><strong>创建自定义pallet</strong>
<blockquote>
<p>node
template的运行时是基于FRAME来实现的。FRAME是一个代码库，允许我们使用一系列pallet来构建底层的运行时。pallet可以看出是定义区块链功能的单个逻辑模块。subtrate为我们提供了一些已经构建好的pallet，我们在定义运行时时可以直接使用。</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628065034/https://mp.weixin.qq.com/s/w9Cj7jWkTo-PIBxtIyV9xQ">使用substrate构建私有网络</a></p>
<blockquote>
<p>本节内容：</p>
</blockquote>
<ol>
<li>基于模板启动substrate区块链网络；</li>
<li>生成ed25519和sr25519 密钥对用于网络授权；</li>
<li>创建和编辑chainspec json文件。</li>
</ol>
<ul>
<li><a href="https://substrate.dev/docs/en/tutorials/start-a-private-network/">参考资料</a></li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628070053/https://mp.weixin.qq.com/s/1Yf6H6NoEOlpYQlBtuhy7A">构建kitties链条</a></p>
<blockquote>
<p>分两部分，一是介绍如何构建kitties pallet，包括创建与kittes交互的功能；另一部分是介绍开发前端UI，与我们第一部分的链进行交互。
目标：</p>
</blockquote>
<ol>
<li>学习构建和运行substrate节点的基本模式。</li>
<li>编写自定义框架pallet并集成到运行时。</li>
<li>了解如何创建和更新存储项。</li>
<li>编写pellet相关辅助函数。</li>
<li>使用PolkadotJs API将substrate节点连接到自定义前端。</li>
</ol>
<ul>
<li>kitties功能：
<ol>
<li>可以通过一些原始来源或者通过使用现有小猫进行繁殖创造。</li>
<li>以其所有者设定的价格出售。</li>
<li>从一个所有者转移到另一个所有者。</li>
</ol>
</li>
<li><a href="https://docs.substrate.io/tutorials/v3/kitties/pt1/#tutorial-objectives">参考资料</a></li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628070149/https://mp.weixin.qq.com/s/dOghynr1eVMdtXITwY5clQ">构建授权网络</a></p>
<blockquote>
<p>无许可准入区块链网络我们比较常见，例如比特币、以太坊都是无准入的。那么授权准入网络在哪些地方可能出现呢?</p>
</blockquote>
<ol>
<li>专用网络或者是联盟链网络；</li>
<li>高度管控的环境；</li>
<li>大规模测试预公开网络。</li>
</ol>
<blockquote>
<p>目标</p>
</blockquote>
<ol>
<li>修改node-template工程添加node-authorization pallet。</li>
<li>加载部分节点并授权新节点加入网络。</li>
</ol>
</li>
</ul>
<h2 id="pallet基础"><a class="header" href="#pallet基础">pallet基础</a></h2>
<h3 id="尝试添加pallet到runtime"><a class="header" href="#尝试添加pallet到runtime">尝试添加pallet到runtime</a></h3>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628065009/https://mp.weixin.qq.com/s/iQ6a-diWMfYDghuLVPJd9Q">添加一个pallet到runtime</a></p>
<blockquote>
<p>substrate node template提供了一个最小的可工作的运行时，但是为了保持精炼，它并不包括Frame中的大多数的Pallet。本节我们将学习如何将Pallet添加到runtime中。</p>
</blockquote>
<ol>
<li>安装Node Template</li>
<li>导入Pallet</li>
<li>配置Pallet</li>
<li>将Nicks添加到construct_runtime!中</li>
</ol>
<ul>
<li><a href="https://docs.substrate.io/tutorials/work-with-pallets/add-a-pallet/">Add a pallet to the runtime | Substrate_ Docs</a></li>
</ul>
</li>
</ul>
<h3 id="编写pallet到rust前置知识"><a class="header" href="#编写pallet到rust前置知识">编写pallet到rust前置知识</a></h3>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/5%E7%BC%96%E5%86%99pallet%E7%9A%84Rust%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86.md">learn-substrate-easy/5编写pallet的Rust前置知识.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
<blockquote>
<p><a href="https://web.archive.org/web/20220627101518/https://mp.weixin.qq.com/s/wPVbEeIVKdXGro0QYsmJBg">Pallet前置知识</a></p>
</blockquote>
<ul>
<li>trait的孤儿规则</li>
<li>trait对象</li>
<li>trait的继承</li>
<li>关联类型</li>
<li>定义Config trait，然后为Pallet实现相应的trait，最后在main函数中使用它</li>
</ul>
</li>
</ul>
<h3 id="编写简单到pallet"><a class="header" href="#编写简单到pallet">编写简单到pallet</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/6%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E7%9A%84pallet.md">learn-substrate-easy/6编写简单的pallet.md at main · KuanHsiaoKuo/learn-substrate-easy</a>
<ul>
<li>
<p>node-template的结构</p>
</li>
<li>
<p>编写pallet的一般格式, 整理出7个部分, 1和2基本上是固定的写法，而对于后面的3-7部分，则是根据实际需要写或者不写。关于模板中每部分的解释，可以参考文档.</p>
<ol>
<li>依赖;</li>
<li>pallet类型声明;</li>
<li>config trait;</li>
<li>定义要使用的链上存储;</li>
<li>事件;</li>
<li>钩子函数;</li>
<li>交易调用函数;</li>
</ol>
</li>
<li>
<p>举例编写simple-pallet</p>
<blockquote>
<p>功能介绍: simple-pallet是一个存证的pallet，简单说就是提供一个存取一段hash到链上的功能，和从链上读取的功能。</p>
</blockquote>
</li>
<li>
<p>将pallet添加到runtime中</p>
</li>
<li>
<p>编译运行</p>
</li>
<li>
<p>调试使用pallet中的功能</p>
</li>
</ul>
</li>
</ul>
<div id="admonition-相关资料" class="admonition info">
<div class="admonition-title">
<p>相关资料</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-相关资料"></a></p>
</div>
<div>
<ul>
<li><a href="https://docs.substrate.io/reference/frame-pallets/#pallets">FRAME pallets | Substrate_ Docs</a> </li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy-source/tree/main/substrate-node-template/pallets/simple-pallet">learn-substrate-easy-source/substrate-node-template/pallets/simple-pallet at main · KuanHsiaoKuo/learn-substrate-easy-source</a></li>
</ul>
</div>
</div>
<h3 id="pallet的组成"><a class="header" href="#pallet的组成">pallet的组成</a></h3>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/7Pallet%E7%9A%84%E7%BB%84%E6%88%90.md">learn-substrate-easy/7Pallet的组成.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
<blockquote>
<p>要想熟练的开发pallet，我们必须得把pallet中的各个组成部分弄清楚。本节，我们就按照模板中的各个部分的顺序来讲解pallet的组成</p>
</blockquote>
<ol>
<li>导出和依赖：Pub mod pallet{}就是将我们的pallet暴露出来， pub use pallet::*;是可以使用pallet中的所有类型，函数，数据等</li>
<li>pallet类型声明：它是一系列trait和方法的拥有者，实际的作用类似于占位符，这里举例rust程序</li>
<li>config trait： 这部分是指定Runtime的配置trait，Pallet中使用的一些类型和常量在此trait中进行配置。</li>
<li>Storage-定义要使用的链上存储： 存储（Storage）允许我们在链上存储数据，使用它存储的数据可以通过Runtime进行访问。substrate提供了四种存储方式，分别是：
<ul>
<li>Storage Value: 存储单个的值, 无键</li>
<li>Storage Map: 以map方式存储，单键，key-value</li>
<li>Storage Double Map: 以双键方式存储，(key1, key2)-value</li>
<li>Storage N Map: 以多键方式存储，(key1, key2, …, keyn)-value</li>
</ul>
</li>
<li>Event-事件：当pallet需要把运行时上的更改或变化通知给外部主体时，就需要用到事件。事件是一个枚举类型</li>
<li>hooks-钩子函数：钩子函数，是在区块链运行过程中希望固定执行的函数，例如我们希望在每个区块构建之前、之后的时候执行某些逻辑等，就可以把这些逻辑放在钩子函数中</li>
<li>Extrinsic-调度函数，交易调用函数: Extrinsic则是<strong>可以从runtime外部可以调用的函数，也是pallet对外提供的逻辑功能</strong>。比如交易</li>
</ol>
<blockquote>
<p><a href="https://kaisery.github.io/trpl-zh-cn/ch07-03-paths-for-referring-to-an-item-in-the-module-tree.html#%E4%BD%BF%E7%94%A8-pub-%E5%85%B3%E9%94%AE%E5%AD%97%E6%9A%B4%E9%9C%B2%E8%B7%AF%E5%BE%84">路径用于引用模块树中的项 - Rust 程序设计语言 简体中文版</a></p>
</blockquote>
</li>
</ul>
<h2 id="pallet技巧细节"><a class="header" href="#pallet技巧细节">Pallet技巧细节</a></h2>
<h3 id="storage链上各个类型使用"><a class="header" href="#storage链上各个类型使用">storage（链上）各个类型使用</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.1storage%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D.md">learn-substrate-easy/8.1storage使用介绍.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://docs.substrate.io/main-docs/build/runtime-storage/#best-practices">Runtime storage | Substrate_ Docs</a></li>
</ul>
<div id="admonition-区别pallet用到的storage和平时开发谈到的持久化storage" class="admonition tip">
<div class="admonition-title">
<p>区别pallet用到的storage和平时开发谈到的持久化storage</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-区别pallet用到的storage和平时开发谈到的持久化storage"></a></p>
</div>
<div>
<p>在pallet中要使用的storage更多的其实是一个应用层的概念，如果用城市建造来类比，持久化存储就像是整个城市的马路或者是管道，而我们谈论的storage则是某个具体建筑或者房屋里面的水管会小路，至于这些小水管（或小路）是怎么和整个城市的大路联系起来的，不是我们讨论的范围。</p>
</div>
</div>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 表示下面定义一个pallet storage
#[pallet::storage]
// 自动为storage生成一个getter函数，名字叫some_value
// 后续可以在pallet使用some_value()函数来获取该Storage中存储的值
#[pallet::getter(fn some_value)]
pub(super) type SomeValue = StorageValue&lt;_, u64, ValueQuery&gt;;
<span class="boring">}
</span></code></pre></pre>
<h3 id="error类型的使用"><a class="header" href="#error类型的使用">Error类型的使用</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220627112629/https://mp.weixin.qq.com/s/cNijF5h2Yn7R-K0ryoOJrA">pallet中Error类型的使用</a>
&gt;
在runtime代码执行时，代码必须是“非抛出的”，或者说不应该panic，应该是优雅的处理错误，所以在写pallet代码时，允许我们自定义错误类型，当错误发生时，可以返回我们定义的错误类型。这里的Error类型是指运行时在执行调度函数（也就是交易函数）时返回的错误。因为在调度函数执行时，返回的结果为DispatchResult类型，当执行结果错误时，返回DispatchError。
<ul>
<li>错误类型的定义</li>
<li>在函数中返回错误</li>
<li>简单示例</li>
</ul>
</li>
</ul>
<h3 id="写调度函数的套路"><a class="header" href="#写调度函数的套路">写调度函数的套路</a></h3>
<ul>
<li>
<p><a href="https://mp.weixin.qq.com/s/Xnv5aNiLn-NoH6obouaONg">substrate轻松学：写调度函数</a></p>
<blockquote>
<p>调度函数在substrate官方文档里面叫做Extrinsics（外部调用），详细的Extrinsics介绍可以参考这里.
在substrate中共有三种Extrinsics，分别是Inherents、Signed transactions和Unsigned transactions。
而在我们开发pallet的过程中，比较常用到的是后两种，所以我们这里也主要介绍后两种，对于Inherents有兴趣的小伙伴可以自己看官方文档研究下。</p>
</blockquote>
<ul>
<li>Signed transactions</li>
<li>Unsigned transactions</li>
<li>通常写法：调度函数的位置-&gt;函数体的写法-&gt;权重-&gt;transactional</li>
<li>示例</li>
<li></li>
</ul>
<p>参考：<a href="https://docs.substrate.io/v3/concepts/extrinsics/">extrinsics</a>
&amp;<a href="https://docs.substrate.io/v3/runtime/weights-and-fees/">weights-and-fees</a></p>
</li>
</ul>
<h3 id="hooks的使用"><a class="header" href="#hooks的使用">hooks的使用</a></h3>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.4Hooks%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8.md">learn-substrate-easy/8.4Hooks函数使用.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628021501/https://mp.weixin.qq.com/s/tPyB9CuTVP2Y1DGgl_VPyQ">hooks: pallet的🪝钩子函数使用</a></p>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/%E8%BF%90%E8%A1%8C%E5%9B%BE.png" alt="运行图" /></p>
</li>
</ul>
<div id="admonition-交易到打包的过程" class="admonition tip">
<div class="admonition-title">
<p>交易到打包的过程</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-交易到打包的过程"></a></p>
</div>
<div>
<ol>
<li>用户通过钱包发起交易;</li>
<li>和钱包相连的全节点收到交易后会把交易广播到网络中;</li>
<li>然后根据共识算法打包区块，某个全节点获得了打包权（图中画的是节点4），
然后将交易打包到区块中;</li>
<li>打包好区块后，将区块广播到网络中;</li>
<li>其它每个节点收到区块后验证，然后执行区块里面的交易，更新自己本地的账本。</li>
</ol>
</div>
</div>
<pre><code>- substrate中的执行过程
    1. 初始化区块（Initializes the block）
    2. 执行区块（Executes extrinsics）
    3. 确认区块（ Finalizes the block）.
- hooks介绍:
    1. on_finalize: 在区块 finalize 的时候调用。
    2. on_idle：区块finalize的时候调用，不过比on_finalize先调用。
    3. on_initialize：区块初始化的时候调用。
    4. on_runtime_upgrade：执行模块升级的时候调用。
    5. pre_upgrade：升级之前的检查。
    6. post_upgrade：升级之后的处理。
    7. offchain_worker：在一个 pallet 上实现此函数后可以在此函数中长时间的执行需要链下执行的功能。该函数会在每次区块导入的时候调用。后续我们讲ocw使用的时候就需要和这个函数打交道。
    8. integrity_test：运行集成测试。
- 示例
- [资料](https://docs.substrate.io/v3/concepts/execution/)
- [substrate源码](https://paritytech.github.io/substrate/master/frame_support/traits/trait.Hooks.html)
</code></pre>
<h3 id="pallet中的config"><a class="header" href="#pallet中的config">pallet中的Config</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.5pallet%E4%B8%AD%E7%9A%84Config.md">learn-substrate-easy/8.5pallet中的Config.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://web.archive.org/web/20220627112755/https://mp.weixin.qq.com/s/JOaBn4bkda2LicV3Lyb4tw">pallet中的config</a>
<ul>
<li>好好理解rust中关于trait和关联类型相关的知识</li>
<li>pallet 简单示例: 介绍一个存储学生信息的pallet，其中存储逻辑写在extrinsic中</li>
<li>在Config中定义配置类型：主要使用trait约束和关联类型改写</li>
<li>在runtime中指定具体的类型</li>
<li>构建、交互与调试</li>
<li><a href="https://docs.substrate.io/v3/runtime/events-and-errors/">参考资料</a></li>
</ul>
</li>
</ul>
<h3 id="在pallet中使用其它pallet"><a class="header" href="#在pallet中使用其它pallet">在pallet中使用其它pallet</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.6%E5%9C%A8pallet%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%85%B6%E5%AE%83pallet.md">learn-substrate-easy/8.6在pallet中使用其它pallet.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://web.archive.org/web/20220627101725/https://mp.weixin.qq.com/s/z4fefNUb3avcae0htHpxgQ">在pallet中使用其他pallet</a>
<ul>
<li>
<p>在自己的pallet中使用其它的pallet主要有以下几种情况：</p>
<ol>
<li>指定某个现成的pallet: 在pallet的config中定义类型，然后runtime中使用时指定这个类型为frame中指定某个现成的pallet；</li>
<li>指定某个自定义的pallet: 在pallet的config中定义类型，然后runtime中使用时指定这个类型为frame中指定某个自定义的pallet；</li>
<li>封装和扩展现有的 pallet 。</li>
</ol>
</li>
<li>
<p>在runtime中直接指定某个类型为其它的pallet</p>
<blockquote>
<p>这种方式比较常见的就是在pallet中定义currency类型，然后用指定currency类型为balances
pallet。详细的可以看substrate中node中的使用，在pallet_assets中使用了pallet_balances，就是通过指定前者的currency类型为后者</p>
</blockquote>
<ul>
<li><a href="https://github.com/paritytech/substrate/blob/master/bin/node/runtime/src/lib.rs#L1343">详情</a></li>
</ul>
</li>
<li>
<p>pallet中使用其它pallet的storage</p>
<blockquote>
<p>自定义两个pallet，分别叫做pallet-use-other-pallet1和pallet-storage-provider，然后我们在前一个pallet中读取和存储后一个pallet</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="封装和扩展现有pallet"><a class="header" href="#封装和扩展现有pallet">封装和扩展现有pallet</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.7%E5%B0%81%E8%A3%85%E5%92%8C%E6%89%A9%E5%B1%95%E7%8E%B0%E6%9C%89pallet.md">learn-substrate-easy/8.7封装和扩展现有pallet.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://web.archive.org/web/20220627113013/https://mp.weixin.qq.com/s/23wuRo4gj4oH-3EG74NnTA">封装和扩展现有的pallet</a>
<ul>
<li>
<p>这里使用substrate提供的contracts pallet，然后对其中的功能进行封装。</p>
<blockquote>
<p>在我们的封装中，将contracts pallet的call函数封装成sudo_call，即需要root权限才能调用。同时，我们在runtime中加载contracts时，去掉直接调用contracts函数的方式。</p>
</blockquote>
</li>
<li>
<p>整个方式我们分成两大步骤，如下：</p>
<ol>
<li>编写extend-pallet;</li>
<li>在runtime配置extend- pallet 和contracts pallet。</li>
</ol>
</li>
<li>
<p><a href="https://www.shawntabrizi.com/substrate/extending-substrate-runtime-modules/">文档资料</a></p>
</li>
</ul>
</li>
</ul>
<h3 id="调试"><a class="header" href="#调试">调试</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.8%E8%B0%83%E8%AF%95.md">learn-substrate-easy/8.8调试.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://web.archive.org/web/20220627113043/https://mp.weixin.qq.com/s/Ddu-CPgRz-U7uO4PkUnp2g">调试pallet</a>
<ul>
<li>在pallet开发时主要有以下几种调试方式：
<ol>
<li>logging uilities;</li>
<li>printable trait;</li>
<li>print函数;</li>
<li>if_std.</li>
</ol>
</li>
<li>使用logging uilities</li>
<li>使用 printable trait</li>
<li>使用print函数</li>
<li>使用 if_std</li>
<li><a href="https://docs.substrate.io/v3/runtime/debugging/">文档资料</a></li>
</ul>
</li>
</ul>
<h3 id="pallet中的类型转换"><a class="header" href="#pallet中的类型转换">pallet中的类型转换；</a></h3>
<h3 id="在pallet中使用链下工作者offchain-worker"><a class="header" href="#在pallet中使用链下工作者offchain-worker">在pallet中使用链下工作者（Offchain worker）</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.9%E4%BD%BF%E7%94%A8OCW%E6%8F%90%E4%BA%A4%E7%AD%BE%E5%90%8D%E4%BA%A4%E6%98%93.md">learn-substrate-easy/8.9使用OCW提交签名交易.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.10%E5%9C%A8ocw%E4%B8%AD%E6%8F%90%E4%BA%A4%E6%9C%AA%E7%AD%BE%E5%90%8D%E4%BA%A4%E6%98%93.md">learn-substrate-easy/8.10在ocw中提交未签名交易.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.11%E5%9C%A8ocw%E4%B8%AD%E6%8F%90%E4%BA%A4%E5%85%B7%E6%9C%89%E7%AD%BE%E5%90%8Dpayload%E7%9A%84%E6%9C%AA%E7%AD%BE%E5%90%8D%E4%BA%A4%E6%98%93.md">learn-substrate-easy/8.11在ocw中提交具有签名payload的未签名交易.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.12%E5%9C%A8ocw%E4%B8%AD%E4%BD%BF%E7%94%A8%E9%93%BE%E4%B8%8B%E5%AD%98%E5%82%A8.md">learn-substrate-easy/8.12在ocw中使用链下存储.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.14%E5%9C%A8ocw%E4%B8%AD%E5%8F%91%E9%80%81http%E8%AF%B7%E6%B1%82.md">learn-substrate-easy/8.14在ocw中发送http请求.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
</ul>
<h3 id="在pallet中链上写本地存储offchain-index"><a class="header" href="#在pallet中链上写本地存储offchain-index">在pallet中链上写本地存储（offchain index）；</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.13%E4%BD%BF%E7%94%A8offchain_index.md">learn-substrate-easy/8.13使用offchain_index.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
</ul>
<h3 id="在pallet的ocw中使用链下存储offchain-storage"><a class="header" href="#在pallet的ocw中使用链下存储offchain-storage">在pallet的ocw中使用链下存储（offchain storage）；</a></h3>
<h3 id="在pallet中使用其它pallet使用其它pallet的存储"><a class="header" href="#在pallet中使用其它pallet使用其它pallet的存储">在pallet中使用其它pallet（使用其它pallet的存储）；</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.6%E5%9C%A8pallet%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%85%B6%E5%AE%83pallet.md">learn-substrate-easy/8.6在pallet中使用其它pallet.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
</ul>
<h3 id="在pallet中添加rpc接口"><a class="header" href="#在pallet中添加rpc接口">在pallet中添加rpc接口</a></h3>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/8.15%E5%9C%A8pallet%E4%B8%AD%E6%B7%BB%E5%8A%A0rpc%E6%8E%A5%E5%8F%A3.md">learn-substrate-easy/8.15在pallet中添加rpc接口.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220627101825/https://mp.weixin.qq.com/s/_QTUGTAWLreUVcNJcVKBjA">为pallet自定义rpc接口</a></p>
<blockquote>
<p>pallet写好后需要通过runtime加载到链上（就是runtime/src/lib.rs中的construct_runtime宏包含的部分）。
那么对应到我们的测试，如果对pallet进行测试，我们也需要构建一个runtime测试环境，然后在这个环境中加载pallet，对pallet进行测试。
所以，编写pallet的测试就分为以下几部分：</p>
</blockquote>
<ol>
<li>编写 mock runtime;</li>
<li>编写pallet的genesisconfig;</li>
<li>编写测试。</li>
</ol>
<ul>
<li><a href="https://docs.substrate.io/v3/runtime/custom-rpcs/">文档资料</a></li>
</ul>
</li>
</ul>
<h3 id="为某些trait提供默认实现"><a class="header" href="#为某些trait提供默认实现">为某些trait提供默认实现。</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220627101811/https://mp.weixin.qq.com/s/ZU5SYYrL6OORWGEbRev7Zg">为pallet编写tests</a></li>
</ul>
<h2 id="智能合约"><a class="header" href="#智能合约">智能合约</a></h2>
<h3 id="初探ink"><a class="header" href="#初探ink">初探ink!</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220628070102/https://mp.weixin.qq.com/s/tvva1vogIcyN60tWcBPqww">初探ink!智能合约开发</a>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628095113/https://zhuanlan.zhihu.com/p/468304741">发展两年的波卡智能合约语言ink!将会带来什么影响？ - 知乎</a></p>
<blockquote>
<p>ink!是由Parity在这里开发智能合约语言Rust编写智能合同并编译成Wasm代码。
智能合同是在分散区块链网络上运行的计算机协议，可视为可自动执行的应用程序。
ink!它不同于其他更成熟的智能合约语言Parity的烙印。ink!最初是通过使用Rust宏系统生成自定义语法和风格，开发智能合约。
但是这种方法偏离了Rust在不牺牲易用性或开发性的前提下，开发人员熟悉和喜欢的语言诞生了ink!2.0.为开发人员提供最大的灵活性。简单来说，整合后现在ink!所有的结构和语法都是纯的Rust</p>
</blockquote>
</li>
<li>
<p><a href="https://docs.substrate.io/tutorials/v3/ink-workshop/pt1/">参考</a></p>
</li>
</ul>
</li>
</ul>
<h3 id="深入ink"><a class="header" href="#深入ink">深入ink!</a></h3>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628070203/https://mp.weixin.qq.com/s/lPkXiu4hyYryHCqx-peRmQ">深入ink!智能合约</a></p>
<blockquote>
<p>学习智能合约的开发，主要包括：</p>
</blockquote>
<ul>
<li>ink!智能合约的结构；</li>
<li>存储单个的值和hash map；</li>
<li>安全的设置或获取这些值；</li>
<li>编写public和private函数；</li>
<li>配置Rust使用安全的数学库。</li>
</ul>
<blockquote>
<p>总的来说，写ink！合约和直接用Rust编码没有太大的区别，只要能使用Rust都能很快的编写合约。</p>
</blockquote>
</li>
</ul>
<h3 id="erc20"><a class="header" href="#erc20">ERC20</a></h3>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628065106/https://mp.weixin.qq.com/s/fLZc_lQxe1jpgfHmmZ65Lg">ERC20合约开发</a></p>
<ul>
<li><a href="https://web.archive.org/web/20220628095517/https://www.jb51.net/blockchain/797814.html">ERC20协议是什么意思?一文读懂ERC20协议_区块链技术_区块链_脚本之家</a></li>
</ul>
<blockquote>
<p>学习写一个ERC20合约，主要包括：</p>
</blockquote>
<ul>
<li>初始token设置；</li>
<li>支持transfer；</li>
<li>通过substrate触发事件。</li>
</ul>
</li>
</ul>
<h2 id="连接其他链"><a class="header" href="#连接其他链">连接其他链</a></h2>
<h3 id="中继链连接"><a class="header" href="#中继链连接">中继链连接</a></h3>
<ul>
<li><a href="https://web.archive.org/web/20220628065121/https://mp.weixin.qq.com/s/QSJRjdvqKgbY9eMbdhpVOA">Relay Chain</a></li>
</ul>
<blockquote>
<p>学习启动一个relay chain， 通过cumus来创建自己的parachain，并且在在本地测试网络中将parachain连接到relaychain。</p>
</blockquote>
<h3 id="平行链连接"><a class="header" href="#平行链连接">平行链连接</a></h3>
<ul>
<li>
<p><a href="https://web.archive.org/web/20220628074818/https://mp.weixin.qq.com/s/hF3vevPi4ZLuXwR2Ehhp_A">连接parachain</a></p>
<blockquote>
<p>上一节，我们启动了relaychain的节点，本节将连接parachain到relaychain节点。 主要包括以下内容：</p>
</blockquote>
<ul>
<li>启动parachain；</li>
<li>parachain注册；</li>
<li>和parachain交互；</li>
<li>连接到添加的parachain节点。</li>
</ul>
</li>
</ul>
<h2 id="测试-1"><a class="header" href="#测试-1">测试</a></h2>
<h3 id="编写测试"><a class="header" href="#编写测试">编写测试</a></h3>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/9%E7%BC%96%E5%86%99tests.md">learn-substrate-easy/9编写tests.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220701080314/https://mp.weixin.qq.com/s/8DsbCwL8XkiIEbTlHx4oAg">为pallet编写benchmarking</a></p>
<blockquote>
<p>为pallet编写benchmarking分两种情况，如下：</p>
</blockquote>
<ol>
<li>对函数进行性能测试时需要的构造条件不会涉及到本pallet以外的其它pallet；</li>
<li>在对函数进行性能测试时需要先使用其它的 pallet 构造测试的先决条件。</li>
</ol>
</li>
</ul>
<div id="admonition-大部分用第一种" class="admonition info">
<div class="admonition-title">
<p>大部分用第一种</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#admonition-大部分用第一种"></a></p>
</div>
<div>
<ul>
<li>第一种情况相对来说比较简单，这个也比较好找到例子。
<ul>
<li>第二种情况则比较复杂，写起来也比较麻烦。</li>
<li>不过在我们的开发中，大部分都是第一种情况。</li>
</ul>
</li>
</ul>
</div>
</div>
<h3 id="benchmarking"><a class="header" href="#benchmarking">benchmarking</a></h3>
<ul>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/10%E7%BC%96%E5%86%99benchmarking.md">learn-substrate-easy/10编写benchmarking.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
<li><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/12%E7%BC%96%E5%86%99%E5%A4%8D%E6%9D%82%E7%9A%84benchmarking.md">learn-substrate-easy/12编写复杂的benchmarking.md at main · KuanHsiaoKuo/learn-substrate-easy</a></li>
</ul>
<h2 id="升级"><a class="header" href="#升级">升级</a></h2>
<ul>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/11%E5%8D%87%E7%BA%A7runtime.md">learn-substrate-easy/11升级runtime.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
</li>
<li>
<p><a href="https://github.com/KuanHsiaoKuo/learn-substrate-easy/blob/main/12%E5%8D%87%E7%BA%A7substrate%E7%89%88%E6%9C%AC.md">learn-substrate-easy/12升级substrate版本.md at main · KuanHsiaoKuo/learn-substrate-easy</a></p>
</li>
<li>
<p><a href="https://web.archive.org/web/20220628065113/https://mp.weixin.qq.com/s/qvqsKqn_h79Uig30jgQk7A">无分叉runtime升级</a></p>
<blockquote>
<p>substrate框架的特性之一就是支持无分叉运行时升级。无分叉升级时以区块链自身能力支持和保护的方式增强区块链运行时的一种手段，区块链的运行时定义了区块链可以保持的状态，还定义了改变该装填的逻辑。
substrate可以在不分叉的情况下更新runtime，因为运行时的定义本身就是substrate链中的一个元素，网络参与者可以通过交易函数，特别是set_code函数来更新该值。
由于运行时状态的更新受到区块链共识机制和加密安全的约束，网络参与者可以在不分叉的情况下使用不受信任分发的更新或者扩展的运行时逻辑，甚至不需要发布新的区块链客户端。</p>
</blockquote>
<ul>
<li>本节内容：
<ol>
<li>使用sudo调用将schelduler</li>
<li>pallet包含到runtime中；</li>
<li>调用runtime升级。</li>
</ol>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate备忘录"><a class="header" href="#substrate备忘录">Substrate备忘录📕</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_ref.html#substrate%E5%A4%87%E5%BF%98%E5%BD%95">Substrate备忘录<g-emoji class="g-emoji" alias="closed_book" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4d5.png">📕</g-emoji>
</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_ref.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:48 UTC 2022 -->
<!--te-->
<h1 id="参考资源-45"><a class="header" href="#参考资源-45">参考资源</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate市场交流"><a class="header" href="#substrate市场交流">Substrate市场交流</a></h1>
<div id="admonition-explore-more" class="admonition tip">
<div class="admonition-title">
<p>Explore More</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#admonition-explore-more"></a></p>
</div>
<div>
<p>这里可以看作是自由竞技分享场，从Runtimes、Pallets和Projects三个方面学习和分享
<a href="https://marketplace.substrate.io/">Home | Substrate_ Marketplace</a></p>
</div>
</div>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#substrate%E5%B8%82%E5%9C%BA%E4%BA%A4%E6%B5%81">Substrate市场交流</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#runtimes">Runtimes</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#pallets">Pallets</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#projects">Projects</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study">Case Study</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#acala-network-defi">Acala Network: Defi</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-1">Case Study</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#astar-network-smart-contracts">Astar Network: Smart Contracts</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-2">Case Study</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#equilibrium">Equilibrium</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-3">Case Study</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#moonbeam-smart-contracts">Moonbeam: Smart Contracts</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-4">Case Study</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#polkadex-defi-infrastructure">Polkadex: DeFi, Infrastructure</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-5">Case Study</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#unique-network-nfts">Unique Network: NFTs</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#case-study-6">Case Study</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#%E5%88%86%E7%B1%BB%E4%BB%8B%E7%BB%8D-144">分类介绍: 144</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#defi-35">DeFi: 35</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#wallet-16">Wallet: 16</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#identity-14">Identity: 14</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#social-5">Social: 5</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#smart-contracts-10">Smart Contracts: 10</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#file-storage-5">File Storage: 5</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#bluzelle">Bluzelle</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#cere">Cere</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#crust-network">Crust Network</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#datdot">DatDot</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#equilibriumco">Equilibrium.co</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#iot-4">IoT: 4</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#data-highway">Data Highway</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#nodle">Nodle</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#origin-trail">Origin Trail</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#robonomicsairalabs">Robonomics(Airalabs)</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#gaming-7">Gaming: 7</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#ajuna-network">Ajuna Network</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#bitcountry">Bit.Country</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#celer-network">Celer Network</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#everdream-soft">Everdream Soft</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#gamedao">GameDAO</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#sensorium-corporation">Sensorium Corporation</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#bridge-4">Bridge: 4</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#infrastructure-39">Infrastructure: 39</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#relay-chain-2">Relay Chain: 2</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#nfts-1">NFTs: 1</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#unique-network">Unique Network</a></li>
</ul>
</li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:48 UTC 2022 -->
<!--te-->
<div id="admonition-他山之石可以攻玉" class="admonition tip">
<div class="admonition-title">
<p>他山之石，可以攻玉</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#admonition-他山之石可以攻玉"></a></p>
</div>
<div>
<p>都知道Substrate框架开发区块链项目功能强大，那么这里可以先看看Substrate至少能做到什么程度</p>
</div>
</div>
<h1 id="runtimes"><a class="header" href="#runtimes">Runtimes</a></h1>
<ul>
<li><a href="https://marketplace.substrate.io/runtimes/">Runtimes | Substrate_ Marketplace</a></li>
</ul>
<h1 id="pallets"><a class="header" href="#pallets">Pallets</a></h1>
<ul>
<li><a href="https://marketplace.substrate.io/pallets/">Pallets | Substrate_ Marketplace</a></li>
</ul>
<h1 id="projects"><a class="header" href="#projects">Projects</a></h1>
<ul>
<li><a href="https://marketplace.substrate.io/projects/">Projects | Substrate_ Marketplace</a></li>
</ul>
<h2 id="case-study"><a class="header" href="#case-study">Case Study</a></h2>
<p>这里主要重点看几个案例学习项目。</p>
<h3 id="acala-network-defi"><a class="header" href="#acala-network-defi">Acala Network: Defi</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Acala%20Network.png" alt="img" style="zoom: 25%;" />
<p>Acala is a decentralized stablecoin platform that powers cross-blockchain open finance applications.</p>
<h4 id="case-study-1"><a class="header" href="#case-study-1">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/acala/">Acala Network Case Study | Substrate_</a></p>
<h3 id="astar-network-smart-contracts"><a class="header" href="#astar-network-smart-contracts">Astar Network: Smart Contracts</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Astar%20Network.png" alt="img" style="zoom:150%;" />
<p>Astar Network is a scaling dapps platform on Substrate compatible with Ethereum Virtual Machine (EVM) and connected to
Polkadot.</p>
<h4 id="case-study-2"><a class="header" href="#case-study-2">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/astar/">Astar Network Case Study | Substrate_</a></p>
<h3 id="equilibrium"><a class="header" href="#equilibrium">Equilibrium</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/equilibrium.png" alt="img" style="zoom:65%;" />
<p>Equilibrium introduces a cross-chain money market that combines pooled lending with synthetic asset generation and
trading</p>
<h4 id="case-study-3"><a class="header" href="#case-study-3">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/equilibrium/">Equilibrium Case Study | Substrate_</a></p>
<h3 id="moonbeam-smart-contracts"><a class="header" href="#moonbeam-smart-contracts">Moonbeam: Smart Contracts</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Moonbeam.png" alt="img" style="zoom:150%;" />
<p>Decentralized and permissionless, Moonbeam provides an Ethereum-compatible smart contract platform that makes it easy to
build natively interoperable applications.</p>
<h4 id="case-study-4"><a class="header" href="#case-study-4">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/moonbeam/">Moonbeam Case Study | Substrate_</a></p>
<h3 id="polkadex-defi-infrastructure"><a class="header" href="#polkadex-defi-infrastructure">Polkadex: DeFi, Infrastructure</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Polkadex.png" alt="img" style="zoom:67%;" />
<p>Polkadex is a Open Source, Decentralized Exchange Platform that features feeless trades, Market Order, AMM and full
focus on UI.</p>
<h4 id="case-study-5"><a class="header" href="#case-study-5">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/polkadex/">Polkadex Case Study | Substrate_</a></p>
<h3 id="unique-network-nfts"><a class="header" href="#unique-network-nfts">Unique Network: NFTs</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Unique%20Network-6253646.png" alt="img" style="zoom:400%;" />
<p>Unique Network is an infrastructure for the next generation NFTs, offering developers independence from network-wide
transaction fees and upgrades.</p>
<h4 id="case-study-6"><a class="header" href="#case-study-6">Case Study</a></h4>
<p><a href="https://substrate.io/ecosystem/projects/case-studies/unique/">Unique Network Case Study | Substrate_</a></p>
<h2 id="分类介绍-144"><a class="header" href="#分类介绍-144">分类介绍: 144</a></h2>
<p>这里主要学习网站上面的分类方法，首先分成DeFi、Wallet、Identity、Social、Smart Contracts、File Storage、IoT、Gaming、Bridge、Infrastructure、Relay
Chain、NFTs这些类别，然后再加上是否企业级别的标记.</p>
<div id="admonition-关于案例学习" class="admonition tip">
<div class="admonition-title">
<p>关于案例学习</p>
<p><a class="admonition-anchor-link" href="layer5_ecosystem/7_business/blockchain/substrate/substrate_marketplace.html#admonition-关于案例学习"></a></p>
</div>
<div>
<p>这里的项目有些直接提供案例学习，也会有相应标出</p>
</div>
</div>
<h2 id="defi-35"><a class="header" href="#defi-35">DeFi: 35</a></h2>
<h2 id="wallet-16"><a class="header" href="#wallet-16">Wallet: 16</a></h2>
<h2 id="identity-14"><a class="header" href="#identity-14">Identity: 14</a></h2>
<h2 id="social-5"><a class="header" href="#social-5">Social: 5</a></h2>
<h2 id="smart-contracts-10"><a class="header" href="#smart-contracts-10">Smart Contracts: 10</a></h2>
<h2 id="file-storage-5"><a class="header" href="#file-storage-5">File Storage: 5</a></h2>
<h3 id="bluzelle"><a class="header" href="#bluzelle">Bluzelle</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Bluzelle.png" alt="img" style="zoom:50%;" />
<p>The Bluzelle project enables dapps to store their data in a place that is both decentralized and mutable</p>
<h3 id="cere"><a class="header" href="#cere">Cere</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/cere.svg" alt="img" style="zoom:50%;" />
<p>Delivers fast-tracked consumer enterprise adoption through decentralized data clouds, data interoperability and SaaS
DeFi.</p>
<h3 id="crust-network"><a class="header" href="#crust-network">Crust Network</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/crust%20network.png" alt="img" style="zoom:67%;" />
<p>Crust Network implements a decentralized cloud blockchain based on Polkadot. It is designed to build a decentralized
cloud ecosystem that values data privacy and ownership.</p>
<h3 id="datdot"><a class="header" href="#datdot">DatDot</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/DatDot.png" alt="img" style="zoom:40%;" />
<p>DatDot is a Distributed (peer-to-peer ) File Hosting Network, leveraging on the Dat Protocol and Substrate.</p>
<h3 id="equilibriumco"><a class="header" href="#equilibriumco">Equilibrium.co</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/equilibrium.co.svg" alt="img" style="zoom: 200%;" />
<p>Equillibrium is building a Rust-based implementation of the InterPlanetary File System (IPFS) Protocol.</p>
<h2 id="iot-4"><a class="header" href="#iot-4">IoT: 4</a></h2>
<h3 id="data-highway"><a class="header" href="#data-highway">Data Highway</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/data%20highway.png" alt="img" /></p>
<p>DataHighway is a DAO that incentivizes the community to run a sophisticated IoT parachain based on Polkadot using the
DHX token.</p>
<h3 id="nodle"><a class="header" href="#nodle">Nodle</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Nodle.png" alt="img" /></p>
<p>Nodle is the world’s largest ecosystem of connected devices, providing infrastructure, software and access to data for
the Internet of Things.</p>
<h3 id="origin-trail"><a class="header" href="#origin-trail">Origin Trail</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Origin%20Trail.svg" alt="img" style="zoom: 400%;" />
<p>OriginTrail is an ecosystem dedicated to making global supply chains work together by enabling a universal,
collaborative and trusted data exchange.</p>
<h3 id="robonomicsairalabs"><a class="header" href="#robonomicsairalabs">Robonomics(Airalabs)</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/robonomics%20(airalabs).png" alt="img" style="zoom:67%;" />
<p>Robonomics Network is a set of open-source packages for Robotics, Smart Cities and Industry 4.0 developers.</p>
<h2 id="gaming-7"><a class="header" href="#gaming-7">Gaming: 7</a></h2>
<h3 id="ajuna-network"><a class="header" href="#ajuna-network">Ajuna Network</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Ajuna%20Network.png" alt="img" style="zoom: 33%;" />
<p>Ajuna Network is an infrastructure for Blockhain Games, featureing a full featured UnitySDK and UnrealSDK built on
Substrate.</p>
<h3 id="bitcountry"><a class="header" href="#bitcountry">Bit.Country</a></h3>
<p><img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Bit.Country.jpeg" alt="img" /></p>
<p>Bit.Country is a decentralized world where everyone can start their own metaverse with the token economy and DAO.</p>
<h3 id="celer-network"><a class="header" href="#celer-network">Celer Network</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/celer%20network.png" alt="img" style="zoom: 33%;" />
<p>Celer Network enables fast, easy and secure off-chain transactions for payment transactions and generalized off-chain
smart contract.</p>
<h3 id="everdream-soft"><a class="header" href="#everdream-soft">Everdream Soft</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Everdream%20Soft.png" alt="img" style="zoom: 50%;" />
<p>Since 2014 is pinoneer in the integration and use of blockchain tools in the domain of gaming and digital collectibles.</p>
<h3 id="gamedao"><a class="header" href="#gamedao">GameDAO</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Gamedao.png" alt="img" style="zoom:20%;" />
<p>GameDAO is democratic and transparent crowdfunding for video game creators, publishers, investors and gamers.</p>
<h3 id="sensorium-corporation"><a class="header" href="#sensorium-corporation">Sensorium Corporation</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Sensorium%20Corporation.jpeg" alt="img" style="zoom:75%;" />
<p>Sensorium Galaxy leverages state-of-the-art blockchain technologies to make the future of content distribution safe for
both the public and artists.</p>
<h2 id="bridge-4"><a class="header" href="#bridge-4">Bridge: 4</a></h2>
<h2 id="infrastructure-39"><a class="header" href="#infrastructure-39">Infrastructure: 39</a></h2>
<h2 id="relay-chain-2"><a class="header" href="#relay-chain-2">Relay Chain: 2</a></h2>
<h2 id="nfts-1"><a class="header" href="#nfts-1">NFTs: 1</a></h2>
<h3 id="unique-network"><a class="header" href="#unique-network">Unique Network</a></h3>
<img src="https://raw.githubusercontent.com/KuanHsiaoKuo/writing_materials/main/imgs/Unique%20Network.png" alt="img" style="zoom: 250%;" />
<p>Unique Network is an infrastructure for the next generation NFTs, offering developers independence from network-wide
transaction fees and upgrades.</p>
<h2 id="参考资源-46"><a class="header" href="#参考资源-46">参考资源</a></h2>
<ul>
<li><a href="https://substrate.io/ecosystem/projects/">Projects | Substrate_</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="substrate惊奇资源"><a class="header" href="#substrate惊奇资源">Substrate惊奇资源</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#substrate%E6%83%8A%E5%A5%87%E8%B5%84%E6%BA%90">Substrate惊奇资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#resources">Resources</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#support">Support</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#social">Social</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#events">Events</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#blogs">Blogs</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#videos">Videos</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#templates">Templates</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#frame-pallets">FRAME Pallets</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#framework-extensions">Framework Extensions</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#client-libraries">Client Libraries</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#mobile">Mobile</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#tools">Tools</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#products-and-services">Products and Services</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#alternative-implementations">Alternative Implementations</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#scale-codec">SCALE Codec</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/substrate/awesome_substrate.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a></li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:47 UTC 2022 -->
<!--te-->
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><a href="https://dotjobs.net/">DotJobs</a> - A job board for the Substrate and Polkadot ecosystem projects, maintained
by <a href="https://stateless.money/">Stateless.Money</a>.</li>
<li><a href="https://github.com/substrate-developer-hub/">Developer Hub GitHub</a> - Substrate Developer Hub repositories.</li>
<li><a href="https://substrate.io/ecosystem/projects/">Ecosystem Projects</a> - Projects and teams building with Substrate.</li>
<li><a href="https://github.com/w3f/Grants-Program/blob/master/docs/polkadot_stack.md">Polkadot Stack</a> - An <code>awesome list</code>
maintained by our friends at <a href="https://web3.foundation/">Web3 Foundation</a>.</li>
<li><a href="https://substrate.io/">Official Homepage</a> - Vision, ecosystem, opportunities, and much more.
<ul>
<li><a href="https://docs.substrate.io/">Docs</a> - Developer documentation.</li>
<li><a href="https://docs.substrate.io/tutorials">Tutorials</a> - Guided exercises to get you started.</li>
<li><a href="https://docs.substrate.io/how-to-guides">How-to guides</a> - Workflows outlined to achieve a specific goal.</li>
<li><a href="https://docs.substrate.io/rustdocs">Reference Docs</a> - Versioned API documentation.</li>
</ul>
</li>
<li>Technical Papers
<ul>
<li><a href="https://polkadot.network/Polkadot-lightpaper.pdf">Polkadot Lightpaper</a></li>
<li><a href="https://github.com/polkadot-io/polkadotpaper/raw/master/PolkaDotPaper.pdf">Polkadot: Vision for a heterogeneous multi-chain framework</a></li>
<li><a href="https://arxiv.org/abs/2005.13456.pdf">Overview of Polkadot and its Design Considerations</a>
<ul>
<li><a href="https://github.com/AmadeusGB/Overview-of-Polkadot">Chinese Translation</a> (by community)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="support"><a class="header" href="#support">Support</a></h2>
<ul>
<li><a href="https://substrate.io/ecosystem/substrate-builders-program/">Builders Program</a> - White-glove solutions and dedicated
support team for visionary teams using Substrate.</li>
<li><a href="https://substrate.stackexchange.com/">Stack Exchange</a> - The best place for all technical questions.</li>
<li><a href="https://web3.foundation/grants">Web3 Foundation Grants</a> - Funding for ecosystem development.</li>
</ul>
<h2 id="social"><a class="header" href="#social">Social</a></h2>
<ul>
<li><a href="https://t.me/substratedevs">Substrate Devs Chat (Telegram)</a> - Chat with other Substrate developers, also bridged
to <a href="https://matrix.to/#/#substratedevs:matrix.org">matrix</a>.</li>
<li><a href="https://twitter.com/substrate_io">Twitter</a> - Follow us to stay up-to-date.</li>
</ul>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<ul>
<li><a href="https://sub0.parity.io/">Sub0 Developer Conference</a> - Semiannual, online and in-person for all things Substrate.</li>
<li><a href="https://substrate.io/ecosystem/resources/seminar/">Substrate Seminar</a> - Bi-weekly collaborative learning sessions.</li>
</ul>
<h2 id="blogs"><a class="header" href="#blogs">Blogs</a></h2>
<ul>
<li><a href="https://dotleap.com/">DotLeap</a> - Polkadot and Substrate Community blog and newsletter.</li>
<li><a href="https://www.parity.io/blog/tag/parity-substrate">Official</a> - Published by Parity.</li>
</ul>
<h2 id="videos"><a class="header" href="#videos">Videos</a></h2>
<ul>
<li><a href="https://www.youtube.com/c/paritytech">Parity YouTube</a>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLp0_ueXY_enXRfoaW7sTudeQH10yDvFOS">Substrate Seminar (YouTube Archive)</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLp0_ueXY_enUZk1RuEAU9ly5h0wy5FuLs">Sub0 Conference Oct. 2020</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLp0_ueXY_enWZ4UZE7rM0hdT8Z_ZTjU5V">Sub0 Conference Dec. 2019</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLp0_ueXY_enWqrfP_vR4PLhzQj76fLT8y">Sub0 Conference Apr. 2019</a></li>
</ul>
</li>
<li><a href="https://www.youtube.com/playlist?list=PLOyWqupZ-WGuAuS00rK-pebTMAOxW41W8">Polkadot Network Technical Explainers</a></li>
<li><a href="https://www.crowdcast.io/e/substrate-seminar-2/">Seminar Crowdcast</a> - Upcoming events and latest recordings.
<ul>
<li><a href="https://www.crowdcast.io/e/substrate-seminar/">Old Seminar Crowdcast</a> - Archive only.</li>
</ul>
</li>
<li><a href="https://www.youtube.com/watch?v=0IoUZdDi5Is">Substrate: A Rustic Vision for Polkadot by Gavin Wood at Web3 Summit 2018</a></li>
</ul>
<h2 id="templates"><a class="header" href="#templates">Templates</a></h2>
<ul>
<li><a href="https://github.com/substrate-developer-hub/substrate-node-template">Base</a> - Minimal FRAME-based node, derived
from <a href="https://github.com/paritytech/substrate/tree/master/bin/node-template">upstream</a>.</li>
<li><a href="https://github.com/paritytech/frontier/tree/master/template">Frontier</a> - Fronter enabled EVM and Ethereum RPC
compatible Substrate node, ready for hacking.</li>
<li><a href="https://github.com/substrate-developer-hub/substrate-front-end-template">Front-End</a> - Polkadot-JS API
and <a href="https://reactjs.org/">React</a> app to build front-ends for Substrate-based chains.</li>
<li><a href="https://github.com/substrate-developer-hub/substrate-parachain-template">Parachain</a> - Cumulus enabled Substrate node,
derived from <a href="https://github.com/paritytech/cumulus/tree/master/parachain-template">upstream</a>.</li>
<li><a href="https://github.com/kaichaosun/substrate-stencil"><code>substrate-stencil</code></a> - A template for a Substrate node that includes
staking and governance capabilities.</li>
</ul>
<h2 id="frame-pallets"><a class="header" href="#frame-pallets">FRAME Pallets</a></h2>
<ul>
<li><a href="https://github.com/smartcontractkit/chainlink-polkadot">Chainlink Feed Pallet</a> - Chainlink feed token interface.</li>
<li><a href="https://github.com/paritytech/substrate/tree/master/frame">Official in Substrate</a> - Large collection, Parity
maintained.</li>
<li><a href="https://github.com/open-web3-stack/open-runtime-module-library">Open Runtime Module Library (ORML)</a> - Community
maintained collection of Substrate runtime modules.</li>
<li><a href="https://github.com/sunshine-protocol/sunshine-bounty/tree/master/pallets">Sunshine Bounty</a> - Distributed autonomous
organization (DAO) for administering a bounty program.</li>
<li><a href="https://github.com/sunshine-protocol/sunshine-keybase/tree/master/identity/pallet">Sunshine Identity</a> -
Keybase-inspired identity management.</li>
<li><a href="https://github.com/sunshine-protocol/sunshine-keybase/tree/master/faucet/pallet">Sunshine Faucet</a> - Dispense
resources for a development chain.</li>
<li><a href="https://github.com/rmrk-team/rmrk-substrate">RMRK Pallets</a> - Nested, conditional &amp; Multi-resourced NFTs.</li>
</ul>
<h2 id="framework-extensions"><a class="header" href="#framework-extensions">Framework Extensions</a></h2>
<ul>
<li><a href="https://github.com/paritytech/parity-bridges-common">Bridges</a> - A collection of tools for cross-chain communication.</li>
<li><a href="https://github.com/paritytech/cumulus">Cumulus</a> - A set of tools for writing Substrate-based Polkadot parachains.</li>
<li><a href="https://docs.substrate.io/v3/runtime/frame/">FRAME</a> - A system for building Substrate runtimes.</li>
<li><a href="https://github.com/paritytech/frontier">Frontier</a> - End-to-end Ethereum emulation for Substrate chains.</li>
<li><a href="https://github.com/paritytech/ink">ink!</a> - Rust smart contract language for Substrate chains.</li>
<li><a href="https://book.integritee.network/">IntegriTEE</a> - Trusted off-chain execution framework that
uses <a href="https://en.wikipedia.org/wiki/Software_Guard_Extensions">Intel SGX</a> trusted execution environments.</li>
<li><a href="https://polkadot.js.org/">Polkadot-JS</a> - Rich JavaScript API framework for front-end development.</li>
</ul>
<h2 id="client-libraries"><a class="header" href="#client-libraries">Client Libraries</a></h2>
<ul>
<li><a href="https://github.com/usetech-llc/polkadot_api_dotnet">.Net API</a> - Maintained
by <a href="https://usetech.com/blockchain/">Usetech</a>.</li>
<li><a href="https://github.com/dotmog/SubstrateNetApi">.NET Standard API</a> - Used
in <a href="https://www.nuget.org/packages/SubstrateNetApi/">nuget</a>,
and <a href="https://github.com/darkfriend77/Unity3DExample">Unity 3D integration example</a>; Maintained
by <a href="https://dotmog.com/">DOTMog</a>.</li>
<li><a href="https://github.com/Aphoh/go-substrate-gen"><code>go-substrate-gen</code></a> - Generate go (de)serialization/client code from
substrate metadata.</li>
<li><a href="https://github.com/virto-network/sube"><code>sube</code></a> - Lightweight Rust client library and CLI with support for type
information.</li>
<li><a href="https://github.com/paritytech/substrate-subxt"><code>subxt</code></a> - Official Rust client.</li>
<li><a href="https://github.com/usetech-llc/polkadot_api_cpp">C++ API</a> - Maintained by Usetech.</li>
<li><a href="https://github.com/centrifuge/go-substrate-rpc-client/">Go RPC Client</a> - Maintained
by <a href="https://centrifuge.io/">Centrifuge</a>.</li>
<li><a href="https://github.com/NodleCode/substrate-client-kotlin">Kotlin Client</a> - Maintained
by <a href="https://github.com/NodleCode">Nodle.io</a>.</li>
<li><a href="https://github.com/polkadot-js/api/">Polkadot-JS API</a> - Semi-official JavaScript library for Substrate-based chains.</li>
<li><a href="https://github.com/polkascan/py-substrate-interface">Python Interface</a> - Maintained
by <a href="https://polkascan.org/">Polkascan Foundation</a>.</li>
<li><a href="https://github.com/scs/substrate-api-client">Rust API Client</a> - Rust client maintained
by <a href="https://www.scs.ch/">Supercomputing Systems AG</a>.</li>
<li><a href="https://github.com/itering/subscan-essentials">Subscan Go Utilities</a> - SS58 and more, developed by Subscan.</li>
</ul>
<h2 id="mobile"><a class="header" href="#mobile">Mobile</a></h2>
<ul>
<li><a href="https://github.com/soramitsu/fearless-utils-Android">Fearless Utils Android</a> - Android Substrate tools.</li>
<li><a href="https://github.com/soramitsu/fearless-utils-iOS">Fearless Utils iOS</a> - iOS Substrate tools.</li>
<li><a href="https://github.com/Pocket4D/Polkadot-Dart">Polkadot-Dart</a> - Dart Substrate API.</li>
<li><a href="https://github.com/polkawallet-io/sdk">PolkaWallet SDK</a> - Flutter SDK for Substrate-based App.</li>
<li><a href="https://github.com/paritytech/react-native-substrate-sign">React-Native-Substrate-Sign</a> - Rust library for React
Native.</li>
</ul>
<h2 id="tools"><a class="header" href="#tools">Tools</a></h2>
<p><a href="https://github.com/paritytech/substrate-debug-kit/tree/master/offline-election"><code>offline-election</code></a>, which is a tool
that is used to predict nominated proof-of-stake elections.</p>
<ul>
<li><a href="https://rs-ipfs.github.io/offchain-ipfs-manual/"><code>offchain::ipfs</code></a> - Substrate infused with <a href="https://ipfs.io/">IPFS</a>.</li>
<li><a href="https://github.com/shawntabrizi/polkadot-js-bundle"><code>polkadot-js-bundle</code></a> - A standalone JS bundle that contains
Polkadot{JS} libraries.</li>
<li><a href="https://github.com/shawntabrizi/polkadot-launch"><code>polkadot-launch</code></a> - Simple CLI tool to launch a local Polkadot test
network.</li>
<li><a href="https://github.com/paritytech/polkadot-runtime-prom-exporter/"><code>polkadot-runtime-prom-exporter</code></a> -
A <a href="https://prometheus.io/">Prometheus</a> exporter for Polkadot runtime metrics (modifiable for Substrate use).</li>
<li><a href="https://github.com/paritytech/polkadot-scripts"><code>polkadot-scripts</code></a> - A collection of scripts Parity uses to diagnose
Polkadot/Kusama.</li>
<li><a href="https://github.com/koute/polkadot-starship"><code>polkadot-starship</code></a> - Another tool to launch a local Polkadot test
network, with emphasis on the ability to run big testnets.</li>
<li><a href="https://github.com/chevdor/srtool-actions"><code>srtool-actions</code></a> - GitHub actions to easily use the <code>srtool</code> Docker image
to build your own runtime.</li>
<li><a href="https://github.com/chevdor/srtool-cli"><code>srtool-cli</code></a> - CLI frontend for the <code>srtool</code> Docker image.</li>
<li><a href="https://github.com/paritytech/srtool"><code>srtool</code></a> - Docker image to deterministically build a runtime.</li>
<li><a href="https://github.com/ascjones/subsee"><code>subsee</code></a> - CLI to inspect metadata of a Substrate node as JSON.</li>
<li><a href="https://github.com/shawntabrizi/substrate-balance-calculator"><code>substrate-balance-calculator</code></a> - Breakdown the
balances of your Substrate account.</li>
<li><a href="https://github.com/shawntabrizi/substrate-balance-graph"><code>substrate-balance-graph</code></a> - Create a graph of the token
balance over time of a Substrate address.</li>
<li><a href="https://github.com/shawntabrizi/substrate-graph-benchmarks"><code>substrate-graph-benchmarks</code></a> - Graph the benchmark
output of FRAME pallets.</li>
<li><a href="https://github.com/shawntabrizi/substrate-js-utilities"><code>substrate-js-utils</code></a> - A set of useful JavaScript utilities
for Substrate that uses the Polkadot{JS} API;
Also <a href="https://www.shawntabrizi.com/substrate-js-utilities/">deployed as a website</a>.</li>
<li><a href="https://github.com/shawntabrizi/substrate-society"><code>substrate-society</code></a> - A basic front-end for the FRAME Society
pallet.</li>
<li><a href="https://github.com/shawntabrizi/substrate-toml-lint"><code>substrate-toml-lint</code></a> - A toml parser and checker to avoid
common errors in Substrate projects.</li>
<li><a href="https://github.com/chevdor/subwasm"><code>subwasm</code></a> - CLI to inspect a runtime WASM blob offline. It shows information,
metadata and can compare runtimes. It can also help you fetch a runtime directly from a node.</li>
<li><a href="https://github.com/clearloop/sup"><code>sup</code></a> - Command line tool for generating or upgrading a Substrate node.</li>
<li><a href="https://aleph.im">Aleph.im</a> - Scalable, decentralized database, file storage, and computation services for Substrate
chains and more.</li>
<li><a href="https://github.com/paritytech/substrate-archive">Archive</a> - Indexing engine for Substrate chains.</li>
<li><a href="https://github.com/danforbes/substrate-devhub-utils">Dev Hub Utils</a> - <em>Unofficial</em> utilities for working with
official Substrate Developer Hub resources.</li>
<li><a href="https://github.com/patractlabs/europa">Europa</a> - A sandbox for the Substrate runtime execution environment.</li>
<li><a href="https://github.com/maxsam4/fork-off-substrate">Fork Off Substrate</a> - Script to help bootstrap a new chain with the
state of a running chain.</li>
<li><a href="https://github.com/centrifuge/fudge">fudge</a> - Core lib for accessing and (arbitrarily) manipulating substrate
databases, including the building and importing of local blocks.</li>
<li><a href="https://github.com/gantree-io/gantree-lib-nodejs">Gantree Library</a> - A suite of technologies for managing
Substrate-powered parachain networks via rapid spin-up &amp; tear-down.</li>
<li><a href="https://github.com/halva-suite/halva">Halva</a> - A toolchain for improving the experience of developing on Substrate.</li>
<li><a href="https://github.com/Joystream/hydra">Hydra</a> - A GraphQL framework for Substrate nodes.</li>
<li><a href="https://github.com/patractlabs/jupiter">Jupiter</a> - Testnet for smart contracts written for the FRAME Contracts pallet
and ink!.</li>
<li><a href="https://github.com/patractlabs/megaclite">Megaclite</a> - Zero-knowledge tools for the Polkadot ecosystem.</li>
<li><a href="https://www.parity.io/signer/">Parity Signer</a> - Upcycle an unused mobile phone into an air-gapped hardware wallet.</li>
<li><a href="https://github.com/SimplyVC/panic_polkadot">Polkadot PANIC</a> - Monitoring and alerting solution for Polkadot nodes by
Simply VC, compatible with many Substrate chains.</li>
<li><a href="https://wiki.polkadot.network/docs/build-tools-index">Polkadot Tool Index</a> - List of tools available for your
development with Polkadot and any Substrate chain including Block Explorers, Wallets, Network Monitoring &amp; Reporting,
Clients, Benchmarking, Fuzzing, Forking, SCALE Codec, CLI Tools and much more.</li>
<li><a href="https://polkadot.js.org/apps/">Polkadot-JS Apps UI</a> - Semi-official block explorer &amp; front-end for Substrate-based
chains.</li>
<li><a href="https://github.com/polkadot-js/extension">Polkadot-JS Extension</a> - Browser extension for interacting with
Substrate-based chains.</li>
<li><a href="https://polkascan.io/">Polkascan</a> - Multi-chain block explorer maintained by Polkascan Foundation.</li>
<li><a href="https://github.com/emostov/proxy-hot-wallet">Proxy Hot Wallet Demo</a> - A demonstration of a secure, convenient, and
flexible hot wallet architecture built on Substrate primitives.</li>
<li><a href="https://github.com/patractlabs/redspot">Redspot</a> - A <a href="https://www.trufflesuite.com/truffle">Truffle</a>-like toolkit for
smart contracts for the FRAME Contracts pallet and ink!.</li>
<li><a href="https://github.com/paritytech/substrate-api-sidecar">Sidecar</a> - REST service that runs alongside Substrate nodes.</li>
<li><a href="https://polkadot.subscan.io/tools/ss58_transform">SS58 Transform</a> - Display key’s addressees with all SS58 prefixes.</li>
<li><a href="https://github.com/w3f/staking-rewards-collector">Staking Rewards Collector</a> - A script to parse and output staking
rewards for a given Kusama or Polkadot address and cross-reference them with daily price data.</li>
<li><a href="https://substrate.dev/docs/en/knowledgebase/integrate/subkey">Subkey</a> - Command line utility for working with
cryptographic keys.</li>
<li><a href="https://subquery.network">SubQuery</a> - A GraphQL indexer and query service that allows users to easily create indexed
data sources and host them online for free.</li>
<li><a href="https://www.subscan.io/">Subscan</a> - Multi-network explorer for Substrate-based chains.</li>
<li><a href="https://subsquid.io">Subsquid</a> - An indexing framework (SDK + infrastructure) to quickly and easily turn Substrate
and EVM on-chain data into APIs and host them.</li>
<li><a href="https://github.com/arrudagates/substate">Substate</a> - 100% no-std/wasm compatible Substrate storage key generator
library for Rust.</li>
<li><a href="https://github.com/paritytech/substrate-debug-kit">Substrate debug-kit</a> - A collection of tools and libraries for
debugging Substrate-based chains.</li>
<li><a href="https://github.com/ETeissonniere/substrate-nodeops">Substrate Docker Builders</a> - A set of Dockerfiles and GitHub
Actions to auto-build and push a Docker image for Substrate-based chains.</li>
<li><a href="https://github.com/starkleytech/substrate-faucet">Substrate Faucet Bot</a> - Python-based faucet for development
purposes.</li>
<li><a href="https://github.com/playzero/substrate-graph">Substrate Graph</a> - GraphQL indexer for Substrate-based chains.</li>
<li><a href="https://github.com/paritytech/txwrapper">TxWrapper</a> - Helpful library for offline transaction creation.</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=paritytech.vscode-substrate">VSCode Substrate</a> - Plugin for
Visual Studio Code.</li>
</ul>
<h2 id="products-and-services"><a class="header" href="#products-and-services">Products and Services</a></h2>
<ul>
<li><a href="https://onfinality.io">OnFinality</a> - Free and paid services to shared Substrate based nodes.</li>
</ul>
<h2 id="alternative-implementations"><a class="header" href="#alternative-implementations">Alternative Implementations</a></h2>
<ul>
<li><a href="https://github.com/ChainSafe/gossamer">Gossamer</a> - A Polkadot client implemented in Go;
from <a href="https://chainsafe.io/">ChainSafe</a>.</li>
<li><a href="https://kagome.readthedocs.io/en/latest/">Kagome</a> - A C++17 implementation of the Polkadot client;
from <a href="http://www.soramitsu.co.jp/">Soramitsu</a>.</li>
<li><a href="https://github.com/LimeChain/as-substrate-runtime">LimeChain AssemblyScript Runtime</a> - An account-based Substrate
proof-of-concept runtime written in AssemblyScript; from <a href="https://limechain.tech/">LimeChain</a>.</li>
</ul>
<h2 id="scale-codec"><a class="header" href="#scale-codec">SCALE Codec</a></h2>
<ul>
<li><a href="https://github.com/LimeChain/as-scale-codec">AssemblyScript</a> - Maintained by LimeChain.</li>
<li><a href="https://github.com/MatthewDarnell/cScale">C</a> - Maintained by Matthew Darnell.</li>
<li><a href="https://github.com/soramitsu/scale-codec-cpp">C++</a> - Maintained by Soramitsu.</li>
<li><a href="https://docs.substrate.io/v3/advanced/scale-codec/">Codec Definition</a> - Official codec documentation.</li>
<li><a href="https://github.com/itering/scale.go">Go</a> - Maintained by <a href="https://www.itering.com/">Itering</a>.</li>
<li><a href="https://github.com/airalab/hs-web3/tree/master/src/Codec">Haskell</a> - Maintained
by <a href="https://robonomics.network/">Robonomics Network</a>.</li>
<li><a href="https://github.com/emeraldpay/polkaj/tree/master/polkaj-scale">Java</a> - Maintained by <a href="https://emerald.cash/">Emerald</a>
.</li>
<li><a href="https://github.com/paritytech/parity-scale-codec">Parity SCALE Codec</a> - Reference implementation written in Rust.</li>
<li><a href="https://github.com/polkascan/py-scale-codec">Python</a> - Maintained by Polkascan Foundation.</li>
<li><a href="https://github.com/itering/scale.rb">Ruby</a> - Maintained by Itering.</li>
<li><a href="https://github.com/virto-network/scales">Scales</a> - Serializing SCALE using type information from a type registry.</li>
<li>JavaScript / TypeScript implementations:
<ul>
<li><a href="https://github.com/paritytech/parity-scale-codec-ts">paritytech/parity-scale-codec-ts</a> - Maintained by Parity
Technologies.</li>
<li><a href="https://github.com/polkadot-js/api/tree/master/packages/types">polkadot-js/api</a> - Maintained by Polkadot-JS.</li>
<li><a href="https://github.com/unstoppablejs/unstoppablejs/tree/main/packages/scale-ts#scale-ts">scale-ts</a> - Maintained by
Josep M Sobrepere.</li>
<li><a href="https://github.com/soramitsu/scale-codec-js-library">soramitsu/scale-codec-js-library</a> - Maintained by Soramitsu.</li>
</ul>
</li>
</ul>
<h2 id="参考资源-47"><a class="header" href="#参考资源-47">参考资源</a></h2>
<ul>
<li><a href="https://github.com/substrate-developer-hub/awesome-substrate/blob/master/README.md">awesome-substrate/README.md at master · substrate-developer-hub/awesome-substrate</a>
<blockquote>
<p>an awesome list is a list of awesome things curated by the Substrate community.</p>
</blockquote>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nervosckb"><a class="header" href="#nervosckb">nervos/ckb</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html#nervosckb">nervos/ckb</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/nervos_ckb_anatomy.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:46 UTC 2022 -->
<!--te-->
<h2 id="参考资源-48"><a class="header" href="#参考资源-48">参考资源</a></h2>
<h3 id="online-book-40"><a class="header" href="#online-book-40">online-book</a></h3>
<ul>
<li><a href="https://github.com/nervosnetwork/ckb">nervosnetwork/ckb: The Nervos CKB is a public permissionless blockchain, and the layer 1 of Nervos network.</a></li>
</ul>
<h3 id="fragment-40"><a class="header" href="#fragment-40">fragment</a></h3>
<h3 id="local-40"><a class="header" href="#local-40">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solana"><a class="header" href="#solana">Solana</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/solana.html#solana">Solana</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/solana.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90">参考资源</a>
<ul>
<li><a href="layer5_ecosystem/7_business/blockchain/solana.html#online-book">online-book</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/solana.html#fragment">fragment</a></li>
<li><a href="layer5_ecosystem/7_business/blockchain/solana.html#local">local</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:46 UTC 2022 -->
<!--te-->
<h2 id="参考资源-49"><a class="header" href="#参考资源-49">参考资源</a></h2>
<h3 id="online-book-41"><a class="header" href="#online-book-41">online-book</a></h3>
<ul>
<li><a href="https://github.com/solana-labs/solana">solana-labs/solana: Web-Scale Blockchain for fast, secure, scalable, decentralized apps and marketplaces.</a></li>
</ul>
<h3 id="fragment-41"><a class="header" href="#fragment-41">fragment</a></h3>
<h3 id="local-41"><a class="header" href="#local-41">local</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="生产实践"><a class="header" href="#生产实践">生产实践</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="优秀产品"><a class="header" href="#优秀产品">优秀产品</a></h1>
<!--ts-->
<ul>
<li><a href="layer5_ecosystem/7_business/products/products.html#%E4%BC%98%E7%A7%80%E4%BA%A7%E5%93%81">优秀产品</a>
<ul>
<li><a href="layer5_ecosystem/7_business/products/products.html#awesome-series">awesome series</a>
<ul>
<li><a href="layer5_ecosystem/7_business/products/products.html#rust-unofficialawesome-rust">rust-unofficial/awesome-rust</a></li>
<li><a href="layer5_ecosystem/7_business/products/products.html#rust-embeddedasesome-embedded-rust">rust-embedded/asesome-embedded-rust</a></li>
<li><a href="layer5_ecosystem/7_business/products/products.html#rust-in-blockchainawesome-blockchain-rust">rust-in-blockchain/awesome-blockchain-rust</a></li>
<li><a href="layer5_ecosystem/7_business/products/products.html#tako8kiawesome-alternatives-in-rust">TaKO8Ki/awesome-alternatives-in-rust</a></li>
<li><a href="layer5_ecosystem/7_business/products/products.html#rustbegginersawesome-rust-mentors">RustBegginers/awesome-rust-mentors</a></li>
<li><a href="layer5_ecosystem/7_business/products/products.html#awesome-rust-comawesome-rust">awesome-rust-com/awesome-rust</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- Created by https://github.com/ekalinin/github-markdown-toc -->
<!-- Added by: runner, at: Thu Jul 21 05:31:49 UTC 2022 -->
<!--te-->
<h2 id="awesome-series"><a class="header" href="#awesome-series">awesome series</a></h2>
<p><a href="https://github.com/topics/awesome">awesome · GitHub Topics</a></p>
<h3 id="rust-unofficialawesome-rust"><a class="header" href="#rust-unofficialawesome-rust">rust-unofficial/awesome-rust</a></h3>
<ul>
<li><a href="https://github.com/rust-unofficial/awesome-rust">rust-unofficial/awesome-rust: A curated list of Rust code and resources.</a></li>
</ul>
<h3 id="rust-embeddedasesome-embedded-rust"><a class="header" href="#rust-embeddedasesome-embedded-rust">rust-embedded/asesome-embedded-rust</a></h3>
<ul>
<li><a href="https://github.com/rust-embedded/awesome-embedded-rust">rust-embedded/awesome-embedded-rust: Curated list of resources for Embedded and Low-level development in the Rust programming language</a></li>
</ul>
<h3 id="rust-in-blockchainawesome-blockchain-rust"><a class="header" href="#rust-in-blockchainawesome-blockchain-rust">rust-in-blockchain/awesome-blockchain-rust</a></h3>
<ul>
<li><a href="https://github.com/rust-in-blockchain/awesome-blockchain-rust">rust-in-blockchain/awesome-blockchain-rust: Collect libraries and packages about blockchain/cryptography in Rust</a></li>
</ul>
<h3 id="tako8kiawesome-alternatives-in-rust"><a class="header" href="#tako8kiawesome-alternatives-in-rust">TaKO8Ki/awesome-alternatives-in-rust</a></h3>
<ul>
<li><a href="https://github.com/TaKO8Ki/awesome-alternatives-in-rust#terminal">TaKO8Ki/awesome-alternatives-in-rust: A curated list of replacements for existing software written in Rust</a></li>
</ul>
<h3 id="rustbegginersawesome-rust-mentors"><a class="header" href="#rustbegginersawesome-rust-mentors">RustBegginers/awesome-rust-mentors</a></h3>
<ul>
<li><a href="https://github.com/RustBeginners/awesome-rust-mentors">RustBeginners/awesome-rust-mentors: A list of rust lang mentors tagged by topics of interest</a></li>
</ul>
<h3 id="awesome-rust-comawesome-rust"><a class="header" href="#awesome-rust-comawesome-rust">awesome-rust-com/awesome-rust</a></h3>
<ul>
<li><a href="https://github.com/awesome-rust-com/awesome-rust">awesome-rust-com/awesome-rust: Awesome Rust</a></li>
<li><a href="https://awesome-rust.com/">Awesome Rust | awesome-rust</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="基础库"><a class="header" href="#基础库">基础库</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="框架引擎"><a class="header" href="#框架引擎">框架引擎</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="checklist"><a class="header" href="#checklist">Checklist</a></h1>
<ul>
<li>
<p>总览:</p>
<ul>
<li>[ ] This is an important note (<a href="../README.html#Note-1">Note-1</a>)</li>
</ul>
</li>
<li>
<p>Substrate教程梳理:</p>
<ul>
<li>[ ] pallet 前置Rust知识 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Preset">Pallet-Preset</a>)</li>
<li>[ ] pallet extrinsics 使用 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Extrinsics">Pallet-Extrinsics</a>)</li>
<li>[ ] pallet errors 使用 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Errors">Pallet-Errors</a>)</li>
<li>[ ] pallet config 使用 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Config">Pallet-Config</a>)</li>
<li>[ ] pallet 使用其他 Pallet (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Use-Other-Pallet">Pallet-Use-Other-Pallet</a>)</li>
<li>[ ] pallet 扩展 使用 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Extension">Pallet-Extension</a>)</li>
<li>[ ] pallet 调试 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Debug">Pallet-Debug</a>)</li>
<li>[ ] pallet rpc 使用 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-RPC">Pallet-RPC</a>)</li>
<li>[ ] pallet 基准测试 (<a href="layer5_ecosystem/7_business/blockchain/substrate/substrate_tutorials.html#Pallet-Benchmarking">Pallet-Benchmarking</a>)</li>
</ul>
</li>
</ul>

            </main>

            <!--            <script src="https://utteranc.es/client.js"-->
            <!--                    repo="RustMagazine/rust_magazine_2022"-->
            <!--                    issue-term="title"-->
            <!--                    theme="github-light"-->
            <!--                    crossorigin="anonymous"-->
            <!--                    async></script>-->

            <nav class="nav-wrapper" aria-label="Page navigation">
                <!-- Mobile navigation buttons -->


                <div style="clear: both"></div>
            </nav>
        </div>
    </div>

    <nav class="nav-wide-wrapper" aria-label="Page navigation">

    </nav>

</div>




    <script type="text/javascript">
        window.playground_copyable = true;
    </script>

    <script src="ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
    <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

    <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

<script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
<script src="highlight.js" type="text/javascript" charset="utf-8"></script>
<script src="book.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JS scripts -->
    <script type="text/javascript" src="assets/mermaid/mermaid.min.js"></script>
    <script type="text/javascript" src="assets/mermaid/mermaid-init.js"></script>
    <script type="text/javascript" src="assets/smart-anchor.js"></script>
    <script type="text/javascript" src="assets/pagetoc/sidebar.js"></script>

        <script type="text/javascript">
            window.addEventListener('load', function () {
                MathJax.Hub.Register.StartupHook('End', function () {
                    window.setTimeout(window.print, 100);
                });
            });
        </script>
</body>
</html>
